(()=>{var Vx=Object.create;var jg=Object.defineProperty;var qx=Object.getOwnPropertyDescriptor;var Kx=Object.getOwnPropertyNames;var $x=Object.getPrototypeOf,Qx=Object.prototype.hasOwnProperty;var je=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Zx=(e,t,i,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Kx(t))!Qx.call(e,n)&&n!==i&&jg(e,n,{get:()=>t[n],enumerable:!(o=qx(t,n))||o.enumerable});return e};var Wn=(e,t,i)=>(i=e!=null?Vx($x(e)):{},Zx(t||!e||!e.__esModule?jg(i,"default",{value:e,enumerable:!0}):i,e));var Mu=je(()=>{});var Fu=je(()=>{});var Lu=je(()=>{});var Ng=je(ut=>{var C=C||{version:"5.2.4"};typeof ut<"u"?ut.fabric=C:typeof define=="function"&&define.amd&&define([],function(){return C});typeof document<"u"&&typeof window<"u"?(document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?C.document=document:C.document=document.implementation.createHTMLDocument(""),C.window=window):(Wg=Mu(),Iu=new Wg.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window,C.document=Iu.document,C.jsdomImplForWrapper=Fu().implForWrapper,C.nodeCanvas=Lu().Canvas,C.window=Iu,DOMParser=C.window.DOMParser);var Wg,Iu;C.isTouchSupported="ontouchstart"in C.window||"ontouchstart"in C.document||C.window&&C.window.navigator&&C.window.navigator.maxTouchPoints>0;C.isLikelyNode=typeof Buffer<"u"&&typeof window>"u";C.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];C.DPI=96;C.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)";C.commaWsp="(?:\\s+,?\\s*|,\\s*)";C.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig;C.reNonWord=/[ \n\.,;!\?\-]/;C.fontPaths={};C.iMatrix=[1,0,0,1,0,0];C.svgNS="http://www.w3.org/2000/svg";C.perfLimitSizeTotal=2097152;C.maxCacheSideLimit=4096;C.minCacheSideLimit=256;C.charWidthsCache={};C.textureSize=2048;C.disableStyleCopyPaste=!1;C.enableGLFiltering=!0;C.devicePixelRatio=C.window.devicePixelRatio||C.window.webkitDevicePixelRatio||C.window.mozDevicePixelRatio||1;C.browserShadowBlurConstant=1;C.arcToSegmentsCache={};C.boundsOfCurveCache={};C.cachesBoundsOfCurve=!0;C.forceGLPutImageData=!1;C.initFilterBackend=function(){if(C.enableGLFiltering&&C.isWebglSupported&&C.isWebglSupported(C.textureSize))return console.log("max texture size: "+C.maxTextureSize),new C.WebglFilterBackend({tileSize:C.textureSize});if(C.Canvas2dFilterBackend)return new C.Canvas2dFilterBackend};typeof document<"u"&&typeof window<"u"&&(window.fabric=C);(function(){function e(r,a){if(this.__eventListeners[r]){var u=this.__eventListeners[r];a?u[u.indexOf(a)]=!1:C.util.array.fill(u,!1)}}function t(r,a){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var u in r)this.on(u,r[u]);else this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(a);return this}function i(r,a){var u=function(){a.apply(this,arguments),this.off(r,u)}.bind(this);this.on(r,u)}function o(r,a){if(arguments.length===1)for(var u in r)i.call(this,u,r[u]);else i.call(this,r,a);return this}function n(r,a){if(!this.__eventListeners)return this;if(arguments.length===0)for(r in this.__eventListeners)e.call(this,r);else if(arguments.length===1&&typeof arguments[0]=="object")for(var u in r)e.call(this,u,r[u]);else e.call(this,r,a);return this}function s(r,a){if(!this.__eventListeners)return this;var u=this.__eventListeners[r];if(!u)return this;for(var l=0,h=u.length;l<h;l++)u[l]&&u[l].call(this,a||{});return this.__eventListeners[r]=u.filter(function(f){return f!==!1}),this}C.Observable={fire:s,on:t,once:o,off:n}})();C.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var e=0,t=arguments.length;e<t;e++)this._onObjectAdded(arguments[e]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(e,t,i){var o=this._objects;return i?o[t]=e:o.splice(t,0,e),this._onObjectAdded&&this._onObjectAdded(e),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var e=this._objects,t,i=!1,o=0,n=arguments.length;o<n;o++)t=e.indexOf(arguments[o]),t!==-1&&(i=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[o]));return this.renderOnAddRemove&&i&&this.requestRenderAll(),this},forEachObject:function(e,t){for(var i=this.getObjects(),o=0,n=i.length;o<n;o++)e.call(t,i[o],o,i);return this},getObjects:function(e){return typeof e>"u"?this._objects.concat():this._objects.filter(function(t){return t.type===e})},item:function(e){return this._objects[e]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(e,t){return this._objects.indexOf(e)>-1?!0:t?this._objects.some(function(i){return typeof i.contains=="function"&&i.contains(e,!0)}):!1},complexity:function(){return this._objects.reduce(function(e,t){return e+=t.complexity?t.complexity():0,e},0)}};C.CommonMethods={_setOptions:function(e){for(var t in e)this.set(t,e[t])},_initGradient:function(e,t){e&&e.colorStops&&!(e instanceof C.Gradient)&&this.set(t,new C.Gradient(e))},_initPattern:function(e,t,i){e&&e.source&&!(e instanceof C.Pattern)?this.set(t,new C.Pattern(e,i)):i&&i()},_setObject:function(e){for(var t in e)this._set(t,e[t])},set:function(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this},_set:function(e,t){this[e]=t},toggle:function(e){var t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this},get:function(e){return this[e]}};(function(e){var t=Math.sqrt,i=Math.atan2,o=Math.pow,n=Math.PI/180,s=Math.PI/2;C.util={cos:function(r){if(r===0)return 1;r<0&&(r=-r);var a=r/s;switch(a){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},sin:function(r){if(r===0)return 0;var a=r/s,u=1;switch(r<0&&(u=-1),a){case 1:return u;case 2:return 0;case 3:return-u}return Math.sin(r)},removeFromArray:function(r,a){var u=r.indexOf(a);return u!==-1&&r.splice(u,1),r},getRandomInt:function(r,a){return Math.floor(Math.random()*(a-r+1))+r},degreesToRadians:function(r){return r*n},radiansToDegrees:function(r){return r/n},rotatePoint:function(r,a,u){var l=new C.Point(r.x-a.x,r.y-a.y),h=C.util.rotateVector(l,u);return new C.Point(h.x,h.y).addEquals(a)},rotateVector:function(r,a){var u=C.util.sin(a),l=C.util.cos(a),h=r.x*l-r.y*u,f=r.x*u+r.y*l;return{x:h,y:f}},createVector:function(r,a){return new C.Point(a.x-r.x,a.y-r.y)},calcAngleBetweenVectors:function(r,a){return Math.acos((r.x*a.x+r.y*a.y)/(Math.hypot(r.x,r.y)*Math.hypot(a.x,a.y)))},getHatVector:function(r){return new C.Point(r.x,r.y).multiply(1/Math.hypot(r.x,r.y))},getBisector:function(r,a,u){var l=C.util.createVector(r,a),h=C.util.createVector(r,u),f=C.util.calcAngleBetweenVectors(l,h),g=C.util.calcAngleBetweenVectors(C.util.rotateVector(l,f),h),p=f*(g===0?1:-1)/2;return{vector:C.util.getHatVector(C.util.rotateVector(l,p)),angle:f}},projectStrokeOnPoints:function(r,a,u){var l=[],h=a.strokeWidth/2,f=a.strokeUniform?new C.Point(1/a.scaleX,1/a.scaleY):new C.Point(1,1),g=function(p){var v=h/Math.hypot(p.x,p.y);return new C.Point(p.x*v*f.x,p.y*v*f.y)};return r.length<=1||r.forEach(function(p,v){var y=new C.Point(p.x,p.y),_,T;v===0?(T=r[v+1],_=u?g(C.util.createVector(T,y)).addEquals(y):r[r.length-1]):v===r.length-1?(_=r[v-1],T=u?g(C.util.createVector(_,y)).addEquals(y):r[0]):(_=r[v-1],T=r[v+1]);var P=C.util.getBisector(y,_,T),F=P.vector,j=P.angle,Z,Q;if(a.strokeLineJoin==="miter"&&(Z=-h/Math.sin(j/2),Q=new C.Point(F.x*Z*f.x,F.y*Z*f.y),Math.hypot(Q.x,Q.y)/h<=a.strokeMiterLimit)){l.push(y.add(Q)),l.push(y.subtract(Q));return}Z=-h*Math.SQRT2,Q=new C.Point(F.x*Z*f.x,F.y*Z*f.y),l.push(y.add(Q)),l.push(y.subtract(Q))}),l},transformPoint:function(r,a,u){return u?new C.Point(a[0]*r.x+a[2]*r.y,a[1]*r.x+a[3]*r.y):new C.Point(a[0]*r.x+a[2]*r.y+a[4],a[1]*r.x+a[3]*r.y+a[5])},makeBoundingBoxFromPoints:function(r,a){if(a)for(var u=0;u<r.length;u++)r[u]=C.util.transformPoint(r[u],a);var l=[r[0].x,r[1].x,r[2].x,r[3].x],h=C.util.array.min(l),f=C.util.array.max(l),g=f-h,p=[r[0].y,r[1].y,r[2].y,r[3].y],v=C.util.array.min(p),y=C.util.array.max(p),_=y-v;return{left:h,top:v,width:g,height:_}},invertTransform:function(r){var a=1/(r[0]*r[3]-r[1]*r[2]),u=[a*r[3],-a*r[1],-a*r[2],a*r[0]],l=C.util.transformPoint({x:r[4],y:r[5]},u,!0);return u[4]=-l.x,u[5]=-l.y,u},toFixed:function(r,a){return parseFloat(Number(r).toFixed(a))},parseUnit:function(r,a){var u=/\D{0,2}$/.exec(r),l=parseFloat(r);switch(a||(a=C.Text.DEFAULT_SVG_FONT_SIZE),u[0]){case"mm":return l*C.DPI/25.4;case"cm":return l*C.DPI/2.54;case"in":return l*C.DPI;case"pt":return l*C.DPI/72;case"pc":return l*C.DPI/72*12;case"em":return l*a;default:return l}},falseFunction:function(){return!1},getKlass:function(r,a){return r=C.util.string.camelize(r.charAt(0).toUpperCase()+r.slice(1)),C.util.resolveNamespace(a)[r]},getSvgAttributes:function(r){var a=["instantiated_by_use","style","id","class"];switch(r){case"linearGradient":a=a.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":a=a.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":a=a.concat(["offset","stop-color","stop-opacity"]);break}return a},resolveNamespace:function(r){if(!r)return C;var a=r.split("."),u=a.length,l,h=e||C.window;for(l=0;l<u;++l)h=h[a[l]];return h},loadImage:function(r,a,u,l){if(!r){a&&a.call(u,r);return}var h=C.util.createImage(),f=function(){a&&a.call(u,h,!1),h=h.onload=h.onerror=null};h.onload=f,h.onerror=function(){C.log("Error loading "+h.src),a&&a.call(u,null,!0),h=h.onload=h.onerror=null},r.indexOf("data")!==0&&l!==void 0&&l!==null&&(h.crossOrigin=l),r.substring(0,14)==="data:image/svg"&&(h.onload=null,C.util.loadImageInDom(h,f)),h.src=r},loadImageInDom:function(r,a){var u=C.document.createElement("div");u.style.width=u.style.height="1px",u.style.left=u.style.top="-100%",u.style.position="absolute",u.appendChild(r),C.document.querySelector("body").appendChild(u),r.onload=function(){a(),u.parentNode.removeChild(u),u=null}},enlivenObjects:function(r,a,u,l){r=r||[];var h=[],f=0,g=r.length;function p(){++f===g&&a&&a(h.filter(function(v){return v}))}if(!g){a&&a(h);return}r.forEach(function(v,y){if(!v||!v.type){p();return}var _=C.util.getKlass(v.type,u);_.fromObject(v,function(T,P){P||(h[y]=T),l&&l(v,T,P),p()})})},enlivenObjectEnlivables:function(r,a,u){var l=C.Object.ENLIVEN_PROPS.filter(function(h){return!!r[h]});C.util.enlivenObjects(l.map(function(h){return r[h]}),function(h){var f={};l.forEach(function(g,p){f[g]=h[p],a&&(a[g]=h[p])}),u&&u(f)})},enlivenPatterns:function(r,a){r=r||[];function u(){++h===f&&a&&a(l)}var l=[],h=0,f=r.length;if(!f){a&&a(l);return}r.forEach(function(g,p){g&&g.source?new C.Pattern(g,function(v){l[p]=v,u()}):(l[p]=g,u())})},groupSVGElements:function(r,a,u){var l;return r&&r.length===1?(typeof u<"u"&&(r[0].sourcePath=u),r[0]):(a&&(a.width&&a.height?a.centerPoint={x:a.width/2,y:a.height/2}:(delete a.width,delete a.height)),l=new C.Group(r,a),typeof u<"u"&&(l.sourcePath=u),l)},populateWithProperties:function(r,a,u){if(u&&Array.isArray(u))for(var l=0,h=u.length;l<h;l++)u[l]in r&&(a[u[l]]=r[u[l]])},createCanvasElement:function(){return C.document.createElement("canvas")},copyCanvasElement:function(r){var a=C.util.createCanvasElement();return a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),a},toDataURL:function(r,a,u){return r.toDataURL("image/"+a,u)},createImage:function(){return C.document.createElement("img")},multiplyTransformMatrices:function(r,a,u){return[r[0]*a[0]+r[2]*a[1],r[1]*a[0]+r[3]*a[1],r[0]*a[2]+r[2]*a[3],r[1]*a[2]+r[3]*a[3],u?0:r[0]*a[4]+r[2]*a[5]+r[4],u?0:r[1]*a[4]+r[3]*a[5]+r[5]]},qrDecompose:function(r){var a=i(r[1],r[0]),u=o(r[0],2)+o(r[1],2),l=t(u),h=(r[0]*r[3]-r[2]*r[1])/l,f=i(r[0]*r[2]+r[1]*r[3],u);return{angle:a/n,scaleX:l,scaleY:h,skewX:f/n,skewY:0,translateX:r[4],translateY:r[5]}},calcRotateMatrix:function(r){if(!r.angle)return C.iMatrix.concat();var a=C.util.degreesToRadians(r.angle),u=C.util.cos(a),l=C.util.sin(a);return[u,l,-l,u,0,0]},calcDimensionsMatrix:function(r){var a=typeof r.scaleX>"u"?1:r.scaleX,u=typeof r.scaleY>"u"?1:r.scaleY,l=[r.flipX?-a:a,0,0,r.flipY?-u:u,0,0],h=C.util.multiplyTransformMatrices,f=C.util.degreesToRadians;return r.skewX&&(l=h(l,[1,0,Math.tan(f(r.skewX)),1],!0)),r.skewY&&(l=h(l,[1,Math.tan(f(r.skewY)),0,1],!0)),l},composeMatrix:function(r){var a=[1,0,0,1,r.translateX||0,r.translateY||0],u=C.util.multiplyTransformMatrices;return r.angle&&(a=u(a,C.util.calcRotateMatrix(r))),(r.scaleX!==1||r.scaleY!==1||r.skewX||r.skewY||r.flipX||r.flipY)&&(a=u(a,C.util.calcDimensionsMatrix(r))),a},resetObjectTransform:function(r){r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},saveObjectTransform:function(r){return{scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}},isTransparent:function(r,a,u,l){l>0&&(a>l?a-=l:a=0,u>l?u-=l:u=0);var h=!0,f,g,p=r.getImageData(a,u,l*2||1,l*2||1),v=p.data.length;for(f=3;f<v&&(g=p.data[f],h=g<=0,h!==!1);f+=4);return p=null,h},parsePreserveAspectRatioAttribute:function(r){var a="meet",u="Mid",l="Mid",h=r.split(" "),f;return h&&h.length&&(a=h.pop(),a!=="meet"&&a!=="slice"?(f=a,a="meet"):h.length&&(f=h.pop())),u=f!=="none"?f.slice(1,4):"none",l=f!=="none"?f.slice(5,8):"none",{meetOrSlice:a,alignX:u,alignY:l}},clearFabricFontCache:function(r){r=(r||"").toLowerCase(),r?C.charWidthsCache[r]&&delete C.charWidthsCache[r]:C.charWidthsCache={}},limitDimsByArea:function(r,a){var u=Math.sqrt(a*r),l=Math.floor(a/u);return{x:Math.floor(u),y:l}},capValue:function(r,a,u){return Math.max(r,Math.min(a,u))},findScaleToFit:function(r,a){return Math.min(a.width/r.width,a.height/r.height)},findScaleToCover:function(r,a){return Math.max(a.width/r.width,a.height/r.height)},matrixToSVG:function(r){return"matrix("+r.map(function(a){return C.util.toFixed(a,C.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(r,a){var u=C.util.invertTransform(a),l=C.util.multiplyTransformMatrices(u,r.calcOwnMatrix());C.util.applyTransformToObject(r,l)},addTransformToObject:function(r,a){C.util.applyTransformToObject(r,C.util.multiplyTransformMatrices(a,r.calcOwnMatrix()))},applyTransformToObject:function(r,a){var u=C.util.qrDecompose(a),l=new C.Point(u.translateX,u.translateY);r.flipX=!1,r.flipY=!1,r.set("scaleX",u.scaleX),r.set("scaleY",u.scaleY),r.skewX=u.skewX,r.skewY=u.skewY,r.angle=u.angle,r.setPositionByOrigin(l,"center","center")},sizeAfterTransform:function(r,a,u){var l=r/2,h=a/2,f=[{x:-l,y:-h},{x:l,y:-h},{x:-l,y:h},{x:l,y:h}],g=C.util.calcDimensionsMatrix(u),p=C.util.makeBoundingBoxFromPoints(f,g);return{x:p.width,y:p.height}},mergeClipPaths:function(r,a){var u=r,l=a;u.inverted&&!l.inverted&&(u=a,l=r),C.util.applyTransformToObject(l,C.util.multiplyTransformMatrices(C.util.invertTransform(u.calcTransformMatrix()),l.calcTransformMatrix()));var h=u.inverted&&l.inverted;return h&&(u.inverted=l.inverted=!1),new C.Group([u],{clipPath:l,inverted:h})},hasStyleChanged:function(r,a,u){return u=u||!1,r.fill!==a.fill||r.stroke!==a.stroke||r.strokeWidth!==a.strokeWidth||r.fontSize!==a.fontSize||r.fontFamily!==a.fontFamily||r.fontWeight!==a.fontWeight||r.fontStyle!==a.fontStyle||r.deltaY!==a.deltaY||u&&(r.overline!==a.overline||r.underline!==a.underline||r.linethrough!==a.linethrough)},stylesToArray:function(u,a){for(var u=C.util.object.clone(u,!0),l=a.split(`
`),h=-1,f={},g=[],p=0;p<l.length;p++){if(!u[p]){h+=l[p].length;continue}for(var v=0;v<l[p].length;v++){h++;var y=u[p][v];if(y){var _=C.util.hasStyleChanged(f,y,!0);_?g.push({start:h,end:h+1,style:y}):g[g.length-1].end++}f=y||{}}}return g},stylesFromArray:function(r,a){if(!Array.isArray(r))return r;for(var u=a.split(`
`),l=-1,h=0,f={},g=0;g<u.length;g++)for(var p=0;p<u[g].length;p++)l++,r[h]&&r[h].start<=l&&l<r[h].end&&(f[g]=f[g]||{},f[g][p]=Object.assign({},r[h].style),l===r[h].end-1&&h++);return f}}})(ut);(function(){var e=Array.prototype.join,t={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},i={m:"l",M:"L"};function o(w,k,A,E,W,O,x,M,R,z,N){var q=C.util.cos(w),et=C.util.sin(w),ot=C.util.cos(k),X=C.util.sin(k),I=A*W*ot-E*O*X+x,G=E*W*ot+A*O*X+M,V=z+R*(-A*W*et-E*O*q),Y=N+R*(-E*W*et+A*O*q),K=I+R*(A*W*X+E*O*ot),st=G+R*(E*W*X-A*O*ot);return["C",V,Y,K,st,I,G]}function n(w,k,A,E,W,O,x){var M=Math.PI,R=x*M/180,z=C.util.sin(R),N=C.util.cos(R),q=0,et=0;A=Math.abs(A),E=Math.abs(E);var ot=-N*w*.5-z*k*.5,X=-N*k*.5+z*w*.5,I=A*A,G=E*E,V=X*X,Y=ot*ot,K=I*G-I*V-G*Y,st=0;if(K<0){var yt=Math.sqrt(1-K/(I*G));A*=yt,E*=yt}else st=(W===O?-1:1)*Math.sqrt(K/(I*V+G*Y));var dt=st*A*X/E,U=-st*E*ot/A,pt=N*dt-z*U+w*.5,_t=z*dt+N*U+k*.5,St=s(1,0,(ot-dt)/A,(X-U)/E),Ot=s((ot-dt)/A,(X-U)/E,(-ot-dt)/A,(-X-U)/E);O===0&&Ot>0?Ot-=2*M:O===1&&Ot<0&&(Ot+=2*M);for(var Tt=Math.ceil(Math.abs(Ot/M*2)),Wt=[],Ft=Ot/Tt,ae=8/3*Math.sin(Ft/4)*Math.sin(Ft/4)/Math.sin(Ft/2),ze=St+Ft,qt=0;qt<Tt;qt++)Wt[qt]=o(St,ze,N,z,A,E,pt,_t,ae,q,et),q=Wt[qt][5],et=Wt[qt][6],St=ze,ze+=Ft;return Wt}function s(w,k,A,E){var W=Math.atan2(k,w),O=Math.atan2(E,A);return O>=W?O-W:2*Math.PI-(W-O)}function r(w,k,A,E,W,O,x,M){var R;if(C.cachesBoundsOfCurve&&(R=e.call(arguments),C.boundsOfCurveCache[R]))return C.boundsOfCurveCache[R];var z=Math.sqrt,N=Math.min,q=Math.max,et=Math.abs,ot=[],X=[[],[]],I,G,V,Y,K,st,yt,dt;G=6*w-12*A+6*W,I=-3*w+9*A-9*W+3*x,V=3*A-3*w;for(var U=0;U<2;++U){if(U>0&&(G=6*k-12*E+6*O,I=-3*k+9*E-9*O+3*M,V=3*E-3*k),et(I)<1e-12){if(et(G)<1e-12)continue;Y=-V/G,0<Y&&Y<1&&ot.push(Y);continue}yt=G*G-4*V*I,!(yt<0)&&(dt=z(yt),K=(-G+dt)/(2*I),0<K&&K<1&&ot.push(K),st=(-G-dt)/(2*I),0<st&&st<1&&ot.push(st))}for(var pt,_t,St=ot.length,Ot=St,Tt;St--;)Y=ot[St],Tt=1-Y,pt=Tt*Tt*Tt*w+3*Tt*Tt*Y*A+3*Tt*Y*Y*W+Y*Y*Y*x,X[0][St]=pt,_t=Tt*Tt*Tt*k+3*Tt*Tt*Y*E+3*Tt*Y*Y*O+Y*Y*Y*M,X[1][St]=_t;X[0][Ot]=w,X[1][Ot]=k,X[0][Ot+1]=x,X[1][Ot+1]=M;var Wt=[{x:N.apply(null,X[0]),y:N.apply(null,X[1])},{x:q.apply(null,X[0]),y:q.apply(null,X[1])}];return C.cachesBoundsOfCurve&&(C.boundsOfCurveCache[R]=Wt),Wt}function a(w,k,A){for(var E=A[1],W=A[2],O=A[3],x=A[4],M=A[5],R=A[6],z=A[7],N=n(R-w,z-k,E,W,x,M,O),q=0,et=N.length;q<et;q++)N[q][1]+=w,N[q][2]+=k,N[q][3]+=w,N[q][4]+=k,N[q][5]+=w,N[q][6]+=k;return N}function u(w){var k=0,A=0,E=w.length,W=0,O=0,x,M,R,z=[],N,q,et;for(M=0;M<E;++M){switch(R=!1,x=w[M].slice(0),x[0]){case"l":x[0]="L",x[1]+=k,x[2]+=A;case"L":k=x[1],A=x[2];break;case"h":x[1]+=k;case"H":x[0]="L",x[2]=A,k=x[1];break;case"v":x[1]+=A;case"V":x[0]="L",A=x[1],x[1]=k,x[2]=A;break;case"m":x[0]="M",x[1]+=k,x[2]+=A;case"M":k=x[1],A=x[2],W=x[1],O=x[2];break;case"c":x[0]="C",x[1]+=k,x[2]+=A,x[3]+=k,x[4]+=A,x[5]+=k,x[6]+=A;case"C":q=x[3],et=x[4],k=x[5],A=x[6];break;case"s":x[0]="S",x[1]+=k,x[2]+=A,x[3]+=k,x[4]+=A;case"S":N==="C"?(q=2*k-q,et=2*A-et):(q=k,et=A),k=x[3],A=x[4],x[0]="C",x[5]=x[3],x[6]=x[4],x[3]=x[1],x[4]=x[2],x[1]=q,x[2]=et,q=x[3],et=x[4];break;case"q":x[0]="Q",x[1]+=k,x[2]+=A,x[3]+=k,x[4]+=A;case"Q":q=x[1],et=x[2],k=x[3],A=x[4];break;case"t":x[0]="T",x[1]+=k,x[2]+=A;case"T":N==="Q"?(q=2*k-q,et=2*A-et):(q=k,et=A),x[0]="Q",k=x[1],A=x[2],x[1]=q,x[2]=et,x[3]=k,x[4]=A;break;case"a":x[0]="A",x[6]+=k,x[7]+=A;case"A":R=!0,z=z.concat(a(k,A,x)),k=x[6],A=x[7];break;case"z":case"Z":k=W,A=O;break;default:}R||z.push(x),N=x[0]}return z}function l(w,k,A,E){return Math.sqrt((A-w)*(A-w)+(E-k)*(E-k))}function h(w){return w*w*w}function f(w){return 3*w*w*(1-w)}function g(w){return 3*w*(1-w)*(1-w)}function p(w){return(1-w)*(1-w)*(1-w)}function v(w,k,A,E,W,O,x,M){return function(R){var z=h(R),N=f(R),q=g(R),et=p(R);return{x:x*z+W*N+A*q+w*et,y:M*z+O*N+E*q+k*et}}}function y(w,k,A,E,W,O,x,M){return function(R){var z=1-R,N=3*z*z*(A-w)+6*z*R*(W-A)+3*R*R*(x-W),q=3*z*z*(E-k)+6*z*R*(O-E)+3*R*R*(M-O);return Math.atan2(q,N)}}function _(w){return w*w}function T(w){return 2*w*(1-w)}function P(w){return(1-w)*(1-w)}function F(w,k,A,E,W,O){return function(x){var M=_(x),R=T(x),z=P(x);return{x:W*M+A*R+w*z,y:O*M+E*R+k*z}}}function j(w,k,A,E,W,O){return function(x){var M=1-x,R=2*M*(A-w)+2*x*(W-A),z=2*M*(E-k)+2*x*(O-E);return Math.atan2(z,R)}}function Z(w,k,A){var E={x:k,y:A},W,O=0,x;for(x=1;x<=100;x+=1)W=w(x/100),O+=l(E.x,E.y,W.x,W.y),E=W;return O}function Q(w,k){for(var A=0,E=0,W=w.iterator,O={x:w.x,y:w.y},x,M,R=.01,z=w.angleFinder,N;E<k&&R>1e-4;)x=W(A),N=A,M=l(O.x,O.y,x.x,x.y),M+E>k?(A-=R,R/=2):(O=x,A+=R,E+=M);return x.angle=z(N),x}function $(w){for(var k=0,A=w.length,E,W=0,O=0,x=0,M=0,R=[],z,N,q,et=0;et<A;et++){switch(E=w[et],N={x:W,y:O,command:E[0]},E[0]){case"M":N.length=0,x=W=E[1],M=O=E[2];break;case"L":N.length=l(W,O,E[1],E[2]),W=E[1],O=E[2];break;case"C":z=v(W,O,E[1],E[2],E[3],E[4],E[5],E[6]),q=y(W,O,E[1],E[2],E[3],E[4],E[5],E[6]),N.iterator=z,N.angleFinder=q,N.length=Z(z,W,O),W=E[5],O=E[6];break;case"Q":z=F(W,O,E[1],E[2],E[3],E[4]),q=j(W,O,E[1],E[2],E[3],E[4]),N.iterator=z,N.angleFinder=q,N.length=Z(z,W,O),W=E[3],O=E[4];break;case"Z":case"z":N.destX=x,N.destY=M,N.length=l(W,O,x,M),W=x,O=M;break}k+=N.length,R.push(N)}return R.push({length:k,x:W,y:O}),R}function tt(w,k,A){A||(A=$(w));for(var E=0;k-A[E].length>0&&E<A.length-2;)k-=A[E].length,E++;var W=A[E],O=k/W.length,x=W.command,M=w[E],R;switch(x){case"M":return{x:W.x,y:W.y,angle:0};case"Z":case"z":return R=new C.Point(W.x,W.y).lerp(new C.Point(W.destX,W.destY),O),R.angle=Math.atan2(W.destY-W.y,W.destX-W.x),R;case"L":return R=new C.Point(W.x,W.y).lerp(new C.Point(M[1],M[2]),O),R.angle=Math.atan2(M[2]-W.y,M[1]-W.x),R;case"C":return Q(W,k);case"Q":return Q(W,k)}}function rt(w){var k=[],A=[],E,W,O=C.rePathCommand,x="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",M="("+x+")"+C.commaWsp,R="([01])"+C.commaWsp+"?",z=M+"?"+M+"?"+M+R+R+M+"?("+x+")",N=new RegExp(z,"g"),q,et,ot;if(!w||!w.match)return k;ot=w.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var X=0,I,G=ot.length;X<G;X++){E=ot[X],et=E.slice(1).trim(),A.length=0;var V=E.charAt(0);if(I=[V],V.toLowerCase()==="a")for(var Y;Y=N.exec(et);)for(var K=1;K<Y.length;K++)A.push(Y[K]);else for(;q=O.exec(et);)A.push(q[0]);for(var K=0,st=A.length;K<st;K++)W=parseFloat(A[K]),isNaN(W)||I.push(W);var yt=t[V.toLowerCase()],dt=i[V]||V;if(I.length-1>yt)for(var U=1,pt=I.length;U<pt;U+=yt)k.push([V].concat(I.slice(U,U+yt))),V=dt;else k.push(I)}return k}function ct(w,k){var A=[],E,W=new C.Point(w[0].x,w[0].y),O=new C.Point(w[1].x,w[1].y),x=w.length,M=1,R=0,z=x>2;for(k=k||0,z&&(M=w[2].x<O.x?-1:w[2].x===O.x?0:1,R=w[2].y<O.y?-1:w[2].y===O.y?0:1),A.push(["M",W.x-M*k,W.y-R*k]),E=1;E<x;E++){if(!W.eq(O)){var N=W.midPointFrom(O);A.push(["Q",W.x,W.y,N.x,N.y])}W=w[E],E+1<w.length&&(O=w[E+1])}return z&&(M=W.x>w[E-2].x?1:W.x===w[E-2].x?0:-1,R=W.y>w[E-2].y?1:W.y===w[E-2].y?0:-1),A.push(["L",W.x+M*k,W.y+R*k]),A}function lt(w,k,A){return A&&(k=C.util.multiplyTransformMatrices(k,[1,0,0,1,-A.x,-A.y])),w.map(function(E){for(var W=E.slice(0),O={},x=1;x<E.length-1;x+=2)O.x=E[x],O.y=E[x+1],O=C.util.transformPoint(O,k),W[x]=O.x,W[x+1]=O.y;return W})}C.util.joinPath=function(w){return w.map(function(k){return k.join(" ")}).join(" ")},C.util.parsePath=rt,C.util.makePathSimpler=u,C.util.getSmoothPathFromPoints=ct,C.util.getPathSegmentsInfo=$,C.util.getBoundsOfCurve=r,C.util.getPointOnPath=tt,C.util.transformPath=lt})();(function(){var e=Array.prototype.slice;function t(r,a){for(var u=e.call(arguments,2),l=[],h=0,f=r.length;h<f;h++)l[h]=u.length?r[h][a].apply(r[h],u):r[h][a].call(r[h]);return l}function i(r,a){return s(r,a,function(u,l){return u>=l})}function o(r,a){return s(r,a,function(u,l){return u<l})}function n(r,a){for(var u=r.length;u--;)r[u]=a;return r}function s(r,a,u){if(!(!r||r.length===0)){var l=r.length-1,h=a?r[l][a]:r[l];if(a)for(;l--;)u(r[l][a],h)&&(h=r[l][a]);else for(;l--;)u(r[l],h)&&(h=r[l]);return h}}C.util.array={fill:n,invoke:t,min:o,max:i}})();(function(){function e(i,o,n){if(n)if(!C.isLikelyNode&&o instanceof Element)i=o;else if(o instanceof Array){i=[];for(var s=0,r=o.length;s<r;s++)i[s]=e({},o[s],n)}else if(o&&typeof o=="object")for(var a in o)a==="canvas"||a==="group"?i[a]=null:o.hasOwnProperty(a)&&(i[a]=e({},o[a],n));else i=o;else for(var a in o)i[a]=o[a];return i}function t(i,o){return e({},i,o)}C.util.object={extend:e,clone:t},C.util.object.extend(C.util,C.Observable)})();(function(){function e(s){return s.replace(/-+(.)?/g,function(r,a){return a?a.toUpperCase():""})}function t(s,r){return s.charAt(0).toUpperCase()+(r?s.slice(1):s.slice(1).toLowerCase())}function i(s){return s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function o(s){var r=0,a,u=[];for(r=0,a;r<s.length;r++)(a=n(s,r))!==!1&&u.push(a);return u}function n(s,r){var a=s.charCodeAt(r);if(isNaN(a))return"";if(a<55296||a>57343)return s.charAt(r);if(55296<=a&&a<=56319){if(s.length<=r+1)throw"High surrogate without following low surrogate";var u=s.charCodeAt(r+1);if(56320>u||u>57343)throw"High surrogate without following low surrogate";return s.charAt(r)+s.charAt(r+1)}if(r===0)throw"Low surrogate without preceding high surrogate";var l=s.charCodeAt(r-1);if(55296>l||l>56319)throw"Low surrogate without preceding high surrogate";return!1}C.util.string={camelize:e,capitalize:t,escapeXml:i,graphemeSplit:o}})();(function(){var e=Array.prototype.slice,t=function(){},i=function(){for(var a in{toString:1})if(a==="toString")return!1;return!0}(),o=function(a,u,l){for(var h in u)h in a.prototype&&typeof a.prototype[h]=="function"&&(u[h]+"").indexOf("callSuper")>-1?a.prototype[h]=function(f){return function(){var g=this.constructor.superclass;this.constructor.superclass=l;var p=u[f].apply(this,arguments);if(this.constructor.superclass=g,f!=="initialize")return p}}(h):a.prototype[h]=u[h],i&&(u.toString!==Object.prototype.toString&&(a.prototype.toString=u.toString),u.valueOf!==Object.prototype.valueOf&&(a.prototype.valueOf=u.valueOf))};function n(){}function s(a){for(var u=null,l=this;l.constructor.superclass;){var h=l.constructor.superclass.prototype[a];if(l[a]!==h){u=h;break}l=l.constructor.superclass.prototype}return u?arguments.length>1?u.apply(this,e.call(arguments,1)):u.call(this):console.log("tried to callSuper "+a+", method not found in prototype chain",this)}function r(){var a=null,u=e.call(arguments,0);typeof u[0]=="function"&&(a=u.shift());function l(){this.initialize.apply(this,arguments)}l.superclass=a,l.subclasses=[],a&&(n.prototype=a.prototype,l.prototype=new n,a.subclasses.push(l));for(var h=0,f=u.length;h<f;h++)o(l,u[h],a);return l.prototype.initialize||(l.prototype.initialize=t),l.prototype.constructor=l,l.prototype.callSuper=s,l}C.util.createClass=r})();(function(){var e=!!C.document.createElement("div").attachEvent,t=["touchstart","touchmove","touchend"];C.util.addListener=function(o,n,s,r){o&&o.addEventListener(n,s,e?!1:r)},C.util.removeListener=function(o,n,s,r){o&&o.removeEventListener(n,s,e?!1:r)};function i(o){var n=o.changedTouches;return n&&n[0]?n[0]:o}C.util.getPointer=function(o){var n=o.target,s=C.util.getScrollLeftTop(n),r=i(o);return{x:r.clientX+s.left,y:r.clientY+s.top}},C.util.isTouchEvent=function(o){return t.indexOf(o.type)>-1||o.pointerType==="touch"}})();(function(){function e(r,a){var u=r.style;if(!u)return r;if(typeof a=="string")return r.style.cssText+=";"+a,a.indexOf("opacity")>-1?s(r,a.match(/opacity:\s*(\d?\.?\d*)/)[1]):r;for(var l in a)if(l==="opacity")s(r,a[l]);else{var h=l==="float"||l==="cssFloat"?typeof u.styleFloat>"u"?"cssFloat":"styleFloat":l;u.setProperty(h,a[l])}return r}var t=C.document.createElement("div"),i=typeof t.style.opacity=="string",o=typeof t.style.filter=="string",n=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,s=function(r){return r};i?s=function(r,a){return r.style.opacity=a,r}:o&&(s=function(r,a){var u=r.style;return r.currentStyle&&!r.currentStyle.hasLayout&&(u.zoom=1),n.test(u.filter)?(a=a>=.9999?"":"alpha(opacity="+a*100+")",u.filter=u.filter.replace(n,a)):u.filter+=" alpha(opacity="+a*100+")",r}),C.util.setStyle=e})();(function(){var e=Array.prototype.slice;function t(p){return typeof p=="string"?C.document.getElementById(p):p}var i,o=function(p){return e.call(p,0)};try{i=o(C.document.childNodes)instanceof Array}catch{}i||(o=function(p){for(var v=new Array(p.length),y=p.length;y--;)v[y]=p[y];return v});function n(p,v){var y=C.document.createElement(p);for(var _ in v)_==="class"?y.className=v[_]:_==="for"?y.htmlFor=v[_]:y.setAttribute(_,v[_]);return y}function s(p,v){p&&(" "+p.className+" ").indexOf(" "+v+" ")===-1&&(p.className+=(p.className?" ":"")+v)}function r(p,v,y){return typeof v=="string"&&(v=n(v,y)),p.parentNode&&p.parentNode.replaceChild(v,p),v.appendChild(p),v}function a(p){for(var v=0,y=0,_=C.document.documentElement,T=C.document.body||{scrollLeft:0,scrollTop:0};p&&(p.parentNode||p.host)&&(p=p.parentNode||p.host,p===C.document?(v=T.scrollLeft||_.scrollLeft||0,y=T.scrollTop||_.scrollTop||0):(v+=p.scrollLeft||0,y+=p.scrollTop||0),!(p.nodeType===1&&p.style.position==="fixed")););return{left:v,top:y}}function u(p){var v,y=p&&p.ownerDocument,_={left:0,top:0},T={left:0,top:0},P,F={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!y)return T;for(var j in F)T[F[j]]+=parseInt(l(p,j),10)||0;return v=y.documentElement,typeof p.getBoundingClientRect<"u"&&(_=p.getBoundingClientRect()),P=a(p),{left:_.left+P.left-(v.clientLeft||0)+T.left,top:_.top+P.top-(v.clientTop||0)+T.top}}var l;C.document.defaultView&&C.document.defaultView.getComputedStyle?l=function(p,v){var y=C.document.defaultView.getComputedStyle(p,null);return y?y[v]:void 0}:l=function(p,v){var y=p.style[v];return!y&&p.currentStyle&&(y=p.currentStyle[v]),y},function(){var p=C.document.documentElement.style,v="userSelect"in p?"userSelect":"MozUserSelect"in p?"MozUserSelect":"WebkitUserSelect"in p?"WebkitUserSelect":"KhtmlUserSelect"in p?"KhtmlUserSelect":"";function y(T){return typeof T.onselectstart<"u"&&(T.onselectstart=C.util.falseFunction),v?T.style[v]="none":typeof T.unselectable=="string"&&(T.unselectable="on"),T}function _(T){return typeof T.onselectstart<"u"&&(T.onselectstart=null),v?T.style[v]="":typeof T.unselectable=="string"&&(T.unselectable=""),T}C.util.makeElementUnselectable=y,C.util.makeElementSelectable=_}();function h(p){var v=C.jsdomImplForWrapper(p);return v._canvas||v._image}function f(p){if(C.isLikelyNode){var v=C.jsdomImplForWrapper(p);v&&(v._image=null,v._canvas=null,v._currentSrc=null,v._attributes=null,v._classList=null)}}function g(p,v){p.imageSmoothingEnabled=p.imageSmoothingEnabled||p.webkitImageSmoothingEnabled||p.mozImageSmoothingEnabled||p.msImageSmoothingEnabled||p.oImageSmoothingEnabled,p.imageSmoothingEnabled=v}C.util.setImageSmoothing=g,C.util.getById=t,C.util.toArray=o,C.util.addClass=s,C.util.makeElement=n,C.util.wrapElement=r,C.util.getScrollLeftTop=a,C.util.getElementOffset=u,C.util.getNodeCanvas=h,C.util.cleanUpJsdomNode=f})();(function(){function e(o,n){return o+(/\?/.test(o)?"&":"?")+n}function t(){}function i(o,n){n||(n={});var s=n.method?n.method.toUpperCase():"GET",r=n.onComplete||function(){},a=new C.window.XMLHttpRequest,u=n.body||n.parameters;return a.onreadystatechange=function(){a.readyState===4&&(r(a),a.onreadystatechange=t)},s==="GET"&&(u=null,typeof n.parameters=="string"&&(o=e(o,n.parameters))),a.open(s,o,!0),(s==="POST"||s==="PUT")&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(u),a}C.util.request=i})();C.log=console.log;C.warn=console.warn;(function(){var e=C.util.object.extend,t=C.util.object.clone,i=[];C.util.object.extend(i,{cancelAll:function(){var h=this.splice(0);return h.forEach(function(f){f.cancel()}),h},cancelByCanvas:function(h){if(!h)return[];var f=this.filter(function(g){return typeof g.target=="object"&&g.target.canvas===h});return f.forEach(function(g){g.cancel()}),f},cancelByTarget:function(h){var f=this.findAnimationsByTarget(h);return f.forEach(function(g){g.cancel()}),f},findAnimationIndex:function(h){return this.indexOf(this.findAnimation(h))},findAnimation:function(h){return this.find(function(f){return f.cancel===h})},findAnimationsByTarget:function(h){return h?this.filter(function(f){return f.target===h}):[]}});function o(){return!1}function n(h,f,g,p){return-g*Math.cos(h/p*(Math.PI/2))+g+f}function s(h){h||(h={});var f=!1,g,p=function(){var v=C.runningAnimations.indexOf(g);return v>-1&&C.runningAnimations.splice(v,1)[0]};return g=e(t(h),{cancel:function(){return f=!0,p()},currentValue:"startValue"in h?h.startValue:0,completionRate:0,durationRate:0}),C.runningAnimations.push(g),u(function(v){var y=v||+new Date,_=h.duration||500,T=y+_,P,F=h.onChange||o,j=h.abort||o,Z=h.onComplete||o,Q=h.easing||n,$="startValue"in h?h.startValue.length>0:!1,tt="startValue"in h?h.startValue:0,rt="endValue"in h?h.endValue:100,ct=h.byValue||($?tt.map(function(lt,w){return rt[w]-tt[w]}):rt-tt);h.onStart&&h.onStart(),function lt(w){P=w||+new Date;var k=P>T?_:P-y,A=k/_,E=$?tt.map(function(O,x){return Q(k,tt[x],ct[x],_)}):Q(k,tt,ct,_),W=Math.abs($?(E[0]-tt[0])/ct[0]:(E-tt)/ct);if(g.currentValue=$?E.slice():E,g.completionRate=W,g.durationRate=A,!f){if(j(E,W,A)){p();return}if(P>T){g.currentValue=$?rt.slice():rt,g.completionRate=1,g.durationRate=1,F($?rt.slice():rt,1,1),Z(rt,1,1),p();return}else F(E,W,A),u(lt)}}(y)}),g.cancel}var r=C.window.requestAnimationFrame||C.window.webkitRequestAnimationFrame||C.window.mozRequestAnimationFrame||C.window.oRequestAnimationFrame||C.window.msRequestAnimationFrame||function(h){return C.window.setTimeout(h,1e3/60)},a=C.window.cancelAnimationFrame||C.window.clearTimeout;function u(){return r.apply(C.window,arguments)}function l(){return a.apply(C.window,arguments)}C.util.animate=s,C.util.requestAnimFrame=u,C.util.cancelAnimFrame=l,C.runningAnimations=i})();(function(){function e(i,o,n){var s="rgba("+parseInt(i[0]+n*(o[0]-i[0]),10)+","+parseInt(i[1]+n*(o[1]-i[1]),10)+","+parseInt(i[2]+n*(o[2]-i[2]),10);return s+=","+(i&&o?parseFloat(i[3]+n*(o[3]-i[3])):1),s+=")",s}function t(i,o,n,s){var r=new C.Color(i).getSource(),a=new C.Color(o).getSource(),u=s.onComplete,l=s.onChange;return s=s||{},C.util.animate(C.util.object.extend(s,{duration:n||500,startValue:r,endValue:a,byValue:a,easing:function(h,f,g,p){var v=s.colorEasing?s.colorEasing(h,p):1-Math.cos(h/p*(Math.PI/2));return e(f,g,v)},onComplete:function(h,f,g){if(u)return u(e(a,a,0),f,g)},onChange:function(h,f,g){if(l){if(Array.isArray(h))return l(e(h,h,0),f,g);l(h,f,g)}}}))}C.util.animateColor=t})();(function(){function e(w,k,A,E){return w<Math.abs(k)?(w=k,E=A/4):k===0&&w===0?E=A/(2*Math.PI)*Math.asin(1):E=A/(2*Math.PI)*Math.asin(k/w),{a:w,c:k,p:A,s:E}}function t(w,k,A){return w.a*Math.pow(2,10*(k-=1))*Math.sin((k*A-w.s)*(2*Math.PI)/w.p)}function i(w,k,A,E){return A*((w=w/E-1)*w*w+1)+k}function o(w,k,A,E){return w/=E/2,w<1?A/2*w*w*w+k:A/2*((w-=2)*w*w+2)+k}function n(w,k,A,E){return A*(w/=E)*w*w*w+k}function s(w,k,A,E){return-A*((w=w/E-1)*w*w*w-1)+k}function r(w,k,A,E){return w/=E/2,w<1?A/2*w*w*w*w+k:-A/2*((w-=2)*w*w*w-2)+k}function a(w,k,A,E){return A*(w/=E)*w*w*w*w+k}function u(w,k,A,E){return A*((w=w/E-1)*w*w*w*w+1)+k}function l(w,k,A,E){return w/=E/2,w<1?A/2*w*w*w*w*w+k:A/2*((w-=2)*w*w*w*w+2)+k}function h(w,k,A,E){return-A*Math.cos(w/E*(Math.PI/2))+A+k}function f(w,k,A,E){return A*Math.sin(w/E*(Math.PI/2))+k}function g(w,k,A,E){return-A/2*(Math.cos(Math.PI*w/E)-1)+k}function p(w,k,A,E){return w===0?k:A*Math.pow(2,10*(w/E-1))+k}function v(w,k,A,E){return w===E?k+A:A*(-Math.pow(2,-10*w/E)+1)+k}function y(w,k,A,E){return w===0?k:w===E?k+A:(w/=E/2,w<1?A/2*Math.pow(2,10*(w-1))+k:A/2*(-Math.pow(2,-10*--w)+2)+k)}function _(w,k,A,E){return-A*(Math.sqrt(1-(w/=E)*w)-1)+k}function T(w,k,A,E){return A*Math.sqrt(1-(w=w/E-1)*w)+k}function P(w,k,A,E){return w/=E/2,w<1?-A/2*(Math.sqrt(1-w*w)-1)+k:A/2*(Math.sqrt(1-(w-=2)*w)+1)+k}function F(w,k,A,E){var W=1.70158,O=0,x=A;if(w===0)return k;if(w/=E,w===1)return k+A;O||(O=E*.3);var M=e(x,A,O,W);return-t(M,w,E)+k}function j(w,k,A,E){var W=1.70158,O=0,x=A;if(w===0)return k;if(w/=E,w===1)return k+A;O||(O=E*.3);var M=e(x,A,O,W);return M.a*Math.pow(2,-10*w)*Math.sin((w*E-M.s)*(2*Math.PI)/M.p)+M.c+k}function Z(w,k,A,E){var W=1.70158,O=0,x=A;if(w===0)return k;if(w/=E/2,w===2)return k+A;O||(O=E*(.3*1.5));var M=e(x,A,O,W);return w<1?-.5*t(M,w,E)+k:M.a*Math.pow(2,-10*(w-=1))*Math.sin((w*E-M.s)*(2*Math.PI)/M.p)*.5+M.c+k}function Q(w,k,A,E,W){return W===void 0&&(W=1.70158),A*(w/=E)*w*((W+1)*w-W)+k}function $(w,k,A,E,W){return W===void 0&&(W=1.70158),A*((w=w/E-1)*w*((W+1)*w+W)+1)+k}function tt(w,k,A,E,W){return W===void 0&&(W=1.70158),w/=E/2,w<1?A/2*(w*w*(((W*=1.525)+1)*w-W))+k:A/2*((w-=2)*w*(((W*=1.525)+1)*w+W)+2)+k}function rt(w,k,A,E){return A-ct(E-w,0,A,E)+k}function ct(w,k,A,E){return(w/=E)<1/2.75?A*(7.5625*w*w)+k:w<2/2.75?A*(7.5625*(w-=1.5/2.75)*w+.75)+k:w<2.5/2.75?A*(7.5625*(w-=2.25/2.75)*w+.9375)+k:A*(7.5625*(w-=2.625/2.75)*w+.984375)+k}function lt(w,k,A,E){return w<E/2?rt(w*2,0,A,E)*.5+k:ct(w*2-E,0,A,E)*.5+A*.5+k}C.util.ease={easeInQuad:function(w,k,A,E){return A*(w/=E)*w+k},easeOutQuad:function(w,k,A,E){return-A*(w/=E)*(w-2)+k},easeInOutQuad:function(w,k,A,E){return w/=E/2,w<1?A/2*w*w+k:-A/2*(--w*(w-2)-1)+k},easeInCubic:function(w,k,A,E){return A*(w/=E)*w*w+k},easeOutCubic:i,easeInOutCubic:o,easeInQuart:n,easeOutQuart:s,easeInOutQuart:r,easeInQuint:a,easeOutQuint:u,easeInOutQuint:l,easeInSine:h,easeOutSine:f,easeInOutSine:g,easeInExpo:p,easeOutExpo:v,easeInOutExpo:y,easeInCirc:_,easeOutCirc:T,easeInOutCirc:P,easeInElastic:F,easeOutElastic:j,easeInOutElastic:Z,easeInBack:Q,easeOutBack:$,easeInOutBack:tt,easeInBounce:rt,easeOutBounce:ct,easeInOutBounce:lt}})();(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.object.clone,n=t.util.toFixed,s=t.util.parseUnit,r=t.util.multiplyTransformMatrices,a=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],u=["symbol","image","marker","pattern","view","svg"],l=["pattern","defs","symbol","metadata","clipPath","mask","desc"],h=["symbol","g","a","svg","clipPath","defs"],f={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},g={stroke:"strokeOpacity",fill:"fillOpacity"},p="font-size",v="clip-path";t.svgValidTagNamesRegEx=T(a),t.svgViewBoxElementsRegEx=T(u),t.svgInvalidAncestorsRegEx=T(l),t.svgValidParentsRegEx=T(h),t.cssRules={},t.gradientDefs={},t.clipPaths={};function y(O){return O in f?f[O]:O}function _(O,x,M,R){var z=Array.isArray(x),N;if((O==="fill"||O==="stroke")&&x==="none")x="";else{if(O==="strokeUniform")return x==="non-scaling-stroke";if(O==="strokeDashArray")x==="none"?x=null:x=x.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(O==="transformMatrix")M&&M.transformMatrix?x=r(M.transformMatrix,t.parseTransformAttribute(x)):x=t.parseTransformAttribute(x);else if(O==="visible")x=x!=="none"&&x!=="hidden",M&&M.visible===!1&&(x=!1);else if(O==="opacity")x=parseFloat(x),M&&typeof M.opacity<"u"&&(x*=M.opacity);else if(O==="textAnchor")x=x==="start"?"left":x==="end"?"right":"center";else if(O==="charSpacing")N=s(x,R)/R*1e3;else if(O==="paintFirst"){var q=x.indexOf("fill"),et=x.indexOf("stroke"),x="fill";(q>-1&&et>-1&&et<q||q===-1&&et>-1)&&(x="stroke")}else{if(O==="href"||O==="xlink:href"||O==="font")return x;if(O==="imageSmoothing")return x==="optimizeQuality";N=z?x.map(s):s(x,R)}}return!z&&isNaN(N)?x:N}function T(O){return new RegExp("^("+O.join("|")+")\\b","i")}function P(O){for(var x in g)if(!(typeof O[g[x]]>"u"||O[x]==="")){if(typeof O[x]>"u"){if(!t.Object.prototype[x])continue;O[x]=t.Object.prototype[x]}if(O[x].indexOf("url(")!==0){var M=new t.Color(O[x]);O[x]=M.setAlpha(n(M.getAlpha()*O[g[x]],2)).toRgba()}}return O}function F(O,x){var M,R=[],z,N,q;for(N=0,q=x.length;N<q;N++)M=x[N],z=O.getElementsByTagName(M),R=R.concat(Array.prototype.slice.call(z));return R}t.parseTransformAttribute=function(){function O(U,pt){var _t=t.util.cos(pt[0]),St=t.util.sin(pt[0]),Ot=0,Tt=0;pt.length===3&&(Ot=pt[1],Tt=pt[2]),U[0]=_t,U[1]=St,U[2]=-St,U[3]=_t,U[4]=Ot-(_t*Ot-St*Tt),U[5]=Tt-(St*Ot+_t*Tt)}function x(U,pt){var _t=pt[0],St=pt.length===2?pt[1]:pt[0];U[0]=_t,U[3]=St}function M(U,pt,_t){U[_t]=Math.tan(t.util.degreesToRadians(pt[0]))}function R(U,pt){U[4]=pt[0],pt.length===2&&(U[5]=pt[1])}var z=t.iMatrix,N=t.reNum,q=t.commaWsp,et="(?:(skewX)\\s*\\(\\s*("+N+")\\s*\\))",ot="(?:(skewY)\\s*\\(\\s*("+N+")\\s*\\))",X="(?:(rotate)\\s*\\(\\s*("+N+")(?:"+q+"("+N+")"+q+"("+N+"))?\\s*\\))",I="(?:(scale)\\s*\\(\\s*("+N+")(?:"+q+"("+N+"))?\\s*\\))",G="(?:(translate)\\s*\\(\\s*("+N+")(?:"+q+"("+N+"))?\\s*\\))",V="(?:(matrix)\\s*\\(\\s*("+N+")"+q+"("+N+")"+q+"("+N+")"+q+"("+N+")"+q+"("+N+")"+q+"("+N+")\\s*\\))",Y="(?:"+V+"|"+G+"|"+I+"|"+X+"|"+et+"|"+ot+")",K="(?:"+Y+"(?:"+q+"*"+Y+")*)",st="^\\s*(?:"+K+"?)\\s*$",yt=new RegExp(st),dt=new RegExp(Y,"g");return function(U){var pt=z.concat(),_t=[];if(!U||U&&!yt.test(U))return pt;U.replace(dt,function(Ot){var Tt=new RegExp(Y).exec(Ot).filter(function(ae){return!!ae}),Wt=Tt[1],Ft=Tt.slice(2).map(parseFloat);switch(Wt){case"translate":R(pt,Ft);break;case"rotate":Ft[0]=t.util.degreesToRadians(Ft[0]),O(pt,Ft);break;case"scale":x(pt,Ft);break;case"skewX":M(pt,Ft,2);break;case"skewY":M(pt,Ft,1);break;case"matrix":pt=Ft;break}_t.push(pt.concat()),pt=z.concat()});for(var St=_t[0];_t.length>1;)_t.shift(),St=t.util.multiplyTransformMatrices(St,_t[0]);return St}}();function j(O,x){var M,R;O.replace(/;\s*$/,"").split(";").forEach(function(z){var N=z.split(":");M=N[0].trim().toLowerCase(),R=N[1].trim(),x[M]=R})}function Z(O,x){var M,R;for(var z in O)typeof O[z]>"u"||(M=z.toLowerCase(),R=O[z],x[M]=R)}function Q(O,x){var M={};for(var R in t.cssRules[x])if($(O,R.split(" ")))for(var z in t.cssRules[x][R])M[z]=t.cssRules[x][R][z];return M}function $(O,x){var M,R=!0;return M=rt(O,x.pop()),M&&x.length&&(R=tt(O,x)),M&&R&&x.length===0}function tt(O,x){for(var M,R=!0;O.parentNode&&O.parentNode.nodeType===1&&x.length;)R&&(M=x.pop()),O=O.parentNode,R=rt(O,M);return x.length===0}function rt(O,x){var M=O.nodeName,R=O.getAttribute("class"),z=O.getAttribute("id"),N,q;if(N=new RegExp("^"+M,"i"),x=x.replace(N,""),z&&x.length&&(N=new RegExp("#"+z+"(?![a-zA-Z\\-]+)","i"),x=x.replace(N,"")),R&&x.length)for(R=R.split(" "),q=R.length;q--;)N=new RegExp("\\."+R[q]+"(?![a-zA-Z\\-]+)","i"),x=x.replace(N,"");return x.length===0}function ct(O,x){var M;if(O.getElementById&&(M=O.getElementById(x)),M)return M;var R,z,N,q=O.getElementsByTagName("*");for(z=0,N=q.length;z<N;z++)if(R=q[z],x===R.getAttribute("id"))return R}function lt(O){for(var x=F(O,["use","svg:use"]),M=0;x.length&&M<x.length;){var R=x[M],z=R.getAttribute("xlink:href")||R.getAttribute("href");if(z===null)return;var N=z.slice(1),q=R.getAttribute("x")||0,et=R.getAttribute("y")||0,ot=ct(O,N).cloneNode(!0),X=(ot.getAttribute("transform")||"")+" translate("+q+", "+et+")",I,G=x.length,V,Y,K,st,yt=t.svgNS;if(k(ot),/^svg$/i.test(ot.nodeName)){var dt=ot.ownerDocument.createElementNS(yt,"g");for(Y=0,K=ot.attributes,st=K.length;Y<st;Y++)V=K.item(Y),dt.setAttributeNS(yt,V.nodeName,V.nodeValue);for(;ot.firstChild;)dt.appendChild(ot.firstChild);ot=dt}for(Y=0,K=R.attributes,st=K.length;Y<st;Y++)V=K.item(Y),!(V.nodeName==="x"||V.nodeName==="y"||V.nodeName==="xlink:href"||V.nodeName==="href")&&(V.nodeName==="transform"?X=V.nodeValue+" "+X:ot.setAttribute(V.nodeName,V.nodeValue));ot.setAttribute("transform",X),ot.setAttribute("instantiated_by_use","1"),ot.removeAttribute("id"),I=R.parentNode,I.replaceChild(ot,R),x.length===G&&M++}}var w=new RegExp("^\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*$");function k(O){if(!t.svgViewBoxElementsRegEx.test(O.nodeName))return{};var x=O.getAttribute("viewBox"),M=1,R=1,z=0,N=0,q,et,ot,X,I=O.getAttribute("width"),G=O.getAttribute("height"),V=O.getAttribute("x")||0,Y=O.getAttribute("y")||0,K=O.getAttribute("preserveAspectRatio")||"",st=!x||!(x=x.match(w)),yt=!I||!G||I==="100%"||G==="100%",dt=st&&yt,U={},pt="",_t=0,St=0;if(U.width=0,U.height=0,U.toBeParsed=dt,st&&(V||Y)&&O.parentNode&&O.parentNode.nodeName!=="#document"&&(pt=" translate("+s(V)+" "+s(Y)+") ",ot=(O.getAttribute("transform")||"")+pt,O.setAttribute("transform",ot),O.removeAttribute("x"),O.removeAttribute("y")),dt)return U;if(st)return U.width=s(I),U.height=s(G),U;if(z=-parseFloat(x[1]),N=-parseFloat(x[2]),q=parseFloat(x[3]),et=parseFloat(x[4]),U.minX=z,U.minY=N,U.viewBoxWidth=q,U.viewBoxHeight=et,yt?(U.width=q,U.height=et):(U.width=s(I),U.height=s(G),M=U.width/q,R=U.height/et),K=t.util.parsePreserveAspectRatioAttribute(K),K.alignX!=="none"&&(K.meetOrSlice==="meet"&&(R=M=M>R?R:M),K.meetOrSlice==="slice"&&(R=M=M>R?M:R),_t=U.width-q*M,St=U.height-et*M,K.alignX==="Mid"&&(_t/=2),K.alignY==="Mid"&&(St/=2),K.alignX==="Min"&&(_t=0),K.alignY==="Min"&&(St=0)),M===1&&R===1&&z===0&&N===0&&V===0&&Y===0)return U;if((V||Y)&&O.parentNode.nodeName!=="#document"&&(pt=" translate("+s(V)+" "+s(Y)+") "),ot=pt+" matrix("+M+" 0 0 "+R+" "+(z*M+_t)+" "+(N*R+St)+") ",O.nodeName==="svg"){for(X=O.ownerDocument.createElementNS(t.svgNS,"g");O.firstChild;)X.appendChild(O.firstChild);O.appendChild(X)}else X=O,X.removeAttribute("x"),X.removeAttribute("y"),ot=X.getAttribute("transform")+ot;return X.setAttribute("transform",ot),U}function A(O,x){for(;O&&(O=O.parentNode);)if(O.nodeName&&x.test(O.nodeName.replace("svg:",""))&&!O.getAttribute("instantiated_by_use"))return!0;return!1}t.parseSVGDocument=function(O,x,M,R){if(O){lt(O);var z=t.Object.__uid++,N,q,et=k(O),ot=t.util.toArray(O.getElementsByTagName("*"));if(et.crossOrigin=R&&R.crossOrigin,et.svgUid=z,ot.length===0&&t.isLikelyNode){ot=O.selectNodes('//*[name(.)!="svg"]');var X=[];for(N=0,q=ot.length;N<q;N++)X[N]=ot[N];ot=X}var I=ot.filter(function(V){return k(V),t.svgValidTagNamesRegEx.test(V.nodeName.replace("svg:",""))&&!A(V,t.svgInvalidAncestorsRegEx)});if(!I||I&&!I.length){x&&x([],{});return}var G={};ot.filter(function(V){return V.nodeName.replace("svg:","")==="clipPath"}).forEach(function(V){var Y=V.getAttribute("id");G[Y]=t.util.toArray(V.getElementsByTagName("*")).filter(function(K){return t.svgValidTagNamesRegEx.test(K.nodeName.replace("svg:",""))})}),t.gradientDefs[z]=t.getGradientDefs(O),t.cssRules[z]=t.getCSSRules(O),t.clipPaths[z]=G,t.parseElements(I,function(V,Y){x&&(x(V,et,Y,ot),delete t.gradientDefs[z],delete t.cssRules[z],delete t.clipPaths[z])},o(et),M,R)}};function E(O,x){var M=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],R="xlink:href",z=x.getAttribute(R).slice(1),N=ct(O,z);if(N&&N.getAttribute(R)&&E(O,N),M.forEach(function(et){N&&!x.hasAttribute(et)&&N.hasAttribute(et)&&x.setAttribute(et,N.getAttribute(et))}),!x.children.length)for(var q=N.cloneNode(!0);q.firstChild;)x.appendChild(q.firstChild);x.removeAttribute(R)}var W=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+t.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+t.reNum+"))?\\s+(.*)");i(t,{parseFontDeclaration:function(O,x){var M=O.match(W);if(M){var R=M[1],z=M[3],N=M[4],q=M[5],et=M[6];R&&(x.fontStyle=R),z&&(x.fontWeight=isNaN(parseFloat(z))?z:parseFloat(z)),N&&(x.fontSize=s(N)),et&&(x.fontFamily=et),q&&(x.lineHeight=q==="normal"?1:q)}},getGradientDefs:function(O){var x=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],M=F(O,x),R,z=0,N={};for(z=M.length;z--;)R=M[z],R.getAttribute("xlink:href")&&E(O,R),N[R.getAttribute("id")]=R;return N},parseAttributes:function(O,x,M){if(O){var R,z={},N,q;typeof M>"u"&&(M=O.getAttribute("svgUid")),O.parentNode&&t.svgValidParentsRegEx.test(O.parentNode.nodeName)&&(z=t.parseAttributes(O.parentNode,x,M));var et=x.reduce(function(K,st){return R=O.getAttribute(st),R&&(K[st]=R),K},{}),ot=i(Q(O,M),t.parseStyleAttribute(O));et=i(et,ot),ot[v]&&O.setAttribute(v,ot[v]),N=q=z.fontSize||t.Text.DEFAULT_SVG_FONT_SIZE,et[p]&&(et[p]=N=s(et[p],q));var X,I,G={};for(var V in et)X=y(V),I=_(X,et[V],z,N),G[X]=I;G&&G.font&&t.parseFontDeclaration(G.font,G);var Y=i(z,G);return t.svgValidParentsRegEx.test(O.nodeName)?Y:P(Y)}},parseElements:function(O,x,M,R,z){new t.ElementsParser(O,x,M,R,z).parse()},parseStyleAttribute:function(O){var x={},M=O.getAttribute("style");return M&&(typeof M=="string"?j(M,x):Z(M,x)),x},parsePointsAttribute:function(O){if(!O)return null;O=O.replace(/,/g," ").trim(),O=O.split(/\s+/);var x=[],M,R;for(M=0,R=O.length;M<R;M+=2)x.push({x:parseFloat(O[M]),y:parseFloat(O[M+1])});return x},getCSSRules:function(O){var x=O.getElementsByTagName("style"),M,R,z={},N;for(M=0,R=x.length;M<R;M++){var q=x[M].textContent;q=q.replace(/\/\*[\s\S]*?\*\//g,""),q.trim()!==""&&(N=q.split("}"),N=N.filter(function(et){return et.trim()}),N.forEach(function(et){var ot=et.split("{"),X={},I=ot[1].trim(),G=I.split(";").filter(function(st){return st.trim()});for(M=0,R=G.length;M<R;M++){var V=G[M].split(":"),Y=V[0].trim(),K=V[1].trim();X[Y]=K}et=ot[0].trim(),et.split(",").forEach(function(st){st=st.replace(/^svg/i,"").trim(),st!==""&&(z[st]?t.util.object.extend(z[st],X):z[st]=t.util.object.clone(X))})}))}return z},loadSVGFromURL:function(O,x,M,R){O=O.replace(/^\n\s*/,"").trim(),new t.util.request(O,{method:"get",onComplete:z});function z(N){var q=N.responseXML;if(!q||!q.documentElement)return x&&x(null),!1;t.parseSVGDocument(q.documentElement,function(et,ot,X,I){x&&x(et,ot,X,I)},M,R)}},loadSVGFromString:function(O,x,M,R){var z=new t.window.DOMParser,N=z.parseFromString(O.trim(),"text/xml");t.parseSVGDocument(N.documentElement,function(q,et,ot,X){x(q,et,ot,X)},M,R)}})})(ut);C.ElementsParser=function(e,t,i,o,n,s){this.elements=e,this.callback=t,this.options=i,this.reviver=o,this.svgUid=i&&i.svgUid||0,this.parsingOptions=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=s};(function(e){e.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},e.createObjects=function(){var t=this;this.elements.forEach(function(i,o){i.setAttribute("svgUid",t.svgUid),t.createObject(i,o)})},e.findTag=function(t){return C[C.util.string.capitalize(t.tagName.replace("svg:",""))]},e.createObject=function(t,i){var o=this.findTag(t);if(o&&o.fromElement)try{o.fromElement(t,this.createCallback(i,t),this.options)}catch(n){C.log(n)}else this.checkIfDone()},e.createCallback=function(t,i){var o=this;return function(n){var s;o.resolveGradient(n,i,"fill"),o.resolveGradient(n,i,"stroke"),n instanceof C.Image&&n._originalElement&&(s=n.parsePreserveAspectRatioAttribute(i)),n._removeTransformMatrix(s),o.resolveClipPath(n,i),o.reviver&&o.reviver(i,n),o.instances[t]=n,o.checkIfDone()}},e.extractPropertyDefinition=function(t,i,o){var n=t[i],s=this.regexUrl;if(s.test(n)){s.lastIndex=0;var r=s.exec(n)[1];return s.lastIndex=0,C[o][this.svgUid][r]}},e.resolveGradient=function(t,i,o){var n=this.extractPropertyDefinition(t,o,"gradientDefs");if(n){var s=i.getAttribute(o+"-opacity"),r=C.Gradient.fromElement(n,t,s,this.options);t.set(o,r)}},e.createClipPathCallback=function(t,i){return function(o){o._removeTransformMatrix(),o.fillRule=o.clipRule,i.push(o)}},e.resolveClipPath=function(t,i){var o=this.extractPropertyDefinition(t,"clipPath","clipPaths"),n,s,r,a,u,l;if(o){a=[],r=C.util.invertTransform(t.calcTransformMatrix());for(var h=o[0].parentNode,f=i;f.parentNode&&f.getAttribute("clip-path")!==t.clipPath;)f=f.parentNode;f.parentNode.appendChild(h);for(var g=0;g<o.length;g++)n=o[g],s=this.findTag(n),s.fromElement(n,this.createClipPathCallback(t,a),this.options);a.length===1?o=a[0]:o=new C.Group(a),u=C.util.multiplyTransformMatrices(r,o.calcTransformMatrix()),o.clipPath&&this.resolveClipPath(o,f);var l=C.util.qrDecompose(u);o.flipX=!1,o.flipY=!1,o.set("scaleX",l.scaleX),o.set("scaleY",l.scaleY),o.angle=l.angle,o.skewX=l.skewX,o.skewY=0,o.setPositionByOrigin({x:l.translateX,y:l.translateY},"center","center"),t.clipPath=o}else delete t.clipPath},e.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(t){return t!=null}),this.callback(this.instances,this.elements))}})(C.ElementsParser.prototype);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Point){t.warn("fabric.Point is already defined");return}t.Point=i;function i(o,n){this.x=o,this.y=n}i.prototype={type:"point",constructor:i,add:function(o){return new i(this.x+o.x,this.y+o.y)},addEquals:function(o){return this.x+=o.x,this.y+=o.y,this},scalarAdd:function(o){return new i(this.x+o,this.y+o)},scalarAddEquals:function(o){return this.x+=o,this.y+=o,this},subtract:function(o){return new i(this.x-o.x,this.y-o.y)},subtractEquals:function(o){return this.x-=o.x,this.y-=o.y,this},scalarSubtract:function(o){return new i(this.x-o,this.y-o)},scalarSubtractEquals:function(o){return this.x-=o,this.y-=o,this},multiply:function(o){return new i(this.x*o,this.y*o)},multiplyEquals:function(o){return this.x*=o,this.y*=o,this},divide:function(o){return new i(this.x/o,this.y/o)},divideEquals:function(o){return this.x/=o,this.y/=o,this},eq:function(o){return this.x===o.x&&this.y===o.y},lt:function(o){return this.x<o.x&&this.y<o.y},lte:function(o){return this.x<=o.x&&this.y<=o.y},gt:function(o){return this.x>o.x&&this.y>o.y},gte:function(o){return this.x>=o.x&&this.y>=o.y},lerp:function(o,n){return typeof n>"u"&&(n=.5),n=Math.max(Math.min(1,n),0),new i(this.x+(o.x-this.x)*n,this.y+(o.y-this.y)*n)},distanceFrom:function(o){var n=this.x-o.x,s=this.y-o.y;return Math.sqrt(n*n+s*s)},midPointFrom:function(o){return this.lerp(o)},min:function(o){return new i(Math.min(this.x,o.x),Math.min(this.y,o.y))},max:function(o){return new i(Math.max(this.x,o.x),Math.max(this.y,o.y))},toString:function(){return this.x+","+this.y},setXY:function(o,n){return this.x=o,this.y=n,this},setX:function(o){return this.x=o,this},setY:function(o){return this.y=o,this},setFromPoint:function(o){return this.x=o.x,this.y=o.y,this},swap:function(o){var n=this.x,s=this.y;this.x=o.x,this.y=o.y,o.x=n,o.y=s},clone:function(){return new i(this.x,this.y)}}})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Intersection){t.warn("fabric.Intersection is already defined");return}function i(o){this.status=o,this.points=[]}t.Intersection=i,t.Intersection.prototype={constructor:i,appendPoint:function(o){return this.points.push(o),this},appendPoints:function(o){return this.points=this.points.concat(o),this}},t.Intersection.intersectLineLine=function(o,n,s,r){var a,u=(r.x-s.x)*(o.y-s.y)-(r.y-s.y)*(o.x-s.x),l=(n.x-o.x)*(o.y-s.y)-(n.y-o.y)*(o.x-s.x),h=(r.y-s.y)*(n.x-o.x)-(r.x-s.x)*(n.y-o.y);if(h!==0){var f=u/h,g=l/h;0<=f&&f<=1&&0<=g&&g<=1?(a=new i("Intersection"),a.appendPoint(new t.Point(o.x+f*(n.x-o.x),o.y+f*(n.y-o.y)))):a=new i}else u===0||l===0?a=new i("Coincident"):a=new i("Parallel");return a},t.Intersection.intersectLinePolygon=function(o,n,s){var r=new i,a=s.length,u,l,h,f;for(f=0;f<a;f++)u=s[f],l=s[(f+1)%a],h=i.intersectLineLine(o,n,u,l),r.appendPoints(h.points);return r.points.length>0&&(r.status="Intersection"),r},t.Intersection.intersectPolygonPolygon=function(o,n){var s=new i,r=o.length,a;for(a=0;a<r;a++){var u=o[a],l=o[(a+1)%r],h=i.intersectLinePolygon(u,l,n);s.appendPoints(h.points)}return s.points.length>0&&(s.status="Intersection"),s},t.Intersection.intersectPolygonRectangle=function(o,n,s){var r=n.min(s),a=n.max(s),u=new t.Point(a.x,r.y),l=new t.Point(r.x,a.y),h=i.intersectLinePolygon(r,u,o),f=i.intersectLinePolygon(u,a,o),g=i.intersectLinePolygon(a,l,o),p=i.intersectLinePolygon(l,r,o),v=new i;return v.appendPoints(h.points),v.appendPoints(f.points),v.appendPoints(g.points),v.appendPoints(p.points),v.points.length>0&&(v.status="Intersection"),v}})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Color){t.warn("fabric.Color is already defined.");return}function i(n){n?this._tryParsingColor(n):this.setSource([0,0,0,1])}t.Color=i,t.Color.prototype={_tryParsingColor:function(n){var s;n in i.colorNameMap&&(n=i.colorNameMap[n]),n==="transparent"&&(s=[255,255,255,0]),s||(s=i.sourceFromHex(n)),s||(s=i.sourceFromRgb(n)),s||(s=i.sourceFromHsl(n)),s||(s=[0,0,0,1]),s&&this.setSource(s)},_rgbToHsl:function(n,s,r){n/=255,s/=255,r/=255;var a,u,l,h=t.util.array.max([n,s,r]),f=t.util.array.min([n,s,r]);if(l=(h+f)/2,h===f)a=u=0;else{var g=h-f;switch(u=l>.5?g/(2-h-f):g/(h+f),h){case n:a=(s-r)/g+(s<r?6:0);break;case s:a=(r-n)/g+2;break;case r:a=(n-s)/g+4;break}a/=6}return[Math.round(a*360),Math.round(u*100),Math.round(l*100)]},getSource:function(){return this._source},setSource:function(n){this._source=n},toRgb:function(){var n=this.getSource();return"rgb("+n[0]+","+n[1]+","+n[2]+")"},toRgba:function(){var n=this.getSource();return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},toHsl:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsl("+s[0]+","+s[1]+"%,"+s[2]+"%)"},toHsla:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsla("+s[0]+","+s[1]+"%,"+s[2]+"%,"+n[3]+")"},toHex:function(){var n=this.getSource(),s,r,a;return s=n[0].toString(16),s=s.length===1?"0"+s:s,r=n[1].toString(16),r=r.length===1?"0"+r:r,a=n[2].toString(16),a=a.length===1?"0"+a:a,s.toUpperCase()+r.toUpperCase()+a.toUpperCase()},toHexa:function(){var n=this.getSource(),s;return s=Math.round(n[3]*255),s=s.toString(16),s=s.length===1?"0"+s:s,this.toHex()+s.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(n){var s=this.getSource();return s[3]=n,this.setSource(s),this},toGrayscale:function(){var n=this.getSource(),s=parseInt((n[0]*.3+n[1]*.59+n[2]*.11).toFixed(0),10),r=n[3];return this.setSource([s,s,s,r]),this},toBlackWhite:function(n){var s=this.getSource(),r=(s[0]*.3+s[1]*.59+s[2]*.11).toFixed(0),a=s[3];return n=n||127,r=Number(r)<Number(n)?0:255,this.setSource([r,r,r,a]),this},overlayWith:function(n){n instanceof i||(n=new i(n));var s=[],r=this.getAlpha(),a=.5,u=this.getSource(),l=n.getSource(),h;for(h=0;h<3;h++)s.push(Math.round(u[h]*(1-a)+l[h]*a));return s[3]=r,this.setSource(s),this}},t.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,t.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,t.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,t.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function o(n,s,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?n+(s-n)*6*r:r<1/2?s:r<2/3?n+(s-n)*(2/3-r)*6:n}t.Color.fromRgb=function(n){return i.fromSource(i.sourceFromRgb(n))},t.Color.sourceFromRgb=function(n){var s=n.match(i.reRGBa);if(s){var r=parseInt(s[1],10)/(/%$/.test(s[1])?100:1)*(/%$/.test(s[1])?255:1),a=parseInt(s[2],10)/(/%$/.test(s[2])?100:1)*(/%$/.test(s[2])?255:1),u=parseInt(s[3],10)/(/%$/.test(s[3])?100:1)*(/%$/.test(s[3])?255:1);return[parseInt(r,10),parseInt(a,10),parseInt(u,10),s[4]?parseFloat(s[4]):1]}},t.Color.fromRgba=i.fromRgb,t.Color.fromHsl=function(n){return i.fromSource(i.sourceFromHsl(n))},t.Color.sourceFromHsl=function(n){var s=n.match(i.reHSLa);if(s){var r=(parseFloat(s[1])%360+360)%360/360,a=parseFloat(s[2])/(/%$/.test(s[2])?100:1),u=parseFloat(s[3])/(/%$/.test(s[3])?100:1),l,h,f;if(a===0)l=h=f=u;else{var g=u<=.5?u*(a+1):u+a-u*a,p=u*2-g;l=o(p,g,r+1/3),h=o(p,g,r),f=o(p,g,r-1/3)}return[Math.round(l*255),Math.round(h*255),Math.round(f*255),s[4]?parseFloat(s[4]):1]}},t.Color.fromHsla=i.fromHsl,t.Color.fromHex=function(n){return i.fromSource(i.sourceFromHex(n))},t.Color.sourceFromHex=function(n){if(n.match(i.reHex)){var s=n.slice(n.indexOf("#")+1),r=s.length===3||s.length===4,a=s.length===8||s.length===4,u=r?s.charAt(0)+s.charAt(0):s.substring(0,2),l=r?s.charAt(1)+s.charAt(1):s.substring(2,4),h=r?s.charAt(2)+s.charAt(2):s.substring(4,6),f=a?r?s.charAt(3)+s.charAt(3):s.substring(6,8):"FF";return[parseInt(u,16),parseInt(l,16),parseInt(h,16),parseFloat((parseInt(f,16)/255).toFixed(2))]}},t.Color.fromSource=function(n){var s=new i;return s.setSource(n),s}})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=["e","se","s","sw","w","nw","n","ne","e"],o=["ns","nesw","ew","nwse"],n={},s="left",r="top",a="right",u="bottom",l="center",h={top:u,bottom:r,left:a,right:s,center:l},f=t.util.radiansToDegrees,g=Math.sign||function(X){return(X>0)-(X<0)||+X};function p(X,I){var G=X.angle+f(Math.atan2(I.y,I.x))+360;return Math.round(G%360/45)}function v(X,I){var G=I.transform.target,V=G.canvas,Y=t.util.object.clone(I);Y.target=G,V&&V.fire("object:"+X,Y),G.fire(X,I)}function y(X,I){var G=I.canvas,V=G.uniScaleKey,Y=X[V];return G.uniformScaling&&!Y||!G.uniformScaling&&Y}function _(X){return X.originX===l&&X.originY===l}function T(X,I,G){var V=X.lockScalingX,Y=X.lockScalingY;return!!(V&&Y||!I&&(V||Y)&&G||V&&I==="x"||Y&&I==="y")}function P(X,I,G){var V="not-allowed",Y=y(X,G),K="";if(I.x!==0&&I.y===0?K="x":I.x===0&&I.y!==0&&(K="y"),T(G,K,Y))return V;var st=p(G,I);return i[st]+"-resize"}function F(X,I,G){var V="not-allowed";if(I.x!==0&&G.lockSkewingY||I.y!==0&&G.lockSkewingX)return V;var Y=p(G,I)%4;return o[Y]+"-resize"}function j(X,I,G){return X[G.canvas.altActionKey]?n.skewCursorStyleHandler(X,I,G):n.scaleCursorStyleHandler(X,I,G)}function Z(X,I,G){var V=X[G.canvas.altActionKey];if(I.x===0)return V?"skewX":"scaleY";if(I.y===0)return V?"skewY":"scaleX"}function Q(X,I,G){return G.lockRotation?"not-allowed":I.cursorStyle}function $(X,I,G,V){return{e:X,transform:I,pointer:{x:G,y:V}}}function tt(X){return function(I,G,V,Y){var K=G.target,st=K.getCenterPoint(),yt=K.translateToOriginPoint(st,G.originX,G.originY),dt=X(I,G,V,Y);return K.setPositionByOrigin(yt,G.originX,G.originY),dt}}function rt(X,I){return function(G,V,Y,K){var st=I(G,V,Y,K);return st&&v(X,$(G,V,Y,K)),st}}function ct(X,I,G,V,Y){var K=X.target,st=K.controls[X.corner],yt=K.canvas.getZoom(),dt=K.padding/yt,U=K.toLocalPoint(new t.Point(V,Y),I,G);return U.x>=dt&&(U.x-=dt),U.x<=-dt&&(U.x+=dt),U.y>=dt&&(U.y-=dt),U.y<=dt&&(U.y+=dt),U.x-=st.offsetX,U.y-=st.offsetY,U}function lt(X){return X.flipX!==X.flipY}function w(X,I,G,V,Y){if(X[I]!==0){var K=X._getTransformedDimensions()[V],st=Y/K*X[G];X.set(G,st)}}function k(X,I,G,V){var Y=I.target,K=Y._getTransformedDimensions(0,Y.skewY),st=ct(I,I.originX,I.originY,G,V),yt=Math.abs(st.x*2)-K.x,dt=Y.skewX,U;yt<2?U=0:(U=f(Math.atan2(yt/Y.scaleX,K.y/Y.scaleY)),I.originX===s&&I.originY===u&&(U=-U),I.originX===a&&I.originY===r&&(U=-U),lt(Y)&&(U=-U));var pt=dt!==U;if(pt){var _t=Y._getTransformedDimensions().y;Y.set("skewX",U),w(Y,"skewY","scaleY","y",_t)}return pt}function A(X,I,G,V){var Y=I.target,K=Y._getTransformedDimensions(Y.skewX,0),st=ct(I,I.originX,I.originY,G,V),yt=Math.abs(st.y*2)-K.y,dt=Y.skewY,U;yt<2?U=0:(U=f(Math.atan2(yt/Y.scaleY,K.x/Y.scaleX)),I.originX===s&&I.originY===u&&(U=-U),I.originX===a&&I.originY===r&&(U=-U),lt(Y)&&(U=-U));var pt=dt!==U;if(pt){var _t=Y._getTransformedDimensions().x;Y.set("skewY",U),w(Y,"skewX","scaleX","x",_t)}return pt}function E(X,I,G,V){var Y=I.target,K=Y.skewX,st,yt=I.originY;if(Y.lockSkewingX)return!1;if(K===0){var dt=ct(I,l,l,G,V);dt.x>0?st=s:st=a}else K>0&&(st=yt===r?s:a),K<0&&(st=yt===r?a:s),lt(Y)&&(st=st===s?a:s);I.originX=st;var U=rt("skewing",tt(k));return U(X,I,G,V)}function W(X,I,G,V){var Y=I.target,K=Y.skewY,st,yt=I.originX;if(Y.lockSkewingY)return!1;if(K===0){var dt=ct(I,l,l,G,V);dt.y>0?st=r:st=u}else K>0&&(st=yt===s?r:u),K<0&&(st=yt===s?u:r),lt(Y)&&(st=st===r?u:r);I.originY=st;var U=rt("skewing",tt(A));return U(X,I,G,V)}function O(X,I,G,V){var Y=I,K=Y.target,st=K.translateToOriginPoint(K.getCenterPoint(),Y.originX,Y.originY);if(K.lockRotation)return!1;var yt=Math.atan2(Y.ey-st.y,Y.ex-st.x),dt=Math.atan2(V-st.y,G-st.x),U=f(dt-yt+Y.theta),pt=!0;if(K.snapAngle>0){var _t=K.snapAngle,St=K.snapThreshold||_t,Ot=Math.ceil(U/_t)*_t,Tt=Math.floor(U/_t)*_t;Math.abs(U-Tt)<St?U=Tt:Math.abs(U-Ot)<St&&(U=Ot)}return U<0&&(U=360+U),U%=360,pt=K.angle!==U,K.angle=U,pt}function x(X,I,G,V,Y){Y=Y||{};var K=I.target,st=K.lockScalingX,yt=K.lockScalingY,dt=Y.by,U,pt,_t,St,Ot=y(X,K),Tt=T(K,dt,Ot),Wt,Ft,ae=I.gestureScale;if(Tt)return!1;if(ae)pt=I.scaleX*ae,_t=I.scaleY*ae;else{if(U=ct(I,I.originX,I.originY,G,V),Wt=dt!=="y"?g(U.x):1,Ft=dt!=="x"?g(U.y):1,I.signX||(I.signX=Wt),I.signY||(I.signY=Ft),K.lockScalingFlip&&(I.signX!==Wt||I.signY!==Ft))return!1;if(St=K._getTransformedDimensions(),Ot&&!dt){var ze=Math.abs(U.x)+Math.abs(U.y),qt=I.original,Si=Math.abs(St.x*qt.scaleX/K.scaleX)+Math.abs(St.y*qt.scaleY/K.scaleY),Fi=ze/Si;pt=qt.scaleX*Fi,_t=qt.scaleY*Fi}else pt=Math.abs(U.x*K.scaleX/St.x),_t=Math.abs(U.y*K.scaleY/St.y);_(I)&&(pt*=2,_t*=2),I.signX!==Wt&&dt!=="y"&&(I.originX=h[I.originX],pt*=-1,I.signX=Wt),I.signY!==Ft&&dt!=="x"&&(I.originY=h[I.originY],_t*=-1,I.signY=Ft)}var Pn=K.scaleX,kn=K.scaleY;return dt?(dt==="x"&&K.set("scaleX",pt),dt==="y"&&K.set("scaleY",_t)):(!st&&K.set("scaleX",pt),!yt&&K.set("scaleY",_t)),Pn!==K.scaleX||kn!==K.scaleY}function M(X,I,G,V){return x(X,I,G,V)}function R(X,I,G,V){return x(X,I,G,V,{by:"x"})}function z(X,I,G,V){return x(X,I,G,V,{by:"y"})}function N(X,I,G,V){return X[I.target.canvas.altActionKey]?n.skewHandlerX(X,I,G,V):n.scalingY(X,I,G,V)}function q(X,I,G,V){return X[I.target.canvas.altActionKey]?n.skewHandlerY(X,I,G,V):n.scalingX(X,I,G,V)}function et(X,I,G,V){var Y=I.target,K=ct(I,I.originX,I.originY,G,V),st=Y.strokeWidth/(Y.strokeUniform?Y.scaleX:1),yt=_(I)?2:1,dt=Y.width,U=Math.abs(K.x*yt/Y.scaleX)-st;return Y.set("width",Math.max(U,0)),dt!==U}function ot(X,I,G,V){var Y=I.target,K=G-I.offsetX,st=V-I.offsetY,yt=!Y.get("lockMovementX")&&Y.left!==K,dt=!Y.get("lockMovementY")&&Y.top!==st;return yt&&Y.set("left",K),dt&&Y.set("top",st),(yt||dt)&&v("moving",$(X,I,G,V)),yt||dt}n.scaleCursorStyleHandler=P,n.skewCursorStyleHandler=F,n.scaleSkewCursorStyleHandler=j,n.rotationWithSnapping=rt("rotating",tt(O)),n.scalingEqually=rt("scaling",tt(M)),n.scalingX=rt("scaling",tt(R)),n.scalingY=rt("scaling",tt(z)),n.scalingYOrSkewingX=N,n.scalingXOrSkewingY=q,n.changeWidth=rt("resizing",tt(et)),n.skewHandlerX=E,n.skewHandlerY=W,n.dragHandler=ot,n.scaleOrSkewActionName=Z,n.rotationStyleHandler=Q,n.fireEvent=v,n.wrapWithFixedAnchor=tt,n.wrapWithFireEvent=rt,n.getLocalPoint=ct,t.controlsUtils=n})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.degreesToRadians,o=t.controlsUtils;function n(r,a,u,l,h){l=l||{};var f=this.sizeX||l.cornerSize||h.cornerSize,g=this.sizeY||l.cornerSize||h.cornerSize,p=typeof l.transparentCorners<"u"?l.transparentCorners:h.transparentCorners,v=p?"stroke":"fill",y=!p&&(l.cornerStrokeColor||h.cornerStrokeColor),_=a,T=u,P;r.save(),r.fillStyle=l.cornerColor||h.cornerColor,r.strokeStyle=l.cornerStrokeColor||h.cornerStrokeColor,f>g?(P=f,r.scale(1,g/f),T=u*f/g):g>f?(P=g,r.scale(f/g,1),_=a*g/f):P=f,r.lineWidth=1,r.beginPath(),r.arc(_,T,P/2,0,2*Math.PI,!1),r[v](),y&&r.stroke(),r.restore()}function s(r,a,u,l,h){l=l||{};var f=this.sizeX||l.cornerSize||h.cornerSize,g=this.sizeY||l.cornerSize||h.cornerSize,p=typeof l.transparentCorners<"u"?l.transparentCorners:h.transparentCorners,v=p?"stroke":"fill",y=!p&&(l.cornerStrokeColor||h.cornerStrokeColor),_=f/2,T=g/2;r.save(),r.fillStyle=l.cornerColor||h.cornerColor,r.strokeStyle=l.cornerStrokeColor||h.cornerStrokeColor,r.lineWidth=1,r.translate(a,u),r.rotate(i(h.angle)),r[v+"Rect"](-_,-T,f,g),y&&r.strokeRect(-_,-T,f,g),r.restore()}o.renderCircleControl=n,o.renderSquareControl=s})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={});function i(o){for(var n in o)this[n]=o[n]}t.Control=i,t.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(o,n){return n.cursorStyle},getActionName:function(o,n){return n.actionName},getVisibility:function(o,n){var s=o._controlsVisibility;return s&&typeof s[n]<"u"?s[n]:this.visible},setVisibility:function(o){this.visible=o},positionHandler:function(o,n){var s=t.util.transformPoint({x:this.x*o.x+this.offsetX,y:this.y*o.y+this.offsetY},n);return s},calcCornerCoords:function(o,n,s,r,a){var u,l,h,f,g=a?this.touchSizeX:this.sizeX,p=a?this.touchSizeY:this.sizeY;if(g&&p&&g!==p){var v=Math.atan2(p,g),y=Math.sqrt(g*g+p*p)/2,_=v-t.util.degreesToRadians(o),T=Math.PI/2-v-t.util.degreesToRadians(o);u=y*t.util.cos(_),l=y*t.util.sin(_),h=y*t.util.cos(T),f=y*t.util.sin(T)}else{var P=g&&p?g:n;y=P*.7071067812;var _=t.util.degreesToRadians(45-o);u=h=y*t.util.cos(_),l=f=y*t.util.sin(_)}return{tl:{x:s-f,y:r-h},tr:{x:s+u,y:r-l},bl:{x:s-u,y:r+l},br:{x:s+f,y:r+h}}},render:function(o,n,s,r,a){switch(r=r||{},r.cornerStyle||a.cornerStyle){case"circle":t.controlsUtils.renderCircleControl.call(this,o,n,s,r,a);break;default:t.controlsUtils.renderSquareControl.call(this,o,n,s,r,a)}}}})(ut);(function(){function e(s,r){var a=s.getAttribute("style"),u=s.getAttribute("offset")||0,l,h,f,g;if(u=parseFloat(u)/(/%$/.test(u)?100:1),u=u<0?0:u>1?1:u,a){var p=a.split(/\s*;\s*/);for(p[p.length-1]===""&&p.pop(),g=p.length;g--;){var v=p[g].split(/\s*:\s*/),y=v[0].trim(),_=v[1].trim();y==="stop-color"?l=_:y==="stop-opacity"&&(f=_)}}return l||(l=s.getAttribute("stop-color")||"rgb(0,0,0)"),f||(f=s.getAttribute("stop-opacity")),l=new C.Color(l),h=l.getAlpha(),f=isNaN(parseFloat(f))?1:parseFloat(f),f*=h*r,{offset:u,color:l.toRgb(),opacity:f}}function t(s){return{x1:s.getAttribute("x1")||0,y1:s.getAttribute("y1")||0,x2:s.getAttribute("x2")||"100%",y2:s.getAttribute("y2")||0}}function i(s){return{x1:s.getAttribute("fx")||s.getAttribute("cx")||"50%",y1:s.getAttribute("fy")||s.getAttribute("cy")||"50%",r1:0,x2:s.getAttribute("cx")||"50%",y2:s.getAttribute("cy")||"50%",r2:s.getAttribute("r")||"50%"}}var o=C.util.object.clone;C.Gradient=C.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(s){s||(s={}),s.coords||(s.coords={});var r,a=this;Object.keys(s).forEach(function(u){a[u]=s[u]}),this.id?this.id+="_"+C.Object.__uid++:this.id=C.Object.__uid++,r={x1:s.coords.x1||0,y1:s.coords.y1||0,x2:s.coords.x2||0,y2:s.coords.y2||0},this.type==="radial"&&(r.r1=s.coords.r1||0,r.r2=s.coords.r2||0),this.coords=r,this.colorStops=s.colorStops.slice()},addColorStop:function(s){for(var r in s){var a=new C.Color(s[r]);this.colorStops.push({offset:parseFloat(r),color:a.toRgb(),opacity:a.getAlpha()})}return this},toObject:function(s){var r={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return C.util.populateWithProperties(this,r,s),r},toSVG:function(s,h){var a=o(this.coords,!0),u,l,h=h||{},f,g,p=o(this.colorStops,!0),v=a.r1>a.r2,y=this.gradientTransform?this.gradientTransform.concat():C.iMatrix.concat(),_=-this.offsetX,T=-this.offsetY,P=!!h.additionalTransform,F=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(p.sort(function(tt,rt){return tt.offset-rt.offset}),F==="objectBoundingBox"?(_/=s.width,T/=s.height):(_+=s.width/2,T+=s.height/2),s.type==="path"&&this.gradientUnits!=="percentage"&&(_-=s.pathOffset.x,T-=s.pathOffset.y),y[4]-=_,y[5]-=T,g='id="SVGID_'+this.id+'" gradientUnits="'+F+'"',g+=' gradientTransform="'+(P?h.additionalTransform+" ":"")+C.util.matrixToSVG(y)+'" ',this.type==="linear"?f=["<linearGradient ",g,' x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,`">
`]:this.type==="radial"&&(f=["<radialGradient ",g,' cx="',v?a.x1:a.x2,'" cy="',v?a.y1:a.y2,'" r="',v?a.r1:a.r2,'" fx="',v?a.x2:a.x1,'" fy="',v?a.y2:a.y1,`">
`]),this.type==="radial"){if(v)for(p=p.concat(),p.reverse(),u=0,l=p.length;u<l;u++)p[u].offset=1-p[u].offset;var j=Math.min(a.r1,a.r2);if(j>0){var Z=Math.max(a.r1,a.r2),Q=j/Z;for(u=0,l=p.length;u<l;u++)p[u].offset+=Q*(1-p[u].offset)}}for(u=0,l=p.length;u<l;u++){var $=p[u];f.push("<stop ",'offset="',$.offset*100+"%",'" style="stop-color:',$.color,typeof $.opacity<"u"?";stop-opacity: "+$.opacity:";",`"/>
`)}return f.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),f.join("")},toLive:function(s){var r,a=C.util.object.clone(this.coords),u,l;if(this.type){for(this.type==="linear"?r=s.createLinearGradient(a.x1,a.y1,a.x2,a.y2):this.type==="radial"&&(r=s.createRadialGradient(a.x1,a.y1,a.r1,a.x2,a.y2,a.r2)),u=0,l=this.colorStops.length;u<l;u++){var h=this.colorStops[u].color,f=this.colorStops[u].opacity,g=this.colorStops[u].offset;typeof f<"u"&&(h=new C.Color(h).setAlpha(f).toRgba()),r.addColorStop(g,h)}return r}}}),C.util.object.extend(C.Gradient,{fromElement:function(s,r,a,u){var l=parseFloat(a)/(/%$/.test(a)?100:1);l=l<0?0:l>1?1:l,isNaN(l)&&(l=1);var h=s.getElementsByTagName("stop"),f,g=s.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",p=s.getAttribute("gradientTransform")||"",v=[],y,_,T=0,P=0,F;for(s.nodeName==="linearGradient"||s.nodeName==="LINEARGRADIENT"?(f="linear",y=t(s)):(f="radial",y=i(s)),_=h.length;_--;)v.push(e(h[_],l));F=C.parseTransformAttribute(p),n(r,y,u,g),g==="pixels"&&(T=-r.left,P=-r.top);var j=new C.Gradient({id:s.getAttribute("id"),type:f,coords:y,colorStops:v,gradientUnits:g,gradientTransform:F,offsetX:T,offsetY:P});return j}});function n(s,r,a,u){var l,h;Object.keys(r).forEach(function(f){l=r[f],l==="Infinity"?h=1:l==="-Infinity"?h=0:(h=parseFloat(r[f],10),typeof l=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(l)&&(h*=.01,u==="pixels"&&((f==="x1"||f==="x2"||f==="r2")&&(h*=a.viewBoxWidth||a.width),(f==="y1"||f==="y2")&&(h*=a.viewBoxHeight||a.height)))),r[f]=h})}})();(function(){"use strict";var e=C.util.toFixed;C.Pattern=C.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(t,i){if(t||(t={}),this.id=C.Object.__uid++,this.setOptions(t),!t.source||t.source&&typeof t.source!="string"){i&&i(this);return}else{var o=this;this.source=C.util.createImage(),C.util.loadImage(t.source,function(n,s){o.source=n,i&&i(o,s)},null,this.crossOrigin)}},toObject:function(t){var i=C.Object.NUM_FRACTION_DIGITS,o,n;return typeof this.source.src=="string"?o=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(o=this.source.toDataURL()),n={type:"pattern",source:o,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:e(this.offsetX,i),offsetY:e(this.offsetY,i),patternTransform:this.patternTransform?this.patternTransform.concat():null},C.util.populateWithProperties(this,n,t),n},toSVG:function(t){var i=typeof this.source=="function"?this.source():this.source,o=i.width/t.width,n=i.height/t.height,s=this.offsetX/t.width,r=this.offsetY/t.height,a="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(n=1,r&&(n+=Math.abs(r))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(o=1,s&&(o+=Math.abs(s))),i.src?a=i.src:i.toDataURL&&(a=i.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+s+'" y="'+r+'" width="'+o+'" height="'+n+`">
<image x="0" y="0" width="`+i.width+'" height="'+i.height+'" xlink:href="'+a+`"></image>
</pattern>
`},setOptions:function(t){for(var i in t)this[i]=t[i]},toLive:function(t){var i=this.source;return!i||typeof i.src<"u"&&(!i.complete||i.naturalWidth===0||i.naturalHeight===0)?"":t.createPattern(i,this.repeat)}})})();(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.toFixed;if(t.Shadow){t.warn("fabric.Shadow is already defined.");return}t.Shadow=t.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(o){typeof o=="string"&&(o=this._parseShadow(o));for(var n in o)this[n]=o[n];this.id=t.Object.__uid++},_parseShadow:function(o){var n=o.trim(),s=t.Shadow.reOffsetsAndBlur.exec(n)||[],r=n.replace(t.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:r.trim(),offsetX:parseFloat(s[1],10)||0,offsetY:parseFloat(s[2],10)||0,blur:parseFloat(s[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(o){var n=40,s=40,r=t.Object.NUM_FRACTION_DIGITS,a=t.util.rotateVector({x:this.offsetX,y:this.offsetY},t.util.degreesToRadians(-o.angle)),u=20,l=new t.Color(this.color);return o.width&&o.height&&(n=i((Math.abs(a.x)+this.blur)/o.width,r)*100+u,s=i((Math.abs(a.y)+this.blur)/o.height,r)*100+u),o.flipX&&(a.x*=-1),o.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+n+'%" width="'+(100+2*n)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+i(this.blur?this.blur/2:0,r)+`"></feGaussianBlur>
	<feOffset dx="`+i(a.x,r)+'" dy="'+i(a.y,r)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+l.toRgb()+'" flood-opacity="'+l.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var o={},n=t.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(s){this[s]!==n[s]&&(o[s]=this[s])},this),o}}),t.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/})(ut);(function(){"use strict";if(C.StaticCanvas){C.warn("fabric.StaticCanvas is already defined.");return}var e=C.util.object.extend,t=C.util.getElementOffset,i=C.util.removeFromArray,o=C.util.toFixed,n=C.util.transformPoint,s=C.util.invertTransform,r=C.util.getNodeCanvas,a=C.util.createCanvasElement,u=new Error("Could not initialize `canvas` element");C.StaticCanvas=C.util.createClass(C.CommonMethods,{initialize:function(l,h){h||(h={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(l,h)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:C.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(l,h){var f=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(l),this._initOptions(h),this.interactive||this._initRetinaScaling(),h.overlayImage&&this.setOverlayImage(h.overlayImage,f),h.backgroundImage&&this.setBackgroundImage(h.backgroundImage,f),h.backgroundColor&&this.setBackgroundColor(h.backgroundColor,f),h.overlayColor&&this.setOverlayColor(h.overlayColor,f),this.calcOffset()},_isRetinaScaling:function(){return C.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,C.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var l=C.devicePixelRatio;this.__initRetinaScaling(l,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(l,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(l,h,f){h.setAttribute("width",this.width*l),h.setAttribute("height",this.height*l),f.scale(l,l)},calcOffset:function(){return this._offset=t(this.lowerCanvasEl),this},setOverlayImage:function(l,h,f){return this.__setBgOverlayImage("overlayImage",l,h,f)},setBackgroundImage:function(l,h,f){return this.__setBgOverlayImage("backgroundImage",l,h,f)},setOverlayColor:function(l,h){return this.__setBgOverlayColor("overlayColor",l,h)},setBackgroundColor:function(l,h){return this.__setBgOverlayColor("backgroundColor",l,h)},__setBgOverlayImage:function(l,h,f,g){return typeof h=="string"?C.util.loadImage(h,function(p,v){if(p){var y=new C.Image(p,g);this[l]=y,y.canvas=this}f&&f(p,v)},this,g&&g.crossOrigin):(g&&h.setOptions(g),this[l]=h,h&&(h.canvas=this),f&&f(h,!1)),this},__setBgOverlayColor:function(l,h,f){return this[l]=h,this._initGradient(h,l),this._initPattern(h,l,f),this},_createCanvasElement:function(){var l=a();if(!l||(l.style||(l.style={}),typeof l.getContext>"u"))throw u;return l},_initOptions:function(l){var h=this.lowerCanvasEl;this._setOptions(l),this.width=this.width||parseInt(h.width,10)||0,this.height=this.height||parseInt(h.height,10)||0,this.lowerCanvasEl.style&&(h.width=this.width,h.height=this.height,h.style.width=this.width+"px",h.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(l){l&&l.getContext?this.lowerCanvasEl=l:this.lowerCanvasEl=C.util.getById(l)||this._createCanvasElement(),C.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(l,h){return this.setDimensions({width:l},h)},setHeight:function(l,h){return this.setDimensions({height:l},h)},setDimensions:function(l,h){var f;h=h||{};for(var g in l)f=l[g],h.cssOnly||(this._setBackstoreDimension(g,l[g]),f+="px",this.hasLostContext=!0),h.backstoreOnly||this._setCssDimension(g,f);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),h.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(l,h){return this.lowerCanvasEl[l]=h,this.upperCanvasEl&&(this.upperCanvasEl[l]=h),this.cacheCanvasEl&&(this.cacheCanvasEl[l]=h),this[l]=h,this},_setCssDimension:function(l,h){return this.lowerCanvasEl.style[l]=h,this.upperCanvasEl&&(this.upperCanvasEl.style[l]=h),this.wrapperEl&&(this.wrapperEl.style[l]=h),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(l){var h=this._activeObject,f=this.backgroundImage,g=this.overlayImage,p,v,y;for(this.viewportTransform=l,v=0,y=this._objects.length;v<y;v++)p=this._objects[v],p.group||p.setCoords(!0);return h&&h.setCoords(),f&&f.setCoords(!0),g&&g.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(l,h){var f=l,g=this.viewportTransform.slice(0);l=n(l,s(this.viewportTransform)),g[0]=h,g[3]=h;var p=n(l,g);return g[4]+=f.x-p.x,g[5]+=f.y-p.y,this.setViewportTransform(g)},setZoom:function(l){return this.zoomToPoint(new C.Point(0,0),l),this},absolutePan:function(l){var h=this.viewportTransform.slice(0);return h[4]=-l.x,h[5]=-l.y,this.setViewportTransform(h)},relativePan:function(l){return this.absolutePan(new C.Point(-l.x-this.viewportTransform[4],-l.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(l){this.stateful&&l.setupState(),l._set("canvas",this),l.setCoords(),this.fire("object:added",{target:l}),l.fire("added")},_onObjectRemoved:function(l){this.fire("object:removed",{target:l}),l.fire("removed"),delete l.canvas},clearContext:function(l){return l.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var l=this.contextContainer;return this.renderCanvas(l,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=C.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var l={},h=this.width,f=this.height,g=s(this.viewportTransform);return l.tl=n({x:0,y:0},g),l.br=n({x:h,y:f},g),l.tr=new C.Point(l.br.x,l.tl.y),l.bl=new C.Point(l.tl.x,l.br.y),this.vptCoords=l,l},cancelRequestedRender:function(){this.isRendering&&(C.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(l,h){var f=this.viewportTransform,g=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(l),C.util.setImageSmoothing(l,this.imageSmoothingEnabled),this.fire("before:render",{ctx:l}),this._renderBackground(l),l.save(),l.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._renderObjects(l,h),l.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(l),g&&(g.canvas=this,g.shouldCache(),g._transformDone=!0,g.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(l)),this._renderOverlay(l),this.controlsAboveOverlay&&this.interactive&&this.drawControls(l),this.fire("after:render",{ctx:l})},drawClipPathOnCanvas:function(l){var h=this.viewportTransform,f=this.clipPath;l.save(),l.transform(h[0],h[1],h[2],h[3],h[4],h[5]),l.globalCompositeOperation="destination-in",f.transform(l),l.scale(1/f.zoomX,1/f.zoomY),l.drawImage(f._cacheCanvas,-f.cacheTranslationX,-f.cacheTranslationY),l.restore()},_renderObjects:function(l,h){var f,g;for(f=0,g=h.length;f<g;++f)h[f]&&h[f].render(l)},_renderBackgroundOrOverlay:function(l,h){var f=this[h+"Color"],g=this[h+"Image"],p=this.viewportTransform,v=this[h+"Vpt"];if(!(!f&&!g)){if(f){l.save(),l.beginPath(),l.moveTo(0,0),l.lineTo(this.width,0),l.lineTo(this.width,this.height),l.lineTo(0,this.height),l.closePath(),l.fillStyle=f.toLive?f.toLive(l,this):f,v&&l.transform(p[0],p[1],p[2],p[3],p[4],p[5]),l.transform(1,0,0,1,f.offsetX||0,f.offsetY||0);var y=f.gradientTransform||f.patternTransform;y&&l.transform(y[0],y[1],y[2],y[3],y[4],y[5]),l.fill(),l.restore()}g&&(l.save(),v&&l.transform(p[0],p[1],p[2],p[3],p[4],p[5]),g.render(l),l.restore())}},_renderBackground:function(l){this._renderBackgroundOrOverlay(l,"background")},_renderOverlay:function(l){this._renderBackgroundOrOverlay(l,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new C.Point(this.width/2,this.height/2)},centerObjectH:function(l){return this._centerObject(l,new C.Point(this.getCenterPoint().x,l.getCenterPoint().y))},centerObjectV:function(l){return this._centerObject(l,new C.Point(l.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(l){var h=this.getCenterPoint();return this._centerObject(l,h)},viewportCenterObject:function(l){var h=this.getVpCenter();return this._centerObject(l,h)},viewportCenterObjectH:function(l){var h=this.getVpCenter();return this._centerObject(l,new C.Point(h.x,l.getCenterPoint().y)),this},viewportCenterObjectV:function(l){var h=this.getVpCenter();return this._centerObject(l,new C.Point(l.getCenterPoint().x,h.y))},getVpCenter:function(){var l=this.getCenterPoint(),h=s(this.viewportTransform);return n(l,h)},_centerObject:function(l,h){return l.setPositionByOrigin(h,"center","center"),l.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(l){return this.toDatalessObject(l)},toObject:function(l){return this._toObjectMethod("toObject",l)},toDatalessObject:function(l){return this._toObjectMethod("toDatalessObject",l)},_toObjectMethod:function(l,h){var f=this.clipPath,g={version:C.version,objects:this._toObjects(l,h)};return f&&!f.excludeFromExport&&(g.clipPath=this._toObject(this.clipPath,l,h)),e(g,this.__serializeBgOverlay(l,h)),C.util.populateWithProperties(this,g,h),g},_toObjects:function(l,h){return this._objects.filter(function(f){return!f.excludeFromExport}).map(function(f){return this._toObject(f,l,h)},this)},_toObject:function(l,h,f){var g;this.includeDefaultValues||(g=l.includeDefaultValues,l.includeDefaultValues=!1);var p=l[h](f);return this.includeDefaultValues||(l.includeDefaultValues=g),p},__serializeBgOverlay:function(l,h){var f={},g=this.backgroundImage,p=this.overlayImage,v=this.backgroundColor,y=this.overlayColor;return v&&v.toObject?v.excludeFromExport||(f.background=v.toObject(h)):v&&(f.background=v),y&&y.toObject?y.excludeFromExport||(f.overlay=y.toObject(h)):y&&(f.overlay=y),g&&!g.excludeFromExport&&(f.backgroundImage=this._toObject(g,l,h)),p&&!p.excludeFromExport&&(f.overlayImage=this._toObject(p,l,h)),f},svgViewportTransformation:!0,toSVG:function(l,h){l||(l={}),l.reviver=h;var f=[];return this._setSVGPreamble(f,l),this._setSVGHeader(f,l),this.clipPath&&f.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(f,"background"),this._setSVGBgOverlayImage(f,"backgroundImage",h),this._setSVGObjects(f,h),this.clipPath&&f.push(`</g>
`),this._setSVGBgOverlayColor(f,"overlay"),this._setSVGBgOverlayImage(f,"overlayImage",h),f.push("</svg>"),f.join("")},_setSVGPreamble:function(l,h){h.suppressPreamble||l.push('<?xml version="1.0" encoding="',h.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(l,h){var f=h.width||this.width,g=h.height||this.height,p,v='viewBox="0 0 '+this.width+" "+this.height+'" ',y=C.Object.NUM_FRACTION_DIGITS;h.viewBox?v='viewBox="'+h.viewBox.x+" "+h.viewBox.y+" "+h.viewBox.width+" "+h.viewBox.height+'" ':this.svgViewportTransformation&&(p=this.viewportTransform,v='viewBox="'+o(-p[4]/p[0],y)+" "+o(-p[5]/p[3],y)+" "+o(this.width/p[0],y)+" "+o(this.height/p[3],y)+'" '),l.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',f,'" ','height="',g,'" ',v,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",C.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(h),`</defs>
`)},createSVGClipPathMarkup:function(l){var h=this.clipPath;return h?(h.clipPathId="CLIPPATH_"+C.Object.__uid++,'<clipPath id="'+h.clipPathId+`" >
`+this.clipPath.toClipPathSVG(l.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var l=this,h=["background","overlay"].map(function(f){var g=l[f+"Color"];if(g&&g.toLive){var p=l[f+"Vpt"],v=l.viewportTransform,y={width:l.width/(p?v[0]:1),height:l.height/(p?v[3]:1)};return g.toSVG(y,{additionalTransform:p?C.util.matrixToSVG(v):""})}});return h.join("")},createSVGFontFacesMarkup:function(){var l="",h={},f,g,p,v,y,_,T,P,F,j=C.fontPaths,Z=[];for(this._objects.forEach(function $(tt){Z.push(tt),tt._objects&&tt._objects.forEach($)}),P=0,F=Z.length;P<F;P++)if(f=Z[P],g=f.fontFamily,!(f.type.indexOf("text")===-1||h[g]||!j[g])&&(h[g]=!0,!!f.styles)){p=f.styles;for(y in p){v=p[y];for(T in v)_=v[T],g=_.fontFamily,!h[g]&&j[g]&&(h[g]=!0)}}for(var Q in h)l+=[`		@font-face {
`,"			font-family: '",Q,`';
`,"			src: url('",j[Q],`');
`,`		}
`].join("");return l&&(l=['	<style type="text/css">',`<![CDATA[
`,l,"]]>",`</style>
`].join("")),l},_setSVGObjects:function(l,h){var f,g,p,v=this._objects;for(g=0,p=v.length;g<p;g++)f=v[g],!f.excludeFromExport&&this._setSVGObject(l,f,h)},_setSVGObject:function(l,h,f){l.push(h.toSVG(f))},_setSVGBgOverlayImage:function(l,h,f){this[h]&&!this[h].excludeFromExport&&this[h].toSVG&&l.push(this[h].toSVG(f))},_setSVGBgOverlayColor:function(l,h){var f=this[h+"Color"],g=this.viewportTransform,p=this.width,v=this.height;if(f)if(f.toLive){var y=f.repeat,_=C.util.invertTransform(g),T=this[h+"Vpt"],P=T?C.util.matrixToSVG(_):"";l.push('<rect transform="'+P+" translate(",p/2,",",v/2,')"',' x="',f.offsetX-p/2,'" y="',f.offsetY-v/2,'" ','width="',y==="repeat-y"||y==="no-repeat"?f.source.width:p,'" height="',y==="repeat-x"||y==="no-repeat"?f.source.height:v,'" fill="url(#SVGID_'+f.id+')"',`></rect>
`)}else l.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',f,'"',`></rect>
`)},sendToBack:function(l){if(!l)return this;var h=this._activeObject,f,g,p;if(l===h&&l.type==="activeSelection")for(p=h._objects,f=p.length;f--;)g=p[f],i(this._objects,g),this._objects.unshift(g);else i(this._objects,l),this._objects.unshift(l);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(l){if(!l)return this;var h=this._activeObject,f,g,p;if(l===h&&l.type==="activeSelection")for(p=h._objects,f=0;f<p.length;f++)g=p[f],i(this._objects,g),this._objects.push(g);else i(this._objects,l),this._objects.push(l);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(l,h){if(!l)return this;var f=this._activeObject,g,p,v,y,_,T=0;if(l===f&&l.type==="activeSelection")for(_=f._objects,g=0;g<_.length;g++)p=_[g],v=this._objects.indexOf(p),v>0+T&&(y=v-1,i(this._objects,p),this._objects.splice(y,0,p)),T++;else v=this._objects.indexOf(l),v!==0&&(y=this._findNewLowerIndex(l,v,h),i(this._objects,l),this._objects.splice(y,0,l));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(l,h,f){var g,p;if(f)for(g=h,p=h-1;p>=0;--p){var v=l.intersectsWithObject(this._objects[p])||l.isContainedWithinObject(this._objects[p])||this._objects[p].isContainedWithinObject(l);if(v){g=p;break}}else g=h-1;return g},bringForward:function(l,h){if(!l)return this;var f=this._activeObject,g,p,v,y,_,T=0;if(l===f&&l.type==="activeSelection")for(_=f._objects,g=_.length;g--;)p=_[g],v=this._objects.indexOf(p),v<this._objects.length-1-T&&(y=v+1,i(this._objects,p),this._objects.splice(y,0,p)),T++;else v=this._objects.indexOf(l),v!==this._objects.length-1&&(y=this._findNewUpperIndex(l,v,h),i(this._objects,l),this._objects.splice(y,0,l));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(l,h,f){var g,p,v;if(f)for(g=h,p=h+1,v=this._objects.length;p<v;++p){var y=l.intersectsWithObject(this._objects[p])||l.isContainedWithinObject(this._objects[p])||this._objects[p].isContainedWithinObject(l);if(y){g=p;break}}else g=h+1;return g},moveTo:function(l,h){return i(this._objects,l),this._objects.splice(h,0,l),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(C.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(l){l.dispose&&l.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),C.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),C.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),e(C.StaticCanvas.prototype,C.Observable),e(C.StaticCanvas.prototype,C.Collection),e(C.StaticCanvas.prototype,C.DataURLExporter),e(C.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(l){var h=a();if(!h||!h.getContext)return null;var f=h.getContext("2d");if(!f)return null;switch(l){case"setLineDash":return typeof f.setLineDash<"u";default:return null}}}),C.StaticCanvas.prototype.toJSON=C.StaticCanvas.prototype.toObject,C.isLikelyNode&&(C.StaticCanvas.prototype.createPNGStream=function(){var l=r(this.lowerCanvasEl);return l&&l.createPNGStream()},C.StaticCanvas.prototype.createJPEGStream=function(l){var h=r(this.lowerCanvasEl);return h&&h.createJPEGStream(l)})})();C.BaseBrush=C.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(e){e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.miterLimit=this.strokeMiterLimit,e.lineJoin=this.strokeLineJoin,e.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(e){var t=this.canvas.viewportTransform;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5])},_setShadow:function(){if(this.shadow){var e=this.canvas,t=this.shadow,i=e.contextTop,o=e.getZoom();e&&e._isRetinaScaling()&&(o*=C.devicePixelRatio),i.shadowColor=t.color,i.shadowBlur=t.blur*o,i.shadowOffsetX=t.offsetX*o,i.shadowOffsetY=t.offsetY*o}},needsFullRender:function(){var e=new C.Color(this.color);return e.getAlpha()<1||!!this.shadow},_resetShadow:function(){var e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0},_isOutSideCanvas:function(e){return e.x<0||e.x>this.canvas.getWidth()||e.y<0||e.y>this.canvas.getHeight()}});(function(){C.PencilBrush=C.util.createClass(C.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(e){this.canvas=e,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(e,t,i){var o=t.midPointFrom(i);return e.quadraticCurveTo(t.x,t.y,o.x,o.y),o},onMouseDown:function(e,t){this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],this._prepareForDrawing(e),this._captureDrawingPath(e),this._render())},onMouseMove:function(e,t){if(this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e))&&this._captureDrawingPath(e)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var i=this._points,o=i.length,n=this.canvas.contextTop;this._saveAndTransform(n),this.oldEnd&&(n.beginPath(),n.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(n,i[o-2],i[o-1],!0),n.stroke(),n.restore()}},onMouseUp:function(e){return this.canvas._isMainEvent(e.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(e){var t=new C.Point(e.x,e.y);this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)},_addPoint:function(e){return this._points.length>1&&e.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(e),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(e){var t=new C.Point(e.x,e.y);return this._addPoint(t)},_render:function(e){var t,i,o=this._points[0],n=this._points[1];if(e=e||this.canvas.contextTop,this._saveAndTransform(e),e.beginPath(),this._points.length===2&&o.x===n.x&&o.y===n.y){var s=this.width/1e3;o=new C.Point(o.x,o.y),n=new C.Point(n.x,n.y),o.x-=s,n.x+=s}for(e.moveTo(o.x,o.y),t=1,i=this._points.length;t<i;t++)this._drawSegment(e,o,n),o=this._points[t],n=this._points[t+1];e.lineTo(o.x,o.y),e.stroke(),e.restore()},convertPointsToSVGPath:function(e){var t=this.width/1e3;return C.util.getSmoothPathFromPoints(e,t)},_isEmptySVGPath:function(e){var t=C.util.joinPath(e);return t==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(e){var t=new C.Path(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.shadow=new C.Shadow(this.shadow)),t},decimatePoints:function(e,t){if(e.length<=2)return e;var i=this.canvas.getZoom(),o=Math.pow(t/i,2),n,s=e.length-1,r=e[0],a=[r],u;for(n=1;n<s-1;n++)u=Math.pow(r.x-e[n].x,2)+Math.pow(r.y-e[n].y,2),u>=o&&(r=e[n],a.push(r));return a.push(e[s]),a},_finalizeAndAddPath:function(){var e=this.canvas.contextTop;e.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var t=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(t)){this.canvas.requestRenderAll();return}var i=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:i}),this.canvas.add(i),this.canvas.requestRenderAll(),i.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:i})}})})();C.CircleBrush=C.util.createClass(C.BaseBrush,{width:10,initialize:function(e){this.canvas=e,this.points=[]},drawDot:function(e){var t=this.addPoint(e),i=this.canvas.contextTop;this._saveAndTransform(i),this.dot(i,t),i.restore()},dot:function(e,t){e.fillStyle=t.fill,e.beginPath(),e.arc(t.x,t.y,t.radius,0,Math.PI*2,!1),e.closePath(),e.fill()},onMouseDown:function(e){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(e)},_render:function(){var e=this.canvas.contextTop,t,i,o=this.points;for(this._saveAndTransform(e),t=0,i=o.length;t<i;t++)this.dot(e,o[t]);e.restore()},onMouseMove:function(e){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(e),this._render()):this.drawDot(e))},onMouseUp:function(){var e=this.canvas.renderOnAddRemove,t,i;this.canvas.renderOnAddRemove=!1;var o=[];for(t=0,i=this.points.length;t<i;t++){var n=this.points[t],s=new C.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&(s.shadow=new C.Shadow(this.shadow)),o.push(s)}var r=new C.Group(o);r.canvas=this.canvas,this.canvas.fire("before:path:created",{path:r}),this.canvas.add(r),this.canvas.fire("path:created",{path:r}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()},addPoint:function(e){var t=new C.Point(e.x,e.y),i=C.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,o=new C.Color(this.color).setAlpha(C.util.getRandomInt(0,100)/100).toRgba();return t.radius=i,t.fill=o,this.points.push(t),t}});C.SprayBrush=C.util.createClass(C.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(e){this.canvas=e,this.sprayChunks=[]},onMouseDown:function(e){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(e),this.render(this.sprayChunkPoints)},onMouseMove:function(e){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e)||(this.addSprayChunk(e),this.render(this.sprayChunkPoints))},onMouseUp:function(){var e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var t=[],i=0,o=this.sprayChunks.length;i<o;i++)for(var n=this.sprayChunks[i],s=0,r=n.length;s<r;s++){var a=new C.Rect({width:n[s].width,height:n[s].width,left:n[s].x+1,top:n[s].y+1,originX:"center",originY:"center",fill:this.color});t.push(a)}this.optimizeOverlapping&&(t=this._getOptimizedRects(t));var u=new C.Group(t);this.shadow&&u.set("shadow",new C.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:u}),this.canvas.add(u),this.canvas.fire("path:created",{path:u}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()},_getOptimizedRects:function(e){var t={},i,o,n;for(o=0,n=e.length;o<n;o++)i=e[o].left+""+e[o].top,t[i]||(t[i]=e[o]);var s=[];for(i in t)s.push(t[i]);return s},render:function(e){var t=this.canvas.contextTop,i,o;for(t.fillStyle=this.color,this._saveAndTransform(t),i=0,o=e.length;i<o;i++){var n=e[i];typeof n.opacity<"u"&&(t.globalAlpha=n.opacity),t.fillRect(n.x,n.y,n.width,n.width)}t.restore()},_render:function(){var e=this.canvas.contextTop,t,i;for(e.fillStyle=this.color,this._saveAndTransform(e),t=0,i=this.sprayChunks.length;t<i;t++)this.render(this.sprayChunks[t]);e.restore()},addSprayChunk:function(e){this.sprayChunkPoints=[];var t,i,o,n=this.width/2,s;for(s=0;s<this.density;s++){t=C.util.getRandomInt(e.x-n,e.x+n),i=C.util.getRandomInt(e.y-n,e.y+n),this.dotWidthVariance?o=C.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):o=this.dotWidth;var r=new C.Point(t,i);r.width=o,this.randomOpacity&&(r.opacity=C.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(r)}this.sprayChunks.push(this.sprayChunkPoints)}});C.PatternBrush=C.util.createClass(C.PencilBrush,{getPatternSrc:function(){var e=20,t=5,i=C.util.createCanvasElement(),o=i.getContext("2d");return i.width=i.height=e+t,o.fillStyle=this.color,o.beginPath(),o.arc(e/2,e/2,e/2,0,Math.PI*2,!1),o.closePath(),o.fill(),i},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(e){return e.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(e){this.callSuper("_setBrushStyles",e),e.strokeStyle=this.getPattern(e)},createPath:function(e){var t=this.callSuper("createPath",e),i=t._getLeftTopCoords().scalarAdd(t.strokeWidth/2);return t.stroke=new C.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-i.x,offsetY:-i.y}),t}});(function(){var e=C.util.getPointer,t=C.util.degreesToRadians,i=C.util.isTouchEvent;C.Canvas=C.util.createClass(C.StaticCanvas,{initialize:function(n,s){s||(s={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(n,s),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=C.PencilBrush&&new C.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var n=this.getActiveObjects(),s,r,a;if(n.length>0&&!this.preserveObjectStacking){r=[],a=[];for(var u=0,l=this._objects.length;u<l;u++)s=this._objects[u],n.indexOf(s)===-1?r.push(s):a.push(s);n.length>1&&(this._activeObject._objects=a),r.push.apply(r,a)}else r=this._objects;return r},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var n=this.contextContainer;return this.renderCanvas(n,this._chooseObjectsToRender()),this},renderTopLayer:function(n){n.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(n),this.contextTopDirty=!0),n.restore()},renderTop:function(){var n=this.contextTop;return this.clearContext(n),this.renderTopLayer(n),this.fire("after:render"),this},_normalizePointer:function(n,s){var r=n.calcTransformMatrix(),a=C.util.invertTransform(r),u=this.restorePointerVpt(s);return C.util.transformPoint(u,a)},isTargetTransparent:function(n,s,r){if(n.shouldCache()&&n._cacheCanvas&&n!==this._activeObject){var a=this._normalizePointer(n,{x:s,y:r}),u=Math.max(n.cacheTranslationX+a.x*n.zoomX,0),l=Math.max(n.cacheTranslationY+a.y*n.zoomY,0),p=C.util.isTransparent(n._cacheContext,Math.round(u),Math.round(l),this.targetFindTolerance);return p}var h=this.contextCache,f=n.selectionBackgroundColor,g=this.viewportTransform;n.selectionBackgroundColor="",this.clearContext(h),h.save(),h.transform(g[0],g[1],g[2],g[3],g[4],g[5]),n.render(h),h.restore(),n.selectionBackgroundColor=f;var p=C.util.isTransparent(h,s,r,this.targetFindTolerance);return p},_isSelectionKeyPressed:function(n){var s=!1;return Array.isArray(this.selectionKey)?s=!!this.selectionKey.find(function(r){return n[r]===!0}):s=n[this.selectionKey],s},_shouldClearSelection:function(n,s){var r=this.getActiveObjects(),a=this._activeObject;return!s||s&&a&&r.length>1&&r.indexOf(s)===-1&&a!==s&&!this._isSelectionKeyPressed(n)||s&&!s.evented||s&&!s.selectable&&a&&a!==s},_shouldCenterTransform:function(n,s,r){if(n){var a;return s==="scale"||s==="scaleX"||s==="scaleY"||s==="resizing"?a=this.centeredScaling||n.centeredScaling:s==="rotate"&&(a=this.centeredRotation||n.centeredRotation),a?!r:r}},_getOriginFromCorner:function(n,s){var r={x:n.originX,y:n.originY};return s==="ml"||s==="tl"||s==="bl"?r.x="right":(s==="mr"||s==="tr"||s==="br")&&(r.x="left"),s==="tl"||s==="mt"||s==="tr"?r.y="bottom":(s==="bl"||s==="mb"||s==="br")&&(r.y="top"),r},_getActionFromCorner:function(n,s,r,a){if(!s||!n)return"drag";var u=a.controls[s];return u.getActionName(r,u,a)},_setupCurrentTransform:function(n,s,r){if(s){var a=this.getPointer(n),u=s.__corner,l=s.controls[u],h=r&&u?l.getActionHandler(n,s,l):C.controlsUtils.dragHandler,f=this._getActionFromCorner(r,u,n,s),g=this._getOriginFromCorner(s,u),p=n[this.centeredKey],v={target:s,action:f,actionHandler:h,corner:u,scaleX:s.scaleX,scaleY:s.scaleY,skewX:s.skewX,skewY:s.skewY,offsetX:a.x-s.left,offsetY:a.y-s.top,originX:g.x,originY:g.y,ex:a.x,ey:a.y,lastX:a.x,lastY:a.y,theta:t(s.angle),width:s.width*s.scaleX,shiftKey:n.shiftKey,altKey:p,original:C.util.saveObjectTransform(s)};this._shouldCenterTransform(s,f,p)&&(v.originX="center",v.originY="center"),v.original.originX=g.x,v.original.originY=g.y,this._currentTransform=v,this._beforeTransform(n)}},setCursor:function(n){this.upperCanvasEl.style.cursor=n},_drawSelection:function(n){var s=this._groupSelector,r=new C.Point(s.ex,s.ey),a=C.util.transformPoint(r,this.viewportTransform),u=new C.Point(s.ex+s.left,s.ey+s.top),l=C.util.transformPoint(u,this.viewportTransform),h=Math.min(a.x,l.x),f=Math.min(a.y,l.y),g=Math.max(a.x,l.x),p=Math.max(a.y,l.y),v=this.selectionLineWidth/2;this.selectionColor&&(n.fillStyle=this.selectionColor,n.fillRect(h,f,g-h,p-f)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(n.lineWidth=this.selectionLineWidth,n.strokeStyle=this.selectionBorderColor,h+=v,f+=v,g-=v,p-=v,C.Object.prototype._setLineDash.call(this,n,this.selectionDashArray),n.strokeRect(h,f,g-h,p-f))},findTarget:function(n,s){if(!this.skipTargetFind){var r=!0,a=this.getPointer(n,r),u=this._activeObject,l=this.getActiveObjects(),h,f,g=i(n),p=l.length>1&&!s||l.length===1;if(this.targets=[],p&&u._findTargetCorner(a,g)||l.length>1&&!s&&u===this._searchPossibleTargets([u],a))return u;if(l.length===1&&u===this._searchPossibleTargets([u],a))if(this.preserveObjectStacking)h=u,f=this.targets,this.targets=[];else return u;var v=this._searchPossibleTargets(this._objects,a);return n[this.altSelectionKey]&&v&&h&&v!==h&&(v=h,this.targets=f),v}},_checkTarget:function(n,s,r){if(s&&s.visible&&s.evented&&s.containsPoint(n))if((this.perPixelTargetFind||s.perPixelTargetFind)&&!s.isEditing){var a=this.isTargetTransparent(s,r.x,r.y);if(!a)return!0}else return!0},_searchPossibleTargets:function(n,s){for(var r,a=n.length,u;a--;){var l=n[a],h=l.group?this._normalizePointer(l.group,s):s;if(this._checkTarget(h,l,s)){r=n[a],r.subTargetCheck&&r instanceof C.Group&&(u=this._searchPossibleTargets(r._objects,s),u&&this.targets.push(u));break}}return r},restorePointerVpt:function(n){return C.util.transformPoint(n,C.util.invertTransform(this.viewportTransform))},getPointer:function(n,s){if(this._absolutePointer&&!s)return this._absolutePointer;if(this._pointer&&s)return this._pointer;var r=e(n),a=this.upperCanvasEl,u=a.getBoundingClientRect(),l=u.width||0,h=u.height||0,f;(!l||!h)&&("top"in u&&"bottom"in u&&(h=Math.abs(u.top-u.bottom)),"right"in u&&"left"in u&&(l=Math.abs(u.right-u.left))),this.calcOffset(),r.x=r.x-this._offset.left,r.y=r.y-this._offset.top,s||(r=this.restorePointerVpt(r));var g=this.getRetinaScaling();return g!==1&&(r.x/=g,r.y/=g),l===0||h===0?f={width:1,height:1}:f={width:a.width/l,height:a.height/h},{x:r.x*f.width,y:r.y*f.height}},_createUpperCanvas:function(){var n=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),s=this.lowerCanvasEl,r=this.upperCanvasEl;r?r.className="":(r=this._createCanvasElement(),this.upperCanvasEl=r),C.util.addClass(r,"upper-canvas "+n),this.wrapperEl.appendChild(r),this._copyCanvasStyle(s,r),this._applyCanvasStyle(r),this.contextTop=r.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=C.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),C.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),C.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(n){var s=this.width||n.width,r=this.height||n.height;C.util.setStyle(n,{position:"absolute",width:s+"px",height:r+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),n.width=s,n.height=r,C.util.makeElementUnselectable(n)},_copyCanvasStyle:function(n,s){s.style.cssText=n.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var n=this._activeObject;return n?n.type==="activeSelection"&&n._objects?n._objects.slice(0):[n]:[]},_onObjectRemoved:function(n){n===this._activeObject&&(this.fire("before:selection:cleared",{target:n}),this._discardActiveObject(),this.fire("selection:cleared",{target:n}),n.fire("deselected")),n===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",n)},_fireSelectionEvents:function(n,s){var r=!1,a=this.getActiveObjects(),u=[],l=[];n.forEach(function(h){a.indexOf(h)===-1&&(r=!0,h.fire("deselected",{e:s,target:h}),l.push(h))}),a.forEach(function(h){n.indexOf(h)===-1&&(r=!0,h.fire("selected",{e:s,target:h}),u.push(h))}),n.length>0&&a.length>0?r&&this.fire("selection:updated",{e:s,selected:u,deselected:l}):a.length>0?this.fire("selection:created",{e:s,selected:u}):n.length>0&&this.fire("selection:cleared",{e:s,deselected:l})},setActiveObject:function(n,s){var r=this.getActiveObjects();return this._setActiveObject(n,s),this._fireSelectionEvents(r,s),this},_setActiveObject:function(n,s){return this._activeObject===n||!this._discardActiveObject(s,n)||n.onSelect({e:s})?!1:(this._activeObject=n,!0)},_discardActiveObject:function(n,s){var r=this._activeObject;if(r){if(r.onDeselect({e:n,object:s}))return!1;this._activeObject=null}return!0},discardActiveObject:function(n){var s=this.getActiveObjects(),r=this.getActiveObject();return s.length&&this.fire("before:selection:cleared",{target:r,e:n}),this._discardActiveObject(n),this._fireSelectionEvents(s,n),this},dispose:function(){var n=this.wrapperEl;return this.removeListeners(),n.removeChild(this.upperCanvasEl),n.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(s){C.util.cleanUpJsdomNode(this[s]),this[s]=void 0}.bind(this)),n.parentNode&&n.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,C.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(n){var s=this._activeObject;s&&s._renderControls(n)},_toObject:function(n,s,r){var a=this._realizeGroupTransformOnObject(n),u=this.callSuper("_toObject",n,s,r);return this._unwindGroupTransformOnObject(n,a),u},_realizeGroupTransformOnObject:function(n){if(n.group&&n.group.type==="activeSelection"&&this._activeObject===n.group){var s=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],r={};return s.forEach(function(a){r[a]=n[a]}),C.util.addTransformToObject(n,this._activeObject.calcOwnMatrix()),r}else return null},_unwindGroupTransformOnObject:function(n,s){s&&n.set(s)},_setSVGObject:function(n,s,r){var a=this._realizeGroupTransformOnObject(s);this.callSuper("_setSVGObject",n,s,r),this._unwindGroupTransformOnObject(s,a)},setViewportTransform:function(n){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),C.StaticCanvas.prototype.setViewportTransform.call(this,n)}});for(var o in C.StaticCanvas)o!=="prototype"&&(C.Canvas[o]=C.StaticCanvas[o])})();(function(){var e=C.util.addListener,t=C.util.removeListener,i=3,o=2,n=1,s={passive:!1};function r(a,u){return a.button&&a.button===u-1}C.util.object.extend(C.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(e,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(a,u){var l=this.upperCanvasEl,h=this._getEventPrefix();a(C.window,"resize",this._onResize),a(l,h+"down",this._onMouseDown),a(l,h+"move",this._onMouseMove,s),a(l,h+"out",this._onMouseOut),a(l,h+"enter",this._onMouseEnter),a(l,"wheel",this._onMouseWheel),a(l,"contextmenu",this._onContextMenu),a(l,"dblclick",this._onDoubleClick),a(l,"dragover",this._onDragOver),a(l,"dragenter",this._onDragEnter),a(l,"dragleave",this._onDragLeave),a(l,"drop",this._onDrop),this.enablePointerEvents||a(l,"touchstart",this._onTouchStart,s),typeof eventjs<"u"&&u in eventjs&&(eventjs[u](l,"gesture",this._onGesture),eventjs[u](l,"drag",this._onDrag),eventjs[u](l,"orientation",this._onOrientationChange),eventjs[u](l,"shake",this._onShake),eventjs[u](l,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(t,"remove");var a=this._getEventPrefix();t(C.document,a+"up",this._onMouseUp),t(C.document,"touchend",this._onTouchEnd,s),t(C.document,a+"move",this._onMouseMove,s),t(C.document,"touchmove",this._onMouseMove,s)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(a,u){this.__onTransformGesture&&this.__onTransformGesture(a,u)},_onDrag:function(a,u){this.__onDrag&&this.__onDrag(a,u)},_onMouseWheel:function(a){this.__onMouseWheel(a)},_onMouseOut:function(a){var u=this._hoveredTarget;this.fire("mouse:out",{target:u,e:a}),this._hoveredTarget=null,u&&u.fire("mouseout",{e:a});var l=this;this._hoveredTargets.forEach(function(h){l.fire("mouse:out",{target:u,e:a}),h&&u.fire("mouseout",{e:a})}),this._hoveredTargets=[]},_onMouseEnter:function(a){!this._currentTransform&&!this.findTarget(a)&&(this.fire("mouse:over",{target:null,e:a}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(a,u){this.__onOrientationChange&&this.__onOrientationChange(a,u)},_onShake:function(a,u){this.__onShake&&this.__onShake(a,u)},_onLongPress:function(a,u){this.__onLongPress&&this.__onLongPress(a,u)},_onDragOver:function(a){a.preventDefault();var u=this._simpleEventHandler("dragover",a);this._fireEnterLeaveEvents(u,a)},_onDrop:function(a){return this._simpleEventHandler("drop:before",a),this._simpleEventHandler("drop",a)},_onContextMenu:function(a){return this.stopContextMenu&&(a.stopPropagation(),a.preventDefault()),!1},_onDoubleClick:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"dblclick"),this._resetTransformEventData(a)},getPointerId:function(a){var u=a.changedTouches;return u?u[0]&&u[0].identifier:this.enablePointerEvents?a.pointerId:-1},_isMainEvent:function(a){return a.isPrimary===!0?!0:a.isPrimary===!1?!1:a.type==="touchend"&&a.touches.length===0?!0:a.changedTouches?a.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(a){a.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(a)),this.__onMouseDown(a),this._resetTransformEventData();var u=this.upperCanvasEl,l=this._getEventPrefix();e(C.document,"touchend",this._onTouchEnd,s),e(C.document,"touchmove",this._onMouseMove,s),t(u,l+"down",this._onMouseDown)},_onMouseDown:function(a){this.__onMouseDown(a),this._resetTransformEventData();var u=this.upperCanvasEl,l=this._getEventPrefix();t(u,l+"move",this._onMouseMove,s),e(C.document,l+"up",this._onMouseUp),e(C.document,l+"move",this._onMouseMove,s)},_onTouchEnd:function(a){if(!(a.touches.length>0)){this.__onMouseUp(a),this._resetTransformEventData(),this.mainTouchId=null;var u=this._getEventPrefix();t(C.document,"touchend",this._onTouchEnd,s),t(C.document,"touchmove",this._onMouseMove,s);var l=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){e(l.upperCanvasEl,u+"down",l._onMouseDown),l._willAddMouseDown=0},400)}},_onMouseUp:function(a){this.__onMouseUp(a),this._resetTransformEventData();var u=this.upperCanvasEl,l=this._getEventPrefix();this._isMainEvent(a)&&(t(C.document,l+"up",this._onMouseUp),t(C.document,l+"move",this._onMouseMove,s),e(u,l+"move",this._onMouseMove,s))},_onMouseMove:function(a){!this.allowTouchScrolling&&a.preventDefault&&a.preventDefault(),this.__onMouseMove(a)},_onResize:function(){this.calcOffset()},_shouldRender:function(a){var u=this._activeObject;return!!u!=!!a||u&&a&&u!==a?!0:(u&&u.isEditing,!1)},__onMouseUp:function(a){var u,l=this._currentTransform,h=this._groupSelector,f=!1,g=!h||h.left===0&&h.top===0;if(this._cacheTransformEventData(a),u=this._target,this._handleEvent(a,"up:before"),r(a,i)){this.fireRightClick&&this._handleEvent(a,"up",i,g);return}if(r(a,o)){this.fireMiddleClick&&this._handleEvent(a,"up",o,g),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(a);return}if(this._isMainEvent(a)){if(l&&(this._finalizeCurrentTransform(a),f=l.actionPerformed),!g){var p=u===this._activeObject;this._maybeGroupObjects(a),f||(f=this._shouldRender(u)||!p&&u===this._activeObject)}var v,y;if(u){if(v=u._findTargetCorner(this.getPointer(a,!0),C.util.isTouchEvent(a)),u.selectable&&u!==this._activeObject&&u.activeOn==="up")this.setActiveObject(u,a),f=!0;else{var _=u.controls[v],T=_&&_.getMouseUpHandler(a,u,_);T&&(y=this.getPointer(a),T(a,l,y.x,y.y))}u.isMoving=!1}if(l&&(l.target!==u||l.corner!==v)){var P=l.target&&l.target.controls[l.corner],F=P&&P.getMouseUpHandler(a,u,_);y=y||this.getPointer(a),F&&F(a,l,y.x,y.y)}this._setCursorFromEvent(a,u),this._handleEvent(a,"up",n,g),this._groupSelector=null,this._currentTransform=null,u&&(u.__corner=0),f?this.requestRenderAll():g||this.renderTop()}},_simpleEventHandler:function(a,u){var l=this.findTarget(u),h=this.targets,f={e:u,target:l,subTargets:h};if(this.fire(a,f),l&&l.fire(a,f),!h)return l;for(var g=0;g<h.length;g++)h[g].fire(a,f);return l},_handleEvent:function(a,u,l,h){var f=this._target,g=this.targets||[],p={e:a,target:f,subTargets:g,button:l||n,isClick:h||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};u==="up"&&(p.currentTarget=this.findTarget(a),p.currentSubTargets=this.targets),this.fire("mouse:"+u,p),f&&f.fire("mouse"+u,p);for(var v=0;v<g.length;v++)g[v].fire("mouse"+u,p)},_finalizeCurrentTransform:function(a){var u=this._currentTransform,l=u.target,h={e:a,target:l,transform:u,action:u.action};l._scaling&&(l._scaling=!1),l.setCoords(),(u.actionPerformed||this.stateful&&l.hasStateChanged())&&this._fire("modified",h)},_onMouseDownInDrawingMode:function(a){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(a).requestRenderAll();var u=this.getPointer(a);this.freeDrawingBrush.onMouseDown(u,{e:a,pointer:u}),this._handleEvent(a,"down")},_onMouseMoveInDrawingMode:function(a){if(this._isCurrentlyDrawing){var u=this.getPointer(a);this.freeDrawingBrush.onMouseMove(u,{e:a,pointer:u})}this.setCursor(this.freeDrawingCursor),this._handleEvent(a,"move")},_onMouseUpInDrawingMode:function(a){var u=this.getPointer(a);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:a,pointer:u}),this._handleEvent(a,"up")},__onMouseDown:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"down:before");var u=this._target;if(r(a,i)){this.fireRightClick&&this._handleEvent(a,"down",i);return}if(r(a,o)){this.fireMiddleClick&&this._handleEvent(a,"down",o);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(a);return}if(this._isMainEvent(a)&&!this._currentTransform){var l=this._pointer;this._previousPointer=l;var h=this._shouldRender(u),f=this._shouldGroup(a,u);if(this._shouldClearSelection(a,u)?this.discardActiveObject(a):f&&(this._handleGrouping(a,u),u=this._activeObject),this.selection&&(!u||!u.selectable&&!u.isEditing&&u!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),u){var g=u===this._activeObject;u.selectable&&u.activeOn==="down"&&this.setActiveObject(u,a);var p=u._findTargetCorner(this.getPointer(a,!0),C.util.isTouchEvent(a));if(u.__corner=p,u===this._activeObject&&(p||!f)){this._setupCurrentTransform(a,u,g);var v=u.controls[p],l=this.getPointer(a),y=v&&v.getMouseDownHandler(a,u,v);y&&y(a,this._currentTransform,l.x,l.y)}}this._handleEvent(a,"down"),(h||f)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(a){this._resetTransformEventData(),this._pointer=this.getPointer(a,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(a)||null},_beforeTransform:function(a){var u=this._currentTransform;this.stateful&&u.target.saveState(),this.fire("before:transform",{e:a,transform:u})},__onMouseMove:function(a){this._handleEvent(a,"move:before"),this._cacheTransformEventData(a);var u,l;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(a);return}if(this._isMainEvent(a)){var h=this._groupSelector;h?(l=this._absolutePointer,h.left=l.x-h.ex,h.top=l.y-h.ey,this.renderTop()):this._currentTransform?this._transformObject(a):(u=this.findTarget(a)||null,this._setCursorFromEvent(a,u),this._fireOverOutEvents(u,a)),this._handleEvent(a,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(a,u){var l=this._hoveredTarget,h=this._hoveredTargets,f=this.targets,g=Math.max(h.length,f.length);this.fireSyntheticInOutEvents(a,u,{oldTarget:l,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var p=0;p<g;p++)this.fireSyntheticInOutEvents(f[p],u,{oldTarget:h[p],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=a,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(a,u){var l=this._draggedoverTarget,h=this._hoveredTargets,f=this.targets,g=Math.max(h.length,f.length);this.fireSyntheticInOutEvents(a,u,{oldTarget:l,evtOut:"dragleave",evtIn:"dragenter"});for(var p=0;p<g;p++)this.fireSyntheticInOutEvents(f[p],u,{oldTarget:h[p],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=a},fireSyntheticInOutEvents:function(a,u,l){var h,f,g=l.oldTarget,p,v,y=g!==a,_=l.canvasEvtIn,T=l.canvasEvtOut;y&&(h={e:u,target:a,previousTarget:g},f={e:u,target:g,nextTarget:a}),v=a&&y,p=g&&y,p&&(T&&this.fire(T,f),g.fire(l.evtOut,f)),v&&(_&&this.fire(_,h),a.fire(l.evtIn,h))},__onMouseWheel:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"wheel"),this._resetTransformEventData()},_transformObject:function(a){var u=this.getPointer(a),l=this._currentTransform;l.reset=!1,l.shiftKey=a.shiftKey,l.altKey=a[this.centeredKey],this._performTransformAction(a,l,u),l.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(a,u,l){var h=l.x,f=l.y,g=u.action,p=!1,v=u.actionHandler;v&&(p=v(a,u,h,f)),g==="drag"&&p&&(u.target.isMoving=!0,this.setCursor(u.target.moveCursor||this.moveCursor)),u.actionPerformed=u.actionPerformed||p},_fire:C.controlsUtils.fireEvent,_setCursorFromEvent:function(a,u){if(!u)return this.setCursor(this.defaultCursor),!1;var l=u.hoverCursor||this.hoverCursor,h=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,f=(!h||!h.contains(u))&&u._findTargetCorner(this.getPointer(a,!0));f?this.setCursor(this.getCornerCursor(f,u,a)):(u.subTargetCheck&&this.targets.concat().reverse().map(function(g){l=g.hoverCursor||l}),this.setCursor(l))},getCornerCursor:function(a,u,l){var h=u.controls[a];return h.cursorStyleHandler(l,h,u)}})})();(function(){var e=Math.min,t=Math.max;C.util.object.extend(C.Canvas.prototype,{_shouldGroup:function(i,o){var n=this._activeObject;return n&&this._isSelectionKeyPressed(i)&&o&&o.selectable&&this.selection&&(n!==o||n.type==="activeSelection")&&!o.onSelect({e:i})},_handleGrouping:function(i,o){var n=this._activeObject;n.__corner||o===n&&(o=this.findTarget(i,!0),!o||!o.selectable)||(n&&n.type==="activeSelection"?this._updateActiveSelection(o,i):this._createActiveSelection(o,i))},_updateActiveSelection:function(i,o){var n=this._activeObject,s=n._objects.slice(0);n.contains(i)?(n.removeWithUpdate(i),this._hoveredTarget=i,this._hoveredTargets=this.targets.concat(),n.size()===1&&this._setActiveObject(n.item(0),o)):(n.addWithUpdate(i),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(s,o)},_createActiveSelection:function(i,o){var n=this.getActiveObjects(),s=this._createGroup(i);this._hoveredTarget=s,this._setActiveObject(s,o),this._fireSelectionEvents(n,o)},_createGroup:function(i){var o=this._objects,n=o.indexOf(this._activeObject)<o.indexOf(i),s=n?[this._activeObject,i]:[i,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new C.ActiveSelection(s,{canvas:this})},_groupSelectedObjects:function(i){var o=this._collectObjects(i),n;o.length===1?this.setActiveObject(o[0],i):o.length>1&&(n=new C.ActiveSelection(o.reverse(),{canvas:this}),this.setActiveObject(n,i))},_collectObjects:function(i){for(var o=[],n,s=this._groupSelector.ex,r=this._groupSelector.ey,a=s+this._groupSelector.left,u=r+this._groupSelector.top,l=new C.Point(e(s,a),e(r,u)),h=new C.Point(t(s,a),t(r,u)),f=!this.selectionFullyContained,g=s===a&&r===u,p=this._objects.length;p--&&(n=this._objects[p],!(!(!n||!n.selectable||!n.visible)&&(f&&n.intersectsWithRect(l,h,!0)||n.isContainedWithinRect(l,h,!0)||f&&n.containsPoint(l,null,!0)||f&&n.containsPoint(h,null,!0))&&(o.push(n),g))););return o.length>1&&(o=o.filter(function(v){return!v.onSelect({e:i})})),o},_maybeGroupObjects:function(i){this.selection&&this._groupSelector&&this._groupSelectedObjects(i),this.setCursor(this.defaultCursor),this._groupSelector=null}})})();(function(){C.util.object.extend(C.StaticCanvas.prototype,{toDataURL:function(e){e||(e={});var t=e.format||"png",i=e.quality||1,o=(e.multiplier||1)*(e.enableRetinaScaling?this.getRetinaScaling():1),n=this.toCanvasElement(o,e);return C.util.toDataURL(n,t,i)},toCanvasElement:function(e,t){e=e||1,t=t||{};var i=(t.width||this.width)*e,o=(t.height||this.height)*e,n=this.getZoom(),s=this.width,r=this.height,a=n*e,u=this.viewportTransform,l=(u[4]-(t.left||0))*e,h=(u[5]-(t.top||0))*e,f=this.interactive,g=[a,0,0,a,l,h],p=this.enableRetinaScaling,v=C.util.createCanvasElement(),y=this.contextTop;return v.width=i,v.height=o,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=g,this.width=i,this.height=o,this.calcViewportBoundaries(),this.renderCanvas(v.getContext("2d"),this._objects),this.viewportTransform=u,this.width=s,this.height=r,this.calcViewportBoundaries(),this.interactive=f,this.enableRetinaScaling=p,this.contextTop=y,v}})})();C.util.object.extend(C.StaticCanvas.prototype,{loadFromJSON:function(e,t,i){if(e){var o=typeof e=="string"?JSON.parse(e):C.util.object.clone(e),n=this,s=o.clipPath,r=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete o.clipPath,this._enlivenObjects(o.objects,function(a){n.clear(),n._setBgOverlay(o,function(){s?n._enlivenObjects([s],function(u){n.clipPath=u[0],n.__setupCanvas.call(n,o,a,r,t)}):n.__setupCanvas.call(n,o,a,r,t)})},i),this}},__setupCanvas:function(e,t,i,o){var n=this;t.forEach(function(s,r){n.insertAt(s,r)}),this.renderOnAddRemove=i,delete e.objects,delete e.backgroundImage,delete e.overlayImage,delete e.background,delete e.overlay,this._setOptions(e),this.renderAll(),o&&o()},_setBgOverlay:function(e,t){var i={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!e.backgroundImage&&!e.overlayImage&&!e.background&&!e.overlay){t&&t();return}var o=function(){i.backgroundImage&&i.overlayImage&&i.backgroundColor&&i.overlayColor&&t&&t()};this.__setBgOverlay("backgroundImage",e.backgroundImage,i,o),this.__setBgOverlay("overlayImage",e.overlayImage,i,o),this.__setBgOverlay("backgroundColor",e.background,i,o),this.__setBgOverlay("overlayColor",e.overlay,i,o)},__setBgOverlay:function(e,t,i,o){var n=this;if(!t){i[e]=!0,o&&o();return}e==="backgroundImage"||e==="overlayImage"?C.util.enlivenObjects([t],function(s){n[e]=s[0],i[e]=!0,o&&o()}):this["set"+C.util.string.capitalize(e,!0)](t,function(){i[e]=!0,o&&o()})},_enlivenObjects:function(e,t,i){if(!e||e.length===0){t&&t([]);return}C.util.enlivenObjects(e,function(o){t&&t(o)},null,i)},_toDataURL:function(e,t){this.clone(function(i){t(i.toDataURL(e))})},_toDataURLWithMultiplier:function(e,t,i){this.clone(function(o){i(o.toDataURLWithMultiplier(e,t))})},clone:function(e,t){var i=JSON.stringify(this.toJSON(t));this.cloneWithoutData(function(o){o.loadFromJSON(i,function(){e&&e(o)})})},cloneWithoutData:function(e){var t=C.util.createCanvasElement();t.width=this.width,t.height=this.height;var i=new C.Canvas(t);this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,function(){i.renderAll(),e&&e(i)}),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):e&&e(i)}});(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.object.clone,n=t.util.toFixed,s=t.util.string.capitalize,r=t.util.degreesToRadians,a=!t.isLikelyNode,u=2;t.Object||(t.Object=t.util.createClass(t.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:a,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(l){l&&this.setOptions(l)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=t.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(l){var h=t.perfLimitSizeTotal,f=l.width,g=l.height,p=t.maxCacheSideLimit,v=t.minCacheSideLimit;if(f<=p&&g<=p&&f*g<=h)return f<v&&(l.width=v),g<v&&(l.height=v),l;var y=f/g,_=t.util.limitDimsByArea(y,h),T=t.util.capValue,P=T(v,_.x,p),F=T(v,_.y,p);return f>P&&(l.zoomX/=f/P,l.width=P,l.capped=!0),g>F&&(l.zoomY/=g/F,l.height=F,l.capped=!0),l},_getCacheCanvasDimensions:function(){var l=this.getTotalObjectScaling(),h=this._getTransformedDimensions(0,0),f=h.x*l.scaleX/this.scaleX,g=h.y*l.scaleY/this.scaleY;return{width:f+u,height:g+u,zoomX:l.scaleX,zoomY:l.scaleY,x:f,y:g}},_updateCacheCanvas:function(){var l=this.canvas;if(this.noScaleCache&&l&&l._currentTransform){var h=l._currentTransform.target,f=l._currentTransform.action;if(this===h&&f.slice&&f.slice(0,5)==="scale")return!1}var g=this._cacheCanvas,p=this._limitCacheSize(this._getCacheCanvasDimensions()),v=t.minCacheSideLimit,y=p.width,_=p.height,T,P,F=p.zoomX,j=p.zoomY,Z=y!==this.cacheWidth||_!==this.cacheHeight,Q=this.zoomX!==F||this.zoomY!==j,$=Z||Q,tt=0,rt=0,ct=!1;if(Z){var lt=this._cacheCanvas.width,w=this._cacheCanvas.height,k=y>lt||_>w,A=(y<lt*.9||_<w*.9)&&lt>v&&w>v;ct=k||A,k&&!p.capped&&(y>v||_>v)&&(tt=y*.1,rt=_*.1)}return this instanceof t.Text&&this.path&&($=!0,ct=!0,tt+=this.getHeightOfLine(0)*this.zoomX,rt+=this.getHeightOfLine(0)*this.zoomY),$?(ct?(g.width=Math.ceil(y+tt),g.height=Math.ceil(_+rt)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,g.width,g.height)),T=p.x/2,P=p.y/2,this.cacheTranslationX=Math.round(g.width/2-T)+T,this.cacheTranslationY=Math.round(g.height/2-P)+P,this.cacheWidth=y,this.cacheHeight=_,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(F,j),this.zoomX=F,this.zoomY=j,!0):!1},setOptions:function(l){this._setOptions(l),this._initGradient(l.fill,"fill"),this._initGradient(l.stroke,"stroke"),this._initPattern(l.fill,"fill"),this._initPattern(l.stroke,"stroke")},transform:function(l){var h=this.group&&!this.group._transformDone||this.group&&this.canvas&&l===this.canvas.contextTop,f=this.calcTransformMatrix(!h);l.transform(f[0],f[1],f[2],f[3],f[4],f[5])},toObject:function(l){var h=t.Object.NUM_FRACTION_DIGITS,f={type:this.type,version:t.version,originX:this.originX,originY:this.originY,left:n(this.left,h),top:n(this.top,h),width:n(this.width,h),height:n(this.height,h),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,h),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:n(this.strokeMiterLimit,h),scaleX:n(this.scaleX,h),scaleY:n(this.scaleY,h),angle:n(this.angle,h),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,h),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:n(this.skewX,h),skewY:n(this.skewY,h)};return this.clipPath&&!this.clipPath.excludeFromExport&&(f.clipPath=this.clipPath.toObject(l),f.clipPath.inverted=this.clipPath.inverted,f.clipPath.absolutePositioned=this.clipPath.absolutePositioned),t.util.populateWithProperties(this,f,l),this.includeDefaultValues||(f=this._removeDefaultValues(f)),f},toDatalessObject:function(l){return this.toObject(l)},_removeDefaultValues:function(l){var h=t.util.getKlass(l.type).prototype,f=h.stateProperties;return f.forEach(function(g){g==="left"||g==="top"||(l[g]===h[g]&&delete l[g],Array.isArray(l[g])&&Array.isArray(h[g])&&l[g].length===0&&h[g].length===0&&delete l[g])}),l},toString:function(){return"#<fabric."+s(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var l=t.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(l.scaleX),scaleY:Math.abs(l.scaleY)}},getTotalObjectScaling:function(){var l=this.getObjectScaling(),h=l.scaleX,f=l.scaleY;if(this.canvas){var g=this.canvas.getZoom(),p=this.canvas.getRetinaScaling();h*=g*p,f*=g*p}return{scaleX:h,scaleY:f}},getObjectOpacity:function(){var l=this.opacity;return this.group&&(l*=this.group.getObjectOpacity()),l},_set:function(l,h){var f=l==="scaleX"||l==="scaleY",g=this[l]!==h,p=!1;return f&&(h=this._constrainScale(h)),l==="scaleX"&&h<0?(this.flipX=!this.flipX,h*=-1):l==="scaleY"&&h<0?(this.flipY=!this.flipY,h*=-1):l==="shadow"&&h&&!(h instanceof t.Shadow)?h=new t.Shadow(h):l==="dirty"&&this.group&&this.group.set("dirty",h),this[l]=h,g&&(p=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(l)>-1?(this.dirty=!0,p&&this.group.set("dirty",!0)):p&&this.stateProperties.indexOf(l)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:t.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(l){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(l.save(),this._setupCompositeOperation(l),this.drawSelectionBackground(l),this.transform(l),this._setOpacity(l),this._setShadow(l,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(l)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(l),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),l.restore())},renderCache:function(l){l=l||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,l.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(l,h){if(l.save(),h.inverted?l.globalCompositeOperation="destination-out":l.globalCompositeOperation="destination-in",h.absolutePositioned){var f=t.util.invertTransform(this.calcTransformMatrix());l.transform(f[0],f[1],f[2],f[3],f[4],f[5])}h.transform(l),l.scale(1/h.zoomX,1/h.zoomY),l.drawImage(h._cacheCanvas,-h.cacheTranslationX,-h.cacheTranslationY),l.restore()},drawObject:function(l,h){var f=this.fill,g=this.stroke;h?(this.fill="black",this.stroke="",this._setClippingProperties(l)):this._renderBackground(l),this._render(l),this._drawClipPath(l,this.clipPath),this.fill=f,this.stroke=g},_drawClipPath:function(l,h){h&&(h.canvas=this.canvas,h.shouldCache(),h._transformDone=!0,h.renderCache({forClipping:!0}),this.drawClipPathOnCache(l,h))},drawCacheOnCanvas:function(l){l.scale(1/this.zoomX,1/this.zoomY),l.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(l){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!l&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!l){var h=this.cacheWidth/this.zoomX,f=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-h/2,-f/2,h,f)}return!0}return!1},_renderBackground:function(l){if(this.backgroundColor){var h=this._getNonTransformedDimensions();l.fillStyle=this.backgroundColor,l.fillRect(-h.x/2,-h.y/2,h.x,h.y),this._removeShadow(l)}},_setOpacity:function(l){this.group&&!this.group._transformDone?l.globalAlpha=this.getObjectOpacity():l.globalAlpha*=this.opacity},_setStrokeStyles:function(l,h){var f=h.stroke;f&&(l.lineWidth=h.strokeWidth,l.lineCap=h.strokeLineCap,l.lineDashOffset=h.strokeDashOffset,l.lineJoin=h.strokeLineJoin,l.miterLimit=h.strokeMiterLimit,f.toLive?f.gradientUnits==="percentage"||f.gradientTransform||f.patternTransform?this._applyPatternForTransformedGradient(l,f):(l.strokeStyle=f.toLive(l,this),this._applyPatternGradientTransform(l,f)):l.strokeStyle=h.stroke)},_setFillStyles:function(l,h){var f=h.fill;f&&(f.toLive?(l.fillStyle=f.toLive(l,this),this._applyPatternGradientTransform(l,h.fill)):l.fillStyle=f)},_setClippingProperties:function(l){l.globalAlpha=1,l.strokeStyle="transparent",l.fillStyle="#000000"},_setLineDash:function(l,h){!h||h.length===0||(1&h.length&&h.push.apply(h,h),l.setLineDash(h))},_renderControls:function(l,h){var f=this.getViewportTransform(),g=this.calcTransformMatrix(),p,v,y;h=h||{},v=typeof h.hasBorders<"u"?h.hasBorders:this.hasBorders,y=typeof h.hasControls<"u"?h.hasControls:this.hasControls,g=t.util.multiplyTransformMatrices(f,g),p=t.util.qrDecompose(g),l.save(),l.translate(p.translateX,p.translateY),l.lineWidth=1*this.borderScaleFactor,this.group||(l.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(p.angle-=180),l.rotate(r(this.group?p.angle:this.angle)),h.forActiveSelection||this.group?v&&this.drawBordersInGroup(l,p,h):v&&this.drawBorders(l,h),y&&this.drawControls(l,h),l.restore()},_setShadow:function(l){if(this.shadow){var h=this.shadow,f=this.canvas,g,p=f&&f.viewportTransform[0]||1,v=f&&f.viewportTransform[3]||1;h.nonScaling?g={scaleX:1,scaleY:1}:g=this.getObjectScaling(),f&&f._isRetinaScaling()&&(p*=t.devicePixelRatio,v*=t.devicePixelRatio),l.shadowColor=h.color,l.shadowBlur=h.blur*t.browserShadowBlurConstant*(p+v)*(g.scaleX+g.scaleY)/4,l.shadowOffsetX=h.offsetX*p*g.scaleX,l.shadowOffsetY=h.offsetY*v*g.scaleY}},_removeShadow:function(l){this.shadow&&(l.shadowColor="",l.shadowBlur=l.shadowOffsetX=l.shadowOffsetY=0)},_applyPatternGradientTransform:function(l,h){if(!h||!h.toLive)return{offsetX:0,offsetY:0};var f=h.gradientTransform||h.patternTransform,g=-this.width/2+h.offsetX||0,p=-this.height/2+h.offsetY||0;return h.gradientUnits==="percentage"?l.transform(this.width,0,0,this.height,g,p):l.transform(1,0,0,1,g,p),f&&l.transform(f[0],f[1],f[2],f[3],f[4],f[5]),{offsetX:g,offsetY:p}},_renderPaintInOrder:function(l){this.paintFirst==="stroke"?(this._renderStroke(l),this._renderFill(l)):(this._renderFill(l),this._renderStroke(l))},_render:function(){},_renderFill:function(l){this.fill&&(l.save(),this._setFillStyles(l,this),this.fillRule==="evenodd"?l.fill("evenodd"):l.fill(),l.restore())},_renderStroke:function(l){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(l),l.save(),this.strokeUniform&&this.group){var h=this.getObjectScaling();l.scale(1/h.scaleX,1/h.scaleY)}else this.strokeUniform&&l.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(l,this.strokeDashArray),this._setStrokeStyles(l,this),l.stroke(),l.restore()}},_applyPatternForTransformedGradient:function(l,h){var f=this._limitCacheSize(this._getCacheCanvasDimensions()),g=t.util.createCanvasElement(),p,v=this.canvas.getRetinaScaling(),y=f.x/this.scaleX/v,_=f.y/this.scaleY/v;g.width=y,g.height=_,p=g.getContext("2d"),p.beginPath(),p.moveTo(0,0),p.lineTo(y,0),p.lineTo(y,_),p.lineTo(0,_),p.closePath(),p.translate(y/2,_/2),p.scale(f.zoomX/this.scaleX/v,f.zoomY/this.scaleY/v),this._applyPatternGradientTransform(p,h),p.fillStyle=h.toLive(l),p.fill(),l.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),l.scale(v*this.scaleX/f.zoomX,v*this.scaleY/f.zoomY),l.strokeStyle=p.createPattern(g,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var l=t.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",l.scaleX),this.set("scaleY",l.scaleY),this.angle=l.angle,this.skewX=l.skewX,this.skewY=0}},_removeTransformMatrix:function(l){var h=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),h=t.util.transformPoint(h,this.transformMatrix)),this.transformMatrix=null,l&&(this.scaleX*=l.scaleX,this.scaleY*=l.scaleY,this.cropX=l.cropX,this.cropY=l.cropY,h.x+=l.offsetLeft,h.y+=l.offsetTop,this.width=l.width,this.height=l.height),this.setPositionByOrigin(h,"center","center")},clone:function(l,h){var f=this.toObject(h);this.constructor.fromObject?this.constructor.fromObject(f,l):t.Object._fromObject("Object",f,l)},cloneAsImage:function(l,h){var f=this.toCanvasElement(h);return l&&l(new t.Image(f)),this},toCanvasElement:function(l){l||(l={});var h=t.util,f=h.saveObjectTransform(this),g=this.group,p=this.shadow,v=Math.abs,y=(l.multiplier||1)*(l.enableRetinaScaling?t.devicePixelRatio:1);delete this.group,l.withoutTransform&&h.resetObjectTransform(this),l.withoutShadow&&(this.shadow=null);var _=t.util.createCanvasElement(),T=this.getBoundingRect(!0,!0),P=this.shadow,F,j={x:0,y:0},Z,Q,$;P&&(Z=P.blur,P.nonScaling?F={scaleX:1,scaleY:1}:F=this.getObjectScaling(),j.x=2*Math.round(v(P.offsetX)+Z)*v(F.scaleX),j.y=2*Math.round(v(P.offsetY)+Z)*v(F.scaleY)),Q=T.width+j.x,$=T.height+j.y,_.width=Math.ceil(Q),_.height=Math.ceil($);var tt=new t.StaticCanvas(_,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});l.format==="jpeg"&&(tt.backgroundColor="#fff"),this.setPositionByOrigin(new t.Point(tt.width/2,tt.height/2),"center","center");var rt=this.canvas;tt.add(this);var ct=tt.toCanvasElement(y||1,l);return this.shadow=p,this.set("canvas",rt),g&&(this.group=g),this.set(f).setCoords(),tt._objects=[],tt.dispose(),tt=null,ct},toDataURL:function(l){return l||(l={}),t.util.toDataURL(this.toCanvasElement(l),l.format||"png",l.quality||1)},isType:function(l){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===l},complexity:function(){return 1},toJSON:function(l){return this.toObject(l)},rotate:function(l){var h=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return h&&this._setOriginToCenter(),this.set("angle",l),h&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(l,h){h=h||this.canvas.getPointer(l);var f=new t.Point(h.x,h.y),g=this._getLeftTopCoords();return this.angle&&(f=t.util.rotatePoint(f,g,r(-this.angle))),{x:f.x-g.x,y:f.y-g.y}},_setupCompositeOperation:function(l){this.globalCompositeOperation&&(l.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){t.runningAnimations&&t.runningAnimations.cancelByTarget(this)}}),t.util.createAccessors&&t.util.createAccessors(t.Object),i(t.Object.prototype,t.Observable),t.Object.NUM_FRACTION_DIGITS=2,t.Object.ENLIVEN_PROPS=["clipPath"],t.Object._fromObject=function(l,h,f,g){var p=t[l];h=o(h,!0),t.util.enlivenPatterns([h.fill,h.stroke],function(v){typeof v[0]<"u"&&(h.fill=v[0]),typeof v[1]<"u"&&(h.stroke=v[1]),t.util.enlivenObjectEnlivables(h,h,function(){var y=g?new p(h[g],h):new p(h);f&&f(y)})})},t.Object.__uid=0)})(ut);(function(){var e=C.util.degreesToRadians,t={left:-.5,center:0,right:.5},i={top:-.5,center:0,bottom:.5};C.util.object.extend(C.Object.prototype,{translateToGivenOrigin:function(o,n,s,r,a){var u=o.x,l=o.y,h,f,g;return typeof n=="string"?n=t[n]:n-=.5,typeof r=="string"?r=t[r]:r-=.5,h=r-n,typeof s=="string"?s=i[s]:s-=.5,typeof a=="string"?a=i[a]:a-=.5,f=a-s,(h||f)&&(g=this._getTransformedDimensions(),u=o.x+h*g.x,l=o.y+f*g.y),new C.Point(u,l)},translateToCenterPoint:function(o,n,s){var r=this.translateToGivenOrigin(o,n,s,"center","center");return this.angle?C.util.rotatePoint(r,o,e(this.angle)):r},translateToOriginPoint:function(o,n,s){var r=this.translateToGivenOrigin(o,"center","center",n,s);return this.angle?C.util.rotatePoint(r,o,e(this.angle)):r},getCenterPoint:function(){var o=new C.Point(this.left,this.top);return this.translateToCenterPoint(o,this.originX,this.originY)},getPointByOrigin:function(o,n){var s=this.getCenterPoint();return this.translateToOriginPoint(s,o,n)},toLocalPoint:function(o,n,s){var r=this.getCenterPoint(),a,u;return typeof n<"u"&&typeof s<"u"?a=this.translateToGivenOrigin(r,"center","center",n,s):a=new C.Point(this.left,this.top),u=new C.Point(o.x,o.y),this.angle&&(u=C.util.rotatePoint(u,r,-e(this.angle))),u.subtractEquals(a)},setPositionByOrigin:function(o,n,s){var r=this.translateToCenterPoint(o,n,s),a=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",a.x),this.set("top",a.y)},adjustPosition:function(o){var n=e(this.angle),s=this.getScaledWidth(),r=C.util.cos(n)*s,a=C.util.sin(n)*s,u,l;typeof this.originX=="string"?u=t[this.originX]:u=this.originX-.5,typeof o=="string"?l=t[o]:l=o-.5,this.left+=r*(l-u),this.top+=a*(l-u),this.setCoords(),this.originX=o},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var o=this.getCenterPoint();this.originX="center",this.originY="center",this.left=o.x,this.top=o.y},_resetOrigin:function(){var o=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=o.x,this.top=o.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})})();(function(){function e(s){return[new C.Point(s.tl.x,s.tl.y),new C.Point(s.tr.x,s.tr.y),new C.Point(s.br.x,s.br.y),new C.Point(s.bl.x,s.bl.y)]}var t=C.util,i=t.degreesToRadians,o=t.multiplyTransformMatrices,n=t.transformPoint;t.object.extend(C.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(s,r){return r?s?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),s?this.aCoords:this.lineCoords)},getCoords:function(s,r){return e(this._getCoords(s,r))},intersectsWithRect:function(s,r,a,u){var l=this.getCoords(a,u),h=C.Intersection.intersectPolygonRectangle(l,s,r);return h.status==="Intersection"},intersectsWithObject:function(s,r,a){var u=C.Intersection.intersectPolygonPolygon(this.getCoords(r,a),s.getCoords(r,a));return u.status==="Intersection"||s.isContainedWithinObject(this,r,a)||this.isContainedWithinObject(s,r,a)},isContainedWithinObject:function(s,r,a){for(var u=this.getCoords(r,a),l=r?s.aCoords:s.lineCoords,h=0,f=s._getImageLines(l);h<4;h++)if(!s.containsPoint(u[h],f))return!1;return!0},isContainedWithinRect:function(s,r,a,u){var l=this.getBoundingRect(a,u);return l.left>=s.x&&l.left+l.width<=r.x&&l.top>=s.y&&l.top+l.height<=r.y},containsPoint:function(s,h,a,u){var l=this._getCoords(a,u),h=h||this._getImageLines(l),f=this._findCrossPoints(s,h);return f!==0&&f%2===1},isOnScreen:function(s){if(!this.canvas)return!1;var r=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br,u=this.getCoords(!0,s);return u.some(function(l){return l.x<=a.x&&l.x>=r.x&&l.y<=a.y&&l.y>=r.y})||this.intersectsWithRect(r,a,!0,s)?!0:this._containsCenterOfCanvas(r,a,s)},_containsCenterOfCanvas:function(s,r,a){var u={x:(s.x+r.x)/2,y:(s.y+r.y)/2};return!!this.containsPoint(u,null,!0,a)},isPartiallyOnScreen:function(s){if(!this.canvas)return!1;var r=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br;if(this.intersectsWithRect(r,a,!0,s))return!0;var u=this.getCoords(!0,s).every(function(l){return(l.x>=a.x||l.x<=r.x)&&(l.y>=a.y||l.y<=r.y)});return u&&this._containsCenterOfCanvas(r,a,s)},_getImageLines:function(s){var r={topline:{o:s.tl,d:s.tr},rightline:{o:s.tr,d:s.br},bottomline:{o:s.br,d:s.bl},leftline:{o:s.bl,d:s.tl}};return r},_findCrossPoints:function(s,r){var a,u,l,h,f,g=0,p;for(var v in r)if(p=r[v],!(p.o.y<s.y&&p.d.y<s.y)&&!(p.o.y>=s.y&&p.d.y>=s.y)&&(p.o.x===p.d.x&&p.o.x>=s.x?f=p.o.x:(a=0,u=(p.d.y-p.o.y)/(p.d.x-p.o.x),l=s.y-a*s.x,h=p.o.y-u*p.o.x,f=-(l-h)/(a-u)),f>=s.x&&(g+=1),g===2))break;return g},getBoundingRect:function(s,r){var a=this.getCoords(s,r);return t.makeBoundingBoxFromPoints(a)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(s){return Math.abs(s)<this.minScaleLimit?s<0?-this.minScaleLimit:this.minScaleLimit:s===0?1e-4:s},scale:function(s){return this._set("scaleX",s),this._set("scaleY",s),this.setCoords()},scaleToWidth:function(s,r){var a=this.getBoundingRect(r).width/this.getScaledWidth();return this.scale(s/this.width/a)},scaleToHeight:function(s,r){var a=this.getBoundingRect(r).height/this.getScaledHeight();return this.scale(s/this.height/a)},calcLineCoords:function(){var s=this.getViewportTransform(),r=this.padding,a=i(this.angle),u=t.cos(a),l=t.sin(a),h=u*r,f=l*r,g=h+f,p=h-f,v=this.calcACoords(),y={tl:n(v.tl,s),tr:n(v.tr,s),bl:n(v.bl,s),br:n(v.br,s)};return r&&(y.tl.x-=p,y.tl.y-=g,y.tr.x+=g,y.tr.y-=p,y.bl.x-=g,y.bl.y+=p,y.br.x+=p,y.br.y+=g),y},calcOCoords:function(){var s=this._calcRotateMatrix(),r=this._calcTranslateMatrix(),a=this.getViewportTransform(),u=o(a,r),l=o(u,s),l=o(l,[1/a[0],0,0,1/a[3],0,0]),h=this._calculateCurrentDimensions(),f={};return this.forEachControl(function(g,p,v){f[p]=g.positionHandler(h,l,v)}),f},calcACoords:function(){var s=this._calcRotateMatrix(),r=this._calcTranslateMatrix(),a=o(r,s),u=this._getTransformedDimensions(),l=u.x/2,h=u.y/2;return{tl:n({x:-l,y:-h},a),tr:n({x:l,y:-h},a),bl:n({x:-l,y:h},a),br:n({x:l,y:h},a)}},setCoords:function(s){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),s?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return t.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var s=this.getCenterPoint();return[1,0,0,1,s.x,s.y]},transformMatrixKey:function(s){var r="_",a="";return!s&&this.group&&(a=this.group.transformMatrixKey(s)+r),a+this.top+r+this.left+r+this.scaleX+r+this.scaleY+r+this.skewX+r+this.skewY+r+this.angle+r+this.originX+r+this.originY+r+this.width+r+this.height+r+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(s){var r=this.calcOwnMatrix();if(s||!this.group)return r;var a=this.transformMatrixKey(s),u=this.matrixCache||(this.matrixCache={});return u.key===a?u.value:(this.group&&(r=o(this.group.calcTransformMatrix(!1),r)),u.key=a,u.value=r,r)},calcOwnMatrix:function(){var s=this.transformMatrixKey(!0),r=this.ownMatrixCache||(this.ownMatrixCache={});if(r.key===s)return r.value;var a=this._calcTranslateMatrix(),u={angle:this.angle,translateX:a[4],translateY:a[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return r.key=s,r.value=t.composeMatrix(u),r.value},_getNonTransformedDimensions:function(){var s=this.strokeWidth,r=this.width+s,a=this.height+s;return{x:r,y:a}},_getTransformedDimensions:function(s,r){typeof s>"u"&&(s=this.skewX),typeof r>"u"&&(r=this.skewY);var a,u,l,h=s===0&&r===0;if(this.strokeUniform?(u=this.width,l=this.height):(a=this._getNonTransformedDimensions(),u=a.x,l=a.y),h)return this._finalizeDimensions(u*this.scaleX,l*this.scaleY);var f=t.sizeAfterTransform(u,l,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:s,skewY:r});return this._finalizeDimensions(f.x,f.y)},_finalizeDimensions:function(s,r){return this.strokeUniform?{x:s+this.strokeWidth,y:r+this.strokeWidth}:{x:s,y:r}},_calculateCurrentDimensions:function(){var s=this.getViewportTransform(),r=this._getTransformedDimensions(),a=n(r,s,!0);return a.scalarAdd(2*this.padding)}})})();C.util.object.extend(C.Object.prototype,{sendToBack:function(){return this.group?C.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?C.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(e){return this.group?C.StaticCanvas.prototype.sendBackwards.call(this.group,this,e):this.canvas&&this.canvas.sendBackwards(this,e),this},bringForward:function(e){return this.group?C.StaticCanvas.prototype.bringForward.call(this.group,this,e):this.canvas&&this.canvas.bringForward(this,e),this},moveTo:function(e){return this.group&&this.group.type!=="activeSelection"?C.StaticCanvas.prototype.moveTo.call(this.group,this,e):this.canvas&&this.canvas.moveTo(this,e),this}});(function(){function e(i,o){if(o){if(o.toLive)return i+": url(#SVGID_"+o.id+"); ";var n=new C.Color(o),s=i+": "+n.toRgb()+"; ",r=n.getAlpha();return r!==1&&(s+=i+"-opacity: "+r.toString()+"; "),s}else return i+": none; "}var t=C.util.toFixed;C.util.object.extend(C.Object.prototype,{getSvgStyles:function(i){var o=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"none",r=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",u=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",h=typeof this.opacity<"u"?this.opacity:"1",f=this.visible?"":" visibility: hidden;",g=i?"":this.getSvgFilter(),p=e("fill",this.fill),v=e("stroke",this.stroke);return[v,"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",r,"; ","stroke-linejoin: ",u,"; ","stroke-miterlimit: ",l,"; ",p,"fill-rule: ",o,"; ","opacity: ",h,";",g,f].join("")},getSvgSpanStyles:function(i,o){var n="; ",r=i.fontFamily?"font-family: "+(i.fontFamily.indexOf("'")===-1&&i.fontFamily.indexOf('"')===-1?"'"+i.fontFamily+"'":i.fontFamily)+n:"",s=i.strokeWidth?"stroke-width: "+i.strokeWidth+n:"",r=r,a=i.fontSize?"font-size: "+i.fontSize+"px"+n:"",u=i.fontStyle?"font-style: "+i.fontStyle+n:"",l=i.fontWeight?"font-weight: "+i.fontWeight+n:"",h=i.fill?e("fill",i.fill):"",f=i.stroke?e("stroke",i.stroke):"",g=this.getSvgTextDecoration(i),p=i.deltaY?"baseline-shift: "+-i.deltaY+"; ":"";return g&&(g="text-decoration: "+g+n),[f,s,r,a,u,l,g,h,p,o?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(i){return["overline","underline","line-through"].filter(function(o){return i[o.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(i,o){var n=i?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'+C.util.matrixToSVG(n);return s+(o||"")+'" '},_setSVGBg:function(i){if(this.backgroundColor){var o=C.Object.NUM_FRACTION_DIGITS;i.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',t(-this.width/2,o),'" y="',t(-this.height/2,o),'" width="',t(this.width,o),'" height="',t(this.height,o),`"></rect>
`)}},toSVG:function(i){return this._createBaseSVGMarkup(this._toSVG(i),{reviver:i})},toClipPathSVG:function(i){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(i),{reviver:i})},_createBaseClipPathSVGMarkup:function(i,o){o=o||{};var n=o.reviver,s=o.additionalTransform||"",r=[this.getSvgTransform(!0,s),this.getSvgCommons()].join(""),a=i.indexOf("COMMON_PARTS");return i[a]=r,n?n(i.join("")):i.join("")},_createBaseSVGMarkup:function(i,o){o=o||{};var n=o.noStyle,s=o.reviver,r=n?"":'style="'+this.getSvgStyles()+'" ',a=o.withShadow?'style="'+this.getSvgFilter()+'" ':"",u=this.clipPath,l=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",h=u&&u.absolutePositioned,f=this.stroke,g=this.fill,p=this.shadow,v,y=[],_,T=i.indexOf("COMMON_PARTS"),P=o.additionalTransform;return u&&(u.clipPathId="CLIPPATH_"+C.Object.__uid++,_='<clipPath id="'+u.clipPathId+`" >
`+u.toClipPathSVG(s)+`</clipPath>
`),h&&y.push("<g ",a,this.getSvgCommons(),` >
`),y.push("<g ",this.getSvgTransform(!1),h?"":a+this.getSvgCommons(),` >
`),v=[r,l,n?"":this.addPaintOrder()," ",P?'transform="'+P+'" ':""].join(""),i[T]=v,g&&g.toLive&&y.push(g.toSVG(this)),f&&f.toLive&&y.push(f.toSVG(this)),p&&y.push(p.toSVG(this)),u&&y.push(_),y.push(i.join("")),y.push(`</g>
`),h&&y.push(`</g>
`),s?s(y.join("")):y.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})})();(function(){var e=C.util.object.extend,t="stateProperties";function i(n,s,r){var a={},u=!0;r.forEach(function(l){a[l]=n[l]}),e(n[s],a,u)}function o(n,s,r){if(n===s)return!0;if(Array.isArray(n)){if(!Array.isArray(s)||n.length!==s.length)return!1;for(var a=0,u=n.length;a<u;a++)if(!o(n[a],s[a]))return!1;return!0}else if(n&&typeof n=="object"){var l=Object.keys(n),h;if(!s||typeof s!="object"||!r&&l.length!==Object.keys(s).length)return!1;for(var a=0,u=l.length;a<u;a++)if(h=l[a],!(h==="canvas"||h==="group")&&!o(n[h],s[h]))return!1;return!0}}C.util.object.extend(C.Object.prototype,{hasStateChanged:function(n){n=n||t;var s="_"+n;return Object.keys(this[s]).length<this[n].length?!0:!o(this[s],this,!0)},saveState:function(n){var s=n&&n.propertySet||t,r="_"+s;return this[r]?(i(this,r,this[s]),n&&n.stateProperties&&i(this,r,n.stateProperties),this):this.setupState(n)},setupState:function(n){n=n||{};var s=n.propertySet||t;return n.propertySet=s,this["_"+s]={},this.saveState(n),this}})})();(function(){var e=C.util.degreesToRadians;C.util.object.extend(C.Object.prototype,{_findTargetCorner:function(t,i){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var o=t.x,n=t.y,s,r,a=Object.keys(this.oCoords),u=a.length-1,l;for(this.__corner=0;u>=0;u--)if(l=a[u],!!this.isControlVisible(l)&&(r=this._getImageLines(i?this.oCoords[l].touchCorner:this.oCoords[l].corner),s=this._findCrossPoints({x:o,y:n},r),s!==0&&s%2===1))return this.__corner=l,l;return!1},forEachControl:function(t){for(var i in this.controls)t(this.controls[i],i,this)},_setCornerCoords:function(){var t=this.oCoords;for(var i in t){var o=this.controls[i];t[i].corner=o.calcCornerCoords(this.angle,this.cornerSize,t[i].x,t[i].y,!1),t[i].touchCorner=o.calcCornerCoords(this.angle,this.touchCornerSize,t[i].x,t[i].y,!0)}},drawSelectionBackground:function(t){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;t.save();var i=this.getCenterPoint(),o=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return t.translate(i.x,i.y),t.scale(1/n[0],1/n[3]),t.rotate(e(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-o.x/2,-o.y/2,o.x,o.y),t.restore(),this},drawBorders:function(t,i){i=i||{};var o=this._calculateCurrentDimensions(),n=this.borderScaleFactor,s=o.x+n,r=o.y+n,a=typeof i.hasControls<"u"?i.hasControls:this.hasControls,u=!1;return t.save(),t.strokeStyle=i.borderColor||this.borderColor,this._setLineDash(t,i.borderDashArray||this.borderDashArray),t.strokeRect(-s/2,-r/2,s,r),a&&(t.beginPath(),this.forEachControl(function(l,h,f){l.withConnection&&l.getVisibility(f,h)&&(u=!0,t.moveTo(l.x*s,l.y*r),t.lineTo(l.x*s+l.offsetX,l.y*r+l.offsetY))}),u&&t.stroke()),t.restore(),this},drawBordersInGroup:function(t,i,o){o=o||{};var n=C.util.sizeAfterTransform(this.width,this.height,i),s=this.strokeWidth,r=this.strokeUniform,a=this.borderScaleFactor,u=n.x+s*(r?this.canvas.getZoom():i.scaleX)+a,l=n.y+s*(r?this.canvas.getZoom():i.scaleY)+a;return t.save(),this._setLineDash(t,o.borderDashArray||this.borderDashArray),t.strokeStyle=o.borderColor||this.borderColor,t.strokeRect(-u/2,-l/2,u,l),t.restore(),this},drawControls:function(t,i){i=i||{},t.save();var o=this.canvas.getRetinaScaling(),n,s;return t.setTransform(o,0,0,o,0,0),t.strokeStyle=t.fillStyle=i.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=i.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,i.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(n=this.group.calcTransformMatrix()),this.forEachControl(function(r,a,u){s=u.oCoords[a],r.getVisibility(u,a)&&(n&&(s=C.util.transformPoint(s,n)),r.render(t,s.x,s.y,i,u))}),t.restore(),this},isControlVisible:function(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)},setControlVisible:function(t,i){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=i,this},setControlsVisibility:function(t){t||(t={});for(var i in t)this.setControlVisible(i,t[i]);return this},onDeselect:function(){},onSelect:function(){}})})();C.util.object.extend(C.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(e,t){t=t||{};var i=function(){},o=t.onComplete||i,n=t.onChange||i,s=this;return C.util.animate({target:this,startValue:e.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(r){e.set("left",r),s.requestRenderAll(),n()},onComplete:function(){e.setCoords(),o()}})},fxCenterObjectV:function(e,t){t=t||{};var i=function(){},o=t.onComplete||i,n=t.onChange||i,s=this;return C.util.animate({target:this,startValue:e.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(r){e.set("top",r),s.requestRenderAll(),n()},onComplete:function(){e.setCoords(),o()}})},fxRemove:function(e,t){t=t||{};var i=function(){},o=t.onComplete||i,n=t.onChange||i,s=this;return C.util.animate({target:this,startValue:e.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(r){e.set("opacity",r),s.requestRenderAll(),n()},onComplete:function(){s.remove(e),o()}})}});C.util.object.extend(C.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var e=[],t,i,o=[];for(t in arguments[0])e.push(t);for(var n=0,s=e.length;n<s;n++)t=e[n],i=n!==s-1,o.push(this._animate(t,arguments[0][t],arguments[1],i));return o}else return this._animate.apply(this,arguments)},_animate:function(e,t,i,o){var n=this,s;t=t.toString(),i?i=C.util.object.clone(i):i={},~e.indexOf(".")&&(s=e.split("."));var r=n.colorProperties.indexOf(e)>-1||s&&n.colorProperties.indexOf(s[1])>-1,a=s?this.get(s[0])[s[1]]:this.get(e);"from"in i||(i.from=a),r||(~t.indexOf("=")?t=a+parseFloat(t.replace("=","")):t=parseFloat(t));var u={target:this,startValue:i.from,endValue:t,byValue:i.by,easing:i.easing,duration:i.duration,abort:i.abort&&function(l,h,f){return i.abort.call(n,l,h,f)},onChange:function(l,h,f){s?n[s[0]][s[1]]=l:n.set(e,l),!o&&i.onChange&&i.onChange(l,h,f)},onComplete:function(l,h,f){o||(n.setCoords(),i.onComplete&&i.onComplete(l,h,f))}};return r?C.util.animateColor(u.startValue,u.endValue,u.duration,u):C.util.animate(u)}});(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.object.clone,n={x1:1,x2:1,y1:1,y2:1};if(t.Line){t.warn("fabric.Line is already defined");return}t.Line=t.util.createClass(t.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:t.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(r,a){r||(r=[0,0,0,0]),this.callSuper("initialize",a),this.set("x1",r[0]),this.set("y1",r[1]),this.set("x2",r[2]),this.set("y2",r[3]),this._setWidthHeight(a)},_setWidthHeight:function(r){r||(r={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in r?r.left:this._getLeftToOriginX(),this.top="top"in r?r.top:this._getTopToOriginY()},_set:function(r,a){return this.callSuper("_set",r,a),typeof n[r]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:s({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:s({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(r){r.beginPath();var a=this.calcLinePoints();r.moveTo(a.x1,a.y1),r.lineTo(a.x2,a.y2),r.lineWidth=this.strokeWidth;var u=r.strokeStyle;r.strokeStyle=this.stroke||r.fillStyle,this.stroke&&this._renderStroke(r),r.strokeStyle=u},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(r){return i(this.callSuper("toObject",r),this.calcLinePoints())},_getNonTransformedDimensions:function(){var r=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(r.y-=this.strokeWidth),this.height===0&&(r.x-=this.strokeWidth)),r},calcLinePoints:function(){var r=this.x1<=this.x2?-1:1,a=this.y1<=this.y2?-1:1,u=r*this.width*.5,l=a*this.height*.5,h=r*this.width*-.5,f=a*this.height*-.5;return{x1:u,x2:h,y1:l,y2:f}},_toSVG:function(){var r=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',r.x1,'" y1="',r.y1,'" x2="',r.x2,'" y2="',r.y2,`" />
`]}}),t.Line.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),t.Line.fromElement=function(r,a,u){u=u||{};var l=t.parseAttributes(r,t.Line.ATTRIBUTE_NAMES),h=[l.x1||0,l.y1||0,l.x2||0,l.y2||0];a(new t.Line(h,i(l,u)))},t.Line.fromObject=function(r,a){function u(h){delete h.points,a&&a(h)}var l=o(r,!0);l.points=[r.x1,r.y1,r.x2,r.y2],t.Object._fromObject("Line",l,u,"points")};function s(r,a){var u=r.origin,l=r.axis1,h=r.axis2,f=r.dimension,g=a.nearest,p=a.center,v=a.farthest;return function(){switch(this.get(u)){case g:return Math.min(this.get(l),this.get(h));case p:return Math.min(this.get(l),this.get(h))+.5*this.get(f);case v:return Math.max(this.get(l),this.get(h))}}}})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.degreesToRadians;if(t.Circle){t.warn("fabric.Circle is already defined.");return}t.Circle=t.util.createClass(t.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:t.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(n,s){return this.callSuper("_set",n,s),n==="radius"&&this.setRadius(s),this},toObject:function(n){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(n))},_toSVG:function(){var n,s=0,r=0,a=(this.endAngle-this.startAngle)%360;if(a===0)n=["<circle ","COMMON_PARTS",'cx="'+s+'" cy="'+r+'" ','r="',this.radius,`" />
`];else{var u=i(this.startAngle),l=i(this.endAngle),h=this.radius,f=t.util.cos(u)*h,g=t.util.sin(u)*h,p=t.util.cos(l)*h,v=t.util.sin(l)*h,y=a>180?"1":"0";n=['<path d="M '+f+" "+g," A "+h+" "+h," 0 ",+y+" 1"," "+p+" "+v,'" ',"COMMON_PARTS",` />
`]}return n},_render:function(n){n.beginPath(),n.arc(0,0,this.radius,i(this.startAngle),i(this.endAngle),!1),this._renderPaintInOrder(n)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(n){return this.radius=n,this.set("width",n*2).set("height",n*2)}}),t.Circle.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),t.Circle.fromElement=function(n,s){var r=t.parseAttributes(n,t.Circle.ATTRIBUTE_NAMES);if(!o(r))throw new Error("value of `r` attribute is required and can not be negative");r.left=(r.left||0)-r.radius,r.top=(r.top||0)-r.radius,s(new t.Circle(r))};function o(n){return"radius"in n&&n.radius>=0}t.Circle.fromObject=function(n,s){t.Object._fromObject("Circle",n,s)}})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Triangle){t.warn("fabric.Triangle is already defined");return}t.Triangle=t.util.createClass(t.Object,{type:"triangle",width:100,height:100,_render:function(i){var o=this.width/2,n=this.height/2;i.beginPath(),i.moveTo(-o,n),i.lineTo(0,-n),i.lineTo(o,n),i.closePath(),this._renderPaintInOrder(i)},_toSVG:function(){var i=this.width/2,o=this.height/2,n=[-i+" "+o,"0 "+-o,i+" "+o].join(",");return["<polygon ","COMMON_PARTS",'points="',n,'" />']}}),t.Triangle.fromObject=function(i,o){return t.Object._fromObject("Triangle",i,o)}})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=Math.PI*2;if(t.Ellipse){t.warn("fabric.Ellipse is already defined.");return}t.Ellipse=t.util.createClass(t.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this.set("rx",o&&o.rx||0),this.set("ry",o&&o.ry||0)},_set:function(o,n){switch(this.callSuper("_set",o,n),o){case"rx":this.rx=n,this.set("width",n*2);break;case"ry":this.ry=n,this.set("height",n*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(o){o.beginPath(),o.save(),o.transform(1,0,0,this.ry/this.rx,0,0),o.arc(0,0,this.rx,0,i,!1),o.restore(),this._renderPaintInOrder(o)}}),t.Ellipse.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),t.Ellipse.fromElement=function(o,n){var s=t.parseAttributes(o,t.Ellipse.ATTRIBUTE_NAMES);s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,n(new t.Ellipse(s))},t.Ellipse.fromObject=function(o,n){t.Object._fromObject("Ellipse",o,n)}})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend;if(t.Rect){t.warn("fabric.Rect is already defined");return}t.Rect=t.util.createClass(t.Object,{stateProperties:t.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(o){var n=this.rx?Math.min(this.rx,this.width/2):0,s=this.ry?Math.min(this.ry,this.height/2):0,r=this.width,a=this.height,u=-this.width/2,l=-this.height/2,h=n!==0||s!==0,f=1-.5522847498;o.beginPath(),o.moveTo(u+n,l),o.lineTo(u+r-n,l),h&&o.bezierCurveTo(u+r-f*n,l,u+r,l+f*s,u+r,l+s),o.lineTo(u+r,l+a-s),h&&o.bezierCurveTo(u+r,l+a-f*s,u+r-f*n,l+a,u+r-n,l+a),o.lineTo(u+n,l+a),h&&o.bezierCurveTo(u+f*n,l+a,u,l+a-f*s,u,l+a-s),o.lineTo(u,l+s),h&&o.bezierCurveTo(u,l+f*s,u+f*n,l,u+n,l),o.closePath(),this._renderPaintInOrder(o)},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){var o=-this.width/2,n=-this.height/2;return["<rect ","COMMON_PARTS",'x="',o,'" y="',n,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),t.Rect.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),t.Rect.fromElement=function(o,n,s){if(!o)return n(null);s=s||{};var r=t.parseAttributes(o,t.Rect.ATTRIBUTE_NAMES);r.left=r.left||0,r.top=r.top||0,r.height=r.height||0,r.width=r.width||0;var a=new t.Rect(i(s?t.util.object.clone(s):{},r));a.visible=a.visible&&a.width>0&&a.height>0,n(a)},t.Rect.fromObject=function(o,n){return t.Object._fromObject("Rect",o,n)}})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.array.min,n=t.util.array.max,s=t.util.toFixed,r=t.util.projectStrokeOnPoints;if(t.Polyline){t.warn("fabric.Polyline is already defined");return}t.Polyline=t.util.createClass(t.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:t.Object.prototype.cacheProperties.concat("points"),initialize:function(a,u){u=u||{},this.points=a||[],this.callSuper("initialize",u),this._setPositionDimensions(u)},_projectStrokeOnPoints:function(){return r(this.points,this,!0)},_setPositionDimensions:function(a){var u=this._calcDimensions(a),l,h=this.exactBoundingBox?this.strokeWidth:0;this.width=u.width-h,this.height=u.height-h,a.fromSVG||(l=this.translateToGivenOrigin({x:u.left-this.strokeWidth/2+h/2,y:u.top-this.strokeWidth/2+h/2},"left","top",this.originX,this.originY)),typeof a.left>"u"&&(this.left=a.fromSVG?u.left:l.x),typeof a.top>"u"&&(this.top=a.fromSVG?u.top:l.y),this.pathOffset={x:u.left+this.width/2+h/2,y:u.top+this.height/2+h/2}},_calcDimensions:function(){var a=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,u=o(a,"x")||0,l=o(a,"y")||0,h=n(a,"x")||0,f=n(a,"y")||0,g=h-u,p=f-l;return{left:u,top:l,width:g,height:p}},toObject:function(a){return i(this.callSuper("toObject",a),{points:this.points.concat()})},_toSVG:function(){for(var a=[],u=this.pathOffset.x,l=this.pathOffset.y,h=t.Object.NUM_FRACTION_DIGITS,f=0,g=this.points.length;f<g;f++)a.push(s(this.points[f].x-u,h),",",s(this.points[f].y-l,h)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',a.join(""),`" />
`]},commonRender:function(a){var u,l=this.points.length,h=this.pathOffset.x,f=this.pathOffset.y;if(!l||isNaN(this.points[l-1].y))return!1;a.beginPath(),a.moveTo(this.points[0].x-h,this.points[0].y-f);for(var g=0;g<l;g++)u=this.points[g],a.lineTo(u.x-h,u.y-f);return!0},_render:function(a){this.commonRender(a)&&this._renderPaintInOrder(a)},complexity:function(){return this.get("points").length}}),t.Polyline.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polyline.fromElementGenerator=function(a){return function(u,l,h){if(!u)return l(null);h||(h={});var f=t.parsePointsAttribute(u.getAttribute("points")),g=t.parseAttributes(u,t[a].ATTRIBUTE_NAMES);g.fromSVG=!0,l(new t[a](f,i(g,h)))}},t.Polyline.fromElement=t.Polyline.fromElementGenerator("Polyline"),t.Polyline.fromObject=function(a,u){return t.Object._fromObject("Polyline",a,u,"points")}})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.projectStrokeOnPoints;if(t.Polygon){t.warn("fabric.Polygon is already defined");return}t.Polygon=t.util.createClass(t.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return i(this.points,this)},_render:function(o){this.commonRender(o)&&(o.closePath(),this._renderPaintInOrder(o))}}),t.Polygon.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polygon.fromElement=t.Polyline.fromElementGenerator("Polygon"),t.Polygon.fromObject=function(o,n){t.Object._fromObject("Polygon",o,n,"points")}})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.array.min,o=t.util.array.max,n=t.util.object.extend,s=t.util.object.clone,r=t.util.toFixed;if(t.Path){t.warn("fabric.Path is already defined");return}t.Path=t.util.createClass(t.Object,{type:"path",path:null,cacheProperties:t.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:t.Object.prototype.stateProperties.concat("path"),initialize:function(a,u){u=s(u||{}),delete u.path,this.callSuper("initialize",u),this._setPath(a||[],u)},_setPath:function(a,u){this.path=t.util.makePathSimpler(Array.isArray(a)?a:t.util.parsePath(a)),t.Polyline.prototype._setPositionDimensions.call(this,u||{})},_renderPathCommands:function(a){var u,l=0,h=0,f=0,g=0,p=0,v=0,y=-this.pathOffset.x,_=-this.pathOffset.y;a.beginPath();for(var T=0,P=this.path.length;T<P;++T)switch(u=this.path[T],u[0]){case"L":f=u[1],g=u[2],a.lineTo(f+y,g+_);break;case"M":f=u[1],g=u[2],l=f,h=g,a.moveTo(f+y,g+_);break;case"C":f=u[5],g=u[6],p=u[3],v=u[4],a.bezierCurveTo(u[1]+y,u[2]+_,p+y,v+_,f+y,g+_);break;case"Q":a.quadraticCurveTo(u[1]+y,u[2]+_,u[3]+y,u[4]+_),f=u[3],g=u[4],p=u[1],v=u[2];break;case"z":case"Z":f=l,g=h,a.closePath();break}},_render:function(a){this._renderPathCommands(a),this._renderPaintInOrder(a)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){return n(this.callSuper("toObject",a),{path:this.path.map(function(u){return u.slice()})})},toDatalessObject:function(a){var u=this.toObject(["sourcePath"].concat(a));return u.sourcePath&&delete u.path,u},_toSVG:function(){var a=t.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',a,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var a=t.Object.NUM_FRACTION_DIGITS;return" translate("+r(-this.pathOffset.x,a)+", "+r(-this.pathOffset.y,a)+")"},toClipPathSVG:function(a){var u=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:u})},toSVG:function(a){var u=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:u})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var a=[],u=[],l,h=0,f=0,g=0,p=0,v,y=0,_=this.path.length;y<_;++y){switch(l=this.path[y],l[0]){case"L":g=l[1],p=l[2],v=[];break;case"M":g=l[1],p=l[2],h=g,f=p,v=[];break;case"C":v=t.util.getBoundsOfCurve(g,p,l[1],l[2],l[3],l[4],l[5],l[6]),g=l[5],p=l[6];break;case"Q":v=t.util.getBoundsOfCurve(g,p,l[1],l[2],l[1],l[2],l[3],l[4]),g=l[3],p=l[4];break;case"z":case"Z":g=h,p=f;break}v.forEach(function($){a.push($.x),u.push($.y)}),a.push(g),u.push(p)}var T=i(a)||0,P=i(u)||0,F=o(a)||0,j=o(u)||0,Z=F-T,Q=j-P;return{left:T,top:P,width:Z,height:Q}}}),t.Path.fromObject=function(a,u){if(typeof a.sourcePath=="string"){var l=a.sourcePath;t.loadSVGFromURL(l,function(h){var f=h[0];f.setOptions(a),a.clipPath?t.util.enlivenObjects([a.clipPath],function(g){f.clipPath=g[0],u&&u(f)}):u&&u(f)})}else t.Object._fromObject("Path",a,u,"path")},t.Path.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(["d"]),t.Path.fromElement=function(a,u,l){var h=t.parseAttributes(a,t.Path.ATTRIBUTE_NAMES);h.fromSVG=!0,u(new t.Path(h.d,n(h,l)))}})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.array.min,o=t.util.array.max;t.Group||(t.Group=t.util.createClass(t.Object,t.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(n,s,r){s=s||{},this._objects=[],r&&this.callSuper("initialize",s),this._objects=n||[];for(var a=this._objects.length;a--;)this._objects[a].group=this;if(r)this._updateObjectsACoords();else{var u=s&&s.centerPoint;s.originX!==void 0&&(this.originX=s.originX),s.originY!==void 0&&(this.originY=s.originY),u||this._calcBounds(),this._updateObjectsCoords(u),delete s.centerPoint,this.callSuper("initialize",s)}this.setCoords()},_updateObjectsACoords:function(){for(var n=!0,s=this._objects.length;s--;)this._objects[s].setCoords(n)},_updateObjectsCoords:function(s){for(var s=s||this.getCenterPoint(),r=this._objects.length;r--;)this._updateObjectCoords(this._objects[r],s)},_updateObjectCoords:function(n,s){var r=n.left,a=n.top,u=!0;n.set({left:r-s.x,top:a-s.y}),n.group=this,n.setCoords(u)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(n){var s=!!this.group;return this._restoreObjectsState(),t.util.resetObjectTransform(this),n&&(s&&t.util.removeTransformFromObject(n,this.group.calcTransformMatrix()),this._objects.push(n),n.group=this,n._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,s?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(n){return this._restoreObjectsState(),t.util.resetObjectTransform(this),this.remove(n),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(n){this.dirty=!0,n.group=this,n._set("canvas",this.canvas)},_onObjectRemoved:function(n){this.dirty=!0,delete n.group},_set:function(n,s){var r=this._objects.length;if(this.useSetOnGroup)for(;r--;)this._objects[r].setOnGroup(n,s);if(n==="canvas")for(;r--;)this._objects[r]._set(n,s);t.Object.prototype._set.call(this,n,s)},toObject:function(n){var s=this.includeDefaultValues,r=this._objects.filter(function(u){return!u.excludeFromExport}).map(function(u){var l=u.includeDefaultValues;u.includeDefaultValues=s;var h=u.toObject(n);return u.includeDefaultValues=l,h}),a=t.Object.prototype.toObject.call(this,n);return a.objects=r,a},toDatalessObject:function(n){var s,r=this.sourcePath;if(r)s=r;else{var a=this.includeDefaultValues;s=this._objects.map(function(l){var h=l.includeDefaultValues;l.includeDefaultValues=a;var f=l.toDatalessObject(n);return l.includeDefaultValues=h,f})}var u=t.Object.prototype.toDatalessObject.call(this,n);return u.objects=s,u},render:function(n){this._transformDone=!0,this.callSuper("render",n),this._transformDone=!1},shouldCache:function(){var n=t.Object.prototype.shouldCache.call(this);if(n){for(var s=0,r=this._objects.length;s<r;s++)if(this._objects[s].willDrawShadow())return this.ownCaching=!1,!1}return n},willDrawShadow:function(){if(t.Object.prototype.willDrawShadow.call(this))return!0;for(var n=0,s=this._objects.length;n<s;n++)if(this._objects[n].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(n){for(var s=0,r=this._objects.length;s<r;s++)this._objects[s].render(n);this._drawClipPath(n,this.clipPath)},isCacheDirty:function(n){if(this.callSuper("isCacheDirty",n))return!0;if(!this.statefullCache)return!1;for(var s=0,r=this._objects.length;s<r;s++)if(this._objects[s].isCacheDirty(!0)){if(this._cacheCanvas){var a=this.cacheWidth/this.zoomX,u=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-a/2,-u/2,a,u)}return!0}return!1},_restoreObjectsState:function(){var n=this.calcOwnMatrix();return this._objects.forEach(function(s){t.util.addTransformToObject(s,n),delete s.group,s.setCoords()}),this},destroy:function(){return this._objects.forEach(function(n){n.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(n){n.dispose&&n.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var n=this._objects,s=this.canvas;this._objects=[];var r=this.toObject();delete r.objects;var a=new t.ActiveSelection([]);return a.set(r),a.type="activeSelection",s.remove(this),n.forEach(function(u){u.group=a,u.dirty=!0,s.add(u)}),a.canvas=s,a._objects=n,s._activeObject=a,a.setCoords(),a}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var n=!0;return this.forEachObject(function(s){s.setCoords(n)}),this},_calcBounds:function(n){for(var s=[],r=[],a,u,l,h=["tr","br","bl","tl"],f=0,g=this._objects.length,p,v=h.length;f<g;++f){for(a=this._objects[f],l=a.calcACoords(),p=0;p<v;p++)u=h[p],s.push(l[u].x),r.push(l[u].y);a.aCoords=l}this._getBounds(s,r,n)},_getBounds:function(n,s,r){var a=new t.Point(i(n),i(s)),u=new t.Point(o(n),o(s)),l=a.y||0,h=a.x||0,f=u.x-a.x||0,g=u.y-a.y||0;this.width=f,this.height=g,r||this.setPositionByOrigin({x:h,y:l},"left","top")},_toSVG:function(n){for(var s=["<g ","COMMON_PARTS",` >
`],r=0,a=this._objects.length;r<a;r++)s.push("		",this._objects[r].toSVG(n));return s.push(`</g>
`),s},getSvgStyles:function(){var n=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",s=this.visible?"":" visibility: hidden;";return[n,this.getSvgFilter(),s].join("")},toClipPathSVG:function(n){for(var s=[],r=0,a=this._objects.length;r<a;r++)s.push("	",this._objects[r].toClipPathSVG(n));return this._createBaseClipPathSVGMarkup(s,{reviver:n})}}),t.Group.fromObject=function(n,s){var r=n.objects,a=t.util.object.clone(n,!0);if(delete a.objects,typeof r=="string"){t.loadSVGFromURL(r,function(u){var l=t.util.groupSVGElements(u,n,r),h=a.clipPath;delete a.clipPath,l.set(a),h?t.util.enlivenObjects([h],function(f){l.clipPath=f[0],s&&s(l)}):s&&s(l)});return}t.util.enlivenObjects(r,function(u){t.util.enlivenObjectEnlivables(n,a,function(){s&&s(new t.Group(u,a,!0))})})})})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={});t.ActiveSelection||(t.ActiveSelection=t.util.createClass(t.Group,{type:"activeSelection",initialize:function(i,o){o=o||{},this._objects=i||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;o.originX&&(this.originX=o.originX),o.originY&&(this.originY=o.originY),this._calcBounds(),this._updateObjectsCoords(),t.Object.prototype.initialize.call(this,o),this.setCoords()},toGroup:function(){var i=this._objects.concat();this._objects=[];var o=t.Object.prototype.toObject.call(this),n=new t.Group([]);if(delete o.type,n.set(o),i.forEach(function(r){r.canvas.remove(r),r.group=n}),n._objects=i,!this.canvas)return n;var s=this.canvas;return s.add(n),s._activeObject=n,n.setCoords(),n},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(i,o,n){i.save(),i.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",i,o),n=n||{},typeof n.hasControls>"u"&&(n.hasControls=!1),n.forActiveSelection=!0;for(var s=0,r=this._objects.length;s<r;s++)this._objects[s]._renderControls(i,n);i.restore()}}),t.ActiveSelection.fromObject=function(i,o){t.util.enlivenObjects(i.objects,function(n){delete i.objects,o&&o(new t.ActiveSelection(n,i,!0))})})})(ut);(function(e){"use strict";var t=C.util.object.extend;if(e.fabric||(e.fabric={}),e.fabric.Image){C.warn("fabric.Image is already defined.");return}C.Image=C.util.createClass(C.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:C.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:C.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(i,o){o||(o={}),this.filters=[],this.cacheKey="texture"+C.Object.__uid++,this.callSuper("initialize",o),this._initElement(i,o)},getElement:function(){return this._element||{}},setElement:function(i,o){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=i,this._originalElement=i,this._initConfig(o),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(i){var o=C.filterBackend;o&&o.evictCachesForKey&&o.evictCachesForKey(i)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(i){C.util.cleanUpJsdomNode(this[i]),this[i]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var i=this.getElement();return{width:i.naturalWidth||i.width,height:i.naturalHeight||i.height}},_stroke:function(i){if(!(!this.stroke||this.strokeWidth===0)){var o=this.width/2,n=this.height/2;i.beginPath(),i.moveTo(-o,-n),i.lineTo(o,-n),i.lineTo(o,n),i.lineTo(-o,n),i.lineTo(-o,-n),i.closePath()}},toObject:function(i){var o=[];this.filters.forEach(function(s){s&&o.push(s.toObject())});var n=t(this.callSuper("toObject",["cropX","cropY"].concat(i)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:o});return this.resizeFilter&&(n.resizeFilter=this.resizeFilter.toObject()),n},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var i=[],o=[],n,s=this._element,r=-this.width/2,a=-this.height/2,u="",l="";if(!s)return[];if(this.hasCrop()){var h=C.Object.__uid++;i.push('<clipPath id="imageCrop_'+h+`">
`,'	<rect x="'+r+'" y="'+a+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),u=' clip-path="url(#imageCrop_'+h+')" '}if(this.imageSmoothing||(l='" image-rendering="optimizeSpeed'),o.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',r-this.cropX,'" y="',a-this.cropY,'" width="',s.width||s.naturalWidth,'" height="',s.height||s.height,l,'"',u,`></image>
`),this.stroke||this.strokeDashArray){var f=this.fill;this.fill=null,n=["	<rect ",'x="',r,'" y="',a,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=f}return this.paintFirst!=="fill"?i=i.concat(n,o):i=i.concat(o,n),i},getSrc:function(i){var o=i?this._element:this._originalElement;return o?o.toDataURL?o.toDataURL():this.srcFromAttribute?o.getAttribute("src"):o.src:this.src||""},setSrc:function(i,o,n){return C.util.loadImage(i,function(s,r){this.setElement(s,n),this._setWidthHeight(),o&&o(this,r)},this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var i=this.resizeFilter,o=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.scaleX,r=n.scaleY,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!i||s>o&&r>o){this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,this._lastScaleY=r;return}C.filterBackend||(C.filterBackend=C.initFilterBackend());var u=C.util.createCanvasElement(),l=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,h=a.width,f=a.height;u.width=h,u.height=f,this._element=u,this._lastScaleX=i.scaleX=s,this._lastScaleY=i.scaleY=r,C.filterBackend.applyFilters([i],a,h,f,this._element,l),this._filterScalingX=u.width/this._originalElement.width,this._filterScalingY=u.height/this._originalElement.height},applyFilters:function(i){if(i=i||this.filters||[],i=i.filter(function(a){return a&&!a.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),i.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var o=this._originalElement,n=o.naturalWidth||o.width,s=o.naturalHeight||o.height;if(this._element===this._originalElement){var r=C.util.createCanvasElement();r.width=n,r.height=s,this._element=r,this._filteredEl=r}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1;return C.filterBackend||(C.filterBackend=C.initFilterBackend()),C.filterBackend.applyFilters(i,this._originalElement,n,s,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(i){C.util.setImageSmoothing(i,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(i),this._renderPaintInOrder(i)},drawCacheOnCanvas:function(i){C.util.setImageSmoothing(i,this.imageSmoothing),C.Object.prototype.drawCacheOnCanvas.call(this,i)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(i){var o=this._element;if(o){var n=this._filterScalingX,s=this._filterScalingY,r=this.width,a=this.height,u=Math.min,l=Math.max,h=l(this.cropX,0),f=l(this.cropY,0),g=o.naturalWidth||o.width,p=o.naturalHeight||o.height,v=h*n,y=f*s,_=u(r*n,g-v),T=u(a*s,p-y),P=-r/2,F=-a/2,j=u(r,g/n-h),Z=u(a,p/s-f);o&&i.drawImage(o,v,y,_,T,P,F,j,Z)}},_needsResize:function(){var i=this.getTotalObjectScaling();return i.scaleX!==this._lastScaleX||i.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(i,o){this.setElement(C.util.getById(i),o),C.util.addClass(this.getElement(),C.Image.CSS_CANVAS)},_initConfig:function(i){i||(i={}),this.setOptions(i),this._setWidthHeight(i)},_initFilters:function(i,o){i&&i.length?C.util.enlivenObjects(i,function(n){o&&o(n)},"fabric.Image.filters"):o&&o()},_setWidthHeight:function(i){i||(i={});var o=this.getElement();this.width=i.width||o.naturalWidth||o.width||0,this.height=i.height||o.naturalHeight||o.height||0},parsePreserveAspectRatioAttribute:function(){var i=C.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),o=this._element.width,n=this._element.height,s=1,r=1,a=0,u=0,l=0,h=0,f,g=this.width,p=this.height,v={width:g,height:p};return i&&(i.alignX!=="none"||i.alignY!=="none")?(i.meetOrSlice==="meet"&&(s=r=C.util.findScaleToFit(this._element,v),f=(g-o*s)/2,i.alignX==="Min"&&(a=-f),i.alignX==="Max"&&(a=f),f=(p-n*r)/2,i.alignY==="Min"&&(u=-f),i.alignY==="Max"&&(u=f)),i.meetOrSlice==="slice"&&(s=r=C.util.findScaleToCover(this._element,v),f=o-g/s,i.alignX==="Mid"&&(l=f/2),i.alignX==="Max"&&(l=f),f=n-p/r,i.alignY==="Mid"&&(h=f/2),i.alignY==="Max"&&(h=f),o=g/s,n=p/r)):(s=g/o,r=p/n),{width:o,height:n,scaleX:s,scaleY:r,offsetLeft:a,offsetTop:u,cropX:l,cropY:h}}}),C.Image.CSS_CANVAS="canvas-img",C.Image.prototype.getSvgSrc=C.Image.prototype.getSrc,C.Image.fromObject=function(i,o){var n=C.util.object.clone(i);C.util.loadImage(n.src,function(s,r){if(r){o&&o(null,!0);return}C.Image.prototype._initFilters.call(n,n.filters,function(a){n.filters=a||[],C.Image.prototype._initFilters.call(n,[n.resizeFilter],function(u){n.resizeFilter=u[0],C.util.enlivenObjectEnlivables(n,n,function(){var l=new C.Image(s,n);o(l,!1)})})})},null,n.crossOrigin)},C.Image.fromURL=function(i,o,n){C.util.loadImage(i,function(s,r){o&&o(new C.Image(s,n),r)},null,n&&n.crossOrigin)},C.Image.ATTRIBUTE_NAMES=C.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),C.Image.fromElement=function(i,o,n){var s=C.parseAttributes(i,C.Image.ATTRIBUTE_NAMES);C.Image.fromURL(s["xlink:href"],o,t(n?C.util.object.clone(n):{},s))}})(ut);C.util.object.extend(C.Object.prototype,{_getAngleValueForStraighten:function(){var e=this.angle%360;return e>0?Math.round((e-1)/90)*90:Math.round(e/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(e){e=e||{};var t=function(){},i=e.onComplete||t,o=e.onChange||t,n=this;return C.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(s){n.rotate(s),o()},onComplete:function(){n.setCoords(),i()}})}});C.util.object.extend(C.StaticCanvas.prototype,{straightenObject:function(e){return e.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(e){return e.fxStraighten({onChange:this.requestRenderAllBound})}});(function(){"use strict";function e(i,o){var n="precision "+o+` float;
void main(){}`,s=i.createShader(i.FRAGMENT_SHADER);return i.shaderSource(s,n),i.compileShader(s),!!i.getShaderParameter(s,i.COMPILE_STATUS)}C.isWebglSupported=function(i){if(C.isLikelyNode)return!1;i=i||C.WebglFilterBackend.prototype.tileSize;var o=document.createElement("canvas"),n=o.getContext("webgl")||o.getContext("experimental-webgl"),s=!1;if(n){C.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),s=C.maxTextureSize>=i;for(var r=["highp","mediump","lowp"],a=0;a<3;a++)if(e(n,r[a])){C.webGlPrecision=r[a];break}}return this.isSupported=s,s},C.WebglFilterBackend=t;function t(i){i&&i.tileSize&&(this.tileSize=i.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}t.prototype={tileSize:2048,resources:{},setupGLContext:function(i,o){this.dispose(),this.createWebGLCanvas(i,o),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(i,o)},chooseFastestCopyGLTo2DMethod:function(i,o){var n=typeof window.performance<"u",s;try{new ImageData(1,1),s=!0}catch{s=!1}var r=typeof ArrayBuffer<"u",a=typeof Uint8ClampedArray<"u";if(n&&s&&r&&a){var u=C.util.createCanvasElement(),l=new ArrayBuffer(i*o*4);if(C.forceGLPutImageData){this.imageBuffer=l,this.copyGLTo2D=Bu;return}var h={imageBuffer:l,destinationWidth:i,destinationHeight:o,targetCanvas:u},f,g,p;u.width=i,u.height=o,f=window.performance.now(),Ru.call(h,this.gl,h),g=window.performance.now()-f,f=window.performance.now(),Bu.call(h,this.gl,h),p=window.performance.now()-f,g>p?(this.imageBuffer=l,this.copyGLTo2D=Bu):this.copyGLTo2D=Ru}},createWebGLCanvas:function(i,o){var n=C.util.createCanvasElement();n.width=i,n.height=o;var s={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},r=n.getContext("webgl",s);r||(r=n.getContext("experimental-webgl",s)),r&&(r.clearColor(0,0,0,0),this.canvas=n,this.gl=r)},applyFilters:function(i,o,n,s,r,a){var u=this.gl,l;a&&(l=this.getCachedTexture(a,o));var h={originalWidth:o.width||o.originalWidth,originalHeight:o.height||o.originalHeight,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:u,sourceTexture:this.createTexture(u,n,s,!l&&o),targetTexture:this.createTexture(u,n,s),originalTexture:l||this.createTexture(u,n,s,!l&&o),passes:i.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:r},f=u.createFramebuffer();return u.bindFramebuffer(u.FRAMEBUFFER,f),i.forEach(function(g){g&&g.applyTo(h)}),Jx(h),this.copyGLTo2D(u,h),u.bindTexture(u.TEXTURE_2D,null),u.deleteTexture(h.sourceTexture),u.deleteTexture(h.targetTexture),u.deleteFramebuffer(f),r.getContext("2d").setTransform(1,0,0,1,0,0),h},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(i,o,n,s){var r=i.createTexture();return i.bindTexture(i.TEXTURE_2D,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),s?i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,s):i.texImage2D(i.TEXTURE_2D,0,i.RGBA,o,n,0,i.RGBA,i.UNSIGNED_BYTE,null),r},getCachedTexture:function(i,o){if(this.textureCache[i])return this.textureCache[i];var n=this.createTexture(this.gl,o.width,o.height,o);return this.textureCache[i]=n,n},evictCachesForKey:function(i){this.textureCache[i]&&(this.gl.deleteTexture(this.textureCache[i]),delete this.textureCache[i])},copyGLTo2D:Ru,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var i=this.gl,o={renderer:"",vendor:""};if(!i)return o;var n=i.getExtension("WEBGL_debug_renderer_info");if(n){var s=i.getParameter(n.UNMASKED_RENDERER_WEBGL),r=i.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(o.renderer=s.toLowerCase()),r&&(o.vendor=r.toLowerCase())}return this.gpuInfo=o,o}}})();function Jx(e){var t=e.targetCanvas,i=t.width,o=t.height,n=e.destinationWidth,s=e.destinationHeight;(i!==n||o!==s)&&(t.width=n,t.height=s)}function Ru(e,t){var i=e.canvas,o=t.targetCanvas,n=o.getContext("2d");n.translate(0,o.height),n.scale(1,-1);var s=i.height-o.height;n.drawImage(i,0,s,o.width,o.height,0,0,o.width,o.height)}function Bu(e,t){var i=t.targetCanvas,o=i.getContext("2d"),n=t.destinationWidth,s=t.destinationHeight,r=n*s*4,a=new Uint8Array(this.imageBuffer,0,r),u=new Uint8ClampedArray(this.imageBuffer,0,r);e.readPixels(0,0,n,s,e.RGBA,e.UNSIGNED_BYTE,a);var l=new ImageData(u,n,s);o.putImageData(l,0,0)}(function(){"use strict";var e=function(){};C.Canvas2dFilterBackend=t;function t(){}t.prototype={evictCachesForKey:e,dispose:e,clearWebGLCaches:e,resources:{},applyFilters:function(i,o,n,s,r){var a=r.getContext("2d");a.drawImage(o,0,0,n,s);var u=a.getImageData(0,0,n,s),l=a.getImageData(0,0,n,s),h={sourceWidth:n,sourceHeight:s,imageData:u,originalEl:o,originalImageData:l,canvasEl:r,ctx:a,filterBackend:this};return i.forEach(function(f){f.applyTo(h)}),(h.imageData.width!==n||h.imageData.height!==s)&&(r.width=h.imageData.width,r.height=h.imageData.height),a.putImageData(h.imageData,0,0),h}}})();C.Image=C.Image||{};C.Image.filters=C.Image.filters||{};C.Image.filters.BaseFilter=C.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(e){e&&this.setOptions(e)},setOptions:function(e){for(var t in e)this[t]=e[t]},createProgram:function(e,t,i){t=t||this.fragmentSource,i=i||this.vertexSource,C.webGlPrecision!=="highp"&&(t=t.replace(/precision highp float/g,"precision "+C.webGlPrecision+" float"));var o=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(o,i),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+e.getShaderInfoLog(o));var n=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+e.getShaderInfoLog(n));var s=e.createProgram();if(e.attachShader(s,o),e.attachShader(s,n),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+e.getProgramInfoLog(s));var r=this.getAttributeLocations(e,s),a=this.getUniformLocations(e,s)||{};return a.uStepW=e.getUniformLocation(s,"uStepW"),a.uStepH=e.getUniformLocation(s,"uStepH"),{program:s,attributeLocations:r,uniformLocations:a}},getAttributeLocations:function(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(e,t,i){var o=t.aPosition,n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW)},_setupFrameBuffer:function(e){var t=e.context,i,o;e.passes>1?(i=e.destinationWidth,o=e.destinationHeight,(e.sourceWidth!==i||e.sourceHeight!==o)&&(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,i,o)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)):(t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish())},_swapTextures:function(e){e.passes--,e.pass++;var t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t},isNeutralState:function(){var e=this.mainParameter,t=C.Image.filters[this.type].prototype;if(e)if(Array.isArray(t[e])){for(var i=t[e].length;i--;)if(this[e][i]!==t[e][i])return!1;return!0}else return t[e]===this[e];else return!1},applyTo:function(e){e.webgl?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)},retrieveShader:function(e){return e.programCache.hasOwnProperty(this.type)||(e.programCache[this.type]=this.createProgram(e.context)),e.programCache[this.type]},applyToWebGL:function(e){var t=e.context,i=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(i.program),this.sendAttributeData(t,i.attributeLocations,e.aPosition),t.uniform1f(i.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(i.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,i.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(e,t,i){e.activeTexture(i),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)},unbindAdditionalTexture:function(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(e){this[this.mainParameter]=e},sendUniformData:function(){},createHelpLayer:function(e){if(!e.helpLayer){var t=document.createElement("canvas");t.width=e.sourceWidth,t.height=e.sourceHeight,e.helpLayer=t}},toObject:function(){var e={type:this.type},t=this.mainParameter;return t&&(e[t]=this[t]),e},toJSON:function(){return this.toObject()}});C.Image.filters.BaseFilter.fromObject=function(e,t){var i=new C.Image.filters[e.type](e);return t&&t(i),i};(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.ColorMatrix=o(i.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(n){this.callSuper("initialize",n),this.matrix=this.matrix.slice(0)},applyTo2d:function(n){var s=n.imageData,r=s.data,a=r.length,u=this.matrix,l,h,f,g,p,v=this.colorsOnly;for(p=0;p<a;p+=4)l=r[p],h=r[p+1],f=r[p+2],v?(r[p]=l*u[0]+h*u[1]+f*u[2]+u[4]*255,r[p+1]=l*u[5]+h*u[6]+f*u[7]+u[9]*255,r[p+2]=l*u[10]+h*u[11]+f*u[12]+u[14]*255):(g=r[p+3],r[p]=l*u[0]+h*u[1]+f*u[2]+g*u[3]+u[4]*255,r[p+1]=l*u[5]+h*u[6]+f*u[7]+g*u[8]+u[9]*255,r[p+2]=l*u[10]+h*u[11]+f*u[12]+g*u[13]+u[14]*255,r[p+3]=l*u[15]+h*u[16]+f*u[17]+g*u[18]+u[19]*255)},getUniformLocations:function(n,s){return{uColorMatrix:n.getUniformLocation(s,"uColorMatrix"),uConstants:n.getUniformLocation(s,"uConstants")}},sendUniformData:function(n,s){var r=this.matrix,a=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],u=[r[4],r[9],r[14],r[19]];n.uniformMatrix4fv(s.uColorMatrix,!1,a),n.uniform4fv(s.uConstants,u)}}),t.Image.filters.ColorMatrix.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Brightness=o(i.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(n){if(this.brightness!==0){var s=n.imageData,r=s.data,a,u=r.length,l=Math.round(this.brightness*255);for(a=0;a<u;a+=4)r[a]=r[a]+l,r[a+1]=r[a+1]+l,r[a+2]=r[a+2]+l}},getUniformLocations:function(n,s){return{uBrightness:n.getUniformLocation(s,"uBrightness")}},sendUniformData:function(n,s){n.uniform1f(s.uBrightness,this.brightness)}}),t.Image.filters.Brightness.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.Image.filters,n=t.util.createClass;o.Convolute=n(o.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(s){var r=Math.sqrt(this.matrix.length),a=this.type+"_"+r+"_"+(this.opaque?1:0),u=this.fragmentSource[a];return s.programCache.hasOwnProperty(a)||(s.programCache[a]=this.createProgram(s.context,u)),s.programCache[a]},applyTo2d:function(s){var r=s.imageData,a=r.data,u=this.matrix,l=Math.round(Math.sqrt(u.length)),h=Math.floor(l/2),f=r.width,g=r.height,p=s.ctx.createImageData(f,g),v=p.data,y=this.opaque?1:0,_,T,P,F,j,Z,Q,$,tt,rt,ct,lt,w;for(ct=0;ct<g;ct++)for(rt=0;rt<f;rt++){for(j=(ct*f+rt)*4,_=0,T=0,P=0,F=0,w=0;w<l;w++)for(lt=0;lt<l;lt++)Q=ct+w-h,Z=rt+lt-h,!(Q<0||Q>=g||Z<0||Z>=f)&&($=(Q*f+Z)*4,tt=u[w*l+lt],_+=a[$]*tt,T+=a[$+1]*tt,P+=a[$+2]*tt,y||(F+=a[$+3]*tt));v[j]=_,v[j+1]=T,v[j+2]=P,y?v[j+3]=a[j+3]:v[j+3]=F}s.imageData=p},getUniformLocations:function(s,r){return{uMatrix:s.getUniformLocation(r,"uMatrix"),uOpaque:s.getUniformLocation(r,"uOpaque"),uHalfSize:s.getUniformLocation(r,"uHalfSize"),uSize:s.getUniformLocation(r,"uSize")}},sendUniformData:function(s,r){s.uniform1fv(r.uMatrix,this.matrix)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),t.Image.filters.Convolute.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Grayscale=o(i.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(n){var s=n.imageData,r=s.data,a,u=r.length,l,h=this.mode;for(a=0;a<u;a+=4)h==="average"?l=(r[a]+r[a+1]+r[a+2])/3:h==="lightness"?l=(Math.min(r[a],r[a+1],r[a+2])+Math.max(r[a],r[a+1],r[a+2]))/2:h==="luminosity"&&(l=.21*r[a]+.72*r[a+1]+.07*r[a+2]),r[a]=l,r[a+1]=l,r[a+2]=l},retrieveShader:function(n){var s=this.type+"_"+this.mode;if(!n.programCache.hasOwnProperty(s)){var r=this.fragmentSource[this.mode];n.programCache[s]=this.createProgram(n.context,r)}return n.programCache[s]},getUniformLocations:function(n,s){return{uMode:n.getUniformLocation(s,"uMode")}},sendUniformData:function(n,s){var r=1;n.uniform1i(s.uMode,r)},isNeutralState:function(){return!1}}),t.Image.filters.Grayscale.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Invert=o(i.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(n){var s=n.imageData,r=s.data,a,u=r.length;for(a=0;a<u;a+=4)r[a]=255-r[a],r[a+1]=255-r[a+1],r[a+2]=255-r[a+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(n,s){return{uInvert:n.getUniformLocation(s,"uInvert")}},sendUniformData:function(n,s){n.uniform1i(s.uInvert,this.invert)}}),t.Image.filters.Invert.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.Image.filters,n=t.util.createClass;o.Noise=n(o.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(s){if(this.noise!==0){var r=s.imageData,a=r.data,u,l=a.length,h=this.noise,f;for(u=0,l=a.length;u<l;u+=4)f=(.5-Math.random())*h,a[u]+=f,a[u+1]+=f,a[u+2]+=f}},getUniformLocations:function(s,r){return{uNoise:s.getUniformLocation(r,"uNoise"),uSeed:s.getUniformLocation(r,"uSeed")}},sendUniformData:function(s,r){s.uniform1f(r.uNoise,this.noise/255),s.uniform1f(r.uSeed,Math.random())},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),t.Image.filters.Noise.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Pixelate=o(i.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(n){var s=n.imageData,r=s.data,a=s.height,u=s.width,l,h,f,g,p,v,y,_,T,P,F;for(h=0;h<a;h+=this.blocksize)for(f=0;f<u;f+=this.blocksize)for(l=h*4*u+f*4,g=r[l],p=r[l+1],v=r[l+2],y=r[l+3],P=Math.min(h+this.blocksize,a),F=Math.min(f+this.blocksize,u),_=h;_<P;_++)for(T=f;T<F;T++)l=_*4*u+T*4,r[l]=g,r[l+1]=p,r[l+2]=v,r[l+3]=y},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(n,s){return{uBlocksize:n.getUniformLocation(s,"uBlocksize"),uStepW:n.getUniformLocation(s,"uStepW"),uStepH:n.getUniformLocation(s,"uStepH")}},sendUniformData:function(n,s){n.uniform1f(s.uBlocksize,this.blocksize)}}),t.Image.filters.Pixelate.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.Image.filters,n=t.util.createClass;o.RemoveColor=n(o.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(s){var r=s.imageData,a=r.data,u,l=this.distance*255,h,f,g,p=new t.Color(this.color).getSource(),v=[p[0]-l,p[1]-l,p[2]-l],y=[p[0]+l,p[1]+l,p[2]+l];for(u=0;u<a.length;u+=4)h=a[u],f=a[u+1],g=a[u+2],h>v[0]&&f>v[1]&&g>v[2]&&h<y[0]&&f<y[1]&&g<y[2]&&(a[u+3]=0)},getUniformLocations:function(s,r){return{uLow:s.getUniformLocation(r,"uLow"),uHigh:s.getUniformLocation(r,"uHigh")}},sendUniformData:function(s,r){var a=new t.Color(this.color).getSource(),u=parseFloat(this.distance),l=[0+a[0]/255-u,0+a[1]/255-u,0+a[2]/255-u,1],h=[a[0]/255+u,a[1]/255+u,a[2]/255+u,1];s.uniform4fv(r.uLow,l),s.uniform4fv(r.uHigh,h)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),t.Image.filters.RemoveColor.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var s in n)i[s]=o(i.ColorMatrix,{type:s,matrix:n[s],mainParameter:!1,colorsOnly:!0}),t.Image.filters[s].fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric,i=t.Image.filters,o=t.util.createClass;i.BlendColor=o(i.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(n){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[n]+`}
}`},retrieveShader:function(n){var s=this.type+"_"+this.mode,r;return n.programCache.hasOwnProperty(s)||(r=this.buildSource(this.mode),n.programCache[s]=this.createProgram(n.context,r)),n.programCache[s]},applyTo2d:function(n){var s=n.imageData,r=s.data,a=r.length,u,l,h,f,g,p,v,y=1-this.alpha;v=new t.Color(this.color).getSource(),u=v[0]*this.alpha,l=v[1]*this.alpha,h=v[2]*this.alpha;for(var _=0;_<a;_+=4)switch(f=r[_],g=r[_+1],p=r[_+2],this.mode){case"multiply":r[_]=f*u/255,r[_+1]=g*l/255,r[_+2]=p*h/255;break;case"screen":r[_]=255-(255-f)*(255-u)/255,r[_+1]=255-(255-g)*(255-l)/255,r[_+2]=255-(255-p)*(255-h)/255;break;case"add":r[_]=f+u,r[_+1]=g+l,r[_+2]=p+h;break;case"diff":case"difference":r[_]=Math.abs(f-u),r[_+1]=Math.abs(g-l),r[_+2]=Math.abs(p-h);break;case"subtract":r[_]=f-u,r[_+1]=g-l,r[_+2]=p-h;break;case"darken":r[_]=Math.min(f,u),r[_+1]=Math.min(g,l),r[_+2]=Math.min(p,h);break;case"lighten":r[_]=Math.max(f,u),r[_+1]=Math.max(g,l),r[_+2]=Math.max(p,h);break;case"overlay":r[_]=u<128?2*f*u/255:255-2*(255-f)*(255-u)/255,r[_+1]=l<128?2*g*l/255:255-2*(255-g)*(255-l)/255,r[_+2]=h<128?2*p*h/255:255-2*(255-p)*(255-h)/255;break;case"exclusion":r[_]=u+f-2*u*f/255,r[_+1]=l+g-2*l*g/255,r[_+2]=h+p-2*h*p/255;break;case"tint":r[_]=u+f*y,r[_+1]=l+g*y,r[_+2]=h+p*y}},getUniformLocations:function(n,s){return{uColor:n.getUniformLocation(s,"uColor")}},sendUniformData:function(n,s){var r=new t.Color(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,n.uniform4fv(s.uColor,r)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendColor.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric,i=t.Image.filters,o=t.util.createClass;i.BlendImage=o(i.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(n){var s=this.type+"_"+this.mode,r=this.fragmentSource[this.mode];return n.programCache.hasOwnProperty(s)||(n.programCache[s]=this.createProgram(n.context,r)),n.programCache[s]},applyToWebGL:function(n){var s=n.context,r=this.createTexture(n.filterBackend,this.image);this.bindAdditionalTexture(s,r,s.TEXTURE1),this.callSuper("applyToWebGL",n),this.unbindAdditionalTexture(s,s.TEXTURE1)},createTexture:function(n,s){return n.getCachedTexture(s.cacheKey,s._element)},calculateMatrix:function(){var n=this.image,s=n._element.width,r=n._element.height;return[1/n.scaleX,0,0,0,1/n.scaleY,0,-n.left/s,-n.top/r,1]},applyTo2d:function(n){var s=n.imageData,r=n.filterBackend.resources,a=s.data,u=a.length,l=s.width,h=s.height,f,g,p,v,y,_,T,P,F,j,Z=this.image,Q;r.blendImage||(r.blendImage=t.util.createCanvasElement()),F=r.blendImage,j=F.getContext("2d"),F.width!==l||F.height!==h?(F.width=l,F.height=h):j.clearRect(0,0,l,h),j.setTransform(Z.scaleX,0,0,Z.scaleY,Z.left,Z.top),j.drawImage(Z._element,0,0,l,h),Q=j.getImageData(0,0,l,h).data;for(var $=0;$<u;$+=4)switch(y=a[$],_=a[$+1],T=a[$+2],P=a[$+3],f=Q[$],g=Q[$+1],p=Q[$+2],v=Q[$+3],this.mode){case"multiply":a[$]=y*f/255,a[$+1]=_*g/255,a[$+2]=T*p/255,a[$+3]=P*v/255;break;case"mask":a[$+3]=v;break}},getUniformLocations:function(n,s){return{uTransformMatrix:n.getUniformLocation(s,"uTransformMatrix"),uImage:n.getUniformLocation(s,"uImage")}},sendUniformData:function(n,s){var r=this.calculateMatrix();n.uniform1i(s.uImage,1),n.uniformMatrix3fv(s.uTransformMatrix,!1,r)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendImage.fromObject=function(n,s){t.Image.fromObject(n.image,function(r){var a=t.util.object.clone(n);a.image=r,s(new t.Image.filters.BlendImage(a))})}})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=Math.pow,o=Math.floor,n=Math.sqrt,s=Math.abs,r=Math.round,a=Math.sin,u=Math.ceil,l=t.Image.filters,h=t.util.createClass;l.Resize=h(l.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(f,g){return{uDelta:f.getUniformLocation(g,"uDelta"),uTaps:f.getUniformLocation(g,"uTaps")}},sendUniformData:function(f,g){f.uniform2fv(g.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),f.uniform1fv(g.uTaps,this.taps)},retrieveShader:function(f){var g=this.getFilterWindow(),p=this.type+"_"+g;if(!f.programCache.hasOwnProperty(p)){var v=this.generateShader(g);f.programCache[p]=this.createProgram(f.context,v)}return f.programCache[p]},getFilterWindow:function(){var f=this.tempScale;return Math.ceil(this.lanczosLobes/f)},getTaps:function(){for(var f=this.lanczosCreate(this.lanczosLobes),g=this.tempScale,p=this.getFilterWindow(),v=new Array(p),y=1;y<=p;y++)v[y-1]=f(y*g);return v},generateShader:function(v){for(var g=new Array(v),p=this.fragmentSourceTOP,v,y=1;y<=v;y++)g[y-1]=y+".0 * uDelta";return p+="uniform float uTaps["+v+`];
`,p+=`void main() {
`,p+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,p+=`  float sum = 1.0;
`,g.forEach(function(_,T){p+="  color += texture2D(uTexture, vTexCoord + "+_+") * uTaps["+T+`];
`,p+="  color += texture2D(uTexture, vTexCoord - "+_+") * uTaps["+T+`];
`,p+="  sum += 2.0 * uTaps["+T+`];
`}),p+=`  gl_FragColor = color / sum;
`,p+="}",p},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(f){f.webgl?(f.passes++,this.width=f.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=f.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),f.destinationWidth=this.dW,this._setupFrameBuffer(f),this.applyToWebGL(f),this._swapTextures(f),f.sourceWidth=f.destinationWidth,this.height=f.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),f.destinationHeight=this.dH,this._setupFrameBuffer(f),this.applyToWebGL(f),this._swapTextures(f),f.sourceHeight=f.destinationHeight):this.applyTo2d(f)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(f){return function(g){if(g>=f||g<=-f)return 0;if(g<11920929e-14&&g>-11920929e-14)return 1;g*=Math.PI;var p=g/f;return a(g)/g*a(p)/p}},applyTo2d:function(f){var g=f.imageData,p=this.scaleX,v=this.scaleY;this.rcpScaleX=1/p,this.rcpScaleY=1/v;var y=g.width,_=g.height,T=r(y*p),P=r(_*v),F;this.resizeType==="sliceHack"?F=this.sliceByTwo(f,y,_,T,P):this.resizeType==="hermite"?F=this.hermiteFastResize(f,y,_,T,P):this.resizeType==="bilinear"?F=this.bilinearFiltering(f,y,_,T,P):this.resizeType==="lanczos"&&(F=this.lanczosResize(f,y,_,T,P)),f.imageData=F},sliceByTwo:function(f,g,p,v,y){var _=f.imageData,T=.5,P=!1,F=!1,j=g*T,Z=p*T,Q=t.filterBackend.resources,$,tt,rt=0,ct=0,lt=g,w=0;for(Q.sliceByTwo||(Q.sliceByTwo=document.createElement("canvas")),$=Q.sliceByTwo,($.width<g*1.5||$.height<p)&&($.width=g*1.5,$.height=p),tt=$.getContext("2d"),tt.clearRect(0,0,g*1.5,p),tt.putImageData(_,0,0),v=o(v),y=o(y);!P||!F;)g=j,p=Z,v<o(j*T)?j=o(j*T):(j=v,P=!0),y<o(Z*T)?Z=o(Z*T):(Z=y,F=!0),tt.drawImage($,rt,ct,g,p,lt,w,j,Z),rt=lt,ct=w,w+=Z;return tt.getImageData(rt,ct,v,y)},lanczosResize:function(f,g,p,v,y){function _(A){var E,W,O,x,M,R,z,N,q,et,ot;for(w.x=(A+.5)*Z,k.x=o(w.x),E=0;E<y;E++){for(w.y=(E+.5)*Q,k.y=o(w.y),M=0,R=0,z=0,N=0,q=0,W=k.x-rt;W<=k.x+rt;W++)if(!(W<0||W>=g)){et=o(1e3*s(W-w.x)),lt[et]||(lt[et]={});for(var X=k.y-ct;X<=k.y+ct;X++)X<0||X>=p||(ot=o(1e3*s(X-w.y)),lt[et][ot]||(lt[et][ot]=j(n(i(et*$,2)+i(ot*tt,2))/1e3)),O=lt[et][ot],O>0&&(x=(X*g+W)*4,M+=O,R+=O*T[x],z+=O*T[x+1],N+=O*T[x+2],q+=O*T[x+3]))}x=(E*v+A)*4,F[x]=R/M,F[x+1]=z/M,F[x+2]=N/M,F[x+3]=q/M}return++A<v?_(A):P}var T=f.imageData.data,P=f.ctx.createImageData(v,y),F=P.data,j=this.lanczosCreate(this.lanczosLobes),Z=this.rcpScaleX,Q=this.rcpScaleY,$=2/this.rcpScaleX,tt=2/this.rcpScaleY,rt=u(Z*this.lanczosLobes/2),ct=u(Q*this.lanczosLobes/2),lt={},w={},k={};return _(0)},bilinearFiltering:function(f,g,p,v,y){var _,T,P,F,j,Z,Q,$,tt,rt,ct,lt,w=0,k,A=this.rcpScaleX,E=this.rcpScaleY,W=4*(g-1),O=f.imageData,x=O.data,M=f.ctx.createImageData(v,y),R=M.data;for(Q=0;Q<y;Q++)for($=0;$<v;$++)for(j=o(A*$),Z=o(E*Q),tt=A*$-j,rt=E*Q-Z,k=4*(Z*g+j),ct=0;ct<4;ct++)_=x[k+ct],T=x[k+4+ct],P=x[k+W+ct],F=x[k+W+4+ct],lt=_*(1-tt)*(1-rt)+T*tt*(1-rt)+P*rt*(1-tt)+F*tt*rt,R[w++]=lt;return M},hermiteFastResize:function(f,g,p,v,y){for(var _=this.rcpScaleX,T=this.rcpScaleY,P=u(_/2),F=u(T/2),j=f.imageData,Z=j.data,Q=f.ctx.createImageData(v,y),$=Q.data,tt=0;tt<y;tt++)for(var rt=0;rt<v;rt++){for(var ct=(rt+tt*v)*4,lt=0,w=0,k=0,A=0,E=0,W=0,O=0,x=(tt+.5)*T,M=o(tt*T);M<(tt+1)*T;M++)for(var R=s(x-(M+.5))/F,z=(rt+.5)*_,N=R*R,q=o(rt*_);q<(rt+1)*_;q++){var et=s(z-(q+.5))/P,ot=n(N+et*et);ot>1&&ot<-1||(lt=2*ot*ot*ot-3*ot*ot+1,lt>0&&(et=4*(q+M*g),O+=lt*Z[et+3],k+=lt,Z[et+3]<255&&(lt=lt*Z[et+3]/250),A+=lt*Z[et],E+=lt*Z[et+1],W+=lt*Z[et+2],w+=lt))}$[ct]=A/w,$[ct+1]=E/w,$[ct+2]=W/w,$[ct+3]=O/k}return Q},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),t.Image.filters.Resize.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Contrast=o(i.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(n){if(this.contrast!==0){var s=n.imageData,r,u,a=s.data,u=a.length,l=Math.floor(this.contrast*255),h=259*(l+255)/(255*(259-l));for(r=0;r<u;r+=4)a[r]=h*(a[r]-128)+128,a[r+1]=h*(a[r+1]-128)+128,a[r+2]=h*(a[r+2]-128)+128}},getUniformLocations:function(n,s){return{uContrast:n.getUniformLocation(s,"uContrast")}},sendUniformData:function(n,s){n.uniform1f(s.uContrast,this.contrast)}}),t.Image.filters.Contrast.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Saturation=o(i.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(n){if(this.saturation!==0){var s=n.imageData,r=s.data,a=r.length,u=-this.saturation,l,h;for(l=0;l<a;l+=4)h=Math.max(r[l],r[l+1],r[l+2]),r[l]+=h!==r[l]?(h-r[l])*u:0,r[l+1]+=h!==r[l+1]?(h-r[l+1])*u:0,r[l+2]+=h!==r[l+2]?(h-r[l+2])*u:0}},getUniformLocations:function(n,s){return{uSaturation:n.getUniformLocation(s,"uSaturation")}},sendUniformData:function(n,s){n.uniform1f(s.uSaturation,-this.saturation)}}),t.Image.filters.Saturation.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Vibrance=o(i.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(n){if(this.vibrance!==0){var s=n.imageData,r=s.data,a=r.length,u=-this.vibrance,l,h,f,g;for(l=0;l<a;l+=4)h=Math.max(r[l],r[l+1],r[l+2]),f=(r[l]+r[l+1]+r[l+2])/3,g=Math.abs(h-f)*2/255*u,r[l]+=h!==r[l]?(h-r[l])*g:0,r[l+1]+=h!==r[l+1]?(h-r[l+1])*g:0,r[l+2]+=h!==r[l+2]?(h-r[l+2])*g:0}},getUniformLocations:function(n,s){return{uVibrance:n.getUniformLocation(s,"uVibrance")}},sendUniformData:function(n,s){n.uniform1f(s.uVibrance,-this.vibrance)}}),t.Image.filters.Vibrance.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Blur=o(i.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(n){n.webgl?(this.aspectRatio=n.sourceWidth/n.sourceHeight,n.passes++,this._setupFrameBuffer(n),this.horizontal=!0,this.applyToWebGL(n),this._swapTextures(n),this._setupFrameBuffer(n),this.horizontal=!1,this.applyToWebGL(n),this._swapTextures(n)):this.applyTo2d(n)},applyTo2d:function(n){n.imageData=this.simpleBlur(n)},simpleBlur:function(n){var s=n.filterBackend.resources,r,a,u=n.imageData.width,l=n.imageData.height;s.blurLayer1||(s.blurLayer1=t.util.createCanvasElement(),s.blurLayer2=t.util.createCanvasElement()),r=s.blurLayer1,a=s.blurLayer2,(r.width!==u||r.height!==l)&&(a.width=r.width=u,a.height=r.height=l);var h=r.getContext("2d"),f=a.getContext("2d"),g=15,p,v,y,_,T=this.blur*.06*.5;for(h.putImageData(n.imageData,0,0),f.clearRect(0,0,u,l),_=-g;_<=g;_++)p=(Math.random()-.5)/4,v=_/g,y=T*v*u+p,f.globalAlpha=1-Math.abs(v),f.drawImage(r,y,p),h.drawImage(a,0,0),f.globalAlpha=1,f.clearRect(0,0,a.width,a.height);for(_=-g;_<=g;_++)p=(Math.random()-.5)/4,v=_/g,y=T*v*l+p,f.globalAlpha=1-Math.abs(v),f.drawImage(r,p,y),h.drawImage(a,0,0),f.globalAlpha=1,f.clearRect(0,0,a.width,a.height);n.ctx.drawImage(r,0,0);var P=n.ctx.getImageData(0,0,r.width,r.height);return h.globalAlpha=1,h.clearRect(0,0,r.width,r.height),P},getUniformLocations:function(n,s){return{delta:n.getUniformLocation(s,"uDelta")}},sendUniformData:function(n,s){var r=this.chooseRightDelta();n.uniform2fv(s.delta,r)},chooseRightDelta:function(){var n=1,s=[0,0],r;return this.horizontal?this.aspectRatio>1&&(n=1/this.aspectRatio):this.aspectRatio<1&&(n=this.aspectRatio),r=n*this.blur*.12,this.horizontal?s[0]=r:s[1]=r,s}}),i.Blur.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Gamma=o(i.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(n){this.gamma=[1,1,1],i.BaseFilter.prototype.initialize.call(this,n)},applyTo2d:function(n){var s=n.imageData,r=s.data,a=this.gamma,u=r.length,l=1/a[0],h=1/a[1],f=1/a[2],g;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),g=0,u=256;g<u;g++)this.rVals[g]=Math.pow(g/255,l)*255,this.gVals[g]=Math.pow(g/255,h)*255,this.bVals[g]=Math.pow(g/255,f)*255;for(g=0,u=r.length;g<u;g+=4)r[g]=this.rVals[r[g]],r[g+1]=this.gVals[r[g+1]],r[g+2]=this.bVals[r[g+2]]},getUniformLocations:function(n,s){return{uGamma:n.getUniformLocation(s,"uGamma")}},sendUniformData:function(n,s){n.uniform3fv(s.uGamma,this.gamma)}}),t.Image.filters.Gamma.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Composed=o(i.BaseFilter,{type:"Composed",subFilters:[],initialize:function(n){this.callSuper("initialize",n),this.subFilters=this.subFilters.slice(0)},applyTo:function(n){n.passes+=this.subFilters.length-1,this.subFilters.forEach(function(s){s.applyTo(n)})},toObject:function(){return t.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(n){return n.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(n){return!n.isNeutralState()})}}),t.Image.filters.Composed.fromObject=function(n,s){var r=n.subFilters||[],a=r.map(function(l){return new t.Image.filters[l.type](l)}),u=new t.Image.filters.Composed({subFilters:a});return s&&s(u),u}})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.HueRotation=o(i.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var n=this.rotation*Math.PI,s=t.util.cos(n),r=t.util.sin(n),a=1/3,u=Math.sqrt(a)*r,l=1-s;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=s+l/3,this.matrix[1]=a*l-u,this.matrix[2]=a*l+u,this.matrix[5]=a*l+u,this.matrix[6]=s+a*l,this.matrix[7]=a*l-u,this.matrix[10]=a*l-u,this.matrix[11]=a*l+u,this.matrix[12]=s+a*l},isNeutralState:function(n){return this.calculateMatrix(),i.BaseFilter.prototype.isNeutralState.call(this,n)},applyTo:function(n){this.calculateMatrix(),i.BaseFilter.prototype.applyTo.call(this,n)}}),t.Image.filters.HueRotation.fromObject=t.Image.filters.BaseFilter.fromObject})(ut);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.clone;if(t.Text){t.warn("fabric.Text is already defined");return}var o="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");t.Text=t.util.createClass(t.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:t.Object.prototype.stateProperties.concat(o),cacheProperties:t.Object.prototype.cacheProperties.concat(o),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(n,s){this.styles=s?s.styles||{}:{},this.text=n,this.__skipDimension=!0,this.callSuper("initialize",s),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var n=this.path;n&&(n.segmentsInfo=t.util.getPathSegmentsInfo(n.path))},getMeasuringContext:function(){return t._measuringContext||(t._measuringContext=this.canvas&&this.canvas.contextCache||t.util.createCanvasElement().getContext("2d")),t._measuringContext},_splitText:function(){var n=this._splitTextIntoLines(this.text);return this.textLines=n.lines,this._textLines=n.graphemeLines,this._unwrappedTextLines=n._unwrappedLines,this._text=n.graphemeText,n},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var n,s,r,a,u,l,h,f=0,g=this._textLines.length;f<g;f++)if(!(this.textAlign!=="justify"&&(f===g-1||this.isEndOfWrapping(f)))&&(a=0,u=this._textLines[f],s=this.getLineWidth(f),s<this.width&&(h=this.textLines[f].match(this._reSpacesAndTabs)))){r=h.length,n=(this.width-s)/r;for(var p=0,v=u.length;p<=v;p++)l=this.__charBounds[f][p],this._reSpaceAndTab.test(u[p])?(l.width+=n,l.kernedWidth+=n,l.left+=a,a+=n):l.left+=a}},isEndOfWrapping:function(n){return n===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var n=this.callSuper("_getCacheCanvasDimensions"),s=this.fontSize;return n.width+=s*n.zoomX,n.height+=s*n.zoomY,n},_render:function(n){var s=this.path;s&&!s.isNotVisible()&&s._render(n),this._setTextStyles(n),this._renderTextLinesBackground(n),this._renderTextDecoration(n,"underline"),this._renderText(n),this._renderTextDecoration(n,"overline"),this._renderTextDecoration(n,"linethrough")},_renderText:function(n){this.paintFirst==="stroke"?(this._renderTextStroke(n),this._renderTextFill(n)):(this._renderTextFill(n),this._renderTextStroke(n))},_setTextStyles:function(n,s,r){if(n.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":n.textBaseline="middle";break;case"ascender":n.textBaseline="top";break;case"descender":n.textBaseline="bottom";break}n.font=this._getFontDeclaration(s,r)},calcTextWidth:function(){for(var n=this.getLineWidth(0),s=1,r=this._textLines.length;s<r;s++){var a=this.getLineWidth(s);a>n&&(n=a)}return n},_renderTextLine:function(n,s,r,a,u,l){this._renderChars(n,s,r,a,u,l)},_renderTextLinesBackground:function(n){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var s,r,a=n.fillStyle,u,l,h=this._getLeftOffset(),f=this._getTopOffset(),g=0,p=0,v,y,_=this.path,T,P=0,F=this._textLines.length;P<F;P++){if(s=this.getHeightOfLine(P),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",P)){f+=s;continue}u=this._textLines[P],r=this._getLineLeftOffset(P),p=0,g=0,l=this.getValueOfPropertyAt(P,0,"textBackgroundColor");for(var j=0,Z=u.length;j<Z;j++)v=this.__charBounds[P][j],y=this.getValueOfPropertyAt(P,j,"textBackgroundColor"),_?(n.save(),n.translate(v.renderLeft,v.renderTop),n.rotate(v.angle),n.fillStyle=y,y&&n.fillRect(-v.width/2,-s/this.lineHeight*(1-this._fontSizeFraction),v.width,s/this.lineHeight),n.restore()):y!==l?(T=h+r+g,this.direction==="rtl"&&(T=this.width-T-p),n.fillStyle=l,l&&n.fillRect(T,f,p,s/this.lineHeight),g=v.left,p=v.width,l=y):p+=v.kernedWidth;y&&!_&&(T=h+r+g,this.direction==="rtl"&&(T=this.width-T-p),n.fillStyle=y,n.fillRect(T,f,p,s/this.lineHeight)),f+=s}n.fillStyle=a,this._removeShadow(n)}},getFontCache:function(n){var s=n.fontFamily.toLowerCase();t.charWidthsCache[s]||(t.charWidthsCache[s]={});var r=t.charWidthsCache[s],a=n.fontStyle.toLowerCase()+"_"+(n.fontWeight+"").toLowerCase();return r[a]||(r[a]={}),r[a]},_measureChar:function(n,s,r,a){var u=this.getFontCache(s),l=this._getFontDeclaration(s),h=this._getFontDeclaration(a),f=r+n,g=l===h,p,v,y,_=s.fontSize/this.CACHE_FONT_SIZE,T;if(r&&u[r]!==void 0&&(y=u[r]),u[n]!==void 0&&(T=p=u[n]),g&&u[f]!==void 0&&(v=u[f],T=v-y),p===void 0||y===void 0||v===void 0){var P=this.getMeasuringContext();this._setTextStyles(P,s,!0)}return p===void 0&&(T=p=P.measureText(n).width,u[n]=p),y===void 0&&g&&r&&(y=P.measureText(r).width,u[r]=y),g&&v===void 0&&(v=P.measureText(f).width,u[f]=v,T=v-y),{width:p*_,kernedWidth:T*_}},getHeightOfChar:function(n,s){return this.getValueOfPropertyAt(n,s,"fontSize")},measureLine:function(n){var s=this._measureLine(n);return this.charSpacing!==0&&(s.width-=this._getWidthOfCharSpacing()),s.width<0&&(s.width=0),s},_measureLine:function(n){var s=0,r,a,u=this._textLines[n],l,h,f=0,g=new Array(u.length),p=0,v,y,_=this.path,T=this.pathSide==="right";for(this.__charBounds[n]=g,r=0;r<u.length;r++)a=u[r],h=this._getGraphemeBox(a,n,r,l),g[r]=h,s+=h.kernedWidth,l=a;if(g[r]={left:h?h.left+h.width:0,width:0,kernedWidth:0,height:this.fontSize},_){switch(y=_.segmentsInfo[_.segmentsInfo.length-1].length,v=t.util.getPointOnPath(_.path,0,_.segmentsInfo),v.x+=_.pathOffset.x,v.y+=_.pathOffset.y,this.textAlign){case"left":p=T?y-s:0;break;case"center":p=(y-s)/2;break;case"right":p=T?0:y-s;break}for(p+=this.pathStartOffset*(T?-1:1),r=T?u.length-1:0;T?r>=0:r<u.length;T?r--:r++)h=g[r],p>y?p%=y:p<0&&(p+=y),this._setGraphemeOnPath(p,h,v),p+=h.kernedWidth}return{width:s,numOfSpaces:f}},_setGraphemeOnPath:function(n,s,r){var a=n+s.kernedWidth/2,u=this.path,l=t.util.getPointOnPath(u.path,a,u.segmentsInfo);s.renderLeft=l.x-r.x,s.renderTop=l.y-r.y,s.angle=l.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(n,s,r,a,u){var l=this.getCompleteStyleDeclaration(s,r),h=a?this.getCompleteStyleDeclaration(s,r-1):{},f=this._measureChar(n,l,a,h),g=f.kernedWidth,p=f.width,v;this.charSpacing!==0&&(v=this._getWidthOfCharSpacing(),p+=v,g+=v);var y={width:p,left:0,height:l.fontSize,kernedWidth:g,deltaY:l.deltaY};if(r>0&&!u){var _=this.__charBounds[s][r-1];y.left=_.left+_.width+f.kernedWidth-f.width}return y},getHeightOfLine:function(n){if(this.__lineHeights[n])return this.__lineHeights[n];for(var s=this._textLines[n],r=this.getHeightOfChar(n,0),a=1,u=s.length;a<u;a++)r=Math.max(this.getHeightOfChar(n,a),r);return this.__lineHeights[n]=r*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var n,s=0,r=0,a=this._textLines.length;r<a;r++)n=this.getHeightOfLine(r),s+=r===a-1?n/this.lineHeight:n;return s},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(n,s){n.save();for(var r=0,a=this._getLeftOffset(),u=this._getTopOffset(),l=0,h=this._textLines.length;l<h;l++){var f=this.getHeightOfLine(l),g=f/this.lineHeight,p=this._getLineLeftOffset(l);this._renderTextLine(s,n,this._textLines[l],a+p,u+r+g,l),r+=f}n.restore()},_renderTextFill:function(n){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(n,"fillText")},_renderTextStroke:function(n){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(n),n.save(),this._setLineDash(n,this.strokeDashArray),n.beginPath(),this._renderTextCommon(n,"strokeText"),n.closePath(),n.restore())},_renderChars:function(n,s,r,a,u,l){var h=this.getHeightOfLine(l),f=this.textAlign.indexOf("justify")!==-1,g,p,v="",y,_=0,T,P=this.path,F=!f&&this.charSpacing===0&&this.isEmptyStyles(l)&&!P,j=this.direction==="ltr",Z=this.direction==="ltr"?1:-1,Q,$=s.canvas.getAttribute("dir");if(s.save(),$!==this.direction&&(s.canvas.setAttribute("dir",j?"ltr":"rtl"),s.direction=j?"ltr":"rtl",s.textAlign=j?"left":"right"),u-=h*this._fontSizeFraction/this.lineHeight,F){this._renderChar(n,s,l,0,r.join(""),a,u,h),s.restore();return}for(var tt=0,rt=r.length-1;tt<=rt;tt++)T=tt===rt||this.charSpacing||P,v+=r[tt],y=this.__charBounds[l][tt],_===0?(a+=Z*(y.kernedWidth-y.width),_+=y.width):_+=y.kernedWidth,f&&!T&&this._reSpaceAndTab.test(r[tt])&&(T=!0),T||(g=g||this.getCompleteStyleDeclaration(l,tt),p=this.getCompleteStyleDeclaration(l,tt+1),T=t.util.hasStyleChanged(g,p,!1)),T&&(P?(s.save(),s.translate(y.renderLeft,y.renderTop),s.rotate(y.angle),this._renderChar(n,s,l,tt,v,-_/2,0,h),s.restore()):(Q=a,this._renderChar(n,s,l,tt,v,Q,u,h)),v="",g=p,a+=Z*_,_=0);s.restore()},_applyPatternGradientTransformText:function(n){var s=t.util.createCanvasElement(),r,a=this.width+this.strokeWidth,u=this.height+this.strokeWidth;return s.width=a,s.height=u,r=s.getContext("2d"),r.beginPath(),r.moveTo(0,0),r.lineTo(a,0),r.lineTo(a,u),r.lineTo(0,u),r.closePath(),r.translate(a/2,u/2),r.fillStyle=n.toLive(r),this._applyPatternGradientTransform(r,n),r.fill(),r.createPattern(s,"no-repeat")},handleFiller:function(n,s,r){var a,u;return r.toLive?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?(a=-this.width/2,u=-this.height/2,n.translate(a,u),n[s]=this._applyPatternGradientTransformText(r),{offsetX:a,offsetY:u}):(n[s]=r.toLive(n,this),this._applyPatternGradientTransform(n,r)):(n[s]=r,{offsetX:0,offsetY:0})},_setStrokeStyles:function(n,s){return n.lineWidth=s.strokeWidth,n.lineCap=this.strokeLineCap,n.lineDashOffset=this.strokeDashOffset,n.lineJoin=this.strokeLineJoin,n.miterLimit=this.strokeMiterLimit,this.handleFiller(n,"strokeStyle",s.stroke)},_setFillStyles:function(n,s){return this.handleFiller(n,"fillStyle",s.fill)},_renderChar:function(n,s,r,a,u,l,h){var f=this._getStyleDeclaration(r,a),g=this.getCompleteStyleDeclaration(r,a),p=n==="fillText"&&g.fill,v=n==="strokeText"&&g.stroke&&g.strokeWidth,y,_;!v&&!p||(s.save(),p&&(y=this._setFillStyles(s,g)),v&&(_=this._setStrokeStyles(s,g)),s.font=this._getFontDeclaration(g),f&&f.textBackgroundColor&&this._removeShadow(s),f&&f.deltaY&&(h+=f.deltaY),p&&s.fillText(u,l-y.offsetX,h-y.offsetY),v&&s.strokeText(u,l-_.offsetX,h-_.offsetY),s.restore())},setSuperscript:function(n,s){return this._setScript(n,s,this.superscript)},setSubscript:function(n,s){return this._setScript(n,s,this.subscript)},_setScript:function(n,s,r){var a=this.get2DCursorLocation(n,!0),u=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"fontSize"),l=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"deltaY"),h={fontSize:u*r.size,deltaY:l+u*r.baseline};return this.setSelectionStyles(h,n,s),this},_getLineLeftOffset:function(n){var s=this.getLineWidth(n),r=this.width-s,a=this.textAlign,u=this.direction,h,l=0,h=this.isEndOfWrapping(n);return a==="justify"||a==="justify-center"&&!h||a==="justify-right"&&!h||a==="justify-left"&&!h?0:(a==="center"&&(l=r/2),a==="right"&&(l=r),a==="justify-center"&&(l=r/2),a==="justify-right"&&(l=r),u==="rtl"&&(l-=r),l)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var n=this._forceClearCache;return n||(n=this.hasStateChanged("_dimensionAffectingProps")),n&&(this.dirty=!0,this._forceClearCache=!1),n},getLineWidth:function(n){if(this.__lineWidths[n]!==void 0)return this.__lineWidths[n];var s=this.measureLine(n),r=s.width;return this.__lineWidths[n]=r,r},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(n,s,r){var a=this._getStyleDeclaration(n,s);return a&&typeof a[r]<"u"?a[r]:this[r]},_renderTextDecoration:function(n,s){if(!(!this[s]&&!this.styleHas(s))){for(var r,a,u,l,h,f,g,p,v=this._getLeftOffset(),y=this._getTopOffset(),_,T,P,F,j,Z,Q,$,tt=this.path,rt=this._getWidthOfCharSpacing(),ct=this.offsets[s],lt=0,w=this._textLines.length;lt<w;lt++){if(r=this.getHeightOfLine(lt),!this[s]&&!this.styleHas(s,lt)){y+=r;continue}g=this._textLines[lt],Z=r/this.lineHeight,l=this._getLineLeftOffset(lt),T=0,P=0,p=this.getValueOfPropertyAt(lt,0,s),$=this.getValueOfPropertyAt(lt,0,"fill"),_=y+Z*(1-this._fontSizeFraction),a=this.getHeightOfChar(lt,0),h=this.getValueOfPropertyAt(lt,0,"deltaY");for(var k=0,A=g.length;k<A;k++)if(F=this.__charBounds[lt][k],j=this.getValueOfPropertyAt(lt,k,s),Q=this.getValueOfPropertyAt(lt,k,"fill"),u=this.getHeightOfChar(lt,k),f=this.getValueOfPropertyAt(lt,k,"deltaY"),tt&&j&&Q)n.save(),n.fillStyle=$,n.translate(F.renderLeft,F.renderTop),n.rotate(F.angle),n.fillRect(-F.kernedWidth/2,ct*u+f,F.kernedWidth,this.fontSize/15),n.restore();else if((j!==p||Q!==$||u!==a||f!==h)&&P>0){var E=v+l+T;this.direction==="rtl"&&(E=this.width-E-P),p&&$&&(n.fillStyle=$,n.fillRect(E,_+ct*a+h,P,this.fontSize/15)),T=F.left,P=F.width,p=j,$=Q,a=u,h=f}else P+=F.kernedWidth;var E=v+l+T;this.direction==="rtl"&&(E=this.width-E-P),n.fillStyle=Q,j&&Q&&n.fillRect(E,_+ct*a+h,P-rt,this.fontSize/15),y+=r}this._removeShadow(n)}},_getFontDeclaration:function(n,s){var r=n||this,a=this.fontFamily,u=t.Text.genericFonts.indexOf(a.toLowerCase())>-1,l=a===void 0||a.indexOf("'")>-1||a.indexOf(",")>-1||a.indexOf('"')>-1||u?r.fontFamily:'"'+r.fontFamily+'"';return[t.isLikelyNode?r.fontWeight:r.fontStyle,t.isLikelyNode?r.fontStyle:r.fontWeight,s?this.CACHE_FONT_SIZE+"px":r.fontSize+"px",l].join(" ")},render:function(n){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",n)))},_splitTextIntoLines:function(n){for(var s=n.split(this._reNewline),r=new Array(s.length),a=[`
`],u=[],l=0;l<s.length;l++)r[l]=t.util.string.graphemeSplit(s[l]),u=u.concat(r[l],a);return u.pop(),{_unwrappedLines:r,lines:s,graphemeText:u,graphemeLines:r}},toObject:function(n){var s=o.concat(n),r=this.callSuper("toObject",s);return r.styles=t.util.stylesToArray(this.styles,this.text),r.path&&(r.path=this.path.toObject()),r},set:function(n,s){this.callSuper("set",n,s);var r=!1,a=!1;if(typeof n=="object")for(var u in n)u==="path"&&this.setPathInfo(),r=r||this._dimensionAffectingProps.indexOf(u)!==-1,a=a||u==="path";else r=this._dimensionAffectingProps.indexOf(n)!==-1,a=n==="path";return a&&this.setPathInfo(),r&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),t.Text.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),t.Text.DEFAULT_SVG_FONT_SIZE=16,t.Text.fromElement=function(n,s,r){if(!n)return s(null);var a=t.parseAttributes(n,t.Text.ATTRIBUTE_NAMES),u=a.textAnchor||"left";if(r=t.util.object.extend(r?i(r):{},a),r.top=r.top||0,r.left=r.left||0,a.textDecoration){var l=a.textDecoration;l.indexOf("underline")!==-1&&(r.underline=!0),l.indexOf("overline")!==-1&&(r.overline=!0),l.indexOf("line-through")!==-1&&(r.linethrough=!0),delete r.textDecoration}"dx"in a&&(r.left+=a.dx),"dy"in a&&(r.top+=a.dy),"fontSize"in r||(r.fontSize=t.Text.DEFAULT_SVG_FONT_SIZE);var h="";"textContent"in n?h=n.textContent:"firstChild"in n&&n.firstChild!==null&&"data"in n.firstChild&&n.firstChild.data!==null&&(h=n.firstChild.data),h=h.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var f=r.strokeWidth;r.strokeWidth=0;var g=new t.Text(h,r),p=g.getScaledHeight()/g.height,v=(g.height+g.strokeWidth)*g.lineHeight-g.height,y=v*p,_=g.getScaledHeight()+y,T=0;u==="center"&&(T=g.getScaledWidth()/2),u==="right"&&(T=g.getScaledWidth()),g.set({left:g.left-T,top:g.top-(_-g.fontSize*(.07+g._fontSizeFraction))/g.lineHeight,strokeWidth:typeof f<"u"?f:1}),s(g)},t.Text.fromObject=function(n,s){var r=i(n),a=n.path;return delete r.path,t.Object._fromObject("Text",r,function(u){u.styles=t.util.stylesFromArray(n.styles,n.text),a?t.Object._fromObject("Path",a,function(l){u.set("path",l),s(u)},"path"):s(u)},"text")},t.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],t.util.createAccessors&&t.util.createAccessors(t.Text)})(ut);(function(){C.util.object.extend(C.Text.prototype,{isEmptyStyles:function(e){if(!this.styles||typeof e<"u"&&!this.styles[e])return!0;var t=typeof e>"u"?this.styles:{line:this.styles[e]};for(var i in t)for(var o in t[i])for(var n in t[i][o])return!1;return!0},styleHas:function(e,t){if(!this.styles||!e||e===""||typeof t<"u"&&!this.styles[t])return!1;var i=typeof t>"u"?this.styles:{0:this.styles[t]};for(var o in i)for(var n in i[o])if(typeof i[o][n][e]<"u")return!0;return!1},cleanStyle:function(e){if(!this.styles||!e||e==="")return!1;var t=this.styles,i=0,o,n,s=!0,r=0,a;for(var u in t){o=0;for(var l in t[u]){var a=t[u][l],h=a.hasOwnProperty(e);i++,h?(n?a[e]!==n&&(s=!1):n=a[e],a[e]===this[e]&&delete a[e]):s=!1,Object.keys(a).length!==0?o++:delete t[u][l]}o===0&&delete t[u]}for(var f=0;f<this._textLines.length;f++)r+=this._textLines[f].length;s&&i===r&&(this[e]=n,this.removeStyle(e))},removeStyle:function(e){if(!(!this.styles||!e||e==="")){var t=this.styles,i,o,n;for(o in t){i=t[o];for(n in i)delete i[n][e],Object.keys(i[n]).length===0&&delete i[n];Object.keys(i).length===0&&delete t[o]}}},_extendStyles:function(e,t){var i=this.get2DCursorLocation(e);this._getLineStyle(i.lineIndex)||this._setLineStyle(i.lineIndex),this._getStyleDeclaration(i.lineIndex,i.charIndex)||this._setStyleDeclaration(i.lineIndex,i.charIndex,{}),C.util.object.extend(this._getStyleDeclaration(i.lineIndex,i.charIndex),t)},get2DCursorLocation:function(e,t){typeof e>"u"&&(e=this.selectionStart);for(var i=t?this._unwrappedTextLines:this._textLines,o=i.length,n=0;n<o;n++){if(e<=i[n].length)return{lineIndex:n,charIndex:e};e-=i[n].length+this.missingNewlineOffset(n)}return{lineIndex:n-1,charIndex:i[n-1].length<e?i[n-1].length:e}},getSelectionStyles:function(e,t,i){typeof e>"u"&&(e=this.selectionStart||0),typeof t>"u"&&(t=this.selectionEnd||e);for(var o=[],n=e;n<t;n++)o.push(this.getStyleAtPosition(n,i));return o},getStyleAtPosition:function(e,t){var i=this.get2DCursorLocation(e),o=t?this.getCompleteStyleDeclaration(i.lineIndex,i.charIndex):this._getStyleDeclaration(i.lineIndex,i.charIndex);return o||{}},setSelectionStyles:function(e,t,i){typeof t>"u"&&(t=this.selectionStart||0),typeof i>"u"&&(i=this.selectionEnd||t);for(var o=t;o<i;o++)this._extendStyles(o,e);return this._forceClearCache=!0,this},_getStyleDeclaration:function(e,t){var i=this.styles&&this.styles[e];return i?i[t]:null},getCompleteStyleDeclaration:function(e,t){for(var i=this._getStyleDeclaration(e,t)||{},o={},n,s=0;s<this._styleProperties.length;s++)n=this._styleProperties[s],o[n]=typeof i[n]>"u"?this[n]:i[n];return o},_setStyleDeclaration:function(e,t,i){this.styles[e][t]=i},_deleteStyleDeclaration:function(e,t){delete this.styles[e][t]},_getLineStyle:function(e){return!!this.styles[e]},_setLineStyle:function(e){this.styles[e]={}},_deleteLineStyle:function(e){delete this.styles[e]}})})();(function(){function e(t){t.textDecoration&&(t.textDecoration.indexOf("underline")>-1&&(t.underline=!0),t.textDecoration.indexOf("line-through")>-1&&(t.linethrough=!0),t.textDecoration.indexOf("overline")>-1&&(t.overline=!0),delete t.textDecoration)}C.IText=C.util.createClass(C.Text,C.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,i){this.callSuper("initialize",t,i),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,i){this[t]!==i&&(this._fireSelectionChanged(),this[t]=i),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var i=this.canvas.contextTop,o=this.canvas.viewportTransform;i.save(),i.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this.transform(i),this._clearTextArea(i),t||i.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var t=this._getCursorBoundaries(),i=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(t,i):this.renderSelection(t,i),i.restore()}},_clearTextArea:function(t){var i=this.width+4,o=this.height+4;t.clearRect(-i/2,-o/2,i,o)},_getCursorBoundaries:function(t){typeof t>"u"&&(t=this.selectionStart);var i=this._getLeftOffset(),o=this._getTopOffset(),n=this._getCursorBoundariesOffsets(t);return{left:i,top:o,leftOffset:n.left,topOffset:n.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var i,o,n,s=0,r=0,a,u=this.get2DCursorLocation(t);n=u.charIndex,o=u.lineIndex;for(var l=0;l<o;l++)s+=this.getHeightOfLine(l);i=this._getLineLeftOffset(o);var h=this.__charBounds[o][n];return h&&(r=h.left),this.charSpacing!==0&&n===this._textLines[o].length&&(r-=this._getWidthOfCharSpacing()),a={top:s,left:i+(r>0?r:0)},this.direction==="rtl"&&(a.left*=-1),this.cursorOffsetCache=a,this.cursorOffsetCache},renderCursor:function(t,i){var o=this.get2DCursorLocation(),n=o.lineIndex,s=o.charIndex>0?o.charIndex-1:0,r=this.getValueOfPropertyAt(n,s,"fontSize"),a=this.scaleX*this.canvas.getZoom(),u=this.cursorWidth/a,l=t.topOffset,h=this.getValueOfPropertyAt(n,s,"deltaY");l+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-r*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,i),i.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,s,"fill"),i.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,i.fillRect(t.left+t.leftOffset-u/2,l+t.top+h,u,r)},renderSelection:function(t,i){for(var o=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,n=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,s=this.textAlign.indexOf("justify")!==-1,r=this.get2DCursorLocation(o),a=this.get2DCursorLocation(n),u=r.lineIndex,l=a.lineIndex,h=r.charIndex<0?0:r.charIndex,f=a.charIndex<0?0:a.charIndex,g=u;g<=l;g++){var p=this._getLineLeftOffset(g)||0,v=this.getHeightOfLine(g),y=0,_=0,T=0;if(g===u&&(_=this.__charBounds[u][h].left),g>=u&&g<l)T=s&&!this.isEndOfWrapping(g)?this.width:this.getLineWidth(g)||5;else if(g===l)if(f===0)T=this.__charBounds[l][f].left;else{var P=this._getWidthOfCharSpacing();T=this.__charBounds[l][f-1].left+this.__charBounds[l][f-1].width-P}y=v,(this.lineHeight<1||g===l&&this.lineHeight>1)&&(v/=this.lineHeight);var F=t.left+p+_,j=T-_,Z=v,Q=0;this.inCompositionMode?(i.fillStyle=this.compositionColor||"black",Z=1,Q=v):i.fillStyle=this.selectionColor,this.direction==="rtl"&&(F=this.width-F-j),i.fillRect(F,t.top+t.topOffset+Q,j,Z),t.topOffset+=y}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),i=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:i}}}),C.IText.fromObject=function(t,i){var o=C.util.stylesFromArray(t.styles,t.text),n=Object.assign({},t,{styles:o});if(e(n),n.styles)for(var s in n.styles)for(var r in n.styles[s])e(n.styles[s][r]);C.Object._fromObject("IText",n,i,"text")}})();(function(){var e=C.util.object.clone;C.util.object.extend(C.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var t=this;this.on("added",function(){var i=t.canvas;i&&(i._hasITextHandlers||(i._hasITextHandlers=!0,t._initCanvasHandlers(i)),i._iTextInstances=i._iTextInstances||[],i._iTextInstances.push(t))})},initRemovedHandler:function(){var t=this;this.on("removed",function(){var i=t.canvas;i&&(i._iTextInstances=i._iTextInstances||[],C.util.removeFromArray(i._iTextInstances,t),i._iTextInstances.length===0&&(i._hasITextHandlers=!1,t._removeCanvasHandlers(i)))})},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach(function(i){i.__isMousedown=!1})},t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,i,o,n){var s;return s={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",i,{duration:o,onComplete:function(){s.isAborted||t[n]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return s.isAborted}}),s},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(t){var i=this,o=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){i._tick()},o)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,i=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&i&&i.clearContext(i.contextTop||i.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var i=0,o=t-1;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)i++,o--;for(;/\S/.test(this._text[o])&&o>-1;)i++,o--;return t-i},findWordBoundaryRight:function(t){var i=0,o=t;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)i++,o++;for(;/\S/.test(this._text[o])&&o<this._text.length;)i++,o++;return t+i},findLineBoundaryLeft:function(t){for(var i=0,o=t-1;!/\n/.test(this._text[o])&&o>-1;)i++,o--;return t-i},findLineBoundaryRight:function(t){for(var i=0,o=t;!/\n/.test(this._text[o])&&o<this._text.length;)i++,o++;return t+i},searchWordBoundary:function(t,i){for(var o=this._text,n=this._reSpace.test(o[t])?t-1:t,s=o[n],r=C.reNonWord;!r.test(s)&&n>0&&n<o.length;)n+=i,s=o[n];return r.test(s)&&(n+=i===1?0:1),n},selectWord:function(t){t=t||this.selectionStart;var i=this.searchWordBoundary(t,-1),o=this.searchWordBoundary(t,1);this.selectionStart=i,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var i=this.findLineBoundaryLeft(t),o=this.findLineBoundaryRight(t);return this.selectionStart=i,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach(function(i){i.selected=!1,i.isEditing&&i.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var i=this.getSelectionStartFromPointer(t.e),o=this.selectionStart,n=this.selectionEnd;(i!==this.__selectionStartOnMouseDown||o===n)&&(o===i||n===i)||(i>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=i):(this.selectionStart=i,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==o||this.selectionEnd!==n)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,i,o){var n=o.slice(0,t),s=C.util.string.graphemeSplit(n).length;if(t===i)return{selectionStart:s,selectionEnd:s};var r=o.slice(t,i),a=C.util.string.graphemeSplit(r).length;return{selectionStart:s,selectionEnd:s+a}},fromGraphemeToStringSelection:function(t,i,o){var n=o.slice(0,t),s=n.join("").length;if(t===i)return{selectionStart:s,selectionEnd:s};var r=o.slice(t,i),a=r.join("").length;return{selectionStart:s,selectionEnd:s+a}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,i=this._getCursorBoundaries(t),o=this.get2DCursorLocation(t),n=o.lineIndex,s=o.charIndex,r=this.getValueOfPropertyAt(n,s,"fontSize")*this.lineHeight,a=i.leftOffset,u=this.calcTransformMatrix(),l={x:i.left+a,y:i.top+i.topOffset+r},h=this.canvas.getRetinaScaling(),f=this.canvas.upperCanvasEl,g=f.width/h,p=f.height/h,v=g-r,y=p-r,_=f.clientWidth/g,T=f.clientHeight/p;return l=C.util.transformPoint(l,u),l=C.util.transformPoint(l,this.canvas.viewportTransform),l.x*=_,l.y*=T,l.x<0&&(l.x=0),l.x>v&&(l.x=v),l.y<0&&(l.y=0),l.y>y&&(l.y=y),l.x+=this.canvas._offset.left,l.y+=this.canvas._offset.top,{left:l.x+"px",top:l.y+"px",fontSize:r+"px",charHeight:r}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text,i=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,i&&(i.blur&&i.blur(),i.parentNode&&i.parentNode.removeChild(i)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,i){var o=this.get2DCursorLocation(t,!0),n=this.get2DCursorLocation(i,!0),s=o.lineIndex,r=o.charIndex,a=n.lineIndex,u=n.charIndex,l,h;if(s!==a){if(this.styles[s])for(l=r;l<this._unwrappedTextLines[s].length;l++)delete this.styles[s][l];if(this.styles[a])for(l=u;l<this._unwrappedTextLines[a].length;l++)h=this.styles[a][l],h&&(this.styles[s]||(this.styles[s]={}),this.styles[s][r+l-u]=h);for(l=s+1;l<=a;l++)delete this.styles[l];this.shiftLineStyles(a,s-a)}else if(this.styles[s]){h=this.styles[s];var f=u-r,g,p;for(l=r;l<u;l++)delete h[l];for(p in this.styles[s])g=parseInt(p,10),g>=u&&(h[g-f]=h[p],delete h[p])}},shiftLineStyles:function(t,i){var o=e(this.styles);for(var n in this.styles){var s=parseInt(n,10);s>t&&(this.styles[s+i]=o[s],o[s-i]||delete this.styles[s])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(t,i,o,n){var s,r={},a=!1,u=this._unwrappedTextLines[t].length===i;o||(o=1),this.shiftLineStyles(t,o),this.styles[t]&&(s=this.styles[t][i===0?i:i-1]);for(var l in this.styles[t]){var h=parseInt(l,10);h>=i&&(a=!0,r[h-i]=this.styles[t][l],u&&i===0||delete this.styles[t][l])}var f=!1;for(a&&!u&&(this.styles[t+o]=r,f=!0),f&&o--;o>0;)n&&n[o-1]?this.styles[t+o]={0:e(n[o-1])}:s?this.styles[t+o]={0:e(s)}:delete this.styles[t+o],o--;this._forceClearCache=!0},insertCharStyleObject:function(t,i,o,n){this.styles||(this.styles={});var s=this.styles[t],r=s?e(s):{};o||(o=1);for(var a in r){var u=parseInt(a,10);u>=i&&(s[u+o]=r[u],r[u-o]||delete s[u])}if(this._forceClearCache=!0,n){for(;o--;)Object.keys(n[o]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][i+o]=e(n[o]));return}if(s)for(var l=s[i?i-1:1];l&&o--;)this.styles[t][i+o]=e(l)},insertNewStyleBlock:function(t,i,o){for(var n=this.get2DCursorLocation(i,!0),s=[0],r=0,a=0;a<t.length;a++)t[a]===`
`?(r++,s[r]=0):s[r]++;s[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,s[0],o),o=o&&o.slice(s[0]+1)),r&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+s[0],r);for(var a=1;a<r;a++)s[a]>0?this.insertCharStyleObject(n.lineIndex+a,0,s[a],o):o&&this.styles[n.lineIndex+a]&&o[0]&&(this.styles[n.lineIndex+a][0]=o[0]),o=o&&o.slice(s[a]+1);s[a]>0&&this.insertCharStyleObject(n.lineIndex+a,0,s[a],o)},setSelectionStartEndWithShift:function(t,i,o){o<=t?(i===t?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=o):o>t&&o<i?this._selectionDirection==="right"?this.selectionEnd=o:this.selectionStart=o:(i===t?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=i),this.selectionEnd=o)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}})})();C.util.object.extend(C.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(e){if(this.canvas){this.__newClickTime=+new Date;var t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),this._stopEvent(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y},_stopEvent:function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))},tripleClickHandler:function(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(e){!this.canvas||!this.editable||e.e.button&&e.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(e.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(e){!this.canvas||!this.editable||e.e.button&&e.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(e){if(this.__isMousedown=!1,!(!this.editable||this.group||e.transform&&e.transform.actionPerformed||e.e.button&&e.e.button!==1)){if(this.canvas){var t=this.canvas._activeObject;if(t&&t!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(e.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(e){var t=this.getSelectionStartFromPointer(e),i=this.selectionStart,o=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(i,o,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(e){for(var t=this.getLocalPointer(e),i=0,o=0,n=0,s=0,r=0,a,u,l=0,h=this._textLines.length;l<h&&n<=t.y;l++)n+=this.getHeightOfLine(l)*this.scaleY,r=l,l>0&&(s+=this._textLines[l-1].length+this.missingNewlineOffset(l-1));a=this._getLineLeftOffset(r),o=a*this.scaleX,u=this._textLines[r],this.direction==="rtl"&&(t.x=this.width*this.scaleX-t.x+o);for(var f=0,g=u.length;f<g&&(i=o,o+=this.__charBounds[r][f].kernedWidth*this.scaleX,o<=t.x);f++)s++;return this._getNewSelectionStartFromOffset(t,i,o,s,g)},_getNewSelectionStartFromOffset:function(e,t,i,o,n){var s=e.x-t,r=i-e.x,a=r>s||r<0?0:1,u=o+a;return this.flipX&&(u=n-u),u>this._text.length&&(u=this._text.length),u}});C.util.object.extend(C.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=C.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var e=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+e.top+"; left: "+e.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+e.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):C.document.body.appendChild(this.hiddenTextarea),C.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),C.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),C.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),C.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),C.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),C.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),C.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),C.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),C.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(C.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(e){if(this.isEditing){var t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else if(e.keyCode in this.ctrlKeysMapDown&&(e.ctrlKey||e.metaKey))this[this.ctrlKeysMapDown[e.keyCode]](e);else return;e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(e){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey))this[this.ctrlKeysMapUp[e.keyCode]](e);else return;e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(e){var t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!!this.isEditing){var i=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,n=i.length,s,r,a=n-o,u=this.selectionStart,l=this.selectionEnd,h=u!==l,f,g,p;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var v=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),y=u>v.selectionStart;h?(s=this._text.slice(u,l),a+=l-u):n<o&&(y?s=this._text.slice(l+a,l):s=this._text.slice(u,u-a)),r=i.slice(v.selectionEnd-a,v.selectionEnd),s&&s.length&&(r.length&&(f=this.getSelectionStyles(u,u+1,!1),f=r.map(function(){return f[0]})),h?(g=u,p=l):y?(g=l-s.length,p=l):(g=l,p=l+s.length),this.removeStyleFromTo(g,p)),r.length&&(t&&r.join("")===C.copiedText&&!C.disableStyleCopyPaste&&(f=C.copiedTextStyle),this.insertNewStyleBlock(r,u,f)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(e){this.compositionStart=e.target.selectionStart,this.compositionEnd=e.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(C.copiedText=this.getSelectedText(),C.disableStyleCopyPaste?C.copiedTextStyle=null:C.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(e){return e&&e.clipboardData||C.window.clipboardData},_getWidthBeforeCursor:function(e,t){var i=this._getLineLeftOffset(e),o;return t>0&&(o=this.__charBounds[e][t-1],i+=o.left+o.width),i},getDownCursorOffset:function(e,t){var i=this._getSelectionForOffset(e,t),o=this.get2DCursorLocation(i),n=o.lineIndex;if(n===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-i;var s=o.charIndex,r=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n+1,r),u=this._textLines[n].slice(s);return u.length+a+1+this.missingNewlineOffset(n)},_getSelectionForOffset:function(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(e,t){var i=this._getSelectionForOffset(e,t),o=this.get2DCursorLocation(i),n=o.lineIndex;if(n===0||e.metaKey||e.keyCode===33)return-i;var s=o.charIndex,r=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n-1,r),u=this._textLines[n].slice(0,s),l=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+a-u.length+(1-l)},_getIndexOnLine:function(e,t){for(var i=this._textLines[e],o=this._getLineLeftOffset(e),n=o,s=0,r,a,u=0,l=i.length;u<l;u++)if(r=this.__charBounds[e][u].width,n+=r,n>t){a=!0;var h=n-r,f=n,g=Math.abs(h-t),p=Math.abs(f-t);s=p<g?u:u-1;break}return a||(s=i.length-1),s},moveCursorDown:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)},moveCursorUp:function(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)},_moveCursorUpOrDown:function(e,t){var i="get"+e+"CursorOffset",o=this[i](t,this._selectionDirection==="right");t.shiftKey?this.moveCursorWithShift(o):this.moveCursorWithoutShift(o),o!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(e){var t=this._selectionDirection==="left"?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0},moveCursorWithoutShift:function(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0},moveCursorLeft:function(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)},_move:function(e,t,i){var o;if(e.altKey)o=this["findWordBoundary"+i](this[t]);else if(e.metaKey||e.keyCode===35||e.keyCode===36)o=this["findLineBoundary"+i](this[t]);else return this[t]+=i==="Left"?-1:1,!0;if(typeof o<"u"&&this[t]!==o)return this[t]=o,!0},_moveLeft:function(e,t){return this._move(e,t,"Left")},_moveRight:function(e,t){return this._move(e,t,"Right")},moveCursorLeftWithoutShift:function(e){var t=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t},moveCursorLeftWithShift:function(e){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(e,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(e,"selectionStart")},moveCursorRight:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)},_moveCursorLeftOrRight:function(e,t){var i="moveCursor"+e+"With";this._currentCursorOpacity=1,t.shiftKey?i+="Shift":i+="outShift",this[i](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(e){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(e,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(e,"selectionEnd")},moveCursorRightWithoutShift:function(e){var t=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t},removeChars:function(e,t){typeof t>"u"&&(t=e+1),this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(e,t,i,o){typeof o>"u"&&(o=i),o>i&&this.removeStyleFromTo(i,o);var n=C.util.string.graphemeSplit(e);this.insertNewStyleBlock(n,i,t),this._text=[].concat(this._text.slice(0,i),n,this._text.slice(o)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}});(function(){var e=C.util.toFixed,t=/  +/g;C.util.object.extend(C.Text.prototype,{_toSVG:function(){var i=this._getSVGLeftTopOffsets(),o=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(o)},toSVG:function(i){return this._createBaseSVGMarkup(this._toSVG(),{reviver:i,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(i){var o=!0,n=this.getSvgTextDecoration(this);return[i.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",n?'text-decoration="'+n+'" ':"",'style="',this.getSvgStyles(o),'"',this.addPaintOrder()," >",i.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(i,o){var n=[],s=[],r=i,a;this._setSVGBg(s);for(var u=0,l=this._textLines.length;u<l;u++)a=this._getLineLeftOffset(u),(this.textBackgroundColor||this.styleHas("textBackgroundColor",u))&&this._setSVGTextLineBg(s,u,o+a,r),this._setSVGTextLineText(n,u,o+a,r),r+=this.getHeightOfLine(u);return{textSpans:n,textBgRects:s}},_createTextCharSpan:function(i,o,n,s){var r=i!==i.trim()||i.match(t),a=this.getSvgSpanStyles(o,r),u=a?'style="'+a+'"':"",l=o.deltaY,h="",f=C.Object.NUM_FRACTION_DIGITS;return l&&(h=' dy="'+e(l,f)+'" '),['<tspan x="',e(n,f),'" y="',e(s,f),'" ',h,u,">",C.util.string.escapeXml(i),"</tspan>"].join("")},_setSVGTextLineText:function(i,o,n,s){var r=this.getHeightOfLine(o),a=this.textAlign.indexOf("justify")!==-1,u,l,h="",f,g,p=0,v=this._textLines[o],y;s+=r*(1-this._fontSizeFraction)/this.lineHeight;for(var _=0,T=v.length-1;_<=T;_++)y=_===T||this.charSpacing,h+=v[_],f=this.__charBounds[o][_],p===0?(n+=f.kernedWidth-f.width,p+=f.width):p+=f.kernedWidth,a&&!y&&this._reSpaceAndTab.test(v[_])&&(y=!0),y||(u=u||this.getCompleteStyleDeclaration(o,_),l=this.getCompleteStyleDeclaration(o,_+1),y=C.util.hasStyleChanged(u,l,!0)),y&&(g=this._getStyleDeclaration(o,_)||{},i.push(this._createTextCharSpan(h,g,n,s)),h="",u=l,n+=p,p=0)},_pushTextBgRect:function(i,o,n,s,r,a){var u=C.Object.NUM_FRACTION_DIGITS;i.push("		<rect ",this._getFillAttributes(o),' x="',e(n,u),'" y="',e(s,u),'" width="',e(r,u),'" height="',e(a,u),`"></rect>
`)},_setSVGTextLineBg:function(i,o,n,s){for(var r=this._textLines[o],a=this.getHeightOfLine(o)/this.lineHeight,u=0,l=0,h,f,g=this.getValueOfPropertyAt(o,0,"textBackgroundColor"),p=0,v=r.length;p<v;p++)h=this.__charBounds[o][p],f=this.getValueOfPropertyAt(o,p,"textBackgroundColor"),f!==g?(g&&this._pushTextBgRect(i,g,n+l,s,u,a),l=h.left,u=h.width,g=f):u+=h.kernedWidth;f&&this._pushTextBgRect(i,f,n+l,s,u,a)},_getFillAttributes:function(i){var o=i&&typeof i=="string"?new C.Color(i):"";return!o||!o.getSource()||o.getAlpha()===1?'fill="'+i+'"':'opacity="'+o.getAlpha()+'" fill="'+o.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(i){for(var o=0,n=0,s=0;s<i;s++)o+=this.getHeightOfLine(s);return n=this.getHeightOfLine(s),{lineTop:o,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(i){var o=C.Object.prototype.getSvgStyles.call(this,i);return o+" white-space: pre;"}})})();(function(e){"use strict";var t=e.fabric||(e.fabric={});t.Textbox=t.util.createClass(t.IText,t.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:t.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(i){for(var o=0,n=0,s=0,r={},a=0;a<i.graphemeLines.length;a++)i.graphemeText[s]===`
`&&a>0?(n=0,s++,o++):!this.splitByGrapheme&&this._reSpaceAndTab.test(i.graphemeText[s])&&a>0&&(n++,s++),r[a]={line:o,offset:n},s+=i.graphemeLines[a].length,n+=i.graphemeLines[a].length;return r},styleHas:function(i,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[o];n&&(o=n.line)}return t.Text.prototype.styleHas.call(this,i,o)},isEmptyStyles:function(i){if(!this.styles)return!0;var o=0,n=i+1,s,r,a=!1,u=this._styleMap[i],l=this._styleMap[i+1];u&&(i=u.line,o=u.offset),l&&(n=l.line,a=n===i,s=l.offset),r=typeof i>"u"?this.styles:{line:this.styles[i]};for(var h in r)for(var f in r[h])if(f>=o&&(!a||f<s))for(var g in r[h][f])return!1;return!0},_getStyleDeclaration:function(i,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[i];if(!n)return null;i=n.line,o=n.offset+o}return this.callSuper("_getStyleDeclaration",i,o)},_setStyleDeclaration:function(i,o,n){var s=this._styleMap[i];i=s.line,o=s.offset+o,this.styles[i][o]=n},_deleteStyleDeclaration:function(i,o){var n=this._styleMap[i];i=n.line,o=n.offset+o,delete this.styles[i][o]},_getLineStyle:function(i){var o=this._styleMap[i];return!!this.styles[o.line]},_setLineStyle:function(i){var o=this._styleMap[i];this.styles[o.line]={}},_wrapText:function(i,o){var n=[],s;for(this.isWrapping=!0,s=0;s<i.length;s++)n=n.concat(this._wrapLine(i[s],s,o));return this.isWrapping=!1,n},_measureWord:function(i,o,n){var s=0,r,a=!0;n=n||0;for(var u=0,l=i.length;u<l;u++){var h=this._getGraphemeBox(i[u],o,u+n,r,a);s+=h.kernedWidth,r=i[u]}return s},_wrapLine:function(i,o,n,F){var r=0,a=this.splitByGrapheme,u=[],l=[],h=a?t.util.string.graphemeSplit(i):i.split(this._wordJoiners),f="",g=0,p=a?"":" ",v=0,y=0,_=0,T=!0,P=this._getWidthOfCharSpacing(),F=F||0;h.length===0&&h.push([]),n-=F;for(var j=0;j<h.length;j++)f=a?h[j]:t.util.string.graphemeSplit(h[j]),v=this._measureWord(f,o,g),g+=f.length,r+=y+v-P,r>n&&!T?(u.push(l),l=[],r=v,T=!0):r+=P,!T&&!a&&l.push(p),l=l.concat(f),y=a?0:this._measureWord([p],o,g),g++,T=!1,v>_&&(_=v);return j&&u.push(l),_+F>this.dynamicMinWidth&&(this.dynamicMinWidth=_-P+F),u},isEndOfWrapping:function(i){return!this._styleMap[i+1]||this._styleMap[i+1].line!==this._styleMap[i].line},missingNewlineOffset:function(i){return this.splitByGrapheme?this.isEndOfWrapping(i)?1:0:1},_splitTextIntoLines:function(i){for(var o=t.Text.prototype._splitTextIntoLines.call(this,i),n=this._wrapText(o.lines,this.width),s=new Array(n.length),r=0;r<n.length;r++)s[r]=n[r].join("");return o.lines=s,o.graphemeLines=n,o},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var i={};for(var o in this._styleMap)this._textLines[o]&&(i[this._styleMap[o].line]=1);for(var o in this.styles)i[o]||delete this.styles[o]},toObject:function(i){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(i))}}),t.Textbox.fromObject=function(i,o){var n=t.util.stylesFromArray(i.styles,i.text),s=Object.assign({},i,{styles:n});return t.Object._fromObject("Textbox",s,o,"text")}})(ut);(function(){var e=C.controlsUtils,t=e.scaleSkewCursorStyleHandler,i=e.scaleCursorStyleHandler,o=e.scalingEqually,n=e.scalingYOrSkewingX,s=e.scalingXOrSkewingY,r=e.scaleOrSkewActionName,a=C.Object.prototype.controls;if(a.ml=new C.Control({x:-.5,y:0,cursorStyleHandler:t,actionHandler:s,getActionName:r}),a.mr=new C.Control({x:.5,y:0,cursorStyleHandler:t,actionHandler:s,getActionName:r}),a.mb=new C.Control({x:0,y:.5,cursorStyleHandler:t,actionHandler:n,getActionName:r}),a.mt=new C.Control({x:0,y:-.5,cursorStyleHandler:t,actionHandler:n,getActionName:r}),a.tl=new C.Control({x:-.5,y:-.5,cursorStyleHandler:i,actionHandler:o}),a.tr=new C.Control({x:.5,y:-.5,cursorStyleHandler:i,actionHandler:o}),a.bl=new C.Control({x:-.5,y:.5,cursorStyleHandler:i,actionHandler:o}),a.br=new C.Control({x:.5,y:.5,cursorStyleHandler:i,actionHandler:o}),a.mtr=new C.Control({x:0,y:-.5,actionHandler:e.rotationWithSnapping,cursorStyleHandler:e.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),C.Textbox){var u=C.Textbox.prototype.controls={};u.mtr=a.mtr,u.tr=a.tr,u.br=a.br,u.tl=a.tl,u.bl=a.bl,u.mt=a.mt,u.mb=a.mb,u.mr=new C.Control({x:.5,y:0,actionHandler:e.changeWidth,cursorStyleHandler:t,actionName:"resizing"}),u.ml=new C.Control({x:-.5,y:0,actionHandler:e.changeWidth,cursorStyleHandler:t,actionName:"resizing"})}})()});var ju=je((v2,Hg)=>{"use strict";var Ug=Object.getOwnPropertySymbols,tT=Object.prototype.hasOwnProperty,eT=Object.prototype.propertyIsEnumerable;function iT(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function nT(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;var o=Object.getOwnPropertyNames(t).map(function(s){return t[s]});if(o.join("")!=="0123456789")return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(s){n[s]=s}),Object.keys(Object.assign({},n)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}Hg.exports=nT()?Object.assign:function(e,t){for(var i,o=iT(e),n,s=1;s<arguments.length;s++){i=Object(arguments[s]);for(var r in i)tT.call(i,r)&&(o[r]=i[r]);if(Ug){n=Ug(i);for(var a=0;a<n.length;a++)eT.call(i,n[a])&&(o[n[a]]=i[n[a]])}}return o}});var ap=je(Yt=>{"use strict";var Nu=ju(),gr=60103,qg=60106;Yt.Fragment=60107;Yt.StrictMode=60108;Yt.Profiler=60114;var Kg=60109,$g=60110,Qg=60112;Yt.Suspense=60113;var Zg=60115,Jg=60116;typeof Symbol=="function"&&Symbol.for&&(oi=Symbol.for,gr=oi("react.element"),qg=oi("react.portal"),Yt.Fragment=oi("react.fragment"),Yt.StrictMode=oi("react.strict_mode"),Yt.Profiler=oi("react.profiler"),Kg=oi("react.provider"),$g=oi("react.context"),Qg=oi("react.forward_ref"),Yt.Suspense=oi("react.suspense"),Zg=oi("react.memo"),Jg=oi("react.lazy"));var oi,Gg=typeof Symbol=="function"&&Symbol.iterator;function rT(e){return e===null||typeof e!="object"?null:(e=Gg&&e[Gg]||e["@@iterator"],typeof e=="function"?e:null)}function hs(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var tp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ep={};function pr(e,t,i){this.props=e,this.context=t,this.refs=ep,this.updater=i||tp}pr.prototype.isReactComponent={};pr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error(hs(85));this.updater.enqueueSetState(this,e,t,"setState")};pr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ip(){}ip.prototype=pr.prototype;function Xu(e,t,i){this.props=e,this.context=t,this.refs=ep,this.updater=i||tp}var Yu=Xu.prototype=new ip;Yu.constructor=Xu;Nu(Yu,pr.prototype);Yu.isPureReactComponent=!0;var zu={current:null},np=Object.prototype.hasOwnProperty,rp={key:!0,ref:!0,__self:!0,__source:!0};function sp(e,t,i){var o,n={},s=null,r=null;if(t!=null)for(o in t.ref!==void 0&&(r=t.ref),t.key!==void 0&&(s=""+t.key),t)np.call(t,o)&&!rp.hasOwnProperty(o)&&(n[o]=t[o]);var a=arguments.length-2;if(a===1)n.children=i;else if(1<a){for(var u=Array(a),l=0;l<a;l++)u[l]=arguments[l+2];n.children=u}if(e&&e.defaultProps)for(o in a=e.defaultProps,a)n[o]===void 0&&(n[o]=a[o]);return{$$typeof:gr,type:e,key:s,ref:r,props:n,_owner:zu.current}}function sT(e,t){return{$$typeof:gr,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Uu(e){return typeof e=="object"&&e!==null&&e.$$typeof===gr}function oT(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(i){return t[i]})}var Vg=/\/+/g;function Wu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?oT(""+e.key):t.toString(36)}function ta(e,t,i,o,n){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var r=!1;if(e===null)r=!0;else switch(s){case"string":case"number":r=!0;break;case"object":switch(e.$$typeof){case gr:case qg:r=!0}}if(r)return r=e,n=n(r),e=o===""?"."+Wu(r,0):o,Array.isArray(n)?(i="",e!=null&&(i=e.replace(Vg,"$&/")+"/"),ta(n,t,i,"",function(l){return l})):n!=null&&(Uu(n)&&(n=sT(n,i+(!n.key||r&&r.key===n.key?"":(""+n.key).replace(Vg,"$&/")+"/")+e)),t.push(n)),1;if(r=0,o=o===""?".":o+":",Array.isArray(e))for(var a=0;a<e.length;a++){s=e[a];var u=o+Wu(s,a);r+=ta(s,t,i,u,n)}else if(u=rT(e),typeof u=="function")for(e=u.call(e),a=0;!(s=e.next()).done;)s=s.value,u=o+Wu(s,a++),r+=ta(s,t,i,u,n);else if(s==="object")throw t=""+e,Error(hs(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t));return r}function Jo(e,t,i){if(e==null)return e;var o=[],n=0;return ta(e,o,"","",function(s){return t.call(i,s,n++)}),o}function aT(e){if(e._status===-1){var t=e._result;t=t(),e._status=0,e._result=t,t.then(function(i){e._status===0&&(i=i.default,e._status=1,e._result=i)},function(i){e._status===0&&(e._status=2,e._result=i)})}if(e._status===1)return e._result;throw e._result}var op={current:null};function zi(){var e=op.current;if(e===null)throw Error(hs(321));return e}var lT={ReactCurrentDispatcher:op,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:zu,IsSomeRendererActing:{current:!1},assign:Nu};Yt.Children={map:Jo,forEach:function(e,t,i){Jo(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return Jo(e,function(){t++}),t},toArray:function(e){return Jo(e,function(t){return t})||[]},only:function(e){if(!Uu(e))throw Error(hs(143));return e}};Yt.Component=pr;Yt.PureComponent=Xu;Yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lT;Yt.cloneElement=function(e,t,i){if(e==null)throw Error(hs(267,e));var o=Nu({},e.props),n=e.key,s=e.ref,r=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,r=zu.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(u in t)np.call(t,u)&&!rp.hasOwnProperty(u)&&(o[u]=t[u]===void 0&&a!==void 0?a[u]:t[u])}var u=arguments.length-2;if(u===1)o.children=i;else if(1<u){a=Array(u);for(var l=0;l<u;l++)a[l]=arguments[l+2];o.children=a}return{$$typeof:gr,type:e.type,key:n,ref:s,props:o,_owner:r}};Yt.createContext=function(e,t){return t===void 0&&(t=null),e={$$typeof:$g,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider={$$typeof:Kg,_context:e},e.Consumer=e};Yt.createElement=sp;Yt.createFactory=function(e){var t=sp.bind(null,e);return t.type=e,t};Yt.createRef=function(){return{current:null}};Yt.forwardRef=function(e){return{$$typeof:Qg,render:e}};Yt.isValidElement=Uu;Yt.lazy=function(e){return{$$typeof:Jg,_payload:{_status:-1,_result:e},_init:aT}};Yt.memo=function(e,t){return{$$typeof:Zg,type:e,compare:t===void 0?null:t}};Yt.useCallback=function(e,t){return zi().useCallback(e,t)};Yt.useContext=function(e,t){return zi().useContext(e,t)};Yt.useDebugValue=function(){};Yt.useEffect=function(e,t){return zi().useEffect(e,t)};Yt.useImperativeHandle=function(e,t,i){return zi().useImperativeHandle(e,t,i)};Yt.useLayoutEffect=function(e,t){return zi().useLayoutEffect(e,t)};Yt.useMemo=function(e,t){return zi().useMemo(e,t)};Yt.useReducer=function(e,t,i){return zi().useReducer(e,t,i)};Yt.useRef=function(e){return zi().useRef(e)};Yt.useState=function(e){return zi().useState(e)};Yt.version="17.0.2"});var Hu=je((_2,lp)=>{"use strict";lp.exports=ap()});var gp=je(Ht=>{"use strict";var vr,ds,ra,Zu;typeof performance=="object"&&typeof performance.now=="function"?(up=performance,Ht.unstable_now=function(){return up.now()}):(Gu=Date,hp=Gu.now(),Ht.unstable_now=function(){return Gu.now()-hp});var up,Gu,hp;typeof window>"u"||typeof MessageChannel!="function"?(mr=null,Vu=null,qu=function(){if(mr!==null)try{var e=Ht.unstable_now();mr(!0,e),mr=null}catch(t){throw setTimeout(qu,0),t}},vr=function(e){mr!==null?setTimeout(vr,0,e):(mr=e,setTimeout(qu,0))},ds=function(e,t){Vu=setTimeout(e,t)},ra=function(){clearTimeout(Vu)},Ht.unstable_shouldYield=function(){return!1},Zu=Ht.unstable_forceFrameRate=function(){}):(cp=window.setTimeout,fp=window.clearTimeout,typeof console<"u"&&(dp=window.cancelAnimationFrame,typeof window.requestAnimationFrame!="function"&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),typeof dp!="function"&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")),cs=!1,fs=null,ea=-1,Ku=5,$u=0,Ht.unstable_shouldYield=function(){return Ht.unstable_now()>=$u},Zu=function(){},Ht.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ku=0<e?Math.floor(1e3/e):5},Qu=new MessageChannel,ia=Qu.port2,Qu.port1.onmessage=function(){if(fs!==null){var e=Ht.unstable_now();$u=e+Ku;try{fs(!0,e)?ia.postMessage(null):(cs=!1,fs=null)}catch(t){throw ia.postMessage(null),t}}else cs=!1},vr=function(e){fs=e,cs||(cs=!0,ia.postMessage(null))},ds=function(e,t){ea=cp(function(){e(Ht.unstable_now())},t)},ra=function(){fp(ea),ea=-1});var mr,Vu,qu,cp,fp,dp,cs,fs,ea,Ku,$u,Qu,ia;function Ju(e,t){var i=e.length;e.push(t);t:for(;;){var o=i-1>>>1,n=e[o];if(n!==void 0&&0<na(n,t))e[o]=t,e[i]=n,i=o;else break t}}function yi(e){return e=e[0],e===void 0?null:e}function sa(e){var t=e[0];if(t!==void 0){var i=e.pop();if(i!==t){e[0]=i;t:for(var o=0,n=e.length;o<n;){var s=2*(o+1)-1,r=e[s],a=s+1,u=e[a];if(r!==void 0&&0>na(r,i))u!==void 0&&0>na(u,r)?(e[o]=u,e[a]=i,o=a):(e[o]=r,e[s]=i,o=s);else if(u!==void 0&&0>na(u,i))e[o]=u,e[a]=i,o=a;else break t}}return t}return null}function na(e,t){var i=e.sortIndex-t.sortIndex;return i!==0?i:e.id-t.id}var bi=[],an=[],uT=1,ai=null,Te=3,oa=!1,Nn=!1,gs=!1;function th(e){for(var t=yi(an);t!==null;){if(t.callback===null)sa(an);else if(t.startTime<=e)sa(an),t.sortIndex=t.expirationTime,Ju(bi,t);else break;t=yi(an)}}function eh(e){if(gs=!1,th(e),!Nn)if(yi(bi)!==null)Nn=!0,vr(ih);else{var t=yi(an);t!==null&&ds(eh,t.startTime-e)}}function ih(e,t){Nn=!1,gs&&(gs=!1,ra()),oa=!0;var i=Te;try{for(th(t),ai=yi(bi);ai!==null&&(!(ai.expirationTime>t)||e&&!Ht.unstable_shouldYield());){var o=ai.callback;if(typeof o=="function"){ai.callback=null,Te=ai.priorityLevel;var n=o(ai.expirationTime<=t);t=Ht.unstable_now(),typeof n=="function"?ai.callback=n:ai===yi(bi)&&sa(bi),th(t)}else sa(bi);ai=yi(bi)}if(ai!==null)var s=!0;else{var r=yi(an);r!==null&&ds(eh,r.startTime-t),s=!1}return s}finally{ai=null,Te=i,oa=!1}}var hT=Zu;Ht.unstable_IdlePriority=5;Ht.unstable_ImmediatePriority=1;Ht.unstable_LowPriority=4;Ht.unstable_NormalPriority=3;Ht.unstable_Profiling=null;Ht.unstable_UserBlockingPriority=2;Ht.unstable_cancelCallback=function(e){e.callback=null};Ht.unstable_continueExecution=function(){Nn||oa||(Nn=!0,vr(ih))};Ht.unstable_getCurrentPriorityLevel=function(){return Te};Ht.unstable_getFirstCallbackNode=function(){return yi(bi)};Ht.unstable_next=function(e){switch(Te){case 1:case 2:case 3:var t=3;break;default:t=Te}var i=Te;Te=t;try{return e()}finally{Te=i}};Ht.unstable_pauseExecution=function(){};Ht.unstable_requestPaint=hT;Ht.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=Te;Te=e;try{return t()}finally{Te=i}};Ht.unstable_scheduleCallback=function(e,t,i){var o=Ht.unstable_now();switch(typeof i=="object"&&i!==null?(i=i.delay,i=typeof i=="number"&&0<i?o+i:o):i=o,e){case 1:var n=-1;break;case 2:n=250;break;case 5:n=1073741823;break;case 4:n=1e4;break;default:n=5e3}return n=i+n,e={id:uT++,callback:t,priorityLevel:e,startTime:i,expirationTime:n,sortIndex:-1},i>o?(e.sortIndex=i,Ju(an,e),yi(bi)===null&&e===yi(an)&&(gs?ra():gs=!0,ds(eh,i-o))):(e.sortIndex=n,Ju(bi,e),Nn||oa||(Nn=!0,vr(ih))),e};Ht.unstable_wrapCallback=function(e){var t=Te;return function(){var i=Te;Te=t;try{return e.apply(this,arguments)}finally{Te=i}}}});var mp=je((S2,pp)=>{"use strict";pp.exports=gp()});var i0=je(di=>{"use strict";var Ja=Hu(),ie=ju(),ve=mp();function Ct(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!Ja)throw Error(Ct(227));var km=new Set,Us={};function Qn(e,t){jr(e,t),jr(e+"Capture",t)}function jr(e,t){for(Us[e]=t,e=0;e<t.length;e++)km.add(t[e])}var Ki=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,vp=Object.prototype.hasOwnProperty,yp={},_p={};function fT(e){return vp.call(_p,e)?!0:vp.call(yp,e)?!1:cT.test(e)?_p[e]=!0:(yp[e]=!0,!1)}function dT(e,t,i,o){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return o?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function gT(e,t,i,o){if(t===null||typeof t>"u"||dT(e,t,i,o))return!0;if(o)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Fe(e,t,i,o,n,s,r){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=o,this.attributeNamespace=n,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=r}var Se={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Se[e]=new Fe(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Se[t]=new Fe(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Se[e]=new Fe(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Se[e]=new Fe(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Se[e]=new Fe(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Se[e]=new Fe(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Se[e]=new Fe(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Se[e]=new Fe(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Se[e]=new Fe(e,5,!1,e.toLowerCase(),null,!1,!1)});var cc=/[\-:]([a-z])/g;function fc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(cc,fc);Se[t]=new Fe(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(cc,fc);Se[t]=new Fe(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(cc,fc);Se[t]=new Fe(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Se[e]=new Fe(e,1,!1,e.toLowerCase(),null,!1,!1)});Se.xlinkHref=new Fe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Se[e]=new Fe(e,1,!1,e.toLowerCase(),null,!0,!0)});function dc(e,t,i,o){var n=Se.hasOwnProperty(t)?Se[t]:null,s=n!==null?n.type===0:o?!1:!(!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N");s||(gT(t,i,n,o)&&(i=null),o||n===null?fT(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):n.mustUseProperty?e[n.propertyName]=i===null?n.type===3?!1:"":i:(t=n.attributeName,o=n.attributeNamespace,i===null?e.removeAttribute(t):(n=n.type,i=n===3||n===4&&i===!0?"":""+i,o?e.setAttributeNS(o,t,i):e.setAttribute(t,i))))}var Zn=Ja.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Es=60103,Yn=60106,un=60107,gc=60108,Ms=60114,pc=60109,mc=60110,tl=60112,Fs=60113,Aa=60120,el=60115,vc=60116,yc=60121,_c=60128,Am=60129,Cc=60130,bh=60131;typeof Symbol=="function"&&Symbol.for&&(de=Symbol.for,Es=de("react.element"),Yn=de("react.portal"),un=de("react.fragment"),gc=de("react.strict_mode"),Ms=de("react.profiler"),pc=de("react.provider"),mc=de("react.context"),tl=de("react.forward_ref"),Fs=de("react.suspense"),Aa=de("react.suspense_list"),el=de("react.memo"),vc=de("react.lazy"),yc=de("react.block"),de("react.scope"),_c=de("react.opaque.id"),Am=de("react.debug_trace_mode"),Cc=de("react.offscreen"),bh=de("react.legacy_hidden"));var de,Cp=typeof Symbol=="function"&&Symbol.iterator;function ps(e){return e===null||typeof e!="object"?null:(e=Cp&&e[Cp]||e["@@iterator"],typeof e=="function"?e:null)}var nh;function Ps(e){if(nh===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);nh=t&&t[1]||""}return`
`+nh+e}var rh=!1;function aa(e,t){if(!e||rh)return"";rh=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var o=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){o=u}e.call(t.prototype)}else{try{throw Error()}catch(u){o=u}e()}}catch(u){if(u&&o&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),s=o.stack.split(`
`),r=n.length-1,a=s.length-1;1<=r&&0<=a&&n[r]!==s[a];)a--;for(;1<=r&&0<=a;r--,a--)if(n[r]!==s[a]){if(r!==1||a!==1)do if(r--,a--,0>a||n[r]!==s[a])return`
`+n[r].replace(" at new "," at ");while(1<=r&&0<=a);break}}}finally{rh=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?Ps(e):""}function pT(e){switch(e.tag){case 5:return Ps(e.type);case 16:return Ps("Lazy");case 13:return Ps("Suspense");case 19:return Ps("SuspenseList");case 0:case 2:case 15:return e=aa(e.type,!1),e;case 11:return e=aa(e.type.render,!1),e;case 22:return e=aa(e.type._render,!1),e;case 1:return e=aa(e.type,!0),e;default:return""}}function Pr(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case un:return"Fragment";case Yn:return"Portal";case Ms:return"Profiler";case gc:return"StrictMode";case Fs:return"Suspense";case Aa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case mc:return(e.displayName||"Context")+".Consumer";case pc:return(e._context.displayName||"Context")+".Provider";case tl:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case el:return Pr(e.type);case yc:return Pr(e._render);case vc:t=e._payload,e=e._init;try{return Pr(e(t))}catch{}}return null}function Sn(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function Dm(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function mT(e){var t=Dm(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var n=i.get,s=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(r){o=""+r,s.call(this,r)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return o},setValue:function(r){o=""+r},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function la(e){e._valueTracker||(e._valueTracker=mT(e))}function Mm(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),o="";return e&&(o=Dm(e)?e.checked?"true":"false":e.value),e=o,e!==i?(t.setValue(e),!0):!1}function Da(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Oh(e,t){var i=t.checked;return ie({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function Sp(e,t){var i=t.defaultValue==null?"":t.defaultValue,o=t.checked!=null?t.checked:t.defaultChecked;i=Sn(t.value!=null?t.value:i),e._wrapperState={initialChecked:o,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Fm(e,t){t=t.checked,t!=null&&dc(e,"checked",t,!1)}function Eh(e,t){Fm(e,t);var i=Sn(t.value),o=t.type;if(i!=null)o==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ph(e,t.type,i):t.hasOwnProperty("defaultValue")&&Ph(e,t.type,Sn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function wp(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!(o!=="submit"&&o!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function Ph(e,t,i){(t!=="number"||Da(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}function vT(e){var t="";return Ja.Children.forEach(e,function(i){i!=null&&(t+=i)}),t}function kh(e,t){return e=ie({children:void 0},t),(t=vT(t.children))&&(e.children=t),e}function kr(e,t,i,o){if(e=e.options,t){t={};for(var n=0;n<i.length;n++)t["$"+i[n]]=!0;for(i=0;i<e.length;i++)n=t.hasOwnProperty("$"+e[i].value),e[i].selected!==n&&(e[i].selected=n),n&&o&&(e[i].defaultSelected=!0)}else{for(i=""+Sn(i),t=null,n=0;n<e.length;n++){if(e[n].value===i){e[n].selected=!0,o&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function Ah(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ct(91));return ie({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function xp(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(Ct(92));if(Array.isArray(i)){if(!(1>=i.length))throw Error(Ct(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:Sn(i)}}function Lm(e,t){var i=Sn(t.value),o=Sn(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),o!=null&&(e.defaultValue=""+o)}function Tp(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}var Dh={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function Im(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mh(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Im(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ua,Rm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,o,n){MSApp.execUnsafeLocalFunction(function(){return e(t,i,o,n)})}:e}(function(e,t){if(e.namespaceURI!==Dh.svg||"innerHTML"in e)e.innerHTML=t;else{for(ua=ua||document.createElement("div"),ua.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ua.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Hs(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var Ls={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yT=["Webkit","ms","Moz","O"];Object.keys(Ls).forEach(function(e){yT.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ls[t]=Ls[e]})});function Bm(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||Ls.hasOwnProperty(e)&&Ls[e]?(""+t).trim():t+"px"}function jm(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var o=i.indexOf("--")===0,n=Bm(i,t[i],o);i==="float"&&(i="cssFloat"),o?e.setProperty(i,n):e[i]=n}}var _T=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fh(e,t){if(t){if(_T[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ct(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ct(60));if(!(typeof t.dangerouslySetInnerHTML=="object"&&"__html"in t.dangerouslySetInnerHTML))throw Error(Ct(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ct(62))}}function Lh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Sc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ih=null,Ar=null,Dr=null;function bp(e){if(e=so(e)){if(typeof Ih!="function")throw Error(Ct(280));var t=e.stateNode;t&&(t=al(t),Ih(e.stateNode,e.type,t))}}function Wm(e){Ar?Dr?Dr.push(e):Dr=[e]:Ar=e}function Nm(){if(Ar){var e=Ar,t=Dr;if(Dr=Ar=null,bp(e),t)for(e=0;e<t.length;e++)bp(t[e])}}function wc(e,t){return e(t)}function Xm(e,t,i,o,n){return e(t,i,o,n)}function xc(){}var Ym=wc,zn=!1,sh=!1;function Tc(){(Ar!==null||Dr!==null)&&(xc(),Nm())}function CT(e,t,i){if(sh)return e(t,i);sh=!0;try{return Ym(e,t,i)}finally{sh=!1,Tc()}}function Gs(e,t){var i=e.stateNode;if(i===null)return null;var o=al(i);if(o===null)return null;i=o[t];t:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break t;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(Ct(231,t,typeof i));return i}var Rh=!1;if(Ki)try{yr={},Object.defineProperty(yr,"passive",{get:function(){Rh=!0}}),window.addEventListener("test",yr,yr),window.removeEventListener("test",yr,yr)}catch{Rh=!1}var yr;function ST(e,t,i,o,n,s,r,a,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(i,l)}catch(h){this.onError(h)}}var Is=!1,Ma=null,Fa=!1,Bh=null,wT={onError:function(e){Is=!0,Ma=e}};function xT(e,t,i,o,n,s,r,a,u){Is=!1,Ma=null,ST.apply(wT,arguments)}function TT(e,t,i,o,n,s,r,a,u){if(xT.apply(this,arguments),Is){if(Is){var l=Ma;Is=!1,Ma=null}else throw Error(Ct(198));Fa||(Fa=!0,Bh=l)}}function Jn(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&1026&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function zm(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Op(e){if(Jn(e)!==e)throw Error(Ct(188))}function bT(e){var t=e.alternate;if(!t){if(t=Jn(e),t===null)throw Error(Ct(188));return t!==e?null:e}for(var i=e,o=t;;){var n=i.return;if(n===null)break;var s=n.alternate;if(s===null){if(o=n.return,o!==null){i=o;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===i)return Op(n),e;if(s===o)return Op(n),t;s=s.sibling}throw Error(Ct(188))}if(i.return!==o.return)i=n,o=s;else{for(var r=!1,a=n.child;a;){if(a===i){r=!0,i=n,o=s;break}if(a===o){r=!0,o=n,i=s;break}a=a.sibling}if(!r){for(a=s.child;a;){if(a===i){r=!0,i=s,o=n;break}if(a===o){r=!0,o=s,i=n;break}a=a.sibling}if(!r)throw Error(Ct(189))}}if(i.alternate!==o)throw Error(Ct(190))}if(i.tag!==3)throw Error(Ct(188));return i.stateNode.current===i?e:t}function Um(e){if(e=bT(e),!e)return null;for(var t=e;;){if(t.tag===5||t.tag===6)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function Ep(e,t){for(var i=e.alternate;t!==null;){if(t===e||t===i)return!0;t=t.return}return!1}var Hm,bc,Gm,Vm,jh=!1,Oi=[],dn=null,gn=null,pn=null,Vs=new Map,qs=new Map,ms=[],Pp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wh(e,t,i,o,n){return{blockedOn:e,domEventName:t,eventSystemFlags:i|16,nativeEvent:n,targetContainers:[o]}}function kp(e,t){switch(e){case"focusin":case"focusout":dn=null;break;case"dragenter":case"dragleave":gn=null;break;case"mouseover":case"mouseout":pn=null;break;case"pointerover":case"pointerout":Vs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":qs.delete(t.pointerId)}}function vs(e,t,i,o,n,s){return e===null||e.nativeEvent!==s?(e=Wh(t,i,o,n,s),t!==null&&(t=so(t),t!==null&&bc(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function OT(e,t,i,o,n){switch(t){case"focusin":return dn=vs(dn,e,t,i,o,n),!0;case"dragenter":return gn=vs(gn,e,t,i,o,n),!0;case"mouseover":return pn=vs(pn,e,t,i,o,n),!0;case"pointerover":var s=n.pointerId;return Vs.set(s,vs(Vs.get(s)||null,e,t,i,o,n)),!0;case"gotpointercapture":return s=n.pointerId,qs.set(s,vs(qs.get(s)||null,e,t,i,o,n)),!0}return!1}function ET(e){var t=Un(e.target);if(t!==null){var i=Jn(t);if(i!==null){if(t=i.tag,t===13){if(t=zm(i),t!==null){e.blockedOn=t,Vm(e.lanePriority,function(){ve.unstable_runWithPriority(e.priority,function(){Gm(i)})});return}}else if(t===3&&i.stateNode.hydrate){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ca(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=kc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i!==null)return t=so(i),t!==null&&bc(t),e.blockedOn=i,!1;t.shift()}return!0}function Ap(e,t,i){Ca(e)&&i.delete(t)}function PT(){for(jh=!1;0<Oi.length;){var e=Oi[0];if(e.blockedOn!==null){e=so(e.blockedOn),e!==null&&Hm(e);break}for(var t=e.targetContainers;0<t.length;){var i=kc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i!==null){e.blockedOn=i;break}t.shift()}e.blockedOn===null&&Oi.shift()}dn!==null&&Ca(dn)&&(dn=null),gn!==null&&Ca(gn)&&(gn=null),pn!==null&&Ca(pn)&&(pn=null),Vs.forEach(Ap),qs.forEach(Ap)}function ys(e,t){e.blockedOn===t&&(e.blockedOn=null,jh||(jh=!0,ve.unstable_scheduleCallback(ve.unstable_NormalPriority,PT)))}function qm(e){function t(n){return ys(n,e)}if(0<Oi.length){ys(Oi[0],e);for(var i=1;i<Oi.length;i++){var o=Oi[i];o.blockedOn===e&&(o.blockedOn=null)}}for(dn!==null&&ys(dn,e),gn!==null&&ys(gn,e),pn!==null&&ys(pn,e),Vs.forEach(t),qs.forEach(t),i=0;i<ms.length;i++)o=ms[i],o.blockedOn===e&&(o.blockedOn=null);for(;0<ms.length&&(i=ms[0],i.blockedOn===null);)ET(i),i.blockedOn===null&&ms.shift()}function ha(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var wr={animationend:ha("Animation","AnimationEnd"),animationiteration:ha("Animation","AnimationIteration"),animationstart:ha("Animation","AnimationStart"),transitionend:ha("Transition","TransitionEnd")},oh={},Km={};Ki&&(Km=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);function il(e){if(oh[e])return oh[e];if(!wr[e])return e;var t=wr[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in Km)return oh[e]=t[i];return e}var $m=il("animationend"),Qm=il("animationiteration"),Zm=il("animationstart"),Jm=il("transitionend"),tv=new Map,Oc=new Map,kT=["abort","abort",$m,"animationEnd",Qm,"animationIteration",Zm,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Jm,"transitionEnd","waiting","waiting"];function Ec(e,t){for(var i=0;i<e.length;i+=2){var o=e[i],n=e[i+1];n="on"+(n[0].toUpperCase()+n.slice(1)),Oc.set(o,t),tv.set(o,n),Qn(n,[o])}}var AT=ve.unstable_now;AT();var Qt=8;function Cr(e){if(1&e)return Qt=15,1;if(2&e)return Qt=14,2;if(4&e)return Qt=13,4;var t=24&e;return t!==0?(Qt=12,t):e&32?(Qt=11,32):(t=192&e,t!==0?(Qt=10,t):e&256?(Qt=9,256):(t=3584&e,t!==0?(Qt=8,t):e&4096?(Qt=7,4096):(t=4186112&e,t!==0?(Qt=6,t):(t=62914560&e,t!==0?(Qt=5,t):e&67108864?(Qt=4,67108864):e&134217728?(Qt=3,134217728):(t=805306368&e,t!==0?(Qt=2,t):1073741824&e?(Qt=1,1073741824):(Qt=8,e))))))}function DT(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}function MT(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(Ct(358,e))}}function Ks(e,t){var i=e.pendingLanes;if(i===0)return Qt=0;var o=0,n=0,s=e.expiredLanes,r=e.suspendedLanes,a=e.pingedLanes;if(s!==0)o=s,n=Qt=15;else if(s=i&134217727,s!==0){var u=s&~r;u!==0?(o=Cr(u),n=Qt):(a&=s,a!==0&&(o=Cr(a),n=Qt))}else s=i&~r,s!==0?(o=Cr(s),n=Qt):a!==0&&(o=Cr(a),n=Qt);if(o===0)return 0;if(o=31-wn(o),o=i&((0>o?0:1<<o)<<1)-1,t!==0&&t!==o&&!(t&r)){if(Cr(t),n<=Qt)return t;Qt=n}if(t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=o;0<t;)i=31-wn(t),n=1<<i,o|=e[i],t&=~n;return o}function ev(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function La(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return e=Sr(24&~t),e===0?La(10,t):e;case 10:return e=Sr(192&~t),e===0?La(8,t):e;case 8:return e=Sr(3584&~t),e===0&&(e=Sr(4186112&~t),e===0&&(e=512)),e;case 2:return t=Sr(805306368&~t),t===0&&(t=268435456),t}throw Error(Ct(358,e))}function Sr(e){return e&-e}function ah(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function nl(e,t,i){e.pendingLanes|=t;var o=t-1;e.suspendedLanes&=o,e.pingedLanes&=o,e=e.eventTimes,t=31-wn(t),e[t]=i}var wn=Math.clz32?Math.clz32:IT,FT=Math.log,LT=Math.LN2;function IT(e){return e===0?32:31-(FT(e)/LT|0)|0}var RT=ve.unstable_UserBlockingPriority,BT=ve.unstable_runWithPriority,Sa=!0;function jT(e,t,i,o){zn||xc();var n=Pc,s=zn;zn=!0;try{Xm(n,e,t,i,o)}finally{(zn=s)||Tc()}}function WT(e,t,i,o){BT(RT,Pc.bind(null,e,t,i,o))}function Pc(e,t,i,o){if(Sa){var n;if((n=(t&4)===0)&&0<Oi.length&&-1<Pp.indexOf(e))e=Wh(null,e,t,i,o),Oi.push(e);else{var s=kc(e,t,i,o);if(s===null)n&&kp(e,o);else{if(n){if(-1<Pp.indexOf(e)){e=Wh(s,e,t,i,o),Oi.push(e);return}if(OT(s,e,t,i,o))return;kp(e,o)}gv(e,t,o,null,i)}}}}function kc(e,t,i,o){var n=Sc(o);if(n=Un(n),n!==null){var s=Jn(n);if(s===null)n=null;else{var r=s.tag;if(r===13){if(n=zm(s),n!==null)return n;n=null}else if(r===3){if(s.stateNode.hydrate)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return gv(e,t,o,n,i),null}var hn=null,Ac=null,wa=null;function iv(){if(wa)return wa;var e,t=Ac,i=t.length,o,n="value"in hn?hn.value:hn.textContent,s=n.length;for(e=0;e<i&&t[e]===n[e];e++);var r=i-e;for(o=1;o<=r&&t[i-o]===n[s-o];o++);return wa=n.slice(e,1<o?1-o:void 0)}function xa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ca(){return!0}function Dp(){return!1}function Qe(e){function t(i,o,n,s,r){this._reactName=i,this._targetInst=n,this.type=o,this.nativeEvent=s,this.target=r,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(i=e[a],this[a]=i?i(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ca:Dp,this.isPropagationStopped=Dp,this}return ie(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=ca)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=ca)},persist:function(){},isPersistent:ca}),t}var Yr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dc=Qe(Yr),ro=ie({},Yr,{view:0,detail:0}),NT=Qe(ro),lh,uh,_s,rl=ie({},ro,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==_s&&(_s&&e.type==="mousemove"?(lh=e.screenX-_s.screenX,uh=e.screenY-_s.screenY):uh=lh=0,_s=e),lh)},movementY:function(e){return"movementY"in e?e.movementY:uh}}),Mp=Qe(rl),XT=ie({},rl,{dataTransfer:0}),YT=Qe(XT),zT=ie({},ro,{relatedTarget:0}),hh=Qe(zT),UT=ie({},Yr,{animationName:0,elapsedTime:0,pseudoElement:0}),HT=Qe(UT),GT=ie({},Yr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),VT=Qe(GT),qT=ie({},Yr,{data:0}),Fp=Qe(qT),KT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$T={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},QT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ZT(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=QT[e])?!!t[e]:!1}function Mc(){return ZT}var JT=ie({},ro,{key:function(e){if(e.key){var t=KT[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=xa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?$T[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mc,charCode:function(e){return e.type==="keypress"?xa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?xa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),tb=Qe(JT),eb=ie({},rl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lp=Qe(eb),ib=ie({},ro,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mc}),nb=Qe(ib),rb=ie({},Yr,{propertyName:0,elapsedTime:0,pseudoElement:0}),sb=Qe(rb),ob=ie({},rl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ab=Qe(ob),lb=[9,13,27,32],Fc=Ki&&"CompositionEvent"in window,Rs=null;Ki&&"documentMode"in document&&(Rs=document.documentMode);var ub=Ki&&"TextEvent"in window&&!Rs,nv=Ki&&(!Fc||Rs&&8<Rs&&11>=Rs),Ip=String.fromCharCode(32),Rp=!1;function rv(e,t){switch(e){case"keyup":return lb.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xr=!1;function hb(e,t){switch(e){case"compositionend":return sv(t);case"keypress":return t.which!==32?null:(Rp=!0,Ip);case"textInput":return e=t.data,e===Ip&&Rp?null:e;default:return null}}function cb(e,t){if(xr)return e==="compositionend"||!Fc&&rv(e,t)?(e=iv(),wa=Ac=hn=null,xr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return nv&&t.locale!=="ko"?null:t.data;default:return null}}var fb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!fb[e.type]:t==="textarea"}function ov(e,t,i,o){Wm(o),t=Ia(t,"onChange"),0<t.length&&(i=new Dc("onChange","change",null,i,o),e.push({event:i,listeners:t}))}var Bs=null,$s=null;function db(e){cv(e,0)}function sl(e){var t=br(e);if(Mm(t))return e}function gb(e,t){if(e==="change")return t}var av=!1;Ki&&(Ki?(da="oninput"in document,da||(ch=document.createElement("div"),ch.setAttribute("oninput","return;"),da=typeof ch.oninput=="function"),fa=da):fa=!1,av=fa&&(!document.documentMode||9<document.documentMode));var fa,da,ch;function jp(){Bs&&(Bs.detachEvent("onpropertychange",lv),$s=Bs=null)}function lv(e){if(e.propertyName==="value"&&sl($s)){var t=[];if(ov(t,$s,e,Sc(e)),e=db,zn)e(t);else{zn=!0;try{wc(e,t)}finally{zn=!1,Tc()}}}}function pb(e,t,i){e==="focusin"?(jp(),Bs=t,$s=i,Bs.attachEvent("onpropertychange",lv)):e==="focusout"&&jp()}function mb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return sl($s)}function vb(e,t){if(e==="click")return sl(t)}function yb(e,t){if(e==="input"||e==="change")return sl(t)}function _b(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var li=typeof Object.is=="function"?Object.is:_b,Cb=Object.prototype.hasOwnProperty;function Qs(e,t){if(li(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(o=0;o<i.length;o++)if(!Cb.call(t,i[o])||!li(e[i[o]],t[i[o]]))return!1;return!0}function Wp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Np(e,t){var i=Wp(e);e=0;for(var o;i;){if(i.nodeType===3){if(o=e+i.textContent.length,e<=t&&o>=t)return{node:i,offset:t-e};e=o}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=Wp(i)}}function uv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?uv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Xp(){for(var e=window,t=Da();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=Da(e.document)}return t}function Nh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Sb=Ki&&"documentMode"in document&&11>=document.documentMode,Tr=null,Xh=null,js=null,Yh=!1;function Yp(e,t,i){var o=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Yh||Tr==null||Tr!==Da(o)||(o=Tr,"selectionStart"in o&&Nh(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),js&&Qs(js,o)||(js=o,o=Ia(Xh,"onSelect"),0<o.length&&(t=new Dc("onSelect","select",null,t,i),e.push({event:t,listeners:o}),t.target=Tr)))}Ec("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0);Ec("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);Ec(kT,2);for(fh="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),ga=0;ga<fh.length;ga++)Oc.set(fh[ga],0);var fh,ga;jr("onMouseEnter",["mouseout","mouseover"]);jr("onMouseLeave",["mouseout","mouseover"]);jr("onPointerEnter",["pointerout","pointerover"]);jr("onPointerLeave",["pointerout","pointerover"]);Qn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ks="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hv=new Set("cancel close invalid load scroll toggle".split(" ").concat(ks));function zp(e,t,i){var o=e.type||"unknown-event";e.currentTarget=i,TT(o,t,void 0,e),e.currentTarget=null}function cv(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var o=e[i],n=o.event;o=o.listeners;t:{var s=void 0;if(t)for(var r=o.length-1;0<=r;r--){var a=o[r],u=a.instance,l=a.currentTarget;if(a=a.listener,u!==s&&n.isPropagationStopped())break t;zp(n,a,l),s=u}else for(r=0;r<o.length;r++){if(a=o[r],u=a.instance,l=a.currentTarget,a=a.listener,u!==s&&n.isPropagationStopped())break t;zp(n,a,l),s=u}}}if(Fa)throw e=Bh,Fa=!1,Bh=null,e}function Jt(e,t){var i=mv(t),o=e+"__bubble";i.has(o)||(dv(t,e,2,!1),i.add(o))}var Up="_reactListening"+Math.random().toString(36).slice(2);function fv(e){e[Up]||(e[Up]=!0,km.forEach(function(t){hv.has(t)||Hp(t,!1,e,null),Hp(t,!0,e,null)}))}function Hp(e,t,i,o){var n=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,s=i;if(e==="selectionchange"&&i.nodeType!==9&&(s=i.ownerDocument),o!==null&&!t&&hv.has(e)){if(e!=="scroll")return;n|=2,s=o}var r=mv(s),a=e+"__"+(t?"capture":"bubble");r.has(a)||(t&&(n|=4),dv(s,e,n,t),r.add(a))}function dv(e,t,i,o){var n=Oc.get(t);switch(n===void 0?2:n){case 0:n=jT;break;case 1:n=WT;break;default:n=Pc}i=n.bind(null,t,i,e),n=void 0,!Rh||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),o?n!==void 0?e.addEventListener(t,i,{capture:!0,passive:n}):e.addEventListener(t,i,!0):n!==void 0?e.addEventListener(t,i,{passive:n}):e.addEventListener(t,i,!1)}function gv(e,t,i,o,n){var s=o;if(!(t&1)&&!(t&2)&&o!==null)t:for(;;){if(o===null)return;var r=o.tag;if(r===3||r===4){var a=o.stateNode.containerInfo;if(a===n||a.nodeType===8&&a.parentNode===n)break;if(r===4)for(r=o.return;r!==null;){var u=r.tag;if((u===3||u===4)&&(u=r.stateNode.containerInfo,u===n||u.nodeType===8&&u.parentNode===n))return;r=r.return}for(;a!==null;){if(r=Un(a),r===null)return;if(u=r.tag,u===5||u===6){o=s=r;continue t}a=a.parentNode}}o=o.return}CT(function(){var l=s,h=Sc(i),f=[];t:{var g=tv.get(e);if(g!==void 0){var p=Dc,v=e;switch(e){case"keypress":if(xa(i)===0)break t;case"keydown":case"keyup":p=tb;break;case"focusin":v="focus",p=hh;break;case"focusout":v="blur",p=hh;break;case"beforeblur":case"afterblur":p=hh;break;case"click":if(i.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Mp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=YT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=nb;break;case $m:case Qm:case Zm:p=HT;break;case Jm:p=sb;break;case"scroll":p=NT;break;case"wheel":p=ab;break;case"copy":case"cut":case"paste":p=VT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Lp}var y=(t&4)!==0,_=!y&&e==="scroll",T=y?g!==null?g+"Capture":null:g;y=[];for(var P=l,F;P!==null;){F=P;var j=F.stateNode;if(F.tag===5&&j!==null&&(F=j,T!==null&&(j=Gs(P,T),j!=null&&y.push(Zs(P,j,F)))),_)break;P=P.return}0<y.length&&(g=new p(g,v,null,i,h),f.push({event:g,listeners:y}))}}if(!(t&7)){t:{if(g=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",g&&!(t&16)&&(v=i.relatedTarget||i.fromElement)&&(Un(v)||v[zr]))break t;if((p||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,p?(v=i.relatedTarget||i.toElement,p=l,v=v?Un(v):null,v!==null&&(_=Jn(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=l),p!==v)){if(y=Mp,j="onMouseLeave",T="onMouseEnter",P="mouse",(e==="pointerout"||e==="pointerover")&&(y=Lp,j="onPointerLeave",T="onPointerEnter",P="pointer"),_=p==null?g:br(p),F=v==null?g:br(v),g=new y(j,P+"leave",p,i,h),g.target=_,g.relatedTarget=F,j=null,Un(h)===l&&(y=new y(T,P+"enter",v,i,h),y.target=F,y.relatedTarget=_,j=y),_=j,p&&v)e:{for(y=p,T=v,P=0,F=y;F;F=_r(F))P++;for(F=0,j=T;j;j=_r(j))F++;for(;0<P-F;)y=_r(y),P--;for(;0<F-P;)T=_r(T),F--;for(;P--;){if(y===T||T!==null&&y===T.alternate)break e;y=_r(y),T=_r(T)}y=null}else y=null;p!==null&&Gp(f,g,p,y,!1),v!==null&&_!==null&&Gp(f,_,v,y,!0)}}t:{if(g=l?br(l):window,p=g.nodeName&&g.nodeName.toLowerCase(),p==="select"||p==="input"&&g.type==="file")var Z=gb;else if(Bp(g))if(av)Z=yb;else{Z=mb;var Q=pb}else(p=g.nodeName)&&p.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(Z=vb);if(Z&&(Z=Z(e,l))){ov(f,Z,i,h);break t}Q&&Q(e,g,l),e==="focusout"&&(Q=g._wrapperState)&&Q.controlled&&g.type==="number"&&Ph(g,"number",g.value)}switch(Q=l?br(l):window,e){case"focusin":(Bp(Q)||Q.contentEditable==="true")&&(Tr=Q,Xh=l,js=null);break;case"focusout":js=Xh=Tr=null;break;case"mousedown":Yh=!0;break;case"contextmenu":case"mouseup":case"dragend":Yh=!1,Yp(f,i,h);break;case"selectionchange":if(Sb)break;case"keydown":case"keyup":Yp(f,i,h)}var $;if(Fc)t:{switch(e){case"compositionstart":var tt="onCompositionStart";break t;case"compositionend":tt="onCompositionEnd";break t;case"compositionupdate":tt="onCompositionUpdate";break t}tt=void 0}else xr?rv(e,i)&&(tt="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(tt="onCompositionStart");tt&&(nv&&i.locale!=="ko"&&(xr||tt!=="onCompositionStart"?tt==="onCompositionEnd"&&xr&&($=iv()):(hn=h,Ac="value"in hn?hn.value:hn.textContent,xr=!0)),Q=Ia(l,tt),0<Q.length&&(tt=new Fp(tt,e,null,i,h),f.push({event:tt,listeners:Q}),$?tt.data=$:($=sv(i),$!==null&&(tt.data=$)))),($=ub?hb(e,i):cb(e,i))&&(l=Ia(l,"onBeforeInput"),0<l.length&&(h=new Fp("onBeforeInput","beforeinput",null,i,h),f.push({event:h,listeners:l}),h.data=$))}cv(f,t)})}function Zs(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Ia(e,t){for(var i=t+"Capture",o=[];e!==null;){var n=e,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=Gs(e,i),s!=null&&o.unshift(Zs(e,s,n)),s=Gs(e,t),s!=null&&o.push(Zs(e,s,n))),e=e.return}return o}function _r(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Gp(e,t,i,o,n){for(var s=t._reactName,r=[];i!==null&&i!==o;){var a=i,u=a.alternate,l=a.stateNode;if(u!==null&&u===o)break;a.tag===5&&l!==null&&(a=l,n?(u=Gs(i,s),u!=null&&r.unshift(Zs(i,u,a))):n||(u=Gs(i,s),u!=null&&r.push(Zs(i,u,a)))),i=i.return}r.length!==0&&e.push({event:t,listeners:r})}function Ra(){}var dh=null,gh=null;function pv(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function zh(e,t){return e==="textarea"||e==="option"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Vp=typeof setTimeout=="function"?setTimeout:void 0,wb=typeof clearTimeout=="function"?clearTimeout:void 0;function Lc(e){e.nodeType===1?e.textContent="":e.nodeType===9&&(e=e.body,e!=null&&(e.textContent=""))}function Mr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break}return e}function qp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var ph=0;function xb(e){return{$$typeof:_c,toString:e,valueOf:e}}var ol=Math.random().toString(36).slice(2),cn="__reactFiber$"+ol,Ba="__reactProps$"+ol,zr="__reactContainer$"+ol,Kp="__reactEvents$"+ol;function Un(e){var t=e[cn];if(t)return t;for(var i=e.parentNode;i;){if(t=i[zr]||i[cn]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=qp(e);e!==null;){if(i=e[cn])return i;e=qp(e)}return t}e=i,i=e.parentNode}return null}function so(e){return e=e[cn]||e[zr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function br(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ct(33))}function al(e){return e[Ba]||null}function mv(e){var t=e[Kp];return t===void 0&&(t=e[Kp]=new Set),t}var Uh=[],Or=-1;function On(e){return{current:e}}function te(e){0>Or||(e.current=Uh[Or],Uh[Or]=null,Or--)}function oe(e,t){Or++,Uh[Or]=e.current,e.current=t}var xn={},Pe=On(xn),Xe=On(!1),qn=xn;function Wr(e,t){var i=e.type.contextTypes;if(!i)return xn;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in i)n[s]=t[s];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function Ye(e){return e=e.childContextTypes,e!=null}function ja(){te(Xe),te(Pe)}function $p(e,t,i){if(Pe.current!==xn)throw Error(Ct(168));oe(Pe,t),oe(Xe,i)}function vv(e,t,i){var o=e.stateNode;if(e=t.childContextTypes,typeof o.getChildContext!="function")return i;o=o.getChildContext();for(var n in o)if(!(n in e))throw Error(Ct(108,Pr(t)||"Unknown",n));return ie({},i,o)}function Ta(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||xn,qn=Pe.current,oe(Pe,e),oe(Xe,Xe.current),!0}function Qp(e,t,i){var o=e.stateNode;if(!o)throw Error(Ct(169));i?(e=vv(e,t,qn),o.__reactInternalMemoizedMergedChildContext=e,te(Xe),te(Pe),oe(Pe,e)):te(Xe),oe(Xe,i)}var Ic=null,Vn=null,Tb=ve.unstable_runWithPriority,Rc=ve.unstable_scheduleCallback,Hh=ve.unstable_cancelCallback,bb=ve.unstable_shouldYield,Zp=ve.unstable_requestPaint,Gh=ve.unstable_now,Ob=ve.unstable_getCurrentPriorityLevel,ll=ve.unstable_ImmediatePriority,yv=ve.unstable_UserBlockingPriority,_v=ve.unstable_NormalPriority,Cv=ve.unstable_LowPriority,Sv=ve.unstable_IdlePriority,mh={},Eb=Zp!==void 0?Zp:function(){},Ui=null,ba=null,vh=!1,Jp=Gh(),Oe=1e4>Jp?Gh:function(){return Gh()-Jp};function Nr(){switch(Ob()){case ll:return 99;case yv:return 98;case _v:return 97;case Cv:return 96;case Sv:return 95;default:throw Error(Ct(332))}}function wv(e){switch(e){case 99:return ll;case 98:return yv;case 97:return _v;case 96:return Cv;case 95:return Sv;default:throw Error(Ct(332))}}function Kn(e,t){return e=wv(e),Tb(e,t)}function Js(e,t,i){return e=wv(e),Rc(e,t,i)}function Di(){if(ba!==null){var e=ba;ba=null,Hh(e)}xv()}function xv(){if(!vh&&Ui!==null){vh=!0;var e=0;try{var t=Ui;Kn(99,function(){for(;e<t.length;e++){var i=t[e];do i=i(!0);while(i!==null)}}),Ui=null}catch(i){throw Ui!==null&&(Ui=Ui.slice(e+1)),Rc(ll,Di),i}finally{vh=!1}}}var Pb=Zn.ReactCurrentBatchConfig;function _i(e,t){if(e&&e.defaultProps){t=ie({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}var Wa=On(null),Na=null,Er=null,Xa=null;function Bc(){Xa=Er=Na=null}function jc(e){var t=Wa.current;te(Wa),e.type._context._currentValue=t}function Tv(e,t){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)===t){if(i===null||(i.childLanes&t)===t)break;i.childLanes|=t}else e.childLanes|=t,i!==null&&(i.childLanes|=t);e=e.return}}function Fr(e,t){Na=e,Xa=Er=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ci=!0),e.firstContext=null)}function ci(e,t){if(Xa!==e&&t!==!1&&t!==0)if((typeof t!="number"||t===1073741823)&&(Xa=e,t=1073741823),t={context:e,observedBits:t,next:null},Er===null){if(Na===null)throw Error(Ct(308));Er=t,Na.dependencies={lanes:0,firstContext:t,responders:null}}else Er=Er.next=t;return e._currentValue}var ln=!1;function Wc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function bv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function vn(e,t){if(e=e.updateQueue,e!==null){e=e.shared;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}}function tm(e,t){var i=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,i===o)){var n=null,s=null;if(i=i.firstBaseUpdate,i!==null){do{var r={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};s===null?n=s=r:s=s.next=r,i=i.next}while(i!==null);s===null?n=s=t:s=s.next=t}else n=s=t;i={baseState:o.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:o.shared,effects:o.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function to(e,t,i,o){var n=e.updateQueue;ln=!1;var s=n.firstBaseUpdate,r=n.lastBaseUpdate,a=n.shared.pending;if(a!==null){n.shared.pending=null;var u=a,l=u.next;u.next=null,r===null?s=l:r.next=l,r=u;var h=e.alternate;if(h!==null){h=h.updateQueue;var f=h.lastBaseUpdate;f!==r&&(f===null?h.firstBaseUpdate=l:f.next=l,h.lastBaseUpdate=u)}}if(s!==null){f=n.baseState,r=0,h=l=u=null;do{a=s.lane;var g=s.eventTime;if((o&a)===a){h!==null&&(h=h.next={eventTime:g,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var p=e,v=s;switch(a=t,g=i,v.tag){case 1:if(p=v.payload,typeof p=="function"){f=p.call(g,f,a);break t}f=p;break t;case 3:p.flags=p.flags&-4097|64;case 0:if(p=v.payload,a=typeof p=="function"?p.call(g,f,a):p,a==null)break t;f=ie({},f,a);break t;case 2:ln=!0}}s.callback!==null&&(e.flags|=32,a=n.effects,a===null?n.effects=[s]:a.push(s))}else g={eventTime:g,lane:a,tag:s.tag,payload:s.payload,callback:s.callback,next:null},h===null?(l=h=g,u=f):h=h.next=g,r|=a;if(s=s.next,s===null){if(a=n.shared.pending,a===null)break;s=a.next,a.next=null,n.lastBaseUpdate=a,n.shared.pending=null}}while(1);h===null&&(u=f),n.baseState=u,n.firstBaseUpdate=l,n.lastBaseUpdate=h,ao|=r,e.lanes=r,e.memoizedState=f}}function em(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var o=e[t],n=o.callback;if(n!==null){if(o.callback=null,o=i,typeof n!="function")throw Error(Ct(191,n));n.call(o)}}}var Ov=new Ja.Component().refs;function Ya(e,t,i,o){t=e.memoizedState,i=i(o,t),i=i==null?t:ie({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var ul={isMounted:function(e){return(e=e._reactInternals)?Jn(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var o=$e(),n=yn(e),s=mn(o,n);s.payload=t,i!=null&&(s.callback=i),vn(e,s),_n(e,n,o)},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var o=$e(),n=yn(e),s=mn(o,n);s.tag=1,s.payload=t,i!=null&&(s.callback=i),vn(e,s),_n(e,n,o)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=$e(),o=yn(e),n=mn(i,o);n.tag=2,t!=null&&(n.callback=t),vn(e,n),_n(e,o,i)}};function im(e,t,i,o,n,s,r){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,s,r):t.prototype&&t.prototype.isPureReactComponent?!Qs(i,o)||!Qs(n,s):!0}function Ev(e,t,i){var o=!1,n=xn,s=t.contextType;return typeof s=="object"&&s!==null?s=ci(s):(n=Ye(t)?qn:Pe.current,o=t.contextTypes,s=(o=o!=null)?Wr(e,n):xn),t=new t(i,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ul,e.stateNode=t,t._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=s),t}function nm(e,t,i,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,o),t.state!==e&&ul.enqueueReplaceState(t,t.state,null)}function Vh(e,t,i,o){var n=e.stateNode;n.props=i,n.state=e.memoizedState,n.refs=Ov,Wc(e);var s=t.contextType;typeof s=="object"&&s!==null?n.context=ci(s):(s=Ye(t)?qn:Pe.current,n.context=Wr(e,s)),to(e,i,n,o),n.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Ya(e,t,s,i),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&ul.enqueueReplaceState(n,n.state,null),to(e,i,n,o),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4)}var pa=Array.isArray;function Cs(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(Ct(309));var o=i.stateNode}if(!o)throw Error(Ct(147,e));var n=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===n?t.ref:(t=function(s){var r=o.refs;r===Ov&&(r=o.refs={}),s===null?delete r[n]:r[n]=s},t._stringRef=n,t)}if(typeof e!="string")throw Error(Ct(284));if(!i._owner)throw Error(Ct(290,e))}return e}function ma(e,t){if(e.type!=="textarea")throw Error(Ct(31,Object.prototype.toString.call(t)==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Pv(e){function t(_,T){if(e){var P=_.lastEffect;P!==null?(P.nextEffect=T,_.lastEffect=T):_.firstEffect=_.lastEffect=T,T.nextEffect=null,T.flags=8}}function i(_,T){if(!e)return null;for(;T!==null;)t(_,T),T=T.sibling;return null}function o(_,T){for(_=new Map;T!==null;)T.key!==null?_.set(T.key,T):_.set(T.index,T),T=T.sibling;return _}function n(_,T){return _=bn(_,T),_.index=0,_.sibling=null,_}function s(_,T,P){return _.index=P,e?(P=_.alternate,P!==null?(P=P.index,P<T?(_.flags=2,T):P):(_.flags=2,T)):T}function r(_){return e&&_.alternate===null&&(_.flags=2),_}function a(_,T,P,F){return T===null||T.tag!==6?(T=wh(P,_.mode,F),T.return=_,T):(T=n(T,P),T.return=_,T)}function u(_,T,P,F){return T!==null&&T.elementType===P.type?(F=n(T,P.props),F.ref=Cs(_,T,P),F.return=_,F):(F=ka(P.type,P.key,P.props,null,_.mode,F),F.ref=Cs(_,T,P),F.return=_,F)}function l(_,T,P,F){return T===null||T.tag!==4||T.stateNode.containerInfo!==P.containerInfo||T.stateNode.implementation!==P.implementation?(T=xh(P,_.mode,F),T.return=_,T):(T=n(T,P.children||[]),T.return=_,T)}function h(_,T,P,F,j){return T===null||T.tag!==7?(T=Br(P,_.mode,F,j),T.return=_,T):(T=n(T,P),T.return=_,T)}function f(_,T,P){if(typeof T=="string"||typeof T=="number")return T=wh(""+T,_.mode,P),T.return=_,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Es:return P=ka(T.type,T.key,T.props,null,_.mode,P),P.ref=Cs(_,null,T),P.return=_,P;case Yn:return T=xh(T,_.mode,P),T.return=_,T}if(pa(T)||ps(T))return T=Br(T,_.mode,P,null),T.return=_,T;ma(_,T)}return null}function g(_,T,P,F){var j=T!==null?T.key:null;if(typeof P=="string"||typeof P=="number")return j!==null?null:a(_,T,""+P,F);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Es:return P.key===j?P.type===un?h(_,T,P.props.children,F,j):u(_,T,P,F):null;case Yn:return P.key===j?l(_,T,P,F):null}if(pa(P)||ps(P))return j!==null?null:h(_,T,P,F,null);ma(_,P)}return null}function p(_,T,P,F,j){if(typeof F=="string"||typeof F=="number")return _=_.get(P)||null,a(T,_,""+F,j);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case Es:return _=_.get(F.key===null?P:F.key)||null,F.type===un?h(T,_,F.props.children,j,F.key):u(T,_,F,j);case Yn:return _=_.get(F.key===null?P:F.key)||null,l(T,_,F,j)}if(pa(F)||ps(F))return _=_.get(P)||null,h(T,_,F,j,null);ma(T,F)}return null}function v(_,T,P,F){for(var j=null,Z=null,Q=T,$=T=0,tt=null;Q!==null&&$<P.length;$++){Q.index>$?(tt=Q,Q=null):tt=Q.sibling;var rt=g(_,Q,P[$],F);if(rt===null){Q===null&&(Q=tt);break}e&&Q&&rt.alternate===null&&t(_,Q),T=s(rt,T,$),Z===null?j=rt:Z.sibling=rt,Z=rt,Q=tt}if($===P.length)return i(_,Q),j;if(Q===null){for(;$<P.length;$++)Q=f(_,P[$],F),Q!==null&&(T=s(Q,T,$),Z===null?j=Q:Z.sibling=Q,Z=Q);return j}for(Q=o(_,Q);$<P.length;$++)tt=p(Q,_,$,P[$],F),tt!==null&&(e&&tt.alternate!==null&&Q.delete(tt.key===null?$:tt.key),T=s(tt,T,$),Z===null?j=tt:Z.sibling=tt,Z=tt);return e&&Q.forEach(function(ct){return t(_,ct)}),j}function y(_,T,P,F){var j=ps(P);if(typeof j!="function")throw Error(Ct(150));if(P=j.call(P),P==null)throw Error(Ct(151));for(var Z=j=null,Q=T,$=T=0,tt=null,rt=P.next();Q!==null&&!rt.done;$++,rt=P.next()){Q.index>$?(tt=Q,Q=null):tt=Q.sibling;var ct=g(_,Q,rt.value,F);if(ct===null){Q===null&&(Q=tt);break}e&&Q&&ct.alternate===null&&t(_,Q),T=s(ct,T,$),Z===null?j=ct:Z.sibling=ct,Z=ct,Q=tt}if(rt.done)return i(_,Q),j;if(Q===null){for(;!rt.done;$++,rt=P.next())rt=f(_,rt.value,F),rt!==null&&(T=s(rt,T,$),Z===null?j=rt:Z.sibling=rt,Z=rt);return j}for(Q=o(_,Q);!rt.done;$++,rt=P.next())rt=p(Q,_,$,rt.value,F),rt!==null&&(e&&rt.alternate!==null&&Q.delete(rt.key===null?$:rt.key),T=s(rt,T,$),Z===null?j=rt:Z.sibling=rt,Z=rt);return e&&Q.forEach(function(lt){return t(_,lt)}),j}return function(_,T,P,F){var j=typeof P=="object"&&P!==null&&P.type===un&&P.key===null;j&&(P=P.props.children);var Z=typeof P=="object"&&P!==null;if(Z)switch(P.$$typeof){case Es:t:{for(Z=P.key,j=T;j!==null;){if(j.key===Z){switch(j.tag){case 7:if(P.type===un){i(_,j.sibling),T=n(j,P.props.children),T.return=_,_=T;break t}break;default:if(j.elementType===P.type){i(_,j.sibling),T=n(j,P.props),T.ref=Cs(_,j,P),T.return=_,_=T;break t}}i(_,j);break}else t(_,j);j=j.sibling}P.type===un?(T=Br(P.props.children,_.mode,F,P.key),T.return=_,_=T):(F=ka(P.type,P.key,P.props,null,_.mode,F),F.ref=Cs(_,T,P),F.return=_,_=F)}return r(_);case Yn:t:{for(j=P.key;T!==null;){if(T.key===j)if(T.tag===4&&T.stateNode.containerInfo===P.containerInfo&&T.stateNode.implementation===P.implementation){i(_,T.sibling),T=n(T,P.children||[]),T.return=_,_=T;break t}else{i(_,T);break}else t(_,T);T=T.sibling}T=xh(P,_.mode,F),T.return=_,_=T}return r(_)}if(typeof P=="string"||typeof P=="number")return P=""+P,T!==null&&T.tag===6?(i(_,T.sibling),T=n(T,P),T.return=_,_=T):(i(_,T),T=wh(P,_.mode,F),T.return=_,_=T),r(_);if(pa(P))return v(_,T,P,F);if(ps(P))return y(_,T,P,F);if(Z&&ma(_,P),typeof P>"u"&&!j)switch(_.tag){case 1:case 22:case 0:case 11:case 15:throw Error(Ct(152,Pr(_.type)||"Component"))}return i(_,T)}}var za=Pv(!0),kv=Pv(!1),oo={},ki=On(oo),eo=On(oo),io=On(oo);function Hn(e){if(e===oo)throw Error(Ct(174));return e}function qh(e,t){switch(oe(io,t),oe(eo,e),oe(ki,oo),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Mh(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Mh(t,e)}te(ki),oe(ki,t)}function Xr(){te(ki),te(eo),te(io)}function rm(e){Hn(io.current);var t=Hn(ki.current),i=Mh(t,e.type);t!==i&&(oe(eo,e),oe(ki,i))}function Nc(e){eo.current===e&&(te(ki),te(eo))}var se=On(0);function Ua(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&64)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Gi=null,fn=null,Ai=!1;function Av(e,t){var i=ui(5,null,null,0);i.elementType="DELETED",i.type="DELETED",i.stateNode=t,i.return=e,i.flags=8,e.lastEffect!==null?(e.lastEffect.nextEffect=i,e.lastEffect=i):e.firstEffect=e.lastEffect=i}function sm(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,!0):!1;case 13:return!1;default:return!1}}function Kh(e){if(Ai){var t=fn;if(t){var i=t;if(!sm(e,t)){if(t=Mr(i.nextSibling),!t||!sm(e,t)){e.flags=e.flags&-1025|2,Ai=!1,Gi=e;return}Av(Gi,i)}Gi=e,fn=Mr(t.firstChild)}else e.flags=e.flags&-1025|2,Ai=!1,Gi=e}}function om(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Gi=e}function va(e){if(e!==Gi)return!1;if(!Ai)return om(e),Ai=!0,!1;var t=e.type;if(e.tag!==5||t!=="head"&&t!=="body"&&!zh(t,e.memoizedProps))for(t=fn;t;)Av(e,t),t=Mr(t.nextSibling);if(om(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ct(317));t:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){fn=Mr(e.nextSibling);break t}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}fn=null}}else fn=Gi?Mr(e.stateNode.nextSibling):null;return!0}function yh(){fn=Gi=null,Ai=!1}var Lr=[];function Xc(){for(var e=0;e<Lr.length;e++)Lr[e]._workInProgressVersionPrimary=null;Lr.length=0}var Ws=Zn.ReactCurrentDispatcher,hi=Zn.ReactCurrentBatchConfig,no=0,he=null,be=null,_e=null,Ha=!1,Ns=!1;function We(){throw Error(Ct(321))}function Yc(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!li(e[i],t[i]))return!1;return!0}function zc(e,t,i,o,n,s){if(no=s,he=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ws.current=e===null||e.memoizedState===null?Ab:Db,e=i(o,n),Ns){s=0;do{if(Ns=!1,!(25>s))throw Error(Ct(301));s+=1,_e=be=null,t.updateQueue=null,Ws.current=Mb,e=i(o,n)}while(Ns)}if(Ws.current=Ka,t=be!==null&&be.next!==null,no=0,_e=be=he=null,Ha=!1,t)throw Error(Ct(300));return e}function Gn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _e===null?he.memoizedState=_e=e:_e=_e.next=e,_e}function tr(){if(be===null){var e=he.alternate;e=e!==null?e.memoizedState:null}else e=be.next;var t=_e===null?he.memoizedState:_e.next;if(t!==null)_e=t,be=e;else{if(e===null)throw Error(Ct(310));be=e,e={memoizedState:be.memoizedState,baseState:be.baseState,baseQueue:be.baseQueue,queue:be.queue,next:null},_e===null?he.memoizedState=_e=e:_e=_e.next=e}return _e}function Ei(e,t){return typeof t=="function"?t(e):t}function Ss(e){var t=tr(),i=t.queue;if(i===null)throw Error(Ct(311));i.lastRenderedReducer=e;var o=be,n=o.baseQueue,s=i.pending;if(s!==null){if(n!==null){var r=n.next;n.next=s.next,s.next=r}o.baseQueue=n=s,i.pending=null}if(n!==null){n=n.next,o=o.baseState;var a=r=s=null,u=n;do{var l=u.lane;if((no&l)===l)a!==null&&(a=a.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),o=u.eagerReducer===e?u.eagerState:e(o,u.action);else{var h={lane:l,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};a===null?(r=a=h,s=o):a=a.next=h,he.lanes|=l,ao|=l}u=u.next}while(u!==null&&u!==n);a===null?s=o:a.next=r,li(o,t.memoizedState)||(Ci=!0),t.memoizedState=o,t.baseState=s,t.baseQueue=a,i.lastRenderedState=o}return[t.memoizedState,i.dispatch]}function ws(e){var t=tr(),i=t.queue;if(i===null)throw Error(Ct(311));i.lastRenderedReducer=e;var o=i.dispatch,n=i.pending,s=t.memoizedState;if(n!==null){i.pending=null;var r=n=n.next;do s=e(s,r.action),r=r.next;while(r!==n);li(s,t.memoizedState)||(Ci=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),i.lastRenderedState=s}return[s,o]}function am(e,t,i){var o=t._getVersion;o=o(t._source);var n=t._workInProgressVersionPrimary;if(n!==null?e=n===o:(e=e.mutableReadLanes,(e=(no&e)===e)&&(t._workInProgressVersionPrimary=o,Lr.push(t))),e)return i(t._source);throw Lr.push(t),Error(Ct(350))}function Dv(e,t,i,o){var n=Me;if(n===null)throw Error(Ct(349));var s=t._getVersion,r=s(t._source),a=Ws.current,u=a.useState(function(){return am(n,t,i)}),l=u[1],h=u[0];u=_e;var f=e.memoizedState,g=f.refs,p=g.getSnapshot,v=f.source;f=f.subscribe;var y=he;return e.memoizedState={refs:g,source:t,subscribe:o},a.useEffect(function(){g.getSnapshot=i,g.setSnapshot=l;var _=s(t._source);if(!li(r,_)){_=i(t._source),li(h,_)||(l(_),_=yn(y),n.mutableReadLanes|=_&n.pendingLanes),_=n.mutableReadLanes,n.entangledLanes|=_;for(var T=n.entanglements,P=_;0<P;){var F=31-wn(P),j=1<<F;T[F]|=_,P&=~j}}},[i,t,o]),a.useEffect(function(){return o(t._source,function(){var _=g.getSnapshot,T=g.setSnapshot;try{T(_(t._source));var P=yn(y);n.mutableReadLanes|=P&n.pendingLanes}catch(F){T(function(){throw F})}})},[t,o]),li(p,i)&&li(v,t)&&li(f,o)||(e={pending:null,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:h},e.dispatch=l=Gc.bind(null,he,e),u.queue=e,u.baseQueue=null,h=am(n,t,i),u.memoizedState=u.baseState=h),h}function Mv(e,t,i){var o=tr();return Dv(o,e,t,i)}function xs(e){var t=Gn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e=t.queue={pending:null,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:e},e=e.dispatch=Gc.bind(null,he,e),[t.memoizedState,e]}function Ga(e,t,i,o){return e={tag:e,create:t,destroy:i,deps:o,next:null},t=he.updateQueue,t===null?(t={lastEffect:null},he.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(o=i.next,i.next=e,e.next=o,t.lastEffect=e)),e}function lm(e){var t=Gn();return e={current:e},t.memoizedState=e}function Va(){return tr().memoizedState}function $h(e,t,i,o){var n=Gn();he.flags|=e,n.memoizedState=Ga(1|t,i,void 0,o===void 0?null:o)}function Uc(e,t,i,o){var n=tr();o=o===void 0?null:o;var s=void 0;if(be!==null){var r=be.memoizedState;if(s=r.destroy,o!==null&&Yc(o,r.deps)){Ga(t,i,s,o);return}}he.flags|=e,n.memoizedState=Ga(1|t,i,s,o)}function um(e,t){return $h(516,4,e,t)}function qa(e,t){return Uc(516,4,e,t)}function Fv(e,t){return Uc(4,2,e,t)}function Lv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Iv(e,t,i){return i=i!=null?i.concat([e]):null,Uc(4,2,Lv.bind(null,t,e),i)}function Hc(){}function Rv(e,t){var i=tr();t=t===void 0?null:t;var o=i.memoizedState;return o!==null&&t!==null&&Yc(t,o[1])?o[0]:(i.memoizedState=[e,t],e)}function Bv(e,t){var i=tr();t=t===void 0?null:t;var o=i.memoizedState;return o!==null&&t!==null&&Yc(t,o[1])?o[0]:(e=e(),i.memoizedState=[e,t],e)}function kb(e,t){var i=Nr();Kn(98>i?98:i,function(){e(!0)}),Kn(97<i?97:i,function(){var o=hi.transition;hi.transition=1;try{e(!1),t()}finally{hi.transition=o}})}function Gc(e,t,i){var o=$e(),n=yn(e),s={lane:n,action:i,eagerReducer:null,eagerState:null,next:null},r=t.pending;if(r===null?s.next=s:(s.next=r.next,r.next=s),t.pending=s,r=e.alternate,e===he||r!==null&&r===he)Ns=Ha=!0;else{if(e.lanes===0&&(r===null||r.lanes===0)&&(r=t.lastRenderedReducer,r!==null))try{var a=t.lastRenderedState,u=r(a,i);if(s.eagerReducer=r,s.eagerState=u,li(u,a))return}catch{}finally{}_n(e,n,o)}}var Ka={readContext:ci,useCallback:We,useContext:We,useEffect:We,useImperativeHandle:We,useLayoutEffect:We,useMemo:We,useReducer:We,useRef:We,useState:We,useDebugValue:We,useDeferredValue:We,useTransition:We,useMutableSource:We,useOpaqueIdentifier:We,unstable_isNewReconciler:!1},Ab={readContext:ci,useCallback:function(e,t){return Gn().memoizedState=[e,t===void 0?null:t],e},useContext:ci,useEffect:um,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,$h(4,2,Lv.bind(null,t,e),i)},useLayoutEffect:function(e,t){return $h(4,2,e,t)},useMemo:function(e,t){var i=Gn();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var o=Gn();return t=i!==void 0?i(t):t,o.memoizedState=o.baseState=t,e=o.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},e=e.dispatch=Gc.bind(null,he,e),[o.memoizedState,e]},useRef:lm,useState:xs,useDebugValue:Hc,useDeferredValue:function(e){var t=xs(e),i=t[0],o=t[1];return um(function(){var n=hi.transition;hi.transition=1;try{o(e)}finally{hi.transition=n}},[e]),i},useTransition:function(){var e=xs(!1),t=e[0];return e=kb.bind(null,e[1]),lm(e),[e,t]},useMutableSource:function(e,t,i){var o=Gn();return o.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:i},Dv(o,e,t,i)},useOpaqueIdentifier:function(){if(Ai){var e=!1,t=xb(function(){throw e||(e=!0,i("r:"+(ph++).toString(36))),Error(Ct(355))}),i=xs(t)[1];return!(he.mode&2)&&(he.flags|=516,Ga(5,function(){i("r:"+(ph++).toString(36))},void 0,null)),t}return t="r:"+(ph++).toString(36),xs(t),t},unstable_isNewReconciler:!1},Db={readContext:ci,useCallback:Rv,useContext:ci,useEffect:qa,useImperativeHandle:Iv,useLayoutEffect:Fv,useMemo:Bv,useReducer:Ss,useRef:Va,useState:function(){return Ss(Ei)},useDebugValue:Hc,useDeferredValue:function(e){var t=Ss(Ei),i=t[0],o=t[1];return qa(function(){var n=hi.transition;hi.transition=1;try{o(e)}finally{hi.transition=n}},[e]),i},useTransition:function(){var e=Ss(Ei)[0];return[Va().current,e]},useMutableSource:Mv,useOpaqueIdentifier:function(){return Ss(Ei)[0]},unstable_isNewReconciler:!1},Mb={readContext:ci,useCallback:Rv,useContext:ci,useEffect:qa,useImperativeHandle:Iv,useLayoutEffect:Fv,useMemo:Bv,useReducer:ws,useRef:Va,useState:function(){return ws(Ei)},useDebugValue:Hc,useDeferredValue:function(e){var t=ws(Ei),i=t[0],o=t[1];return qa(function(){var n=hi.transition;hi.transition=1;try{o(e)}finally{hi.transition=n}},[e]),i},useTransition:function(){var e=ws(Ei)[0];return[Va().current,e]},useMutableSource:Mv,useOpaqueIdentifier:function(){return ws(Ei)[0]},unstable_isNewReconciler:!1},Fb=Zn.ReactCurrentOwner,Ci=!1;function Ne(e,t,i,o){t.child=e===null?kv(t,null,i,o):za(t,e.child,i,o)}function hm(e,t,i,o,n){i=i.render;var s=t.ref;return Fr(t,n),o=zc(e,t,i,o,s,n),e!==null&&!Ci?(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~n,Vi(e,t,n)):(t.flags|=1,Ne(e,t,o,n),t.child)}function cm(e,t,i,o,n,s){if(e===null){var r=i.type;return typeof r=="function"&&!Zc(r)&&r.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=r,jv(e,t,r,o,n,s)):(e=ka(i.type,null,o,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}return r=e.child,!(n&s)&&(n=r.memoizedProps,i=i.compare,i=i!==null?i:Qs,i(n,o)&&e.ref===t.ref)?Vi(e,t,s):(t.flags|=1,e=bn(r,o),e.ref=t.ref,e.return=t,t.child=e)}function jv(e,t,i,o,n,s){if(e!==null&&Qs(e.memoizedProps,o)&&e.ref===t.ref)if(Ci=!1,(s&n)!==0)e.flags&16384&&(Ci=!0);else return t.lanes=e.lanes,Vi(e,t,s);return Qh(e,t,i,o,s)}function _h(e,t,i){var o=t.pendingProps,n=o.children,s=e!==null?e.memoizedState:null;if(o.mode==="hidden"||o.mode==="unstable-defer-without-hiding")if(!(t.mode&4))t.memoizedState={baseLanes:0},_a(t,i);else if(i&1073741824)t.memoizedState={baseLanes:0},_a(t,s!==null?s.baseLanes:i);else return e=s!==null?s.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},_a(t,e),null;else s!==null?(o=s.baseLanes|i,t.memoizedState=null):o=i,_a(t,o);return Ne(e,t,n,i),t.child}function Wv(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=128)}function Qh(e,t,i,o,n){var s=Ye(i)?qn:Pe.current;return s=Wr(t,s),Fr(t,n),i=zc(e,t,i,o,s,n),e!==null&&!Ci?(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~n,Vi(e,t,n)):(t.flags|=1,Ne(e,t,i,n),t.child)}function fm(e,t,i,o,n){if(Ye(i)){var s=!0;Ta(t)}else s=!1;if(Fr(t,n),t.stateNode===null)e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2),Ev(t,i,o),Vh(t,i,o,n),o=!0;else if(e===null){var r=t.stateNode,a=t.memoizedProps;r.props=a;var u=r.context,l=i.contextType;typeof l=="object"&&l!==null?l=ci(l):(l=Ye(i)?qn:Pe.current,l=Wr(t,l));var h=i.getDerivedStateFromProps,f=typeof h=="function"||typeof r.getSnapshotBeforeUpdate=="function";f||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a!==o||u!==l)&&nm(t,r,o,l),ln=!1;var g=t.memoizedState;r.state=g,to(t,o,r,n),u=t.memoizedState,a!==o||g!==u||Xe.current||ln?(typeof h=="function"&&(Ya(t,i,h,o),u=t.memoizedState),(a=ln||im(t,i,a,o,g,u,l))?(f||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(t.flags|=4)):(typeof r.componentDidMount=="function"&&(t.flags|=4),t.memoizedProps=o,t.memoizedState=u),r.props=o,r.state=u,r.context=l,o=a):(typeof r.componentDidMount=="function"&&(t.flags|=4),o=!1)}else{r=t.stateNode,bv(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:_i(t.type,a),r.props=l,f=t.pendingProps,g=r.context,u=i.contextType,typeof u=="object"&&u!==null?u=ci(u):(u=Ye(i)?qn:Pe.current,u=Wr(t,u));var p=i.getDerivedStateFromProps;(h=typeof p=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a!==f||g!==u)&&nm(t,r,o,u),ln=!1,g=t.memoizedState,r.state=g,to(t,o,r,n);var v=t.memoizedState;a!==f||g!==v||Xe.current||ln?(typeof p=="function"&&(Ya(t,i,p,o),v=t.memoizedState),(l=ln||im(t,i,l,o,g,v,u))?(h||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(o,v,u),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(o,v,u)),typeof r.componentDidUpdate=="function"&&(t.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(t.flags|=256)):(typeof r.componentDidUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=256),t.memoizedProps=o,t.memoizedState=v),r.props=o,r.state=v,r.context=u,o=l):(typeof r.componentDidUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=256),o=!1)}return Zh(e,t,i,o,s,n)}function Zh(e,t,i,o,n,s){Wv(e,t);var r=(t.flags&64)!==0;if(!o&&!r)return n&&Qp(t,i,!1),Vi(e,t,s);o=t.stateNode,Fb.current=t;var a=r&&typeof i.getDerivedStateFromError!="function"?null:o.render();return t.flags|=1,e!==null&&r?(t.child=za(t,e.child,null,s),t.child=za(t,null,a,s)):Ne(e,t,a,s),t.memoizedState=o.state,n&&Qp(t,i,!0),t.child}function dm(e){var t=e.stateNode;t.pendingContext?$p(e,t.pendingContext,t.pendingContext!==t.context):t.context&&$p(e,t.context,!1),qh(e,t.containerInfo)}var ya={dehydrated:null,retryLane:0};function gm(e,t,i){var o=t.pendingProps,n=se.current,s=!1,r;return(r=(t.flags&64)!==0)||(r=e!==null&&e.memoizedState===null?!1:(n&2)!==0),r?(s=!0,t.flags&=-65):e!==null&&e.memoizedState===null||o.fallback===void 0||o.unstable_avoidThisFallback===!0||(n|=1),oe(se,n&1),e===null?(o.fallback!==void 0&&Kh(t),e=o.children,n=o.fallback,s?(e=pm(t,e,n,i),t.child.memoizedState={baseLanes:i},t.memoizedState=ya,e):typeof o.unstable_expectedLoadTime=="number"?(e=pm(t,e,n,i),t.child.memoizedState={baseLanes:i},t.memoizedState=ya,t.lanes=33554432,e):(i=Jc({mode:"visible",children:e},t.mode,i,null),i.return=t,t.child=i)):e.memoizedState!==null?s?(o=vm(e,t,o.children,o.fallback,i),s=t.child,n=e.child.memoizedState,s.memoizedState=n===null?{baseLanes:i}:{baseLanes:n.baseLanes|i},s.childLanes=e.childLanes&~i,t.memoizedState=ya,o):(i=mm(e,t,o.children,i),t.memoizedState=null,i):s?(o=vm(e,t,o.children,o.fallback,i),s=t.child,n=e.child.memoizedState,s.memoizedState=n===null?{baseLanes:i}:{baseLanes:n.baseLanes|i},s.childLanes=e.childLanes&~i,t.memoizedState=ya,o):(i=mm(e,t,o.children,i),t.memoizedState=null,i)}function pm(e,t,i,o){var n=e.mode,s=e.child;return t={mode:"hidden",children:t},!(n&2)&&s!==null?(s.childLanes=0,s.pendingProps=t):s=Jc(t,n,0,null),i=Br(i,n,o,null),s.return=e,i.return=e,s.sibling=i,e.child=s,i}function mm(e,t,i,o){var n=e.child;return e=n.sibling,i=bn(n,{mode:"visible",children:i}),!(t.mode&2)&&(i.lanes=o),i.return=t,i.sibling=null,e!==null&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=i}function vm(e,t,i,o,n){var s=t.mode,r=e.child;e=r.sibling;var a={mode:"hidden",children:i};return!(s&2)&&t.child!==r?(i=t.child,i.childLanes=0,i.pendingProps=a,r=i.lastEffect,r!==null?(t.firstEffect=i.firstEffect,t.lastEffect=r,r.nextEffect=null):t.firstEffect=t.lastEffect=null):i=bn(r,a),e!==null?o=bn(e,o):(o=Br(o,s,n,null),o.flags|=2),o.return=t,i.return=t,i.sibling=o,t.child=i,o}function ym(e,t){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),Tv(e.return,t)}function Ch(e,t,i,o,n,s){var r=e.memoizedState;r===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:i,tailMode:n,lastEffect:s}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=o,r.tail=i,r.tailMode=n,r.lastEffect=s)}function _m(e,t,i){var o=t.pendingProps,n=o.revealOrder,s=o.tail;if(Ne(e,t,o.children,i),o=se.current,o&2)o=o&1|2,t.flags|=64;else{if(e!==null&&e.flags&64)t:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ym(e,i);else if(e.tag===19)ym(e,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break t;for(;e.sibling===null;){if(e.return===null||e.return===t)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(oe(se,o),!(t.mode&2))t.memoizedState=null;else switch(n){case"forwards":for(i=t.child,n=null;i!==null;)e=i.alternate,e!==null&&Ua(e)===null&&(n=i),i=i.sibling;i=n,i===null?(n=t.child,t.child=null):(n=i.sibling,i.sibling=null),Ch(t,!1,n,i,s,t.lastEffect);break;case"backwards":for(i=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&Ua(e)===null){t.child=n;break}e=n.sibling,n.sibling=i,i=n,n=e}Ch(t,!0,i,null,s,t.lastEffect);break;case"together":Ch(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function Vi(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),ao|=t.lanes,i&t.childLanes){if(e!==null&&t.child!==e.child)throw Error(Ct(153));if(t.child!==null){for(e=t.child,i=bn(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=bn(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}return null}var Nv,Jh,Xv,Yv;Nv=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};Jh=function(){};Xv=function(e,t,i,o){var n=e.memoizedProps;if(n!==o){e=t.stateNode,Hn(ki.current);var s=null;switch(i){case"input":n=Oh(e,n),o=Oh(e,o),s=[];break;case"option":n=kh(e,n),o=kh(e,o),s=[];break;case"select":n=ie({},n,{value:void 0}),o=ie({},o,{value:void 0}),s=[];break;case"textarea":n=Ah(e,n),o=Ah(e,o),s=[];break;default:typeof n.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=Ra)}Fh(i,o);var r;i=null;for(l in n)if(!o.hasOwnProperty(l)&&n.hasOwnProperty(l)&&n[l]!=null)if(l==="style"){var a=n[l];for(r in a)a.hasOwnProperty(r)&&(i||(i={}),i[r]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Us.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in o){var u=o[l];if(a=n?.[l],o.hasOwnProperty(l)&&u!==a&&(u!=null||a!=null))if(l==="style")if(a){for(r in a)!a.hasOwnProperty(r)||u&&u.hasOwnProperty(r)||(i||(i={}),i[r]="");for(r in u)u.hasOwnProperty(r)&&a[r]!==u[r]&&(i||(i={}),i[r]=u[r])}else i||(s||(s=[]),s.push(l,i)),i=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(s=s||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Us.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&Jt("scroll",e),s||a===u||(s=[])):typeof u=="object"&&u!==null&&u.$$typeof===_c?u.toString():(s=s||[]).push(l,u))}i&&(s=s||[]).push("style",i);var l=s;(t.updateQueue=l)&&(t.flags|=4)}};Yv=function(e,t,i,o){i!==o&&(t.flags|=4)};function Ts(e,t){if(!Ai)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Lb(e,t,i){var o=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return Ye(t.type)&&ja(),null;case 3:return Xr(),te(Xe),te(Pe),Xc(),o=t.stateNode,o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(va(t)?t.flags|=4:o.hydrate||(t.flags|=256)),Jh(t),null;case 5:Nc(t);var n=Hn(io.current);if(i=t.type,e!==null&&t.stateNode!=null)Xv(e,t,i,o,n),e.ref!==t.ref&&(t.flags|=128);else{if(!o){if(t.stateNode===null)throw Error(Ct(166));return null}if(e=Hn(ki.current),va(t)){o=t.stateNode,i=t.type;var s=t.memoizedProps;switch(o[cn]=t,o[Ba]=s,i){case"dialog":Jt("cancel",o),Jt("close",o);break;case"iframe":case"object":case"embed":Jt("load",o);break;case"video":case"audio":for(e=0;e<ks.length;e++)Jt(ks[e],o);break;case"source":Jt("error",o);break;case"img":case"image":case"link":Jt("error",o),Jt("load",o);break;case"details":Jt("toggle",o);break;case"input":Sp(o,s),Jt("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!s.multiple},Jt("invalid",o);break;case"textarea":xp(o,s),Jt("invalid",o)}Fh(i,s),e=null;for(var r in s)s.hasOwnProperty(r)&&(n=s[r],r==="children"?typeof n=="string"?o.textContent!==n&&(e=["children",n]):typeof n=="number"&&o.textContent!==""+n&&(e=["children",""+n]):Us.hasOwnProperty(r)&&n!=null&&r==="onScroll"&&Jt("scroll",o));switch(i){case"input":la(o),wp(o,s,!0);break;case"textarea":la(o),Tp(o);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(o.onclick=Ra)}o=e,t.updateQueue=o,o!==null&&(t.flags|=4)}else{switch(r=n.nodeType===9?n:n.ownerDocument,e===Dh.html&&(e=Im(i)),e===Dh.html?i==="script"?(e=r.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=r.createElement(i,{is:o.is}):(e=r.createElement(i),i==="select"&&(r=e,o.multiple?r.multiple=!0:o.size&&(r.size=o.size))):e=r.createElementNS(e,i),e[cn]=t,e[Ba]=o,Nv(e,t,!1,!1),t.stateNode=e,r=Lh(i,o),i){case"dialog":Jt("cancel",e),Jt("close",e),n=o;break;case"iframe":case"object":case"embed":Jt("load",e),n=o;break;case"video":case"audio":for(n=0;n<ks.length;n++)Jt(ks[n],e);n=o;break;case"source":Jt("error",e),n=o;break;case"img":case"image":case"link":Jt("error",e),Jt("load",e),n=o;break;case"details":Jt("toggle",e),n=o;break;case"input":Sp(e,o),n=Oh(e,o),Jt("invalid",e);break;case"option":n=kh(e,o);break;case"select":e._wrapperState={wasMultiple:!!o.multiple},n=ie({},o,{value:void 0}),Jt("invalid",e);break;case"textarea":xp(e,o),n=Ah(e,o),Jt("invalid",e);break;default:n=o}Fh(i,n);var a=n;for(s in a)if(a.hasOwnProperty(s)){var u=a[s];s==="style"?jm(e,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Rm(e,u)):s==="children"?typeof u=="string"?(i!=="textarea"||u!=="")&&Hs(e,u):typeof u=="number"&&Hs(e,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Us.hasOwnProperty(s)?u!=null&&s==="onScroll"&&Jt("scroll",e):u!=null&&dc(e,s,u,r))}switch(i){case"input":la(e),wp(e,o,!1);break;case"textarea":la(e),Tp(e);break;case"option":o.value!=null&&e.setAttribute("value",""+Sn(o.value));break;case"select":e.multiple=!!o.multiple,s=o.value,s!=null?kr(e,!!o.multiple,s,!1):o.defaultValue!=null&&kr(e,!!o.multiple,o.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=Ra)}pv(i,o)&&(t.flags|=4)}t.ref!==null&&(t.flags|=128)}return null;case 6:if(e&&t.stateNode!=null)Yv(e,t,e.memoizedProps,o);else{if(typeof o!="string"&&t.stateNode===null)throw Error(Ct(166));i=Hn(io.current),Hn(ki.current),va(t)?(o=t.stateNode,i=t.memoizedProps,o[cn]=t,o.nodeValue!==i&&(t.flags|=4)):(o=(i.nodeType===9?i:i.ownerDocument).createTextNode(o),o[cn]=t,t.stateNode=o)}return null;case 13:return te(se),o=t.memoizedState,t.flags&64?(t.lanes=i,t):(o=o!==null,i=!1,e===null?t.memoizedProps.fallback!==void 0&&va(t):i=e.memoizedState!==null,o&&!i&&t.mode&2&&(e===null&&t.memoizedProps.unstable_avoidThisFallback!==!0||se.current&1?Ce===0&&(Ce=3):((Ce===0||Ce===3)&&(Ce=4),Me===null||!(ao&134217727)&&!(Hr&134217727)||Ir(Me,Ee))),(o||i)&&(t.flags|=4),null);case 4:return Xr(),Jh(t),e===null&&fv(t.stateNode.containerInfo),null;case 10:return jc(t),null;case 17:return Ye(t.type)&&ja(),null;case 19:if(te(se),o=t.memoizedState,o===null)return null;if(s=(t.flags&64)!==0,r=o.rendering,r===null)if(s)Ts(o,!1);else{if(Ce!==0||e!==null&&e.flags&64)for(e=t.child;e!==null;){if(r=Ua(e),r!==null){for(t.flags|=64,Ts(o,!1),s=r.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),o.lastEffect===null&&(t.firstEffect=null),t.lastEffect=o.lastEffect,o=i,i=t.child;i!==null;)s=i,e=o,s.flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,r=s.alternate,r===null?(s.childLanes=0,s.lanes=e,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=r.childLanes,s.lanes=r.lanes,s.child=r.child,s.memoizedProps=r.memoizedProps,s.memoizedState=r.memoizedState,s.updateQueue=r.updateQueue,s.type=r.type,e=r.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return oe(se,se.current&1|2),t.child}e=e.sibling}o.tail!==null&&Oe()>sc&&(t.flags|=64,s=!0,Ts(o,!1),t.lanes=33554432)}else{if(!s)if(e=Ua(r),e!==null){if(t.flags|=64,s=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),Ts(o,!0),o.tail===null&&o.tailMode==="hidden"&&!r.alternate&&!Ai)return t=t.lastEffect=o.lastEffect,t!==null&&(t.nextEffect=null),null}else 2*Oe()-o.renderingStartTime>sc&&i!==1073741824&&(t.flags|=64,s=!0,Ts(o,!1),t.lanes=33554432);o.isBackwards?(r.sibling=t.child,t.child=r):(i=o.last,i!==null?i.sibling=r:t.child=r,o.last=r)}return o.tail!==null?(i=o.tail,o.rendering=i,o.tail=i.sibling,o.lastEffect=t.lastEffect,o.renderingStartTime=Oe(),i.sibling=null,t=se.current,oe(se,s?t&1|2:t&1),i):null;case 23:case 24:return Qc(),e!==null&&e.memoizedState!==null!=(t.memoizedState!==null)&&o.mode!=="unstable-defer-without-hiding"&&(t.flags|=4),null}throw Error(Ct(156,t.tag))}function Ib(e){switch(e.tag){case 1:Ye(e.type)&&ja();var t=e.flags;return t&4096?(e.flags=t&-4097|64,e):null;case 3:if(Xr(),te(Xe),te(Pe),Xc(),t=e.flags,t&64)throw Error(Ct(285));return e.flags=t&-4097|64,e;case 5:return Nc(e),null;case 13:return te(se),t=e.flags,t&4096?(e.flags=t&-4097|64,e):null;case 19:return te(se),null;case 4:return Xr(),null;case 10:return jc(e),null;case 23:case 24:return Qc(),null;default:return null}}function Vc(e,t){try{var i="",o=t;do i+=pT(o),o=o.return;while(o);var n=i}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:n}}function tc(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var Rb=typeof WeakMap=="function"?WeakMap:Map;function zv(e,t,i){i=mn(-1,i),i.tag=3,i.payload={element:null};var o=t.value;return i.callback=function(){Qa||(Qa=!0,oc=o),tc(e,t)},i}function Uv(e,t,i){i=mn(-1,i),i.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var n=t.value;i.payload=function(){return tc(e,t),o(n)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(i.callback=function(){typeof o!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this),tc(e,t));var r=t.stack;this.componentDidCatch(t.value,{componentStack:r!==null?r:""})}),i}var Bb=typeof WeakSet=="function"?WeakSet:Set;function Cm(e){var t=e.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){Cn(e,i)}else t.current=null}function jb(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(t.flags&256&&e!==null){var i=e.memoizedProps,o=e.memoizedState;e=t.stateNode,t=e.getSnapshotBeforeUpdate(t.elementType===t.type?i:_i(t.type,i),o),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:t.flags&256&&Lc(t.stateNode.containerInfo);return;case 5:case 6:case 4:case 17:return}throw Error(Ct(163))}function Wb(e,t,i){switch(i.tag){case 0:case 11:case 15:case 22:if(t=i.updateQueue,t=t!==null?t.lastEffect:null,t!==null){e=t=t.next;do{if((e.tag&3)===3){var o=e.create;e.destroy=o()}e=e.next}while(e!==t)}if(t=i.updateQueue,t=t!==null?t.lastEffect:null,t!==null){e=t=t.next;do{var n=e;o=n.next,n=n.tag,n&4&&n&1&&(Jv(i,e),Vb(i,e)),e=o}while(e!==t)}return;case 1:e=i.stateNode,i.flags&4&&(t===null?e.componentDidMount():(o=i.elementType===i.type?t.memoizedProps:_i(i.type,t.memoizedProps),e.componentDidUpdate(o,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),t=i.updateQueue,t!==null&&em(i,t,e);return;case 3:if(t=i.updateQueue,t!==null){if(e=null,i.child!==null)switch(i.child.tag){case 5:e=i.child.stateNode;break;case 1:e=i.child.stateNode}em(i,t,e)}return;case 5:e=i.stateNode,t===null&&i.flags&4&&pv(i.type,i.memoizedProps)&&e.focus();return;case 6:return;case 4:return;case 12:return;case 13:i.memoizedState===null&&(i=i.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&qm(i))));return;case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(Ct(163))}function Sm(e,t){for(var i=e;;){if(i.tag===5){var o=i.stateNode;if(t)o=o.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none";else{o=i.stateNode;var n=i.memoizedProps.style;n=n!=null&&n.hasOwnProperty("display")?n.display:null,o.style.display=Bm("display",n)}}else if(i.tag===6)i.stateNode.nodeValue=t?"":i.memoizedProps;else if((i.tag!==23&&i.tag!==24||i.memoizedState===null||i===e)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function wm(e,t){if(Vn&&typeof Vn.onCommitFiberUnmount=="function")try{Vn.onCommitFiberUnmount(Ic,t)}catch{}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(e=t.updateQueue,e!==null&&(e=e.lastEffect,e!==null)){var i=e=e.next;do{var o=i,n=o.destroy;if(o=o.tag,n!==void 0)if(o&4)Jv(t,i);else{o=t;try{n()}catch(s){Cn(o,s)}}i=i.next}while(i!==e)}break;case 1:if(Cm(t),e=t.stateNode,typeof e.componentWillUnmount=="function")try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(s){Cn(t,s)}break;case 5:Cm(t);break;case 4:Hv(e,t)}}function xm(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function Tm(e){return e.tag===5||e.tag===3||e.tag===4}function bm(e){t:{for(var t=e.return;t!==null;){if(Tm(t))break t;t=t.return}throw Error(Ct(160))}var i=t;switch(t=i.stateNode,i.tag){case 5:var o=!1;break;case 3:t=t.containerInfo,o=!0;break;case 4:t=t.containerInfo,o=!0;break;default:throw Error(Ct(161))}i.flags&16&&(Hs(t,""),i.flags&=-17);t:e:for(i=e;;){for(;i.sibling===null;){if(i.return===null||Tm(i.return)){i=null;break t}i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2)){i=i.stateNode;break t}}o?ec(e,i,t):ic(e,i,t)}function ec(e,t,i){var o=e.tag,n=o===5||o===6;if(n)e=n?e.stateNode:e.stateNode.instance,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=Ra));else if(o!==4&&(e=e.child,e!==null))for(ec(e,t,i),e=e.sibling;e!==null;)ec(e,t,i),e=e.sibling}function ic(e,t,i){var o=e.tag,n=o===5||o===6;if(n)e=n?e.stateNode:e.stateNode.instance,t?i.insertBefore(e,t):i.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(ic(e,t,i),e=e.sibling;e!==null;)ic(e,t,i),e=e.sibling}function Hv(e,t){for(var i=t,o=!1,n,s;;){if(!o){o=i.return;t:for(;;){if(o===null)throw Error(Ct(160));switch(n=o.stateNode,o.tag){case 5:s=!1;break t;case 3:n=n.containerInfo,s=!0;break t;case 4:n=n.containerInfo,s=!0;break t}o=o.return}o=!0}if(i.tag===5||i.tag===6){t:for(var r=e,a=i,u=a;;)if(wm(r,u),u.child!==null&&u.tag!==4)u.child.return=u,u=u.child;else{if(u===a)break t;for(;u.sibling===null;){if(u.return===null||u.return===a)break t;u=u.return}u.sibling.return=u.return,u=u.sibling}s?(r=n,a=i.stateNode,r.nodeType===8?r.parentNode.removeChild(a):r.removeChild(a)):n.removeChild(i.stateNode)}else if(i.tag===4){if(i.child!==null){n=i.stateNode.containerInfo,s=!0,i.child.return=i,i=i.child;continue}}else if(wm(e,i),i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return,i.tag===4&&(o=!1)}i.sibling.return=i.return,i=i.sibling}}function Sh(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do(o.tag&3)===3&&(e=o.destroy,o.destroy=void 0,e!==void 0&&e()),o=o.next;while(o!==i)}return;case 1:return;case 5:if(i=t.stateNode,i!=null){o=t.memoizedProps;var n=e!==null?e.memoizedProps:o;e=t.type;var s=t.updateQueue;if(t.updateQueue=null,s!==null){for(i[Ba]=o,e==="input"&&o.type==="radio"&&o.name!=null&&Fm(i,o),Lh(e,n),t=Lh(e,o),n=0;n<s.length;n+=2){var r=s[n],a=s[n+1];r==="style"?jm(i,a):r==="dangerouslySetInnerHTML"?Rm(i,a):r==="children"?Hs(i,a):dc(i,r,a,t)}switch(e){case"input":Eh(i,o);break;case"textarea":Lm(i,o);break;case"select":e=i._wrapperState.wasMultiple,i._wrapperState.wasMultiple=!!o.multiple,s=o.value,s!=null?kr(i,!!o.multiple,s,!1):e!==!!o.multiple&&(o.defaultValue!=null?kr(i,!!o.multiple,o.defaultValue,!0):kr(i,!!o.multiple,o.multiple?[]:"",!1))}}}return;case 6:if(t.stateNode===null)throw Error(Ct(162));t.stateNode.nodeValue=t.memoizedProps;return;case 3:i=t.stateNode,i.hydrate&&(i.hydrate=!1,qm(i.containerInfo));return;case 12:return;case 13:t.memoizedState!==null&&($c=Oe(),Sm(t.child,!0)),Om(t);return;case 19:Om(t);return;case 17:return;case 23:case 24:Sm(t,t.memoizedState!==null);return}throw Error(Ct(163))}function Om(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new Bb),t.forEach(function(o){var n=$b.bind(null,e,o);i.has(o)||(i.add(o),o.then(n,n))})}}function Nb(e,t){return e!==null&&(e=e.memoizedState,e===null||e.dehydrated!==null)?(t=t.memoizedState,t!==null&&t.dehydrated===null):!1}var Xb=Math.ceil,$a=Zn.ReactCurrentDispatcher,qc=Zn.ReactCurrentOwner,Dt=0,Me=null,ge=null,Ee=0,$n=0,nc=On(0),Ce=0,hl=null,Ur=0,ao=0,Hr=0,Kc=0,rc=null,$c=0,sc=1/0;function Gr(){sc=Oe()+500}var bt=null,Qa=!1,oc=null,Pi=null,Tn=!1,Xs=null,As=90,ac=[],lc=[],qi=null,Ys=0,uc=null,Oa=-1,Hi=0,Ea=0,zs=null,Pa=!1;function $e(){return Dt&48?Oe():Oa!==-1?Oa:Oa=Oe()}function yn(e){if(e=e.mode,!(e&2))return 1;if(!(e&4))return Nr()===99?1:2;if(Hi===0&&(Hi=Ur),Pb.transition!==0){Ea!==0&&(Ea=rc!==null?rc.pendingLanes:0),e=Hi;var t=4186112&~Ea;return t&=-t,t===0&&(e=4186112&~e,t=e&-e,t===0&&(t=8192)),t}return e=Nr(),Dt&4&&e===98?e=La(12,Hi):(e=DT(e),e=La(e,Hi)),e}function _n(e,t,i){if(50<Ys)throw Ys=0,uc=null,Error(Ct(185));if(e=cl(e,t),e===null)return null;nl(e,t,i),e===Me&&(Hr|=t,Ce===4&&Ir(e,Ee));var o=Nr();t===1?Dt&8&&!(Dt&48)?hc(e):(fi(e,i),Dt===0&&(Gr(),Di())):(!(Dt&4)||o!==98&&o!==99||(qi===null?qi=new Set([e]):qi.add(e)),fi(e,i)),rc=e}function cl(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}function fi(e,t){for(var i=e.callbackNode,o=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,r=e.pendingLanes;0<r;){var a=31-wn(r),u=1<<a,l=s[a];if(l===-1){if(!(u&o)||u&n){l=t,Cr(u);var h=Qt;s[a]=10<=h?l+250:6<=h?l+5e3:-1}}else l<=t&&(e.expiredLanes|=u);r&=~u}if(o=Ks(e,e===Me?Ee:0),t=Qt,o===0)i!==null&&(i!==mh&&Hh(i),e.callbackNode=null,e.callbackPriority=0);else{if(i!==null){if(e.callbackPriority===t)return;i!==mh&&Hh(i)}t===15?(i=hc.bind(null,e),Ui===null?(Ui=[i],ba=Rc(ll,xv)):Ui.push(i),i=mh):t===14?i=Js(99,hc.bind(null,e)):(i=MT(t),i=Js(i,Gv.bind(null,e))),e.callbackPriority=t,e.callbackNode=i}}function Gv(e){if(Oa=-1,Ea=Hi=0,Dt&48)throw Error(Ct(327));var t=e.callbackNode;if(En()&&e.callbackNode!==t)return null;var i=Ks(e,e===Me?Ee:0);if(i===0)return null;var o=i,n=Dt;Dt|=16;var s=$v();(Me!==e||Ee!==o)&&(Gr(),Rr(e,o));do try{Ub();break}catch(a){Kv(e,a)}while(1);if(Bc(),$a.current=s,Dt=n,ge!==null?o=0:(Me=null,Ee=0,o=Ce),Ur&Hr)Rr(e,0);else if(o!==0){if(o===2&&(Dt|=64,e.hydrate&&(e.hydrate=!1,Lc(e.containerInfo)),i=ev(e),i!==0&&(o=Ds(e,i))),o===1)throw t=hl,Rr(e,0),Ir(e,i),fi(e,Oe()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=i,o){case 0:case 1:throw Error(Ct(345));case 2:Xn(e);break;case 3:if(Ir(e,i),(i&62914560)===i&&(o=$c+500-Oe(),10<o)){if(Ks(e,0)!==0)break;if(n=e.suspendedLanes,(n&i)!==i){$e(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=Vp(Xn.bind(null,e),o);break}Xn(e);break;case 4:if(Ir(e,i),(i&4186112)===i)break;for(o=e.eventTimes,n=-1;0<i;){var r=31-wn(i);s=1<<r,r=o[r],r>n&&(n=r),i&=~s}if(i=n,i=Oe()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Xb(i/1960))-i,10<i){e.timeoutHandle=Vp(Xn.bind(null,e),i);break}Xn(e);break;case 5:Xn(e);break;default:throw Error(Ct(329))}}return fi(e,Oe()),e.callbackNode===t?Gv.bind(null,e):null}function Ir(e,t){for(t&=~Kc,t&=~Hr,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-wn(t),o=1<<i;e[i]=-1,t&=~o}}function hc(e){if(Dt&48)throw Error(Ct(327));if(En(),e===Me&&e.expiredLanes&Ee){var t=Ee,i=Ds(e,t);Ur&Hr&&(t=Ks(e,t),i=Ds(e,t))}else t=Ks(e,0),i=Ds(e,t);if(e.tag!==0&&i===2&&(Dt|=64,e.hydrate&&(e.hydrate=!1,Lc(e.containerInfo)),t=ev(e),t!==0&&(i=Ds(e,t))),i===1)throw i=hl,Rr(e,0),Ir(e,t),fi(e,Oe()),i;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Xn(e),fi(e,Oe()),null}function Yb(){if(qi!==null){var e=qi;qi=null,e.forEach(function(t){t.expiredLanes|=24&t.pendingLanes,fi(t,Oe())})}Di()}function Vv(e,t){var i=Dt;Dt|=1;try{return e(t)}finally{Dt=i,Dt===0&&(Gr(),Di())}}function qv(e,t){var i=Dt;Dt&=-2,Dt|=8;try{return e(t)}finally{Dt=i,Dt===0&&(Gr(),Di())}}function _a(e,t){oe(nc,$n),$n|=t,Ur|=t}function Qc(){$n=nc.current,te(nc)}function Rr(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,wb(i)),ge!==null)for(i=ge.return;i!==null;){var o=i;switch(o.tag){case 1:o=o.type.childContextTypes,o!=null&&ja();break;case 3:Xr(),te(Xe),te(Pe),Xc();break;case 5:Nc(o);break;case 4:Xr();break;case 13:te(se);break;case 19:te(se);break;case 10:jc(o);break;case 23:case 24:Qc()}i=i.return}Me=e,ge=bn(e.current,null),Ee=$n=Ur=t,Ce=0,hl=null,Kc=Hr=ao=0}function Kv(e,t){do{var i=ge;try{if(Bc(),Ws.current=Ka,Ha){for(var o=he.memoizedState;o!==null;){var n=o.queue;n!==null&&(n.pending=null),o=o.next}Ha=!1}if(no=0,_e=be=he=null,Ns=!1,qc.current=null,i===null||i.return===null){Ce=1,hl=t,ge=null;break}t:{var s=e,r=i.return,a=i,u=t;if(t=Ee,a.flags|=2048,a.firstEffect=a.lastEffect=null,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u;if(!(a.mode&2)){var h=a.alternate;h?(a.updateQueue=h.updateQueue,a.memoizedState=h.memoizedState,a.lanes=h.lanes):(a.updateQueue=null,a.memoizedState=null)}var f=(se.current&1)!==0,g=r;do{var p;if(p=g.tag===13){var v=g.memoizedState;if(v!==null)p=v.dehydrated!==null;else{var y=g.memoizedProps;p=y.fallback===void 0?!1:y.unstable_avoidThisFallback!==!0?!0:!f}}if(p){var _=g.updateQueue;if(_===null){var T=new Set;T.add(l),g.updateQueue=T}else _.add(l);if(!(g.mode&2)){if(g.flags|=64,a.flags|=16384,a.flags&=-2981,a.tag===1)if(a.alternate===null)a.tag=17;else{var P=mn(-1,1);P.tag=2,vn(a,P)}a.lanes|=1;break t}u=void 0,a=t;var F=s.pingCache;if(F===null?(F=s.pingCache=new Rb,u=new Set,F.set(l,u)):(u=F.get(l),u===void 0&&(u=new Set,F.set(l,u))),!u.has(a)){u.add(a);var j=Kb.bind(null,s,l,a);l.then(j,j)}g.flags|=4096,g.lanes=t;break t}g=g.return}while(g!==null);u=Error((Pr(a.type)||"A React component")+` suspended while rendering, but no fallback UI was specified.

Add a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.`)}Ce!==5&&(Ce=2),u=Vc(u,a),g=r;do{switch(g.tag){case 3:s=u,g.flags|=4096,t&=-t,g.lanes|=t;var Z=zv(g,s,t);tm(g,Z);break t;case 1:s=u;var Q=g.type,$=g.stateNode;if(!(g.flags&64)&&(typeof Q.getDerivedStateFromError=="function"||$!==null&&typeof $.componentDidCatch=="function"&&(Pi===null||!Pi.has($)))){g.flags|=4096,t&=-t,g.lanes|=t;var tt=Uv(g,s,t);tm(g,tt);break t}}g=g.return}while(g!==null)}Zv(i)}catch(rt){t=rt,ge===i&&i!==null&&(ge=i=i.return);continue}break}while(1)}function $v(){var e=$a.current;return $a.current=Ka,e===null?Ka:e}function Ds(e,t){var i=Dt;Dt|=16;var o=$v();Me===e&&Ee===t||Rr(e,t);do try{zb();break}catch(n){Kv(e,n)}while(1);if(Bc(),Dt=i,$a.current=o,ge!==null)throw Error(Ct(261));return Me=null,Ee=0,Ce}function zb(){for(;ge!==null;)Qv(ge)}function Ub(){for(;ge!==null&&!bb();)Qv(ge)}function Qv(e){var t=t0(e.alternate,e,$n);e.memoizedProps=e.pendingProps,t===null?Zv(e):ge=t,qc.current=null}function Zv(e){var t=e;do{var i=t.alternate;if(e=t.return,t.flags&2048){if(i=Ib(t),i!==null){i.flags&=2047,ge=i;return}e!==null&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}else{if(i=Lb(i,t,$n),i!==null){ge=i;return}if(i=t,i.tag!==24&&i.tag!==23||i.memoizedState===null||$n&1073741824||!(i.mode&4)){for(var o=0,n=i.child;n!==null;)o|=n.lanes|n.childLanes,n=n.sibling;i.childLanes=o}e!==null&&!(e.flags&2048)&&(e.firstEffect===null&&(e.firstEffect=t.firstEffect),t.lastEffect!==null&&(e.lastEffect!==null&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(e.lastEffect!==null?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}if(t=t.sibling,t!==null){ge=t;return}ge=t=e}while(t!==null);Ce===0&&(Ce=5)}function Xn(e){var t=Nr();return Kn(99,Hb.bind(null,e,t)),null}function Hb(e,t){do En();while(Xs!==null);if(Dt&48)throw Error(Ct(327));var i=e.finishedWork;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(Ct(177));e.callbackNode=null;var o=i.lanes|i.childLanes,n=o,s=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;for(var r=e.eventTimes,a=e.expirationTimes;0<s;){var u=31-wn(s),l=1<<u;n[u]=0,r[u]=-1,a[u]=-1,s&=~l}if(qi!==null&&!(o&24)&&qi.has(e)&&qi.delete(e),e===Me&&(ge=Me=null,Ee=0),1<i.flags?i.lastEffect!==null?(i.lastEffect.nextEffect=i,o=i.firstEffect):o=i:o=i.firstEffect,o!==null){if(n=Dt,Dt|=32,qc.current=null,dh=Sa,r=Xp(),Nh(r)){if("selectionStart"in r)a={start:r.selectionStart,end:r.selectionEnd};else t:if(a=(a=r.ownerDocument)&&a.defaultView||window,(l=a.getSelection&&a.getSelection())&&l.rangeCount!==0){a=l.anchorNode,s=l.anchorOffset,u=l.focusNode,l=l.focusOffset;try{a.nodeType,u.nodeType}catch{a=null;break t}var h=0,f=-1,g=-1,p=0,v=0,y=r,_=null;e:for(;;){for(var T;y!==a||s!==0&&y.nodeType!==3||(f=h+s),y!==u||l!==0&&y.nodeType!==3||(g=h+l),y.nodeType===3&&(h+=y.nodeValue.length),(T=y.firstChild)!==null;)_=y,y=T;for(;;){if(y===r)break e;if(_===a&&++p===s&&(f=h),_===u&&++v===l&&(g=h),(T=y.nextSibling)!==null)break;y=_,_=y.parentNode}y=T}a=f===-1||g===-1?null:{start:f,end:g}}else a=null;a=a||{start:0,end:0}}else a=null;gh={focusedElem:r,selectionRange:a},Sa=!1,zs=null,Pa=!1,bt=o;do try{Gb()}catch(rt){if(bt===null)throw Error(Ct(330));Cn(bt,rt),bt=bt.nextEffect}while(bt!==null);zs=null,bt=o;do try{for(r=e;bt!==null;){var P=bt.flags;if(P&16&&Hs(bt.stateNode,""),P&128){var F=bt.alternate;if(F!==null){var j=F.ref;j!==null&&(typeof j=="function"?j(null):j.current=null)}}switch(P&1038){case 2:bm(bt),bt.flags&=-3;break;case 6:bm(bt),bt.flags&=-3,Sh(bt.alternate,bt);break;case 1024:bt.flags&=-1025;break;case 1028:bt.flags&=-1025,Sh(bt.alternate,bt);break;case 4:Sh(bt.alternate,bt);break;case 8:a=bt,Hv(r,a);var Z=a.alternate;xm(a),Z!==null&&xm(Z)}bt=bt.nextEffect}}catch(rt){if(bt===null)throw Error(Ct(330));Cn(bt,rt),bt=bt.nextEffect}while(bt!==null);if(j=gh,F=Xp(),P=j.focusedElem,r=j.selectionRange,F!==P&&P&&P.ownerDocument&&uv(P.ownerDocument.documentElement,P)){for(r!==null&&Nh(P)&&(F=r.start,j=r.end,j===void 0&&(j=F),"selectionStart"in P?(P.selectionStart=F,P.selectionEnd=Math.min(j,P.value.length)):(j=(F=P.ownerDocument||document)&&F.defaultView||window,j.getSelection&&(j=j.getSelection(),a=P.textContent.length,Z=Math.min(r.start,a),r=r.end===void 0?Z:Math.min(r.end,a),!j.extend&&Z>r&&(a=r,r=Z,Z=a),a=Np(P,Z),s=Np(P,r),a&&s&&(j.rangeCount!==1||j.anchorNode!==a.node||j.anchorOffset!==a.offset||j.focusNode!==s.node||j.focusOffset!==s.offset)&&(F=F.createRange(),F.setStart(a.node,a.offset),j.removeAllRanges(),Z>r?(j.addRange(F),j.extend(s.node,s.offset)):(F.setEnd(s.node,s.offset),j.addRange(F)))))),F=[],j=P;j=j.parentNode;)j.nodeType===1&&F.push({element:j,left:j.scrollLeft,top:j.scrollTop});for(typeof P.focus=="function"&&P.focus(),P=0;P<F.length;P++)j=F[P],j.element.scrollLeft=j.left,j.element.scrollTop=j.top}Sa=!!dh,gh=dh=null,e.current=i,bt=o;do try{for(P=e;bt!==null;){var Q=bt.flags;if(Q&36&&Wb(P,bt.alternate,bt),Q&128){F=void 0;var $=bt.ref;if($!==null){var tt=bt.stateNode;switch(bt.tag){case 5:F=tt;break;default:F=tt}typeof $=="function"?$(F):$.current=F}}bt=bt.nextEffect}}catch(rt){if(bt===null)throw Error(Ct(330));Cn(bt,rt),bt=bt.nextEffect}while(bt!==null);bt=null,Eb(),Dt=n}else e.current=i;if(Tn)Tn=!1,Xs=e,As=t;else for(bt=o;bt!==null;)t=bt.nextEffect,bt.nextEffect=null,bt.flags&8&&(Q=bt,Q.sibling=null,Q.stateNode=null),bt=t;if(o=e.pendingLanes,o===0&&(Pi=null),o===1?e===uc?Ys++:(Ys=0,uc=e):Ys=0,i=i.stateNode,Vn&&typeof Vn.onCommitFiberRoot=="function")try{Vn.onCommitFiberRoot(Ic,i,void 0,(i.current.flags&64)===64)}catch{}if(fi(e,Oe()),Qa)throw Qa=!1,e=oc,oc=null,e;return Dt&8||Di(),null}function Gb(){for(;bt!==null;){var e=bt.alternate;Pa||zs===null||(bt.flags&8?Ep(bt,zs)&&(Pa=!0):bt.tag===13&&Nb(e,bt)&&Ep(bt,zs)&&(Pa=!0));var t=bt.flags;t&256&&jb(e,bt),!(t&512)||Tn||(Tn=!0,Js(97,function(){return En(),null})),bt=bt.nextEffect}}function En(){if(As!==90){var e=97<As?97:As;return As=90,Kn(e,qb)}return!1}function Vb(e,t){ac.push(t,e),Tn||(Tn=!0,Js(97,function(){return En(),null}))}function Jv(e,t){lc.push(t,e),Tn||(Tn=!0,Js(97,function(){return En(),null}))}function qb(){if(Xs===null)return!1;var e=Xs;if(Xs=null,Dt&48)throw Error(Ct(331));var t=Dt;Dt|=32;var i=lc;lc=[];for(var o=0;o<i.length;o+=2){var n=i[o],s=i[o+1],r=n.destroy;if(n.destroy=void 0,typeof r=="function")try{r()}catch(u){if(s===null)throw Error(Ct(330));Cn(s,u)}}for(i=ac,ac=[],o=0;o<i.length;o+=2){n=i[o],s=i[o+1];try{var a=n.create;n.destroy=a()}catch(u){if(s===null)throw Error(Ct(330));Cn(s,u)}}for(a=e.current.firstEffect;a!==null;)e=a.nextEffect,a.nextEffect=null,a.flags&8&&(a.sibling=null,a.stateNode=null),a=e;return Dt=t,Di(),!0}function Em(e,t,i){t=Vc(i,t),t=zv(e,t,1),vn(e,t),t=$e(),e=cl(e,1),e!==null&&(nl(e,1,t),fi(e,t))}function Cn(e,t){if(e.tag===3)Em(e,e,t);else for(var i=e.return;i!==null;){if(i.tag===3){Em(i,e,t);break}else if(i.tag===1){var o=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Pi===null||!Pi.has(o))){e=Vc(t,e);var n=Uv(i,e,1);if(vn(i,n),n=$e(),i=cl(i,1),i!==null)nl(i,1,n),fi(i,n);else if(typeof o.componentDidCatch=="function"&&(Pi===null||!Pi.has(o)))try{o.componentDidCatch(t,e)}catch{}break}}i=i.return}}function Kb(e,t,i){var o=e.pingCache;o!==null&&o.delete(t),t=$e(),e.pingedLanes|=e.suspendedLanes&i,Me===e&&(Ee&i)===i&&(Ce===4||Ce===3&&(Ee&62914560)===Ee&&500>Oe()-$c?Rr(e,0):Kc|=i),fi(e,t)}function $b(e,t){var i=e.stateNode;i!==null&&i.delete(t),t=0,t===0&&(t=e.mode,t&2?t&4?(Hi===0&&(Hi=Ur),t=Sr(62914560&~Hi),t===0&&(t=4194304)):t=Nr()===99?1:2:t=1),i=$e(),e=cl(e,t),e!==null&&(nl(e,t,i),fi(e,i))}var t0;t0=function(e,t,i){var o=t.lanes;if(e!==null)if(e.memoizedProps!==t.pendingProps||Xe.current)Ci=!0;else if(i&o)Ci=!!(e.flags&16384);else{switch(Ci=!1,t.tag){case 3:dm(t),yh();break;case 5:rm(t);break;case 1:Ye(t.type)&&Ta(t);break;case 4:qh(t,t.stateNode.containerInfo);break;case 10:o=t.memoizedProps.value;var n=t.type._context;oe(Wa,n._currentValue),n._currentValue=o;break;case 13:if(t.memoizedState!==null)return i&t.child.childLanes?gm(e,t,i):(oe(se,se.current&1),t=Vi(e,t,i),t!==null?t.sibling:null);oe(se,se.current&1);break;case 19:if(o=(i&t.childLanes)!==0,e.flags&64){if(o)return _m(e,t,i);t.flags|=64}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),oe(se,se.current),o)break;return null;case 23:case 24:return t.lanes=0,_h(e,t,i)}return Vi(e,t,i)}else Ci=!1;switch(t.lanes=0,t.tag){case 2:if(o=t.type,e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,n=Wr(t,Pe.current),Fr(t,i),n=zc(null,t,o,e,n,i),t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ye(o)){var s=!0;Ta(t)}else s=!1;t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,Wc(t);var r=o.getDerivedStateFromProps;typeof r=="function"&&Ya(t,o,r,e),n.updater=ul,t.stateNode=n,n._reactInternals=t,Vh(t,o,e,i),t=Zh(null,t,o,!0,s,i)}else t.tag=0,Ne(null,t,n,i),t=t.child;return t;case 16:n=t.elementType;t:{switch(e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=Zb(n),e=_i(n,e),s){case 0:t=Qh(null,t,n,e,i);break t;case 1:t=fm(null,t,n,e,i);break t;case 11:t=hm(null,t,n,e,i);break t;case 14:t=cm(null,t,n,_i(n.type,e),o,i);break t}throw Error(Ct(306,n,""))}return t;case 0:return o=t.type,n=t.pendingProps,n=t.elementType===o?n:_i(o,n),Qh(e,t,o,n,i);case 1:return o=t.type,n=t.pendingProps,n=t.elementType===o?n:_i(o,n),fm(e,t,o,n,i);case 3:if(dm(t),o=t.updateQueue,e===null||o===null)throw Error(Ct(282));if(o=t.pendingProps,n=t.memoizedState,n=n!==null?n.element:null,bv(e,t),to(t,o,null,i),o=t.memoizedState.element,o===n)yh(),t=Vi(e,t,i);else{if(n=t.stateNode,(s=n.hydrate)&&(fn=Mr(t.stateNode.containerInfo.firstChild),Gi=t,s=Ai=!0),s){if(e=n.mutableSourceEagerHydrationData,e!=null)for(n=0;n<e.length;n+=2)s=e[n],s._workInProgressVersionPrimary=e[n+1],Lr.push(s);for(i=kv(t,null,o,i),t.child=i;i;)i.flags=i.flags&-3|1024,i=i.sibling}else Ne(e,t,o,i),yh();t=t.child}return t;case 5:return rm(t),e===null&&Kh(t),o=t.type,n=t.pendingProps,s=e!==null?e.memoizedProps:null,r=n.children,zh(o,n)?r=null:s!==null&&zh(o,s)&&(t.flags|=16),Wv(e,t),Ne(e,t,r,i),t.child;case 6:return e===null&&Kh(t),null;case 13:return gm(e,t,i);case 4:return qh(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=za(t,null,o,i):Ne(e,t,o,i),t.child;case 11:return o=t.type,n=t.pendingProps,n=t.elementType===o?n:_i(o,n),hm(e,t,o,n,i);case 7:return Ne(e,t,t.pendingProps,i),t.child;case 8:return Ne(e,t,t.pendingProps.children,i),t.child;case 12:return Ne(e,t,t.pendingProps.children,i),t.child;case 10:t:{o=t.type._context,n=t.pendingProps,r=t.memoizedProps,s=n.value;var a=t.type._context;if(oe(Wa,a._currentValue),a._currentValue=s,r!==null)if(a=r.value,s=li(a,s)?0:(typeof o._calculateChangedBits=="function"?o._calculateChangedBits(a,s):1073741823)|0,s===0){if(r.children===n.children&&!Xe.current){t=Vi(e,t,i);break t}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var u=a.dependencies;if(u!==null){r=a.child;for(var l=u.firstContext;l!==null;){if(l.context===o&&l.observedBits&s){a.tag===1&&(l=mn(-1,i&-i),l.tag=2,vn(a,l)),a.lanes|=i,l=a.alternate,l!==null&&(l.lanes|=i),Tv(a.return,i),u.lanes|=i;break}l=l.next}}else r=a.tag===10&&a.type===t.type?null:a.child;if(r!==null)r.return=a;else for(r=a;r!==null;){if(r===t){r=null;break}if(a=r.sibling,a!==null){a.return=r.return,r=a;break}r=r.return}a=r}Ne(e,t,n.children,i),t=t.child}return t;case 9:return n=t.type,s=t.pendingProps,o=s.children,Fr(t,i),n=ci(n,s.unstable_observedBits),o=o(n),t.flags|=1,Ne(e,t,o,i),t.child;case 14:return n=t.type,s=_i(n,t.pendingProps),s=_i(n.type,s),cm(e,t,n,s,o,i);case 15:return jv(e,t,t.type,t.pendingProps,o,i);case 17:return o=t.type,n=t.pendingProps,n=t.elementType===o?n:_i(o,n),e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,Ye(o)?(e=!0,Ta(t)):e=!1,Fr(t,i),Ev(t,o,n),Vh(t,o,n,i),Zh(null,t,o,!0,e,i);case 19:return _m(e,t,i);case 23:return _h(e,t,i);case 24:return _h(e,t,i)}throw Error(Ct(156,t.tag))};function Qb(e,t,i,o){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function ui(e,t,i,o){return new Qb(e,t,i,o)}function Zc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zb(e){if(typeof e=="function")return Zc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===tl)return 11;if(e===el)return 14}return 2}function bn(e,t){var i=e.alternate;return i===null?(i=ui(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null),i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function ka(e,t,i,o,n,s){var r=2;if(o=e,typeof e=="function")Zc(e)&&(r=1);else if(typeof e=="string")r=5;else t:switch(e){case un:return Br(i.children,n,s,t);case Am:r=8,n|=16;break;case gc:r=8,n|=1;break;case Ms:return e=ui(12,i,t,n|8),e.elementType=Ms,e.type=Ms,e.lanes=s,e;case Fs:return e=ui(13,i,t,n),e.type=Fs,e.elementType=Fs,e.lanes=s,e;case Aa:return e=ui(19,i,t,n),e.elementType=Aa,e.lanes=s,e;case Cc:return Jc(i,n,s,t);case bh:return e=ui(24,i,t,n),e.elementType=bh,e.lanes=s,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case pc:r=10;break t;case mc:r=9;break t;case tl:r=11;break t;case el:r=14;break t;case vc:r=16,o=null;break t;case yc:r=22;break t}throw Error(Ct(130,e==null?e:typeof e,""))}return t=ui(r,i,t,n),t.elementType=e,t.type=o,t.lanes=s,t}function Br(e,t,i,o){return e=ui(7,e,o,t),e.lanes=i,e}function Jc(e,t,i,o){return e=ui(23,e,o,t),e.elementType=Cc,e.lanes=i,e}function wh(e,t,i){return e=ui(6,e,null,t),e.lanes=i,e}function xh(e,t,i){return t=ui(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Jb(e,t,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=i,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=ah(0),this.expirationTimes=ah(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ah(0),this.mutableSourceEagerHydrationData=null}function t2(e,t,i){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Yn,key:o==null?null:""+o,children:e,containerInfo:t,implementation:i}}function Za(e,t,i,o){var n=t.current,s=$e(),r=yn(n);t:if(i){i=i._reactInternals;e:{if(Jn(i)!==i||i.tag!==1)throw Error(Ct(170));var a=i;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Ye(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(Ct(171))}if(i.tag===1){var u=i.type;if(Ye(u)){i=vv(i,u,a);break t}}i=a}else i=xn;return t.context===null?t.context=i:t.pendingContext=i,t=mn(s,r),t.payload={element:e},o=o===void 0?null:o,o!==null&&(t.callback=o),vn(n,t),_n(n,r,s),r}function Th(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Pm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function tf(e,t){Pm(e,t),(e=e.alternate)&&Pm(e,t)}function e2(){return null}function ef(e,t,i){var o=i!=null&&i.hydrationOptions!=null&&i.hydrationOptions.mutableSources||null;if(i=new Jb(e,t,i!=null&&i.hydrate===!0),t=ui(3,null,null,t===2?7:t===1?3:0),i.current=t,t.stateNode=i,Wc(t),e[zr]=i.current,fv(e.nodeType===8?e.parentNode:e),o)for(e=0;e<o.length;e++){t=o[e];var n=t._getVersion;n=n(t._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[t,n]:i.mutableSourceEagerHydrationData.push(t,n)}this._internalRoot=i}ef.prototype.render=function(e){Za(e,this._internalRoot,null,null)};ef.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Za(null,e,null,function(){t[zr]=null})};function lo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function i2(e,t){if(t||(t=e?e.nodeType===9?e.documentElement:e.firstChild:null,t=!(!t||t.nodeType!==1||!t.hasAttribute("data-reactroot"))),!t)for(var i;i=e.lastChild;)e.removeChild(i);return new ef(e,0,t?{hydrate:!0}:void 0)}function fl(e,t,i,o,n){var s=i._reactRootContainer;if(s){var r=s._internalRoot;if(typeof n=="function"){var a=n;n=function(){var l=Th(r);a.call(l)}}Za(t,r,e,n)}else{if(s=i._reactRootContainer=i2(i,o),r=s._internalRoot,typeof n=="function"){var u=n;n=function(){var l=Th(r);u.call(l)}}qv(function(){Za(t,r,e,n)})}return Th(r)}Hm=function(e){if(e.tag===13){var t=$e();_n(e,4,t),tf(e,4)}};bc=function(e){if(e.tag===13){var t=$e();_n(e,67108864,t),tf(e,67108864)}};Gm=function(e){if(e.tag===13){var t=$e(),i=yn(e);_n(e,i,t),tf(e,i)}};Vm=function(e,t){return t()};Ih=function(e,t,i){switch(t){case"input":if(Eh(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var o=i[t];if(o!==e&&o.form===e.form){var n=al(o);if(!n)throw Error(Ct(90));Mm(o),Eh(o,n)}}}break;case"textarea":Lm(e,i);break;case"select":t=i.value,t!=null&&kr(e,!!i.multiple,t,!1)}};wc=Vv;Xm=function(e,t,i,o,n){var s=Dt;Dt|=4;try{return Kn(98,e.bind(null,t,i,o,n))}finally{Dt=s,Dt===0&&(Gr(),Di())}};xc=function(){!(Dt&49)&&(Yb(),En())};Ym=function(e,t){var i=Dt;Dt|=2;try{return e(t)}finally{Dt=i,Dt===0&&(Gr(),Di())}};function e0(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lo(t))throw Error(Ct(200));return t2(e,t,null,i)}var n2={Events:[so,br,al,Wm,Nm,En,{current:!1}]},bs={findFiberByHostInstance:Un,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},r2={bundleType:bs.bundleType,version:bs.version,rendererPackageName:bs.rendererPackageName,rendererConfig:bs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Um(e),e===null?null:e.stateNode},findFiberByHostInstance:bs.findFiberByHostInstance||e2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&(Os=__REACT_DEVTOOLS_GLOBAL_HOOK__,!Os.isDisabled&&Os.supportsFiber))try{Ic=Os.inject(r2),Vn=Os}catch{}var Os;di.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=n2;di.createPortal=e0;di.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ct(188)):Error(Ct(268,Object.keys(e)));return e=Um(t),e=e===null?null:e.stateNode,e};di.flushSync=function(e,t){var i=Dt;if(i&48)return e(t);Dt|=1;try{if(e)return Kn(99,e.bind(null,t))}finally{Dt=i,Di()}};di.hydrate=function(e,t,i){if(!lo(t))throw Error(Ct(200));return fl(null,e,t,!0,i)};di.render=function(e,t,i){if(!lo(t))throw Error(Ct(200));return fl(null,e,t,!1,i)};di.unmountComponentAtNode=function(e){if(!lo(e))throw Error(Ct(40));return e._reactRootContainer?(qv(function(){fl(null,null,e,!1,function(){e._reactRootContainer=null,e[zr]=null})}),!0):!1};di.unstable_batchedUpdates=Vv;di.unstable_createPortal=function(e,t){return e0(e,t,2<arguments.length&&arguments[2]!==void 0?arguments[2]:null)};di.unstable_renderSubtreeIntoContainer=function(e,t,i,o){if(!lo(i))throw Error(Ct(200));if(e==null||e._reactInternals===void 0)throw Error(Ct(38));return fl(e,t,i,!1,o)};di.version="17.0.2"});var s0=je((x2,r0)=>{"use strict";function n0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n0)}catch(e){console.error(e)}}n0(),r0.exports=i0()});var o0=je((Vr,uo)=>{(function(){var e,t="4.17.21",i=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",n="Expected a function",s="Invalid `variable` option passed into `_.template`",r="__lodash_hash_undefined__",a=500,u="__lodash_placeholder__",l=1,h=2,f=4,g=1,p=2,v=1,y=2,_=4,T=8,P=16,F=32,j=64,Z=128,Q=256,$=512,tt=30,rt="...",ct=800,lt=16,w=1,k=2,A=3,E=1/0,W=9007199254740991,O=17976931348623157e292,x=0/0,M=4294967295,R=M-1,z=M>>>1,N=[["ary",Z],["bind",v],["bindKey",y],["curry",T],["curryRight",P],["flip",$],["partial",F],["partialRight",j],["rearg",Q]],q="[object Arguments]",et="[object Array]",ot="[object AsyncFunction]",X="[object Boolean]",I="[object Date]",G="[object DOMException]",V="[object Error]",Y="[object Function]",K="[object GeneratorFunction]",st="[object Map]",yt="[object Number]",dt="[object Null]",U="[object Object]",pt="[object Promise]",_t="[object Proxy]",St="[object RegExp]",Ot="[object Set]",Tt="[object String]",Wt="[object Symbol]",Ft="[object Undefined]",ae="[object WeakMap]",ze="[object WeakSet]",qt="[object ArrayBuffer]",Si="[object DataView]",Fi="[object Float32Array]",Pn="[object Float64Array]",kn="[object Int8Array]",gl="[object Int16Array]",pl="[object Int32Array]",ml="[object Uint8Array]",vl="[object Uint8ClampedArray]",yl="[object Uint16Array]",_l="[object Uint32Array]",g0=/\b__p \+= '';/g,p0=/\b(__p \+=) '' \+/g,m0=/(__e\(.*?\)|\b__t\)) \+\n'';/g,uf=/&(?:amp|lt|gt|quot|#39);/g,hf=/[&<>"']/g,v0=RegExp(uf.source),y0=RegExp(hf.source),_0=/<%-([\s\S]+?)%>/g,C0=/<%([\s\S]+?)%>/g,cf=/<%=([\s\S]+?)%>/g,S0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,w0=/^\w*$/,x0=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Cl=/[\\^$.*+?()[\]{}|]/g,T0=RegExp(Cl.source),Sl=/^\s+/,b0=/\s/,O0=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,E0=/\{\n\/\* \[wrapped with (.+)\] \*/,P0=/,? & /,k0=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,A0=/[()=,{}\[\]\/\s]/,D0=/\\(\\)?/g,M0=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ff=/\w*$/,F0=/^[-+]0x[0-9a-f]+$/i,L0=/^0b[01]+$/i,I0=/^\[object .+?Constructor\]$/,R0=/^0o[0-7]+$/i,B0=/^(?:0|[1-9]\d*)$/,j0=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ho=/($^)/,W0=/['\n\r\u2028\u2029\\]/g,co="\\ud800-\\udfff",N0="\\u0300-\\u036f",X0="\\ufe20-\\ufe2f",Y0="\\u20d0-\\u20ff",df=N0+X0+Y0,gf="\\u2700-\\u27bf",pf="a-z\\xdf-\\xf6\\xf8-\\xff",z0="\\xac\\xb1\\xd7\\xf7",U0="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",H0="\\u2000-\\u206f",G0=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",mf="A-Z\\xc0-\\xd6\\xd8-\\xde",vf="\\ufe0e\\ufe0f",yf=z0+U0+H0+G0,wl="['\u2019]",V0="["+co+"]",_f="["+yf+"]",fo="["+df+"]",Cf="\\d+",q0="["+gf+"]",Sf="["+pf+"]",wf="[^"+co+yf+Cf+gf+pf+mf+"]",xl="\\ud83c[\\udffb-\\udfff]",K0="(?:"+fo+"|"+xl+")",xf="[^"+co+"]",Tl="(?:\\ud83c[\\udde6-\\uddff]){2}",bl="[\\ud800-\\udbff][\\udc00-\\udfff]",er="["+mf+"]",Tf="\\u200d",bf="(?:"+Sf+"|"+wf+")",$0="(?:"+er+"|"+wf+")",Of="(?:"+wl+"(?:d|ll|m|re|s|t|ve))?",Ef="(?:"+wl+"(?:D|LL|M|RE|S|T|VE))?",Pf=K0+"?",kf="["+vf+"]?",Q0="(?:"+Tf+"(?:"+[xf,Tl,bl].join("|")+")"+kf+Pf+")*",Z0="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",J0="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Af=kf+Pf+Q0,ty="(?:"+[q0,Tl,bl].join("|")+")"+Af,ey="(?:"+[xf+fo+"?",fo,Tl,bl,V0].join("|")+")",iy=RegExp(wl,"g"),ny=RegExp(fo,"g"),Ol=RegExp(xl+"(?="+xl+")|"+ey+Af,"g"),ry=RegExp([er+"?"+Sf+"+"+Of+"(?="+[_f,er,"$"].join("|")+")",$0+"+"+Ef+"(?="+[_f,er+bf,"$"].join("|")+")",er+"?"+bf+"+"+Of,er+"+"+Ef,J0,Z0,Cf,ty].join("|"),"g"),sy=RegExp("["+Tf+co+df+vf+"]"),oy=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ay=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ly=-1,Zt={};Zt[Fi]=Zt[Pn]=Zt[kn]=Zt[gl]=Zt[pl]=Zt[ml]=Zt[vl]=Zt[yl]=Zt[_l]=!0,Zt[q]=Zt[et]=Zt[qt]=Zt[X]=Zt[Si]=Zt[I]=Zt[V]=Zt[Y]=Zt[st]=Zt[yt]=Zt[U]=Zt[St]=Zt[Ot]=Zt[Tt]=Zt[ae]=!1;var $t={};$t[q]=$t[et]=$t[qt]=$t[Si]=$t[X]=$t[I]=$t[Fi]=$t[Pn]=$t[kn]=$t[gl]=$t[pl]=$t[st]=$t[yt]=$t[U]=$t[St]=$t[Ot]=$t[Tt]=$t[Wt]=$t[ml]=$t[vl]=$t[yl]=$t[_l]=!0,$t[V]=$t[Y]=$t[ae]=!1;var uy={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},hy={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},cy={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},fy={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},dy=parseFloat,gy=parseInt,Df=typeof global=="object"&&global&&global.Object===Object&&global,py=typeof self=="object"&&self&&self.Object===Object&&self,pe=Df||py||Function("return this")(),El=typeof Vr=="object"&&Vr&&!Vr.nodeType&&Vr,An=El&&typeof uo=="object"&&uo&&!uo.nodeType&&uo,Mf=An&&An.exports===El,Pl=Mf&&Df.process,Ze=function(){try{var it=An&&An.require&&An.require("util").types;return it||Pl&&Pl.binding&&Pl.binding("util")}catch{}}(),Ff=Ze&&Ze.isArrayBuffer,Lf=Ze&&Ze.isDate,If=Ze&&Ze.isMap,Rf=Ze&&Ze.isRegExp,Bf=Ze&&Ze.isSet,jf=Ze&&Ze.isTypedArray;function Ue(it,ft,at){switch(at.length){case 0:return it.call(ft);case 1:return it.call(ft,at[0]);case 2:return it.call(ft,at[0],at[1]);case 3:return it.call(ft,at[0],at[1],at[2])}return it.apply(ft,at)}function my(it,ft,at,xt){for(var Mt=-1,zt=it==null?0:it.length;++Mt<zt;){var ce=it[Mt];ft(xt,ce,at(ce),it)}return xt}function Je(it,ft){for(var at=-1,xt=it==null?0:it.length;++at<xt&&ft(it[at],at,it)!==!1;);return it}function vy(it,ft){for(var at=it==null?0:it.length;at--&&ft(it[at],at,it)!==!1;);return it}function Wf(it,ft){for(var at=-1,xt=it==null?0:it.length;++at<xt;)if(!ft(it[at],at,it))return!1;return!0}function $i(it,ft){for(var at=-1,xt=it==null?0:it.length,Mt=0,zt=[];++at<xt;){var ce=it[at];ft(ce,at,it)&&(zt[Mt++]=ce)}return zt}function go(it,ft){var at=it==null?0:it.length;return!!at&&ir(it,ft,0)>-1}function kl(it,ft,at){for(var xt=-1,Mt=it==null?0:it.length;++xt<Mt;)if(at(ft,it[xt]))return!0;return!1}function ee(it,ft){for(var at=-1,xt=it==null?0:it.length,Mt=Array(xt);++at<xt;)Mt[at]=ft(it[at],at,it);return Mt}function Qi(it,ft){for(var at=-1,xt=ft.length,Mt=it.length;++at<xt;)it[Mt+at]=ft[at];return it}function Al(it,ft,at,xt){var Mt=-1,zt=it==null?0:it.length;for(xt&&zt&&(at=it[++Mt]);++Mt<zt;)at=ft(at,it[Mt],Mt,it);return at}function yy(it,ft,at,xt){var Mt=it==null?0:it.length;for(xt&&Mt&&(at=it[--Mt]);Mt--;)at=ft(at,it[Mt],Mt,it);return at}function Dl(it,ft){for(var at=-1,xt=it==null?0:it.length;++at<xt;)if(ft(it[at],at,it))return!0;return!1}var _y=Ml("length");function Cy(it){return it.split("")}function Sy(it){return it.match(k0)||[]}function Nf(it,ft,at){var xt;return at(it,function(Mt,zt,ce){if(ft(Mt,zt,ce))return xt=zt,!1}),xt}function po(it,ft,at,xt){for(var Mt=it.length,zt=at+(xt?1:-1);xt?zt--:++zt<Mt;)if(ft(it[zt],zt,it))return zt;return-1}function ir(it,ft,at){return ft===ft?Fy(it,ft,at):po(it,Xf,at)}function wy(it,ft,at,xt){for(var Mt=at-1,zt=it.length;++Mt<zt;)if(xt(it[Mt],ft))return Mt;return-1}function Xf(it){return it!==it}function Yf(it,ft){var at=it==null?0:it.length;return at?Ll(it,ft)/at:x}function Ml(it){return function(ft){return ft==null?e:ft[it]}}function Fl(it){return function(ft){return it==null?e:it[ft]}}function zf(it,ft,at,xt,Mt){return Mt(it,function(zt,ce,Kt){at=xt?(xt=!1,zt):ft(at,zt,ce,Kt)}),at}function xy(it,ft){var at=it.length;for(it.sort(ft);at--;)it[at]=it[at].value;return it}function Ll(it,ft){for(var at,xt=-1,Mt=it.length;++xt<Mt;){var zt=ft(it[xt]);zt!==e&&(at=at===e?zt:at+zt)}return at}function Il(it,ft){for(var at=-1,xt=Array(it);++at<it;)xt[at]=ft(at);return xt}function Ty(it,ft){return ee(ft,function(at){return[at,it[at]]})}function Uf(it){return it&&it.slice(0,qf(it)+1).replace(Sl,"")}function He(it){return function(ft){return it(ft)}}function Rl(it,ft){return ee(ft,function(at){return it[at]})}function Kr(it,ft){return it.has(ft)}function Hf(it,ft){for(var at=-1,xt=it.length;++at<xt&&ir(ft,it[at],0)>-1;);return at}function Gf(it,ft){for(var at=it.length;at--&&ir(ft,it[at],0)>-1;);return at}function by(it,ft){for(var at=it.length,xt=0;at--;)it[at]===ft&&++xt;return xt}var Oy=Fl(uy),Ey=Fl(hy);function Py(it){return"\\"+fy[it]}function ky(it,ft){return it==null?e:it[ft]}function nr(it){return sy.test(it)}function Ay(it){return oy.test(it)}function Dy(it){for(var ft,at=[];!(ft=it.next()).done;)at.push(ft.value);return at}function Bl(it){var ft=-1,at=Array(it.size);return it.forEach(function(xt,Mt){at[++ft]=[Mt,xt]}),at}function Vf(it,ft){return function(at){return it(ft(at))}}function Zi(it,ft){for(var at=-1,xt=it.length,Mt=0,zt=[];++at<xt;){var ce=it[at];(ce===ft||ce===u)&&(it[at]=u,zt[Mt++]=at)}return zt}function mo(it){var ft=-1,at=Array(it.size);return it.forEach(function(xt){at[++ft]=xt}),at}function My(it){var ft=-1,at=Array(it.size);return it.forEach(function(xt){at[++ft]=[xt,xt]}),at}function Fy(it,ft,at){for(var xt=at-1,Mt=it.length;++xt<Mt;)if(it[xt]===ft)return xt;return-1}function Ly(it,ft,at){for(var xt=at+1;xt--;)if(it[xt]===ft)return xt;return xt}function rr(it){return nr(it)?Ry(it):_y(it)}function gi(it){return nr(it)?By(it):Cy(it)}function qf(it){for(var ft=it.length;ft--&&b0.test(it.charAt(ft)););return ft}var Iy=Fl(cy);function Ry(it){for(var ft=Ol.lastIndex=0;Ol.test(it);)++ft;return ft}function By(it){return it.match(Ol)||[]}function jy(it){return it.match(ry)||[]}var Wy=function it(ft){ft=ft==null?pe:Ji.defaults(pe.Object(),ft,Ji.pick(pe,ay));var at=ft.Array,xt=ft.Date,Mt=ft.Error,zt=ft.Function,ce=ft.Math,Kt=ft.Object,jl=ft.RegExp,Ny=ft.String,ti=ft.TypeError,vo=at.prototype,Xy=zt.prototype,sr=Kt.prototype,yo=ft["__core-js_shared__"],_o=Xy.toString,Gt=sr.hasOwnProperty,Yy=0,Kf=function(){var c=/[^.]+$/.exec(yo&&yo.keys&&yo.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),Co=sr.toString,zy=_o.call(Kt),Uy=pe._,Hy=jl("^"+_o.call(Gt).replace(Cl,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),So=Mf?ft.Buffer:e,tn=ft.Symbol,wo=ft.Uint8Array,$f=So?So.allocUnsafe:e,xo=Vf(Kt.getPrototypeOf,Kt),Qf=Kt.create,Zf=sr.propertyIsEnumerable,To=vo.splice,Jf=tn?tn.isConcatSpreadable:e,$r=tn?tn.iterator:e,Dn=tn?tn.toStringTag:e,bo=function(){try{var c=Rn(Kt,"defineProperty");return c({},"",{}),c}catch{}}(),Gy=ft.clearTimeout!==pe.clearTimeout&&ft.clearTimeout,Vy=xt&&xt.now!==pe.Date.now&&xt.now,qy=ft.setTimeout!==pe.setTimeout&&ft.setTimeout,Oo=ce.ceil,Eo=ce.floor,Wl=Kt.getOwnPropertySymbols,Ky=So?So.isBuffer:e,td=ft.isFinite,$y=vo.join,Qy=Vf(Kt.keys,Kt),fe=ce.max,we=ce.min,Zy=xt.now,Jy=ft.parseInt,ed=ce.random,t_=vo.reverse,Nl=Rn(ft,"DataView"),Qr=Rn(ft,"Map"),Xl=Rn(ft,"Promise"),or=Rn(ft,"Set"),Zr=Rn(ft,"WeakMap"),Jr=Rn(Kt,"create"),Po=Zr&&new Zr,ar={},e_=Bn(Nl),i_=Bn(Qr),n_=Bn(Xl),r_=Bn(or),s_=Bn(Zr),ko=tn?tn.prototype:e,ts=ko?ko.valueOf:e,id=ko?ko.toString:e;function L(c){if(re(c)&&!Lt(c)&&!(c instanceof Nt)){if(c instanceof ei)return c;if(Gt.call(c,"__wrapped__"))return ng(c)}return new ei(c)}var lr=function(){function c(){}return function(d){if(!ne(d))return{};if(Qf)return Qf(d);c.prototype=d;var m=new c;return c.prototype=e,m}}();function Ao(){}function ei(c,d){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!d,this.__index__=0,this.__values__=e}L.templateSettings={escape:_0,evaluate:C0,interpolate:cf,variable:"",imports:{_:L}},L.prototype=Ao.prototype,L.prototype.constructor=L,ei.prototype=lr(Ao.prototype),ei.prototype.constructor=ei;function Nt(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=M,this.__views__=[]}function o_(){var c=new Nt(this.__wrapped__);return c.__actions__=Le(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=Le(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=Le(this.__views__),c}function a_(){if(this.__filtered__){var c=new Nt(this);c.__dir__=-1,c.__filtered__=!0}else c=this.clone(),c.__dir__*=-1;return c}function l_(){var c=this.__wrapped__.value(),d=this.__dir__,m=Lt(c),b=d<0,D=m?c.length:0,B=CC(0,D,this.__views__),H=B.start,J=B.end,nt=J-H,gt=b?J:H-1,mt=this.__iteratees__,vt=mt.length,wt=0,Et=we(nt,this.__takeCount__);if(!m||!b&&D==nt&&Et==nt)return Od(c,this.__actions__);var kt=[];t:for(;nt--&&wt<Et;){gt+=d;for(var Rt=-1,At=c[gt];++Rt<vt;){var jt=mt[Rt],Xt=jt.iteratee,qe=jt.type,De=Xt(At);if(qe==k)At=De;else if(!De){if(qe==w)continue t;break t}}kt[wt++]=At}return kt}Nt.prototype=lr(Ao.prototype),Nt.prototype.constructor=Nt;function Mn(c){var d=-1,m=c==null?0:c.length;for(this.clear();++d<m;){var b=c[d];this.set(b[0],b[1])}}function u_(){this.__data__=Jr?Jr(null):{},this.size=0}function h_(c){var d=this.has(c)&&delete this.__data__[c];return this.size-=d?1:0,d}function c_(c){var d=this.__data__;if(Jr){var m=d[c];return m===r?e:m}return Gt.call(d,c)?d[c]:e}function f_(c){var d=this.__data__;return Jr?d[c]!==e:Gt.call(d,c)}function d_(c,d){var m=this.__data__;return this.size+=this.has(c)?0:1,m[c]=Jr&&d===e?r:d,this}Mn.prototype.clear=u_,Mn.prototype.delete=h_,Mn.prototype.get=c_,Mn.prototype.has=f_,Mn.prototype.set=d_;function Li(c){var d=-1,m=c==null?0:c.length;for(this.clear();++d<m;){var b=c[d];this.set(b[0],b[1])}}function g_(){this.__data__=[],this.size=0}function p_(c){var d=this.__data__,m=Do(d,c);if(m<0)return!1;var b=d.length-1;return m==b?d.pop():To.call(d,m,1),--this.size,!0}function m_(c){var d=this.__data__,m=Do(d,c);return m<0?e:d[m][1]}function v_(c){return Do(this.__data__,c)>-1}function y_(c,d){var m=this.__data__,b=Do(m,c);return b<0?(++this.size,m.push([c,d])):m[b][1]=d,this}Li.prototype.clear=g_,Li.prototype.delete=p_,Li.prototype.get=m_,Li.prototype.has=v_,Li.prototype.set=y_;function Ii(c){var d=-1,m=c==null?0:c.length;for(this.clear();++d<m;){var b=c[d];this.set(b[0],b[1])}}function __(){this.size=0,this.__data__={hash:new Mn,map:new(Qr||Li),string:new Mn}}function C_(c){var d=zo(this,c).delete(c);return this.size-=d?1:0,d}function S_(c){return zo(this,c).get(c)}function w_(c){return zo(this,c).has(c)}function x_(c,d){var m=zo(this,c),b=m.size;return m.set(c,d),this.size+=m.size==b?0:1,this}Ii.prototype.clear=__,Ii.prototype.delete=C_,Ii.prototype.get=S_,Ii.prototype.has=w_,Ii.prototype.set=x_;function Fn(c){var d=-1,m=c==null?0:c.length;for(this.__data__=new Ii;++d<m;)this.add(c[d])}function T_(c){return this.__data__.set(c,r),this}function b_(c){return this.__data__.has(c)}Fn.prototype.add=Fn.prototype.push=T_,Fn.prototype.has=b_;function pi(c){var d=this.__data__=new Li(c);this.size=d.size}function O_(){this.__data__=new Li,this.size=0}function E_(c){var d=this.__data__,m=d.delete(c);return this.size=d.size,m}function P_(c){return this.__data__.get(c)}function k_(c){return this.__data__.has(c)}function A_(c,d){var m=this.__data__;if(m instanceof Li){var b=m.__data__;if(!Qr||b.length<i-1)return b.push([c,d]),this.size=++m.size,this;m=this.__data__=new Ii(b)}return m.set(c,d),this.size=m.size,this}pi.prototype.clear=O_,pi.prototype.delete=E_,pi.prototype.get=P_,pi.prototype.has=k_,pi.prototype.set=A_;function nd(c,d){var m=Lt(c),b=!m&&jn(c),D=!m&&!b&&on(c),B=!m&&!b&&!D&&fr(c),H=m||b||D||B,J=H?Il(c.length,Ny):[],nt=J.length;for(var gt in c)(d||Gt.call(c,gt))&&!(H&&(gt=="length"||D&&(gt=="offset"||gt=="parent")||B&&(gt=="buffer"||gt=="byteLength"||gt=="byteOffset")||Wi(gt,nt)))&&J.push(gt);return J}function rd(c){var d=c.length;return d?c[Zl(0,d-1)]:e}function D_(c,d){return Uo(Le(c),Ln(d,0,c.length))}function M_(c){return Uo(Le(c))}function Yl(c,d,m){(m!==e&&!mi(c[d],m)||m===e&&!(d in c))&&Ri(c,d,m)}function es(c,d,m){var b=c[d];(!(Gt.call(c,d)&&mi(b,m))||m===e&&!(d in c))&&Ri(c,d,m)}function Do(c,d){for(var m=c.length;m--;)if(mi(c[m][0],d))return m;return-1}function F_(c,d,m,b){return en(c,function(D,B,H){d(b,D,m(D),H)}),b}function sd(c,d){return c&&xi(d,me(d),c)}function L_(c,d){return c&&xi(d,Re(d),c)}function Ri(c,d,m){d=="__proto__"&&bo?bo(c,d,{configurable:!0,enumerable:!0,value:m,writable:!0}):c[d]=m}function zl(c,d){for(var m=-1,b=d.length,D=at(b),B=c==null;++m<b;)D[m]=B?e:xu(c,d[m]);return D}function Ln(c,d,m){return c===c&&(m!==e&&(c=c<=m?c:m),d!==e&&(c=c>=d?c:d)),c}function ii(c,d,m,b,D,B){var H,J=d&l,nt=d&h,gt=d&f;if(m&&(H=D?m(c,b,D,B):m(c)),H!==e)return H;if(!ne(c))return c;var mt=Lt(c);if(mt){if(H=wC(c),!J)return Le(c,H)}else{var vt=xe(c),wt=vt==Y||vt==K;if(on(c))return kd(c,J);if(vt==U||vt==q||wt&&!D){if(H=nt||wt?{}:qd(c),!J)return nt?cC(c,L_(H,c)):hC(c,sd(H,c))}else{if(!$t[vt])return D?c:{};H=xC(c,vt,J)}}B||(B=new pi);var Et=B.get(c);if(Et)return Et;B.set(c,H),xg(c)?c.forEach(function(At){H.add(ii(At,d,m,At,c,B))}):Sg(c)&&c.forEach(function(At,jt){H.set(jt,ii(At,d,m,jt,c,B))});var kt=gt?nt?uu:lu:nt?Re:me,Rt=mt?e:kt(c);return Je(Rt||c,function(At,jt){Rt&&(jt=At,At=c[jt]),es(H,jt,ii(At,d,m,jt,c,B))}),H}function I_(c){var d=me(c);return function(m){return od(m,c,d)}}function od(c,d,m){var b=m.length;if(c==null)return!b;for(c=Kt(c);b--;){var D=m[b],B=d[D],H=c[D];if(H===e&&!(D in c)||!B(H))return!1}return!0}function ad(c,d,m){if(typeof c!="function")throw new ti(n);return ls(function(){c.apply(e,m)},d)}function is(c,d,m,b){var D=-1,B=go,H=!0,J=c.length,nt=[],gt=d.length;if(!J)return nt;m&&(d=ee(d,He(m))),b?(B=kl,H=!1):d.length>=i&&(B=Kr,H=!1,d=new Fn(d));t:for(;++D<J;){var mt=c[D],vt=m==null?mt:m(mt);if(mt=b||mt!==0?mt:0,H&&vt===vt){for(var wt=gt;wt--;)if(d[wt]===vt)continue t;nt.push(mt)}else B(d,vt,b)||nt.push(mt)}return nt}var en=Ld(wi),ld=Ld(Hl,!0);function R_(c,d){var m=!0;return en(c,function(b,D,B){return m=!!d(b,D,B),m}),m}function Mo(c,d,m){for(var b=-1,D=c.length;++b<D;){var B=c[b],H=d(B);if(H!=null&&(J===e?H===H&&!Ve(H):m(H,J)))var J=H,nt=B}return nt}function B_(c,d,m,b){var D=c.length;for(m=It(m),m<0&&(m=-m>D?0:D+m),b=b===e||b>D?D:It(b),b<0&&(b+=D),b=m>b?0:bg(b);m<b;)c[m++]=d;return c}function ud(c,d){var m=[];return en(c,function(b,D,B){d(b,D,B)&&m.push(b)}),m}function ye(c,d,m,b,D){var B=-1,H=c.length;for(m||(m=bC),D||(D=[]);++B<H;){var J=c[B];d>0&&m(J)?d>1?ye(J,d-1,m,b,D):Qi(D,J):b||(D[D.length]=J)}return D}var Ul=Id(),hd=Id(!0);function wi(c,d){return c&&Ul(c,d,me)}function Hl(c,d){return c&&hd(c,d,me)}function Fo(c,d){return $i(d,function(m){return Ni(c[m])})}function In(c,d){d=rn(d,c);for(var m=0,b=d.length;c!=null&&m<b;)c=c[Ti(d[m++])];return m&&m==b?c:e}function cd(c,d,m){var b=d(c);return Lt(c)?b:Qi(b,m(c))}function ke(c){return c==null?c===e?Ft:dt:Dn&&Dn in Kt(c)?_C(c):MC(c)}function Gl(c,d){return c>d}function j_(c,d){return c!=null&&Gt.call(c,d)}function W_(c,d){return c!=null&&d in Kt(c)}function N_(c,d,m){return c>=we(d,m)&&c<fe(d,m)}function Vl(c,d,m){for(var b=m?kl:go,D=c[0].length,B=c.length,H=B,J=at(B),nt=1/0,gt=[];H--;){var mt=c[H];H&&d&&(mt=ee(mt,He(d))),nt=we(mt.length,nt),J[H]=!m&&(d||D>=120&&mt.length>=120)?new Fn(H&&mt):e}mt=c[0];var vt=-1,wt=J[0];t:for(;++vt<D&&gt.length<nt;){var Et=mt[vt],kt=d?d(Et):Et;if(Et=m||Et!==0?Et:0,!(wt?Kr(wt,kt):b(gt,kt,m))){for(H=B;--H;){var Rt=J[H];if(!(Rt?Kr(Rt,kt):b(c[H],kt,m)))continue t}wt&&wt.push(kt),gt.push(Et)}}return gt}function X_(c,d,m,b){return wi(c,function(D,B,H){d(b,m(D),B,H)}),b}function ns(c,d,m){d=rn(d,c),c=Zd(c,d);var b=c==null?c:c[Ti(ri(d))];return b==null?e:Ue(b,c,m)}function fd(c){return re(c)&&ke(c)==q}function Y_(c){return re(c)&&ke(c)==qt}function z_(c){return re(c)&&ke(c)==I}function rs(c,d,m,b,D){return c===d?!0:c==null||d==null||!re(c)&&!re(d)?c!==c&&d!==d:U_(c,d,m,b,rs,D)}function U_(c,d,m,b,D,B){var H=Lt(c),J=Lt(d),nt=H?et:xe(c),gt=J?et:xe(d);nt=nt==q?U:nt,gt=gt==q?U:gt;var mt=nt==U,vt=gt==U,wt=nt==gt;if(wt&&on(c)){if(!on(d))return!1;H=!0,mt=!1}if(wt&&!mt)return B||(B=new pi),H||fr(c)?Hd(c,d,m,b,D,B):vC(c,d,nt,m,b,D,B);if(!(m&g)){var Et=mt&&Gt.call(c,"__wrapped__"),kt=vt&&Gt.call(d,"__wrapped__");if(Et||kt){var Rt=Et?c.value():c,At=kt?d.value():d;return B||(B=new pi),D(Rt,At,m,b,B)}}return wt?(B||(B=new pi),yC(c,d,m,b,D,B)):!1}function H_(c){return re(c)&&xe(c)==st}function ql(c,d,m,b){var D=m.length,B=D,H=!b;if(c==null)return!B;for(c=Kt(c);D--;){var J=m[D];if(H&&J[2]?J[1]!==c[J[0]]:!(J[0]in c))return!1}for(;++D<B;){J=m[D];var nt=J[0],gt=c[nt],mt=J[1];if(H&&J[2]){if(gt===e&&!(nt in c))return!1}else{var vt=new pi;if(b)var wt=b(gt,mt,nt,c,d,vt);if(!(wt===e?rs(mt,gt,g|p,b,vt):wt))return!1}}return!0}function dd(c){if(!ne(c)||EC(c))return!1;var d=Ni(c)?Hy:I0;return d.test(Bn(c))}function G_(c){return re(c)&&ke(c)==St}function V_(c){return re(c)&&xe(c)==Ot}function q_(c){return re(c)&&$o(c.length)&&!!Zt[ke(c)]}function gd(c){return typeof c=="function"?c:c==null?Be:typeof c=="object"?Lt(c)?vd(c[0],c[1]):md(c):Rg(c)}function Kl(c){if(!as(c))return Qy(c);var d=[];for(var m in Kt(c))Gt.call(c,m)&&m!="constructor"&&d.push(m);return d}function K_(c){if(!ne(c))return DC(c);var d=as(c),m=[];for(var b in c)b=="constructor"&&(d||!Gt.call(c,b))||m.push(b);return m}function $l(c,d){return c<d}function pd(c,d){var m=-1,b=Ie(c)?at(c.length):[];return en(c,function(D,B,H){b[++m]=d(D,B,H)}),b}function md(c){var d=cu(c);return d.length==1&&d[0][2]?$d(d[0][0],d[0][1]):function(m){return m===c||ql(m,c,d)}}function vd(c,d){return du(c)&&Kd(d)?$d(Ti(c),d):function(m){var b=xu(m,c);return b===e&&b===d?Tu(m,c):rs(d,b,g|p)}}function Lo(c,d,m,b,D){c!==d&&Ul(d,function(B,H){if(D||(D=new pi),ne(B))$_(c,d,H,m,Lo,b,D);else{var J=b?b(pu(c,H),B,H+"",c,d,D):e;J===e&&(J=B),Yl(c,H,J)}},Re)}function $_(c,d,m,b,D,B,H){var J=pu(c,m),nt=pu(d,m),gt=H.get(nt);if(gt){Yl(c,m,gt);return}var mt=B?B(J,nt,m+"",c,d,H):e,vt=mt===e;if(vt){var wt=Lt(nt),Et=!wt&&on(nt),kt=!wt&&!Et&&fr(nt);mt=nt,wt||Et||kt?Lt(J)?mt=J:le(J)?mt=Le(J):Et?(vt=!1,mt=kd(nt,!0)):kt?(vt=!1,mt=Ad(nt,!0)):mt=[]:us(nt)||jn(nt)?(mt=J,jn(J)?mt=Og(J):(!ne(J)||Ni(J))&&(mt=qd(nt))):vt=!1}vt&&(H.set(nt,mt),D(mt,nt,b,B,H),H.delete(nt)),Yl(c,m,mt)}function yd(c,d){var m=c.length;if(m)return d+=d<0?m:0,Wi(d,m)?c[d]:e}function _d(c,d,m){d.length?d=ee(d,function(B){return Lt(B)?function(H){return In(H,B.length===1?B[0]:B)}:B}):d=[Be];var b=-1;d=ee(d,He(Pt()));var D=pd(c,function(B,H,J){var nt=ee(d,function(gt){return gt(B)});return{criteria:nt,index:++b,value:B}});return xy(D,function(B,H){return uC(B,H,m)})}function Q_(c,d){return Cd(c,d,function(m,b){return Tu(c,b)})}function Cd(c,d,m){for(var b=-1,D=d.length,B={};++b<D;){var H=d[b],J=In(c,H);m(J,H)&&ss(B,rn(H,c),J)}return B}function Z_(c){return function(d){return In(d,c)}}function Ql(c,d,m,b){var D=b?wy:ir,B=-1,H=d.length,J=c;for(c===d&&(d=Le(d)),m&&(J=ee(c,He(m)));++B<H;)for(var nt=0,gt=d[B],mt=m?m(gt):gt;(nt=D(J,mt,nt,b))>-1;)J!==c&&To.call(J,nt,1),To.call(c,nt,1);return c}function Sd(c,d){for(var m=c?d.length:0,b=m-1;m--;){var D=d[m];if(m==b||D!==B){var B=D;Wi(D)?To.call(c,D,1):eu(c,D)}}return c}function Zl(c,d){return c+Eo(ed()*(d-c+1))}function J_(c,d,m,b){for(var D=-1,B=fe(Oo((d-c)/(m||1)),0),H=at(B);B--;)H[b?B:++D]=c,c+=m;return H}function Jl(c,d){var m="";if(!c||d<1||d>W)return m;do d%2&&(m+=c),d=Eo(d/2),d&&(c+=c);while(d);return m}function Bt(c,d){return mu(Qd(c,d,Be),c+"")}function tC(c){return rd(dr(c))}function eC(c,d){var m=dr(c);return Uo(m,Ln(d,0,m.length))}function ss(c,d,m,b){if(!ne(c))return c;d=rn(d,c);for(var D=-1,B=d.length,H=B-1,J=c;J!=null&&++D<B;){var nt=Ti(d[D]),gt=m;if(nt==="__proto__"||nt==="constructor"||nt==="prototype")return c;if(D!=H){var mt=J[nt];gt=b?b(mt,nt,J):e,gt===e&&(gt=ne(mt)?mt:Wi(d[D+1])?[]:{})}es(J,nt,gt),J=J[nt]}return c}var wd=Po?function(c,d){return Po.set(c,d),c}:Be,iC=bo?function(c,d){return bo(c,"toString",{configurable:!0,enumerable:!1,value:Ou(d),writable:!0})}:Be;function nC(c){return Uo(dr(c))}function ni(c,d,m){var b=-1,D=c.length;d<0&&(d=-d>D?0:D+d),m=m>D?D:m,m<0&&(m+=D),D=d>m?0:m-d>>>0,d>>>=0;for(var B=at(D);++b<D;)B[b]=c[b+d];return B}function rC(c,d){var m;return en(c,function(b,D,B){return m=d(b,D,B),!m}),!!m}function Io(c,d,m){var b=0,D=c==null?b:c.length;if(typeof d=="number"&&d===d&&D<=z){for(;b<D;){var B=b+D>>>1,H=c[B];H!==null&&!Ve(H)&&(m?H<=d:H<d)?b=B+1:D=B}return D}return tu(c,d,Be,m)}function tu(c,d,m,b){var D=0,B=c==null?0:c.length;if(B===0)return 0;d=m(d);for(var H=d!==d,J=d===null,nt=Ve(d),gt=d===e;D<B;){var mt=Eo((D+B)/2),vt=m(c[mt]),wt=vt!==e,Et=vt===null,kt=vt===vt,Rt=Ve(vt);if(H)var At=b||kt;else gt?At=kt&&(b||wt):J?At=kt&&wt&&(b||!Et):nt?At=kt&&wt&&!Et&&(b||!Rt):Et||Rt?At=!1:At=b?vt<=d:vt<d;At?D=mt+1:B=mt}return we(B,R)}function xd(c,d){for(var m=-1,b=c.length,D=0,B=[];++m<b;){var H=c[m],J=d?d(H):H;if(!m||!mi(J,nt)){var nt=J;B[D++]=H===0?0:H}}return B}function Td(c){return typeof c=="number"?c:Ve(c)?x:+c}function Ge(c){if(typeof c=="string")return c;if(Lt(c))return ee(c,Ge)+"";if(Ve(c))return id?id.call(c):"";var d=c+"";return d=="0"&&1/c==-E?"-0":d}function nn(c,d,m){var b=-1,D=go,B=c.length,H=!0,J=[],nt=J;if(m)H=!1,D=kl;else if(B>=i){var gt=d?null:pC(c);if(gt)return mo(gt);H=!1,D=Kr,nt=new Fn}else nt=d?[]:J;t:for(;++b<B;){var mt=c[b],vt=d?d(mt):mt;if(mt=m||mt!==0?mt:0,H&&vt===vt){for(var wt=nt.length;wt--;)if(nt[wt]===vt)continue t;d&&nt.push(vt),J.push(mt)}else D(nt,vt,m)||(nt!==J&&nt.push(vt),J.push(mt))}return J}function eu(c,d){return d=rn(d,c),c=Zd(c,d),c==null||delete c[Ti(ri(d))]}function bd(c,d,m,b){return ss(c,d,m(In(c,d)),b)}function Ro(c,d,m,b){for(var D=c.length,B=b?D:-1;(b?B--:++B<D)&&d(c[B],B,c););return m?ni(c,b?0:B,b?B+1:D):ni(c,b?B+1:0,b?D:B)}function Od(c,d){var m=c;return m instanceof Nt&&(m=m.value()),Al(d,function(b,D){return D.func.apply(D.thisArg,Qi([b],D.args))},m)}function iu(c,d,m){var b=c.length;if(b<2)return b?nn(c[0]):[];for(var D=-1,B=at(b);++D<b;)for(var H=c[D],J=-1;++J<b;)J!=D&&(B[D]=is(B[D]||H,c[J],d,m));return nn(ye(B,1),d,m)}function Ed(c,d,m){for(var b=-1,D=c.length,B=d.length,H={};++b<D;){var J=b<B?d[b]:e;m(H,c[b],J)}return H}function nu(c){return le(c)?c:[]}function ru(c){return typeof c=="function"?c:Be}function rn(c,d){return Lt(c)?c:du(c,d)?[c]:ig(Ut(c))}var sC=Bt;function sn(c,d,m){var b=c.length;return m=m===e?b:m,!d&&m>=b?c:ni(c,d,m)}var Pd=Gy||function(c){return pe.clearTimeout(c)};function kd(c,d){if(d)return c.slice();var m=c.length,b=$f?$f(m):new c.constructor(m);return c.copy(b),b}function su(c){var d=new c.constructor(c.byteLength);return new wo(d).set(new wo(c)),d}function oC(c,d){var m=d?su(c.buffer):c.buffer;return new c.constructor(m,c.byteOffset,c.byteLength)}function aC(c){var d=new c.constructor(c.source,ff.exec(c));return d.lastIndex=c.lastIndex,d}function lC(c){return ts?Kt(ts.call(c)):{}}function Ad(c,d){var m=d?su(c.buffer):c.buffer;return new c.constructor(m,c.byteOffset,c.length)}function Dd(c,d){if(c!==d){var m=c!==e,b=c===null,D=c===c,B=Ve(c),H=d!==e,J=d===null,nt=d===d,gt=Ve(d);if(!J&&!gt&&!B&&c>d||B&&H&&nt&&!J&&!gt||b&&H&&nt||!m&&nt||!D)return 1;if(!b&&!B&&!gt&&c<d||gt&&m&&D&&!b&&!B||J&&m&&D||!H&&D||!nt)return-1}return 0}function uC(c,d,m){for(var b=-1,D=c.criteria,B=d.criteria,H=D.length,J=m.length;++b<H;){var nt=Dd(D[b],B[b]);if(nt){if(b>=J)return nt;var gt=m[b];return nt*(gt=="desc"?-1:1)}}return c.index-d.index}function Md(c,d,m,b){for(var D=-1,B=c.length,H=m.length,J=-1,nt=d.length,gt=fe(B-H,0),mt=at(nt+gt),vt=!b;++J<nt;)mt[J]=d[J];for(;++D<H;)(vt||D<B)&&(mt[m[D]]=c[D]);for(;gt--;)mt[J++]=c[D++];return mt}function Fd(c,d,m,b){for(var D=-1,B=c.length,H=-1,J=m.length,nt=-1,gt=d.length,mt=fe(B-J,0),vt=at(mt+gt),wt=!b;++D<mt;)vt[D]=c[D];for(var Et=D;++nt<gt;)vt[Et+nt]=d[nt];for(;++H<J;)(wt||D<B)&&(vt[Et+m[H]]=c[D++]);return vt}function Le(c,d){var m=-1,b=c.length;for(d||(d=at(b));++m<b;)d[m]=c[m];return d}function xi(c,d,m,b){var D=!m;m||(m={});for(var B=-1,H=d.length;++B<H;){var J=d[B],nt=b?b(m[J],c[J],J,m,c):e;nt===e&&(nt=c[J]),D?Ri(m,J,nt):es(m,J,nt)}return m}function hC(c,d){return xi(c,fu(c),d)}function cC(c,d){return xi(c,Gd(c),d)}function Bo(c,d){return function(m,b){var D=Lt(m)?my:F_,B=d?d():{};return D(m,c,Pt(b,2),B)}}function ur(c){return Bt(function(d,m){var b=-1,D=m.length,B=D>1?m[D-1]:e,H=D>2?m[2]:e;for(B=c.length>3&&typeof B=="function"?(D--,B):e,H&&Ae(m[0],m[1],H)&&(B=D<3?e:B,D=1),d=Kt(d);++b<D;){var J=m[b];J&&c(d,J,b,B)}return d})}function Ld(c,d){return function(m,b){if(m==null)return m;if(!Ie(m))return c(m,b);for(var D=m.length,B=d?D:-1,H=Kt(m);(d?B--:++B<D)&&b(H[B],B,H)!==!1;);return m}}function Id(c){return function(d,m,b){for(var D=-1,B=Kt(d),H=b(d),J=H.length;J--;){var nt=H[c?J:++D];if(m(B[nt],nt,B)===!1)break}return d}}function fC(c,d,m){var b=d&v,D=os(c);function B(){var H=this&&this!==pe&&this instanceof B?D:c;return H.apply(b?m:this,arguments)}return B}function Rd(c){return function(d){d=Ut(d);var m=nr(d)?gi(d):e,b=m?m[0]:d.charAt(0),D=m?sn(m,1).join(""):d.slice(1);return b[c]()+D}}function hr(c){return function(d){return Al(Lg(Fg(d).replace(iy,"")),c,"")}}function os(c){return function(){var d=arguments;switch(d.length){case 0:return new c;case 1:return new c(d[0]);case 2:return new c(d[0],d[1]);case 3:return new c(d[0],d[1],d[2]);case 4:return new c(d[0],d[1],d[2],d[3]);case 5:return new c(d[0],d[1],d[2],d[3],d[4]);case 6:return new c(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new c(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var m=lr(c.prototype),b=c.apply(m,d);return ne(b)?b:m}}function dC(c,d,m){var b=os(c);function D(){for(var B=arguments.length,H=at(B),J=B,nt=cr(D);J--;)H[J]=arguments[J];var gt=B<3&&H[0]!==nt&&H[B-1]!==nt?[]:Zi(H,nt);if(B-=gt.length,B<m)return Xd(c,d,jo,D.placeholder,e,H,gt,e,e,m-B);var mt=this&&this!==pe&&this instanceof D?b:c;return Ue(mt,this,H)}return D}function Bd(c){return function(d,m,b){var D=Kt(d);if(!Ie(d)){var B=Pt(m,3);d=me(d),m=function(J){return B(D[J],J,D)}}var H=c(d,m,b);return H>-1?D[B?d[H]:H]:e}}function jd(c){return ji(function(d){var m=d.length,b=m,D=ei.prototype.thru;for(c&&d.reverse();b--;){var B=d[b];if(typeof B!="function")throw new ti(n);if(D&&!H&&Yo(B)=="wrapper")var H=new ei([],!0)}for(b=H?b:m;++b<m;){B=d[b];var J=Yo(B),nt=J=="wrapper"?hu(B):e;nt&&gu(nt[0])&&nt[1]==(Z|T|F|Q)&&!nt[4].length&&nt[9]==1?H=H[Yo(nt[0])].apply(H,nt[3]):H=B.length==1&&gu(B)?H[J]():H.thru(B)}return function(){var gt=arguments,mt=gt[0];if(H&&gt.length==1&&Lt(mt))return H.plant(mt).value();for(var vt=0,wt=m?d[vt].apply(this,gt):mt;++vt<m;)wt=d[vt].call(this,wt);return wt}})}function jo(c,d,m,b,D,B,H,J,nt,gt){var mt=d&Z,vt=d&v,wt=d&y,Et=d&(T|P),kt=d&$,Rt=wt?e:os(c);function At(){for(var jt=arguments.length,Xt=at(jt),qe=jt;qe--;)Xt[qe]=arguments[qe];if(Et)var De=cr(At),Ke=by(Xt,De);if(b&&(Xt=Md(Xt,b,D,Et)),B&&(Xt=Fd(Xt,B,H,Et)),jt-=Ke,Et&&jt<gt){var ue=Zi(Xt,De);return Xd(c,d,jo,At.placeholder,m,Xt,ue,J,nt,gt-jt)}var vi=vt?m:this,Yi=wt?vi[c]:c;return jt=Xt.length,J?Xt=FC(Xt,J):kt&&jt>1&&Xt.reverse(),mt&&nt<jt&&(Xt.length=nt),this&&this!==pe&&this instanceof At&&(Yi=Rt||os(Yi)),Yi.apply(vi,Xt)}return At}function Wd(c,d){return function(m,b){return X_(m,c,d(b),{})}}function Wo(c,d){return function(m,b){var D;if(m===e&&b===e)return d;if(m!==e&&(D=m),b!==e){if(D===e)return b;typeof m=="string"||typeof b=="string"?(m=Ge(m),b=Ge(b)):(m=Td(m),b=Td(b)),D=c(m,b)}return D}}function ou(c){return ji(function(d){return d=ee(d,He(Pt())),Bt(function(m){var b=this;return c(d,function(D){return Ue(D,b,m)})})})}function No(c,d){d=d===e?" ":Ge(d);var m=d.length;if(m<2)return m?Jl(d,c):d;var b=Jl(d,Oo(c/rr(d)));return nr(d)?sn(gi(b),0,c).join(""):b.slice(0,c)}function gC(c,d,m,b){var D=d&v,B=os(c);function H(){for(var J=-1,nt=arguments.length,gt=-1,mt=b.length,vt=at(mt+nt),wt=this&&this!==pe&&this instanceof H?B:c;++gt<mt;)vt[gt]=b[gt];for(;nt--;)vt[gt++]=arguments[++J];return Ue(wt,D?m:this,vt)}return H}function Nd(c){return function(d,m,b){return b&&typeof b!="number"&&Ae(d,m,b)&&(m=b=e),d=Xi(d),m===e?(m=d,d=0):m=Xi(m),b=b===e?d<m?1:-1:Xi(b),J_(d,m,b,c)}}function Xo(c){return function(d,m){return typeof d=="string"&&typeof m=="string"||(d=si(d),m=si(m)),c(d,m)}}function Xd(c,d,m,b,D,B,H,J,nt,gt){var mt=d&T,vt=mt?H:e,wt=mt?e:H,Et=mt?B:e,kt=mt?e:B;d|=mt?F:j,d&=~(mt?j:F),d&_||(d&=~(v|y));var Rt=[c,d,D,Et,vt,kt,wt,J,nt,gt],At=m.apply(e,Rt);return gu(c)&&Jd(At,Rt),At.placeholder=b,tg(At,c,d)}function au(c){var d=ce[c];return function(m,b){if(m=si(m),b=b==null?0:we(It(b),292),b&&td(m)){var D=(Ut(m)+"e").split("e"),B=d(D[0]+"e"+(+D[1]+b));return D=(Ut(B)+"e").split("e"),+(D[0]+"e"+(+D[1]-b))}return d(m)}}var pC=or&&1/mo(new or([,-0]))[1]==E?function(c){return new or(c)}:ku;function Yd(c){return function(d){var m=xe(d);return m==st?Bl(d):m==Ot?My(d):Ty(d,c(d))}}function Bi(c,d,m,b,D,B,H,J){var nt=d&y;if(!nt&&typeof c!="function")throw new ti(n);var gt=b?b.length:0;if(gt||(d&=~(F|j),b=D=e),H=H===e?H:fe(It(H),0),J=J===e?J:It(J),gt-=D?D.length:0,d&j){var mt=b,vt=D;b=D=e}var wt=nt?e:hu(c),Et=[c,d,m,b,D,mt,vt,B,H,J];if(wt&&AC(Et,wt),c=Et[0],d=Et[1],m=Et[2],b=Et[3],D=Et[4],J=Et[9]=Et[9]===e?nt?0:c.length:fe(Et[9]-gt,0),!J&&d&(T|P)&&(d&=~(T|P)),!d||d==v)var kt=fC(c,d,m);else d==T||d==P?kt=dC(c,d,J):(d==F||d==(v|F))&&!D.length?kt=gC(c,d,m,b):kt=jo.apply(e,Et);var Rt=wt?wd:Jd;return tg(Rt(kt,Et),c,d)}function zd(c,d,m,b){return c===e||mi(c,sr[m])&&!Gt.call(b,m)?d:c}function Ud(c,d,m,b,D,B){return ne(c)&&ne(d)&&(B.set(d,c),Lo(c,d,e,Ud,B),B.delete(d)),c}function mC(c){return us(c)?e:c}function Hd(c,d,m,b,D,B){var H=m&g,J=c.length,nt=d.length;if(J!=nt&&!(H&&nt>J))return!1;var gt=B.get(c),mt=B.get(d);if(gt&&mt)return gt==d&&mt==c;var vt=-1,wt=!0,Et=m&p?new Fn:e;for(B.set(c,d),B.set(d,c);++vt<J;){var kt=c[vt],Rt=d[vt];if(b)var At=H?b(Rt,kt,vt,d,c,B):b(kt,Rt,vt,c,d,B);if(At!==e){if(At)continue;wt=!1;break}if(Et){if(!Dl(d,function(jt,Xt){if(!Kr(Et,Xt)&&(kt===jt||D(kt,jt,m,b,B)))return Et.push(Xt)})){wt=!1;break}}else if(!(kt===Rt||D(kt,Rt,m,b,B))){wt=!1;break}}return B.delete(c),B.delete(d),wt}function vC(c,d,m,b,D,B,H){switch(m){case Si:if(c.byteLength!=d.byteLength||c.byteOffset!=d.byteOffset)return!1;c=c.buffer,d=d.buffer;case qt:return!(c.byteLength!=d.byteLength||!B(new wo(c),new wo(d)));case X:case I:case yt:return mi(+c,+d);case V:return c.name==d.name&&c.message==d.message;case St:case Tt:return c==d+"";case st:var J=Bl;case Ot:var nt=b&g;if(J||(J=mo),c.size!=d.size&&!nt)return!1;var gt=H.get(c);if(gt)return gt==d;b|=p,H.set(c,d);var mt=Hd(J(c),J(d),b,D,B,H);return H.delete(c),mt;case Wt:if(ts)return ts.call(c)==ts.call(d)}return!1}function yC(c,d,m,b,D,B){var H=m&g,J=lu(c),nt=J.length,gt=lu(d),mt=gt.length;if(nt!=mt&&!H)return!1;for(var vt=nt;vt--;){var wt=J[vt];if(!(H?wt in d:Gt.call(d,wt)))return!1}var Et=B.get(c),kt=B.get(d);if(Et&&kt)return Et==d&&kt==c;var Rt=!0;B.set(c,d),B.set(d,c);for(var At=H;++vt<nt;){wt=J[vt];var jt=c[wt],Xt=d[wt];if(b)var qe=H?b(Xt,jt,wt,d,c,B):b(jt,Xt,wt,c,d,B);if(!(qe===e?jt===Xt||D(jt,Xt,m,b,B):qe)){Rt=!1;break}At||(At=wt=="constructor")}if(Rt&&!At){var De=c.constructor,Ke=d.constructor;De!=Ke&&"constructor"in c&&"constructor"in d&&!(typeof De=="function"&&De instanceof De&&typeof Ke=="function"&&Ke instanceof Ke)&&(Rt=!1)}return B.delete(c),B.delete(d),Rt}function ji(c){return mu(Qd(c,e,og),c+"")}function lu(c){return cd(c,me,fu)}function uu(c){return cd(c,Re,Gd)}var hu=Po?function(c){return Po.get(c)}:ku;function Yo(c){for(var d=c.name+"",m=ar[d],b=Gt.call(ar,d)?m.length:0;b--;){var D=m[b],B=D.func;if(B==null||B==c)return D.name}return d}function cr(c){var d=Gt.call(L,"placeholder")?L:c;return d.placeholder}function Pt(){var c=L.iteratee||Eu;return c=c===Eu?gd:c,arguments.length?c(arguments[0],arguments[1]):c}function zo(c,d){var m=c.__data__;return OC(d)?m[typeof d=="string"?"string":"hash"]:m.map}function cu(c){for(var d=me(c),m=d.length;m--;){var b=d[m],D=c[b];d[m]=[b,D,Kd(D)]}return d}function Rn(c,d){var m=ky(c,d);return dd(m)?m:e}function _C(c){var d=Gt.call(c,Dn),m=c[Dn];try{c[Dn]=e;var b=!0}catch{}var D=Co.call(c);return b&&(d?c[Dn]=m:delete c[Dn]),D}var fu=Wl?function(c){return c==null?[]:(c=Kt(c),$i(Wl(c),function(d){return Zf.call(c,d)}))}:Au,Gd=Wl?function(c){for(var d=[];c;)Qi(d,fu(c)),c=xo(c);return d}:Au,xe=ke;(Nl&&xe(new Nl(new ArrayBuffer(1)))!=Si||Qr&&xe(new Qr)!=st||Xl&&xe(Xl.resolve())!=pt||or&&xe(new or)!=Ot||Zr&&xe(new Zr)!=ae)&&(xe=function(c){var d=ke(c),m=d==U?c.constructor:e,b=m?Bn(m):"";if(b)switch(b){case e_:return Si;case i_:return st;case n_:return pt;case r_:return Ot;case s_:return ae}return d});function CC(c,d,m){for(var b=-1,D=m.length;++b<D;){var B=m[b],H=B.size;switch(B.type){case"drop":c+=H;break;case"dropRight":d-=H;break;case"take":d=we(d,c+H);break;case"takeRight":c=fe(c,d-H);break}}return{start:c,end:d}}function SC(c){var d=c.match(E0);return d?d[1].split(P0):[]}function Vd(c,d,m){d=rn(d,c);for(var b=-1,D=d.length,B=!1;++b<D;){var H=Ti(d[b]);if(!(B=c!=null&&m(c,H)))break;c=c[H]}return B||++b!=D?B:(D=c==null?0:c.length,!!D&&$o(D)&&Wi(H,D)&&(Lt(c)||jn(c)))}function wC(c){var d=c.length,m=new c.constructor(d);return d&&typeof c[0]=="string"&&Gt.call(c,"index")&&(m.index=c.index,m.input=c.input),m}function qd(c){return typeof c.constructor=="function"&&!as(c)?lr(xo(c)):{}}function xC(c,d,m){var b=c.constructor;switch(d){case qt:return su(c);case X:case I:return new b(+c);case Si:return oC(c,m);case Fi:case Pn:case kn:case gl:case pl:case ml:case vl:case yl:case _l:return Ad(c,m);case st:return new b;case yt:case Tt:return new b(c);case St:return aC(c);case Ot:return new b;case Wt:return lC(c)}}function TC(c,d){var m=d.length;if(!m)return c;var b=m-1;return d[b]=(m>1?"& ":"")+d[b],d=d.join(m>2?", ":" "),c.replace(O0,`{
/* [wrapped with `+d+`] */
`)}function bC(c){return Lt(c)||jn(c)||!!(Jf&&c&&c[Jf])}function Wi(c,d){var m=typeof c;return d=d??W,!!d&&(m=="number"||m!="symbol"&&B0.test(c))&&c>-1&&c%1==0&&c<d}function Ae(c,d,m){if(!ne(m))return!1;var b=typeof d;return(b=="number"?Ie(m)&&Wi(d,m.length):b=="string"&&d in m)?mi(m[d],c):!1}function du(c,d){if(Lt(c))return!1;var m=typeof c;return m=="number"||m=="symbol"||m=="boolean"||c==null||Ve(c)?!0:w0.test(c)||!S0.test(c)||d!=null&&c in Kt(d)}function OC(c){var d=typeof c;return d=="string"||d=="number"||d=="symbol"||d=="boolean"?c!=="__proto__":c===null}function gu(c){var d=Yo(c),m=L[d];if(typeof m!="function"||!(d in Nt.prototype))return!1;if(c===m)return!0;var b=hu(m);return!!b&&c===b[0]}function EC(c){return!!Kf&&Kf in c}var PC=yo?Ni:Du;function as(c){var d=c&&c.constructor,m=typeof d=="function"&&d.prototype||sr;return c===m}function Kd(c){return c===c&&!ne(c)}function $d(c,d){return function(m){return m==null?!1:m[c]===d&&(d!==e||c in Kt(m))}}function kC(c){var d=qo(c,function(b){return m.size===a&&m.clear(),b}),m=d.cache;return d}function AC(c,d){var m=c[1],b=d[1],D=m|b,B=D<(v|y|Z),H=b==Z&&m==T||b==Z&&m==Q&&c[7].length<=d[8]||b==(Z|Q)&&d[7].length<=d[8]&&m==T;if(!(B||H))return c;b&v&&(c[2]=d[2],D|=m&v?0:_);var J=d[3];if(J){var nt=c[3];c[3]=nt?Md(nt,J,d[4]):J,c[4]=nt?Zi(c[3],u):d[4]}return J=d[5],J&&(nt=c[5],c[5]=nt?Fd(nt,J,d[6]):J,c[6]=nt?Zi(c[5],u):d[6]),J=d[7],J&&(c[7]=J),b&Z&&(c[8]=c[8]==null?d[8]:we(c[8],d[8])),c[9]==null&&(c[9]=d[9]),c[0]=d[0],c[1]=D,c}function DC(c){var d=[];if(c!=null)for(var m in Kt(c))d.push(m);return d}function MC(c){return Co.call(c)}function Qd(c,d,m){return d=fe(d===e?c.length-1:d,0),function(){for(var b=arguments,D=-1,B=fe(b.length-d,0),H=at(B);++D<B;)H[D]=b[d+D];D=-1;for(var J=at(d+1);++D<d;)J[D]=b[D];return J[d]=m(H),Ue(c,this,J)}}function Zd(c,d){return d.length<2?c:In(c,ni(d,0,-1))}function FC(c,d){for(var m=c.length,b=we(d.length,m),D=Le(c);b--;){var B=d[b];c[b]=Wi(B,m)?D[B]:e}return c}function pu(c,d){if(!(d==="constructor"&&typeof c[d]=="function")&&d!="__proto__")return c[d]}var Jd=eg(wd),ls=qy||function(c,d){return pe.setTimeout(c,d)},mu=eg(iC);function tg(c,d,m){var b=d+"";return mu(c,TC(b,LC(SC(b),m)))}function eg(c){var d=0,m=0;return function(){var b=Zy(),D=lt-(b-m);if(m=b,D>0){if(++d>=ct)return arguments[0]}else d=0;return c.apply(e,arguments)}}function Uo(c,d){var m=-1,b=c.length,D=b-1;for(d=d===e?b:d;++m<d;){var B=Zl(m,D),H=c[B];c[B]=c[m],c[m]=H}return c.length=d,c}var ig=kC(function(c){var d=[];return c.charCodeAt(0)===46&&d.push(""),c.replace(x0,function(m,b,D,B){d.push(D?B.replace(D0,"$1"):b||m)}),d});function Ti(c){if(typeof c=="string"||Ve(c))return c;var d=c+"";return d=="0"&&1/c==-E?"-0":d}function Bn(c){if(c!=null){try{return _o.call(c)}catch{}try{return c+""}catch{}}return""}function LC(c,d){return Je(N,function(m){var b="_."+m[0];d&m[1]&&!go(c,b)&&c.push(b)}),c.sort()}function ng(c){if(c instanceof Nt)return c.clone();var d=new ei(c.__wrapped__,c.__chain__);return d.__actions__=Le(c.__actions__),d.__index__=c.__index__,d.__values__=c.__values__,d}function IC(c,d,m){(m?Ae(c,d,m):d===e)?d=1:d=fe(It(d),0);var b=c==null?0:c.length;if(!b||d<1)return[];for(var D=0,B=0,H=at(Oo(b/d));D<b;)H[B++]=ni(c,D,D+=d);return H}function RC(c){for(var d=-1,m=c==null?0:c.length,b=0,D=[];++d<m;){var B=c[d];B&&(D[b++]=B)}return D}function BC(){var c=arguments.length;if(!c)return[];for(var d=at(c-1),m=arguments[0],b=c;b--;)d[b-1]=arguments[b];return Qi(Lt(m)?Le(m):[m],ye(d,1))}var jC=Bt(function(c,d){return le(c)?is(c,ye(d,1,le,!0)):[]}),WC=Bt(function(c,d){var m=ri(d);return le(m)&&(m=e),le(c)?is(c,ye(d,1,le,!0),Pt(m,2)):[]}),NC=Bt(function(c,d){var m=ri(d);return le(m)&&(m=e),le(c)?is(c,ye(d,1,le,!0),e,m):[]});function XC(c,d,m){var b=c==null?0:c.length;return b?(d=m||d===e?1:It(d),ni(c,d<0?0:d,b)):[]}function YC(c,d,m){var b=c==null?0:c.length;return b?(d=m||d===e?1:It(d),d=b-d,ni(c,0,d<0?0:d)):[]}function zC(c,d){return c&&c.length?Ro(c,Pt(d,3),!0,!0):[]}function UC(c,d){return c&&c.length?Ro(c,Pt(d,3),!0):[]}function HC(c,d,m,b){var D=c==null?0:c.length;return D?(m&&typeof m!="number"&&Ae(c,d,m)&&(m=0,b=D),B_(c,d,m,b)):[]}function rg(c,d,m){var b=c==null?0:c.length;if(!b)return-1;var D=m==null?0:It(m);return D<0&&(D=fe(b+D,0)),po(c,Pt(d,3),D)}function sg(c,d,m){var b=c==null?0:c.length;if(!b)return-1;var D=b-1;return m!==e&&(D=It(m),D=m<0?fe(b+D,0):we(D,b-1)),po(c,Pt(d,3),D,!0)}function og(c){var d=c==null?0:c.length;return d?ye(c,1):[]}function GC(c){var d=c==null?0:c.length;return d?ye(c,E):[]}function VC(c,d){var m=c==null?0:c.length;return m?(d=d===e?1:It(d),ye(c,d)):[]}function qC(c){for(var d=-1,m=c==null?0:c.length,b={};++d<m;){var D=c[d];b[D[0]]=D[1]}return b}function ag(c){return c&&c.length?c[0]:e}function KC(c,d,m){var b=c==null?0:c.length;if(!b)return-1;var D=m==null?0:It(m);return D<0&&(D=fe(b+D,0)),ir(c,d,D)}function $C(c){var d=c==null?0:c.length;return d?ni(c,0,-1):[]}var QC=Bt(function(c){var d=ee(c,nu);return d.length&&d[0]===c[0]?Vl(d):[]}),ZC=Bt(function(c){var d=ri(c),m=ee(c,nu);return d===ri(m)?d=e:m.pop(),m.length&&m[0]===c[0]?Vl(m,Pt(d,2)):[]}),JC=Bt(function(c){var d=ri(c),m=ee(c,nu);return d=typeof d=="function"?d:e,d&&m.pop(),m.length&&m[0]===c[0]?Vl(m,e,d):[]});function t1(c,d){return c==null?"":$y.call(c,d)}function ri(c){var d=c==null?0:c.length;return d?c[d-1]:e}function e1(c,d,m){var b=c==null?0:c.length;if(!b)return-1;var D=b;return m!==e&&(D=It(m),D=D<0?fe(b+D,0):we(D,b-1)),d===d?Ly(c,d,D):po(c,Xf,D,!0)}function i1(c,d){return c&&c.length?yd(c,It(d)):e}var n1=Bt(lg);function lg(c,d){return c&&c.length&&d&&d.length?Ql(c,d):c}function r1(c,d,m){return c&&c.length&&d&&d.length?Ql(c,d,Pt(m,2)):c}function s1(c,d,m){return c&&c.length&&d&&d.length?Ql(c,d,e,m):c}var o1=ji(function(c,d){var m=c==null?0:c.length,b=zl(c,d);return Sd(c,ee(d,function(D){return Wi(D,m)?+D:D}).sort(Dd)),b});function a1(c,d){var m=[];if(!(c&&c.length))return m;var b=-1,D=[],B=c.length;for(d=Pt(d,3);++b<B;){var H=c[b];d(H,b,c)&&(m.push(H),D.push(b))}return Sd(c,D),m}function vu(c){return c==null?c:t_.call(c)}function l1(c,d,m){var b=c==null?0:c.length;return b?(m&&typeof m!="number"&&Ae(c,d,m)?(d=0,m=b):(d=d==null?0:It(d),m=m===e?b:It(m)),ni(c,d,m)):[]}function u1(c,d){return Io(c,d)}function h1(c,d,m){return tu(c,d,Pt(m,2))}function c1(c,d){var m=c==null?0:c.length;if(m){var b=Io(c,d);if(b<m&&mi(c[b],d))return b}return-1}function f1(c,d){return Io(c,d,!0)}function d1(c,d,m){return tu(c,d,Pt(m,2),!0)}function g1(c,d){var m=c==null?0:c.length;if(m){var b=Io(c,d,!0)-1;if(mi(c[b],d))return b}return-1}function p1(c){return c&&c.length?xd(c):[]}function m1(c,d){return c&&c.length?xd(c,Pt(d,2)):[]}function v1(c){var d=c==null?0:c.length;return d?ni(c,1,d):[]}function y1(c,d,m){return c&&c.length?(d=m||d===e?1:It(d),ni(c,0,d<0?0:d)):[]}function _1(c,d,m){var b=c==null?0:c.length;return b?(d=m||d===e?1:It(d),d=b-d,ni(c,d<0?0:d,b)):[]}function C1(c,d){return c&&c.length?Ro(c,Pt(d,3),!1,!0):[]}function S1(c,d){return c&&c.length?Ro(c,Pt(d,3)):[]}var w1=Bt(function(c){return nn(ye(c,1,le,!0))}),x1=Bt(function(c){var d=ri(c);return le(d)&&(d=e),nn(ye(c,1,le,!0),Pt(d,2))}),T1=Bt(function(c){var d=ri(c);return d=typeof d=="function"?d:e,nn(ye(c,1,le,!0),e,d)});function b1(c){return c&&c.length?nn(c):[]}function O1(c,d){return c&&c.length?nn(c,Pt(d,2)):[]}function E1(c,d){return d=typeof d=="function"?d:e,c&&c.length?nn(c,e,d):[]}function yu(c){if(!(c&&c.length))return[];var d=0;return c=$i(c,function(m){if(le(m))return d=fe(m.length,d),!0}),Il(d,function(m){return ee(c,Ml(m))})}function ug(c,d){if(!(c&&c.length))return[];var m=yu(c);return d==null?m:ee(m,function(b){return Ue(d,e,b)})}var P1=Bt(function(c,d){return le(c)?is(c,d):[]}),k1=Bt(function(c){return iu($i(c,le))}),A1=Bt(function(c){var d=ri(c);return le(d)&&(d=e),iu($i(c,le),Pt(d,2))}),D1=Bt(function(c){var d=ri(c);return d=typeof d=="function"?d:e,iu($i(c,le),e,d)}),M1=Bt(yu);function F1(c,d){return Ed(c||[],d||[],es)}function L1(c,d){return Ed(c||[],d||[],ss)}var I1=Bt(function(c){var d=c.length,m=d>1?c[d-1]:e;return m=typeof m=="function"?(c.pop(),m):e,ug(c,m)});function hg(c){var d=L(c);return d.__chain__=!0,d}function R1(c,d){return d(c),c}function Ho(c,d){return d(c)}var B1=ji(function(c){var d=c.length,m=d?c[0]:0,b=this.__wrapped__,D=function(B){return zl(B,c)};return d>1||this.__actions__.length||!(b instanceof Nt)||!Wi(m)?this.thru(D):(b=b.slice(m,+m+(d?1:0)),b.__actions__.push({func:Ho,args:[D],thisArg:e}),new ei(b,this.__chain__).thru(function(B){return d&&!B.length&&B.push(e),B}))});function j1(){return hg(this)}function W1(){return new ei(this.value(),this.__chain__)}function N1(){this.__values__===e&&(this.__values__=Tg(this.value()));var c=this.__index__>=this.__values__.length,d=c?e:this.__values__[this.__index__++];return{done:c,value:d}}function X1(){return this}function Y1(c){for(var d,m=this;m instanceof Ao;){var b=ng(m);b.__index__=0,b.__values__=e,d?D.__wrapped__=b:d=b;var D=b;m=m.__wrapped__}return D.__wrapped__=c,d}function z1(){var c=this.__wrapped__;if(c instanceof Nt){var d=c;return this.__actions__.length&&(d=new Nt(this)),d=d.reverse(),d.__actions__.push({func:Ho,args:[vu],thisArg:e}),new ei(d,this.__chain__)}return this.thru(vu)}function U1(){return Od(this.__wrapped__,this.__actions__)}var H1=Bo(function(c,d,m){Gt.call(c,m)?++c[m]:Ri(c,m,1)});function G1(c,d,m){var b=Lt(c)?Wf:R_;return m&&Ae(c,d,m)&&(d=e),b(c,Pt(d,3))}function V1(c,d){var m=Lt(c)?$i:ud;return m(c,Pt(d,3))}var q1=Bd(rg),K1=Bd(sg);function $1(c,d){return ye(Go(c,d),1)}function Q1(c,d){return ye(Go(c,d),E)}function Z1(c,d,m){return m=m===e?1:It(m),ye(Go(c,d),m)}function cg(c,d){var m=Lt(c)?Je:en;return m(c,Pt(d,3))}function fg(c,d){var m=Lt(c)?vy:ld;return m(c,Pt(d,3))}var J1=Bo(function(c,d,m){Gt.call(c,m)?c[m].push(d):Ri(c,m,[d])});function tS(c,d,m,b){c=Ie(c)?c:dr(c),m=m&&!b?It(m):0;var D=c.length;return m<0&&(m=fe(D+m,0)),Qo(c)?m<=D&&c.indexOf(d,m)>-1:!!D&&ir(c,d,m)>-1}var eS=Bt(function(c,d,m){var b=-1,D=typeof d=="function",B=Ie(c)?at(c.length):[];return en(c,function(H){B[++b]=D?Ue(d,H,m):ns(H,d,m)}),B}),iS=Bo(function(c,d,m){Ri(c,m,d)});function Go(c,d){var m=Lt(c)?ee:pd;return m(c,Pt(d,3))}function nS(c,d,m,b){return c==null?[]:(Lt(d)||(d=d==null?[]:[d]),m=b?e:m,Lt(m)||(m=m==null?[]:[m]),_d(c,d,m))}var rS=Bo(function(c,d,m){c[m?0:1].push(d)},function(){return[[],[]]});function sS(c,d,m){var b=Lt(c)?Al:zf,D=arguments.length<3;return b(c,Pt(d,4),m,D,en)}function oS(c,d,m){var b=Lt(c)?yy:zf,D=arguments.length<3;return b(c,Pt(d,4),m,D,ld)}function aS(c,d){var m=Lt(c)?$i:ud;return m(c,Ko(Pt(d,3)))}function lS(c){var d=Lt(c)?rd:tC;return d(c)}function uS(c,d,m){(m?Ae(c,d,m):d===e)?d=1:d=It(d);var b=Lt(c)?D_:eC;return b(c,d)}function hS(c){var d=Lt(c)?M_:nC;return d(c)}function cS(c){if(c==null)return 0;if(Ie(c))return Qo(c)?rr(c):c.length;var d=xe(c);return d==st||d==Ot?c.size:Kl(c).length}function fS(c,d,m){var b=Lt(c)?Dl:rC;return m&&Ae(c,d,m)&&(d=e),b(c,Pt(d,3))}var dS=Bt(function(c,d){if(c==null)return[];var m=d.length;return m>1&&Ae(c,d[0],d[1])?d=[]:m>2&&Ae(d[0],d[1],d[2])&&(d=[d[0]]),_d(c,ye(d,1),[])}),Vo=Vy||function(){return pe.Date.now()};function gS(c,d){if(typeof d!="function")throw new ti(n);return c=It(c),function(){if(--c<1)return d.apply(this,arguments)}}function dg(c,d,m){return d=m?e:d,d=c&&d==null?c.length:d,Bi(c,Z,e,e,e,e,d)}function gg(c,d){var m;if(typeof d!="function")throw new ti(n);return c=It(c),function(){return--c>0&&(m=d.apply(this,arguments)),c<=1&&(d=e),m}}var _u=Bt(function(c,d,m){var b=v;if(m.length){var D=Zi(m,cr(_u));b|=F}return Bi(c,b,d,m,D)}),pg=Bt(function(c,d,m){var b=v|y;if(m.length){var D=Zi(m,cr(pg));b|=F}return Bi(d,b,c,m,D)});function mg(c,d,m){d=m?e:d;var b=Bi(c,T,e,e,e,e,e,d);return b.placeholder=mg.placeholder,b}function vg(c,d,m){d=m?e:d;var b=Bi(c,P,e,e,e,e,e,d);return b.placeholder=vg.placeholder,b}function yg(c,d,m){var b,D,B,H,J,nt,gt=0,mt=!1,vt=!1,wt=!0;if(typeof c!="function")throw new ti(n);d=si(d)||0,ne(m)&&(mt=!!m.leading,vt="maxWait"in m,B=vt?fe(si(m.maxWait)||0,d):B,wt="trailing"in m?!!m.trailing:wt);function Et(ue){var vi=b,Yi=D;return b=D=e,gt=ue,H=c.apply(Yi,vi),H}function kt(ue){return gt=ue,J=ls(jt,d),mt?Et(ue):H}function Rt(ue){var vi=ue-nt,Yi=ue-gt,Bg=d-vi;return vt?we(Bg,B-Yi):Bg}function At(ue){var vi=ue-nt,Yi=ue-gt;return nt===e||vi>=d||vi<0||vt&&Yi>=B}function jt(){var ue=Vo();if(At(ue))return Xt(ue);J=ls(jt,Rt(ue))}function Xt(ue){return J=e,wt&&b?Et(ue):(b=D=e,H)}function qe(){J!==e&&Pd(J),gt=0,b=nt=D=J=e}function De(){return J===e?H:Xt(Vo())}function Ke(){var ue=Vo(),vi=At(ue);if(b=arguments,D=this,nt=ue,vi){if(J===e)return kt(nt);if(vt)return Pd(J),J=ls(jt,d),Et(nt)}return J===e&&(J=ls(jt,d)),H}return Ke.cancel=qe,Ke.flush=De,Ke}var pS=Bt(function(c,d){return ad(c,1,d)}),mS=Bt(function(c,d,m){return ad(c,si(d)||0,m)});function vS(c){return Bi(c,$)}function qo(c,d){if(typeof c!="function"||d!=null&&typeof d!="function")throw new ti(n);var m=function(){var b=arguments,D=d?d.apply(this,b):b[0],B=m.cache;if(B.has(D))return B.get(D);var H=c.apply(this,b);return m.cache=B.set(D,H)||B,H};return m.cache=new(qo.Cache||Ii),m}qo.Cache=Ii;function Ko(c){if(typeof c!="function")throw new ti(n);return function(){var d=arguments;switch(d.length){case 0:return!c.call(this);case 1:return!c.call(this,d[0]);case 2:return!c.call(this,d[0],d[1]);case 3:return!c.call(this,d[0],d[1],d[2])}return!c.apply(this,d)}}function yS(c){return gg(2,c)}var _S=sC(function(c,d){d=d.length==1&&Lt(d[0])?ee(d[0],He(Pt())):ee(ye(d,1),He(Pt()));var m=d.length;return Bt(function(b){for(var D=-1,B=we(b.length,m);++D<B;)b[D]=d[D].call(this,b[D]);return Ue(c,this,b)})}),Cu=Bt(function(c,d){var m=Zi(d,cr(Cu));return Bi(c,F,e,d,m)}),_g=Bt(function(c,d){var m=Zi(d,cr(_g));return Bi(c,j,e,d,m)}),CS=ji(function(c,d){return Bi(c,Q,e,e,e,d)});function SS(c,d){if(typeof c!="function")throw new ti(n);return d=d===e?d:It(d),Bt(c,d)}function wS(c,d){if(typeof c!="function")throw new ti(n);return d=d==null?0:fe(It(d),0),Bt(function(m){var b=m[d],D=sn(m,0,d);return b&&Qi(D,b),Ue(c,this,D)})}function xS(c,d,m){var b=!0,D=!0;if(typeof c!="function")throw new ti(n);return ne(m)&&(b="leading"in m?!!m.leading:b,D="trailing"in m?!!m.trailing:D),yg(c,d,{leading:b,maxWait:d,trailing:D})}function TS(c){return dg(c,1)}function bS(c,d){return Cu(ru(d),c)}function OS(){if(!arguments.length)return[];var c=arguments[0];return Lt(c)?c:[c]}function ES(c){return ii(c,f)}function PS(c,d){return d=typeof d=="function"?d:e,ii(c,f,d)}function kS(c){return ii(c,l|f)}function AS(c,d){return d=typeof d=="function"?d:e,ii(c,l|f,d)}function DS(c,d){return d==null||od(c,d,me(d))}function mi(c,d){return c===d||c!==c&&d!==d}var MS=Xo(Gl),FS=Xo(function(c,d){return c>=d}),jn=fd(function(){return arguments}())?fd:function(c){return re(c)&&Gt.call(c,"callee")&&!Zf.call(c,"callee")},Lt=at.isArray,LS=Ff?He(Ff):Y_;function Ie(c){return c!=null&&$o(c.length)&&!Ni(c)}function le(c){return re(c)&&Ie(c)}function IS(c){return c===!0||c===!1||re(c)&&ke(c)==X}var on=Ky||Du,RS=Lf?He(Lf):z_;function BS(c){return re(c)&&c.nodeType===1&&!us(c)}function jS(c){if(c==null)return!0;if(Ie(c)&&(Lt(c)||typeof c=="string"||typeof c.splice=="function"||on(c)||fr(c)||jn(c)))return!c.length;var d=xe(c);if(d==st||d==Ot)return!c.size;if(as(c))return!Kl(c).length;for(var m in c)if(Gt.call(c,m))return!1;return!0}function WS(c,d){return rs(c,d)}function NS(c,d,m){m=typeof m=="function"?m:e;var b=m?m(c,d):e;return b===e?rs(c,d,e,m):!!b}function Su(c){if(!re(c))return!1;var d=ke(c);return d==V||d==G||typeof c.message=="string"&&typeof c.name=="string"&&!us(c)}function XS(c){return typeof c=="number"&&td(c)}function Ni(c){if(!ne(c))return!1;var d=ke(c);return d==Y||d==K||d==ot||d==_t}function Cg(c){return typeof c=="number"&&c==It(c)}function $o(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=W}function ne(c){var d=typeof c;return c!=null&&(d=="object"||d=="function")}function re(c){return c!=null&&typeof c=="object"}var Sg=If?He(If):H_;function YS(c,d){return c===d||ql(c,d,cu(d))}function zS(c,d,m){return m=typeof m=="function"?m:e,ql(c,d,cu(d),m)}function US(c){return wg(c)&&c!=+c}function HS(c){if(PC(c))throw new Mt(o);return dd(c)}function GS(c){return c===null}function VS(c){return c==null}function wg(c){return typeof c=="number"||re(c)&&ke(c)==yt}function us(c){if(!re(c)||ke(c)!=U)return!1;var d=xo(c);if(d===null)return!0;var m=Gt.call(d,"constructor")&&d.constructor;return typeof m=="function"&&m instanceof m&&_o.call(m)==zy}var wu=Rf?He(Rf):G_;function qS(c){return Cg(c)&&c>=-W&&c<=W}var xg=Bf?He(Bf):V_;function Qo(c){return typeof c=="string"||!Lt(c)&&re(c)&&ke(c)==Tt}function Ve(c){return typeof c=="symbol"||re(c)&&ke(c)==Wt}var fr=jf?He(jf):q_;function KS(c){return c===e}function $S(c){return re(c)&&xe(c)==ae}function QS(c){return re(c)&&ke(c)==ze}var ZS=Xo($l),JS=Xo(function(c,d){return c<=d});function Tg(c){if(!c)return[];if(Ie(c))return Qo(c)?gi(c):Le(c);if($r&&c[$r])return Dy(c[$r]());var d=xe(c),m=d==st?Bl:d==Ot?mo:dr;return m(c)}function Xi(c){if(!c)return c===0?c:0;if(c=si(c),c===E||c===-E){var d=c<0?-1:1;return d*O}return c===c?c:0}function It(c){var d=Xi(c),m=d%1;return d===d?m?d-m:d:0}function bg(c){return c?Ln(It(c),0,M):0}function si(c){if(typeof c=="number")return c;if(Ve(c))return x;if(ne(c)){var d=typeof c.valueOf=="function"?c.valueOf():c;c=ne(d)?d+"":d}if(typeof c!="string")return c===0?c:+c;c=Uf(c);var m=L0.test(c);return m||R0.test(c)?gy(c.slice(2),m?2:8):F0.test(c)?x:+c}function Og(c){return xi(c,Re(c))}function tw(c){return c?Ln(It(c),-W,W):c===0?c:0}function Ut(c){return c==null?"":Ge(c)}var ew=ur(function(c,d){if(as(d)||Ie(d)){xi(d,me(d),c);return}for(var m in d)Gt.call(d,m)&&es(c,m,d[m])}),Eg=ur(function(c,d){xi(d,Re(d),c)}),Zo=ur(function(c,d,m,b){xi(d,Re(d),c,b)}),iw=ur(function(c,d,m,b){xi(d,me(d),c,b)}),nw=ji(zl);function rw(c,d){var m=lr(c);return d==null?m:sd(m,d)}var sw=Bt(function(c,d){c=Kt(c);var m=-1,b=d.length,D=b>2?d[2]:e;for(D&&Ae(d[0],d[1],D)&&(b=1);++m<b;)for(var B=d[m],H=Re(B),J=-1,nt=H.length;++J<nt;){var gt=H[J],mt=c[gt];(mt===e||mi(mt,sr[gt])&&!Gt.call(c,gt))&&(c[gt]=B[gt])}return c}),ow=Bt(function(c){return c.push(e,Ud),Ue(Pg,e,c)});function aw(c,d){return Nf(c,Pt(d,3),wi)}function lw(c,d){return Nf(c,Pt(d,3),Hl)}function uw(c,d){return c==null?c:Ul(c,Pt(d,3),Re)}function hw(c,d){return c==null?c:hd(c,Pt(d,3),Re)}function cw(c,d){return c&&wi(c,Pt(d,3))}function fw(c,d){return c&&Hl(c,Pt(d,3))}function dw(c){return c==null?[]:Fo(c,me(c))}function gw(c){return c==null?[]:Fo(c,Re(c))}function xu(c,d,m){var b=c==null?e:In(c,d);return b===e?m:b}function pw(c,d){return c!=null&&Vd(c,d,j_)}function Tu(c,d){return c!=null&&Vd(c,d,W_)}var mw=Wd(function(c,d,m){d!=null&&typeof d.toString!="function"&&(d=Co.call(d)),c[d]=m},Ou(Be)),vw=Wd(function(c,d,m){d!=null&&typeof d.toString!="function"&&(d=Co.call(d)),Gt.call(c,d)?c[d].push(m):c[d]=[m]},Pt),yw=Bt(ns);function me(c){return Ie(c)?nd(c):Kl(c)}function Re(c){return Ie(c)?nd(c,!0):K_(c)}function _w(c,d){var m={};return d=Pt(d,3),wi(c,function(b,D,B){Ri(m,d(b,D,B),b)}),m}function Cw(c,d){var m={};return d=Pt(d,3),wi(c,function(b,D,B){Ri(m,D,d(b,D,B))}),m}var Sw=ur(function(c,d,m){Lo(c,d,m)}),Pg=ur(function(c,d,m,b){Lo(c,d,m,b)}),ww=ji(function(c,d){var m={};if(c==null)return m;var b=!1;d=ee(d,function(B){return B=rn(B,c),b||(b=B.length>1),B}),xi(c,uu(c),m),b&&(m=ii(m,l|h|f,mC));for(var D=d.length;D--;)eu(m,d[D]);return m});function xw(c,d){return kg(c,Ko(Pt(d)))}var Tw=ji(function(c,d){return c==null?{}:Q_(c,d)});function kg(c,d){if(c==null)return{};var m=ee(uu(c),function(b){return[b]});return d=Pt(d),Cd(c,m,function(b,D){return d(b,D[0])})}function bw(c,d,m){d=rn(d,c);var b=-1,D=d.length;for(D||(D=1,c=e);++b<D;){var B=c==null?e:c[Ti(d[b])];B===e&&(b=D,B=m),c=Ni(B)?B.call(c):B}return c}function Ow(c,d,m){return c==null?c:ss(c,d,m)}function Ew(c,d,m,b){return b=typeof b=="function"?b:e,c==null?c:ss(c,d,m,b)}var Ag=Yd(me),Dg=Yd(Re);function Pw(c,d,m){var b=Lt(c),D=b||on(c)||fr(c);if(d=Pt(d,4),m==null){var B=c&&c.constructor;D?m=b?new B:[]:ne(c)?m=Ni(B)?lr(xo(c)):{}:m={}}return(D?Je:wi)(c,function(H,J,nt){return d(m,H,J,nt)}),m}function kw(c,d){return c==null?!0:eu(c,d)}function Aw(c,d,m){return c==null?c:bd(c,d,ru(m))}function Dw(c,d,m,b){return b=typeof b=="function"?b:e,c==null?c:bd(c,d,ru(m),b)}function dr(c){return c==null?[]:Rl(c,me(c))}function Mw(c){return c==null?[]:Rl(c,Re(c))}function Fw(c,d,m){return m===e&&(m=d,d=e),m!==e&&(m=si(m),m=m===m?m:0),d!==e&&(d=si(d),d=d===d?d:0),Ln(si(c),d,m)}function Lw(c,d,m){return d=Xi(d),m===e?(m=d,d=0):m=Xi(m),c=si(c),N_(c,d,m)}function Iw(c,d,m){if(m&&typeof m!="boolean"&&Ae(c,d,m)&&(d=m=e),m===e&&(typeof d=="boolean"?(m=d,d=e):typeof c=="boolean"&&(m=c,c=e)),c===e&&d===e?(c=0,d=1):(c=Xi(c),d===e?(d=c,c=0):d=Xi(d)),c>d){var b=c;c=d,d=b}if(m||c%1||d%1){var D=ed();return we(c+D*(d-c+dy("1e-"+((D+"").length-1))),d)}return Zl(c,d)}var Rw=hr(function(c,d,m){return d=d.toLowerCase(),c+(m?Mg(d):d)});function Mg(c){return bu(Ut(c).toLowerCase())}function Fg(c){return c=Ut(c),c&&c.replace(j0,Oy).replace(ny,"")}function Bw(c,d,m){c=Ut(c),d=Ge(d);var b=c.length;m=m===e?b:Ln(It(m),0,b);var D=m;return m-=d.length,m>=0&&c.slice(m,D)==d}function jw(c){return c=Ut(c),c&&y0.test(c)?c.replace(hf,Ey):c}function Ww(c){return c=Ut(c),c&&T0.test(c)?c.replace(Cl,"\\$&"):c}var Nw=hr(function(c,d,m){return c+(m?"-":"")+d.toLowerCase()}),Xw=hr(function(c,d,m){return c+(m?" ":"")+d.toLowerCase()}),Yw=Rd("toLowerCase");function zw(c,d,m){c=Ut(c),d=It(d);var b=d?rr(c):0;if(!d||b>=d)return c;var D=(d-b)/2;return No(Eo(D),m)+c+No(Oo(D),m)}function Uw(c,d,m){c=Ut(c),d=It(d);var b=d?rr(c):0;return d&&b<d?c+No(d-b,m):c}function Hw(c,d,m){c=Ut(c),d=It(d);var b=d?rr(c):0;return d&&b<d?No(d-b,m)+c:c}function Gw(c,d,m){return m||d==null?d=0:d&&(d=+d),Jy(Ut(c).replace(Sl,""),d||0)}function Vw(c,d,m){return(m?Ae(c,d,m):d===e)?d=1:d=It(d),Jl(Ut(c),d)}function qw(){var c=arguments,d=Ut(c[0]);return c.length<3?d:d.replace(c[1],c[2])}var Kw=hr(function(c,d,m){return c+(m?"_":"")+d.toLowerCase()});function $w(c,d,m){return m&&typeof m!="number"&&Ae(c,d,m)&&(d=m=e),m=m===e?M:m>>>0,m?(c=Ut(c),c&&(typeof d=="string"||d!=null&&!wu(d))&&(d=Ge(d),!d&&nr(c))?sn(gi(c),0,m):c.split(d,m)):[]}var Qw=hr(function(c,d,m){return c+(m?" ":"")+bu(d)});function Zw(c,d,m){return c=Ut(c),m=m==null?0:Ln(It(m),0,c.length),d=Ge(d),c.slice(m,m+d.length)==d}function Jw(c,d,m){var b=L.templateSettings;m&&Ae(c,d,m)&&(d=e),c=Ut(c),d=Zo({},d,b,zd);var D=Zo({},d.imports,b.imports,zd),B=me(D),H=Rl(D,B),J,nt,gt=0,mt=d.interpolate||ho,vt="__p += '",wt=jl((d.escape||ho).source+"|"+mt.source+"|"+(mt===cf?M0:ho).source+"|"+(d.evaluate||ho).source+"|$","g"),Et="//# sourceURL="+(Gt.call(d,"sourceURL")?(d.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ly+"]")+`
`;c.replace(wt,function(At,jt,Xt,qe,De,Ke){return Xt||(Xt=qe),vt+=c.slice(gt,Ke).replace(W0,Py),jt&&(J=!0,vt+=`' +
__e(`+jt+`) +
'`),De&&(nt=!0,vt+=`';
`+De+`;
__p += '`),Xt&&(vt+=`' +
((__t = (`+Xt+`)) == null ? '' : __t) +
'`),gt=Ke+At.length,At}),vt+=`';
`;var kt=Gt.call(d,"variable")&&d.variable;if(!kt)vt=`with (obj) {
`+vt+`
}
`;else if(A0.test(kt))throw new Mt(s);vt=(nt?vt.replace(g0,""):vt).replace(p0,"$1").replace(m0,"$1;"),vt="function("+(kt||"obj")+`) {
`+(kt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(J?", __e = _.escape":"")+(nt?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+vt+`return __p
}`;var Rt=Ig(function(){return zt(B,Et+"return "+vt).apply(e,H)});if(Rt.source=vt,Su(Rt))throw Rt;return Rt}function tx(c){return Ut(c).toLowerCase()}function ex(c){return Ut(c).toUpperCase()}function ix(c,d,m){if(c=Ut(c),c&&(m||d===e))return Uf(c);if(!c||!(d=Ge(d)))return c;var b=gi(c),D=gi(d),B=Hf(b,D),H=Gf(b,D)+1;return sn(b,B,H).join("")}function nx(c,d,m){if(c=Ut(c),c&&(m||d===e))return c.slice(0,qf(c)+1);if(!c||!(d=Ge(d)))return c;var b=gi(c),D=Gf(b,gi(d))+1;return sn(b,0,D).join("")}function rx(c,d,m){if(c=Ut(c),c&&(m||d===e))return c.replace(Sl,"");if(!c||!(d=Ge(d)))return c;var b=gi(c),D=Hf(b,gi(d));return sn(b,D).join("")}function sx(c,d){var m=tt,b=rt;if(ne(d)){var D="separator"in d?d.separator:D;m="length"in d?It(d.length):m,b="omission"in d?Ge(d.omission):b}c=Ut(c);var B=c.length;if(nr(c)){var H=gi(c);B=H.length}if(m>=B)return c;var J=m-rr(b);if(J<1)return b;var nt=H?sn(H,0,J).join(""):c.slice(0,J);if(D===e)return nt+b;if(H&&(J+=nt.length-J),wu(D)){if(c.slice(J).search(D)){var gt,mt=nt;for(D.global||(D=jl(D.source,Ut(ff.exec(D))+"g")),D.lastIndex=0;gt=D.exec(mt);)var vt=gt.index;nt=nt.slice(0,vt===e?J:vt)}}else if(c.indexOf(Ge(D),J)!=J){var wt=nt.lastIndexOf(D);wt>-1&&(nt=nt.slice(0,wt))}return nt+b}function ox(c){return c=Ut(c),c&&v0.test(c)?c.replace(uf,Iy):c}var ax=hr(function(c,d,m){return c+(m?" ":"")+d.toUpperCase()}),bu=Rd("toUpperCase");function Lg(c,d,m){return c=Ut(c),d=m?e:d,d===e?Ay(c)?jy(c):Sy(c):c.match(d)||[]}var Ig=Bt(function(c,d){try{return Ue(c,e,d)}catch(m){return Su(m)?m:new Mt(m)}}),lx=ji(function(c,d){return Je(d,function(m){m=Ti(m),Ri(c,m,_u(c[m],c))}),c});function ux(c){var d=c==null?0:c.length,m=Pt();return c=d?ee(c,function(b){if(typeof b[1]!="function")throw new ti(n);return[m(b[0]),b[1]]}):[],Bt(function(b){for(var D=-1;++D<d;){var B=c[D];if(Ue(B[0],this,b))return Ue(B[1],this,b)}})}function hx(c){return I_(ii(c,l))}function Ou(c){return function(){return c}}function cx(c,d){return c==null||c!==c?d:c}var fx=jd(),dx=jd(!0);function Be(c){return c}function Eu(c){return gd(typeof c=="function"?c:ii(c,l))}function gx(c){return md(ii(c,l))}function px(c,d){return vd(c,ii(d,l))}var mx=Bt(function(c,d){return function(m){return ns(m,c,d)}}),vx=Bt(function(c,d){return function(m){return ns(c,m,d)}});function Pu(c,d,m){var b=me(d),D=Fo(d,b);m==null&&!(ne(d)&&(D.length||!b.length))&&(m=d,d=c,c=this,D=Fo(d,me(d)));var B=!(ne(m)&&"chain"in m)||!!m.chain,H=Ni(c);return Je(D,function(J){var nt=d[J];c[J]=nt,H&&(c.prototype[J]=function(){var gt=this.__chain__;if(B||gt){var mt=c(this.__wrapped__),vt=mt.__actions__=Le(this.__actions__);return vt.push({func:nt,args:arguments,thisArg:c}),mt.__chain__=gt,mt}return nt.apply(c,Qi([this.value()],arguments))})}),c}function yx(){return pe._===this&&(pe._=Uy),this}function ku(){}function _x(c){return c=It(c),Bt(function(d){return yd(d,c)})}var Cx=ou(ee),Sx=ou(Wf),wx=ou(Dl);function Rg(c){return du(c)?Ml(Ti(c)):Z_(c)}function xx(c){return function(d){return c==null?e:In(c,d)}}var Tx=Nd(),bx=Nd(!0);function Au(){return[]}function Du(){return!1}function Ox(){return{}}function Ex(){return""}function Px(){return!0}function kx(c,d){if(c=It(c),c<1||c>W)return[];var m=M,b=we(c,M);d=Pt(d),c-=M;for(var D=Il(b,d);++m<c;)d(m);return D}function Ax(c){return Lt(c)?ee(c,Ti):Ve(c)?[c]:Le(ig(Ut(c)))}function Dx(c){var d=++Yy;return Ut(c)+d}var Mx=Wo(function(c,d){return c+d},0),Fx=au("ceil"),Lx=Wo(function(c,d){return c/d},1),Ix=au("floor");function Rx(c){return c&&c.length?Mo(c,Be,Gl):e}function Bx(c,d){return c&&c.length?Mo(c,Pt(d,2),Gl):e}function jx(c){return Yf(c,Be)}function Wx(c,d){return Yf(c,Pt(d,2))}function Nx(c){return c&&c.length?Mo(c,Be,$l):e}function Xx(c,d){return c&&c.length?Mo(c,Pt(d,2),$l):e}var Yx=Wo(function(c,d){return c*d},1),zx=au("round"),Ux=Wo(function(c,d){return c-d},0);function Hx(c){return c&&c.length?Ll(c,Be):0}function Gx(c,d){return c&&c.length?Ll(c,Pt(d,2)):0}return L.after=gS,L.ary=dg,L.assign=ew,L.assignIn=Eg,L.assignInWith=Zo,L.assignWith=iw,L.at=nw,L.before=gg,L.bind=_u,L.bindAll=lx,L.bindKey=pg,L.castArray=OS,L.chain=hg,L.chunk=IC,L.compact=RC,L.concat=BC,L.cond=ux,L.conforms=hx,L.constant=Ou,L.countBy=H1,L.create=rw,L.curry=mg,L.curryRight=vg,L.debounce=yg,L.defaults=sw,L.defaultsDeep=ow,L.defer=pS,L.delay=mS,L.difference=jC,L.differenceBy=WC,L.differenceWith=NC,L.drop=XC,L.dropRight=YC,L.dropRightWhile=zC,L.dropWhile=UC,L.fill=HC,L.filter=V1,L.flatMap=$1,L.flatMapDeep=Q1,L.flatMapDepth=Z1,L.flatten=og,L.flattenDeep=GC,L.flattenDepth=VC,L.flip=vS,L.flow=fx,L.flowRight=dx,L.fromPairs=qC,L.functions=dw,L.functionsIn=gw,L.groupBy=J1,L.initial=$C,L.intersection=QC,L.intersectionBy=ZC,L.intersectionWith=JC,L.invert=mw,L.invertBy=vw,L.invokeMap=eS,L.iteratee=Eu,L.keyBy=iS,L.keys=me,L.keysIn=Re,L.map=Go,L.mapKeys=_w,L.mapValues=Cw,L.matches=gx,L.matchesProperty=px,L.memoize=qo,L.merge=Sw,L.mergeWith=Pg,L.method=mx,L.methodOf=vx,L.mixin=Pu,L.negate=Ko,L.nthArg=_x,L.omit=ww,L.omitBy=xw,L.once=yS,L.orderBy=nS,L.over=Cx,L.overArgs=_S,L.overEvery=Sx,L.overSome=wx,L.partial=Cu,L.partialRight=_g,L.partition=rS,L.pick=Tw,L.pickBy=kg,L.property=Rg,L.propertyOf=xx,L.pull=n1,L.pullAll=lg,L.pullAllBy=r1,L.pullAllWith=s1,L.pullAt=o1,L.range=Tx,L.rangeRight=bx,L.rearg=CS,L.reject=aS,L.remove=a1,L.rest=SS,L.reverse=vu,L.sampleSize=uS,L.set=Ow,L.setWith=Ew,L.shuffle=hS,L.slice=l1,L.sortBy=dS,L.sortedUniq=p1,L.sortedUniqBy=m1,L.split=$w,L.spread=wS,L.tail=v1,L.take=y1,L.takeRight=_1,L.takeRightWhile=C1,L.takeWhile=S1,L.tap=R1,L.throttle=xS,L.thru=Ho,L.toArray=Tg,L.toPairs=Ag,L.toPairsIn=Dg,L.toPath=Ax,L.toPlainObject=Og,L.transform=Pw,L.unary=TS,L.union=w1,L.unionBy=x1,L.unionWith=T1,L.uniq=b1,L.uniqBy=O1,L.uniqWith=E1,L.unset=kw,L.unzip=yu,L.unzipWith=ug,L.update=Aw,L.updateWith=Dw,L.values=dr,L.valuesIn=Mw,L.without=P1,L.words=Lg,L.wrap=bS,L.xor=k1,L.xorBy=A1,L.xorWith=D1,L.zip=M1,L.zipObject=F1,L.zipObjectDeep=L1,L.zipWith=I1,L.entries=Ag,L.entriesIn=Dg,L.extend=Eg,L.extendWith=Zo,Pu(L,L),L.add=Mx,L.attempt=Ig,L.camelCase=Rw,L.capitalize=Mg,L.ceil=Fx,L.clamp=Fw,L.clone=ES,L.cloneDeep=kS,L.cloneDeepWith=AS,L.cloneWith=PS,L.conformsTo=DS,L.deburr=Fg,L.defaultTo=cx,L.divide=Lx,L.endsWith=Bw,L.eq=mi,L.escape=jw,L.escapeRegExp=Ww,L.every=G1,L.find=q1,L.findIndex=rg,L.findKey=aw,L.findLast=K1,L.findLastIndex=sg,L.findLastKey=lw,L.floor=Ix,L.forEach=cg,L.forEachRight=fg,L.forIn=uw,L.forInRight=hw,L.forOwn=cw,L.forOwnRight=fw,L.get=xu,L.gt=MS,L.gte=FS,L.has=pw,L.hasIn=Tu,L.head=ag,L.identity=Be,L.includes=tS,L.indexOf=KC,L.inRange=Lw,L.invoke=yw,L.isArguments=jn,L.isArray=Lt,L.isArrayBuffer=LS,L.isArrayLike=Ie,L.isArrayLikeObject=le,L.isBoolean=IS,L.isBuffer=on,L.isDate=RS,L.isElement=BS,L.isEmpty=jS,L.isEqual=WS,L.isEqualWith=NS,L.isError=Su,L.isFinite=XS,L.isFunction=Ni,L.isInteger=Cg,L.isLength=$o,L.isMap=Sg,L.isMatch=YS,L.isMatchWith=zS,L.isNaN=US,L.isNative=HS,L.isNil=VS,L.isNull=GS,L.isNumber=wg,L.isObject=ne,L.isObjectLike=re,L.isPlainObject=us,L.isRegExp=wu,L.isSafeInteger=qS,L.isSet=xg,L.isString=Qo,L.isSymbol=Ve,L.isTypedArray=fr,L.isUndefined=KS,L.isWeakMap=$S,L.isWeakSet=QS,L.join=t1,L.kebabCase=Nw,L.last=ri,L.lastIndexOf=e1,L.lowerCase=Xw,L.lowerFirst=Yw,L.lt=ZS,L.lte=JS,L.max=Rx,L.maxBy=Bx,L.mean=jx,L.meanBy=Wx,L.min=Nx,L.minBy=Xx,L.stubArray=Au,L.stubFalse=Du,L.stubObject=Ox,L.stubString=Ex,L.stubTrue=Px,L.multiply=Yx,L.nth=i1,L.noConflict=yx,L.noop=ku,L.now=Vo,L.pad=zw,L.padEnd=Uw,L.padStart=Hw,L.parseInt=Gw,L.random=Iw,L.reduce=sS,L.reduceRight=oS,L.repeat=Vw,L.replace=qw,L.result=bw,L.round=zx,L.runInContext=it,L.sample=lS,L.size=cS,L.snakeCase=Kw,L.some=fS,L.sortedIndex=u1,L.sortedIndexBy=h1,L.sortedIndexOf=c1,L.sortedLastIndex=f1,L.sortedLastIndexBy=d1,L.sortedLastIndexOf=g1,L.startCase=Qw,L.startsWith=Zw,L.subtract=Ux,L.sum=Hx,L.sumBy=Gx,L.template=Jw,L.times=kx,L.toFinite=Xi,L.toInteger=It,L.toLength=bg,L.toLower=tx,L.toNumber=si,L.toSafeInteger=tw,L.toString=Ut,L.toUpper=ex,L.trim=ix,L.trimEnd=nx,L.trimStart=rx,L.truncate=sx,L.unescape=ox,L.uniqueId=Dx,L.upperCase=ax,L.upperFirst=bu,L.each=cg,L.eachRight=fg,L.first=ag,Pu(L,function(){var c={};return wi(L,function(d,m){Gt.call(L.prototype,m)||(c[m]=d)}),c}(),{chain:!1}),L.VERSION=t,Je(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){L[c].placeholder=L}),Je(["drop","take"],function(c,d){Nt.prototype[c]=function(m){m=m===e?1:fe(It(m),0);var b=this.__filtered__&&!d?new Nt(this):this.clone();return b.__filtered__?b.__takeCount__=we(m,b.__takeCount__):b.__views__.push({size:we(m,M),type:c+(b.__dir__<0?"Right":"")}),b},Nt.prototype[c+"Right"]=function(m){return this.reverse()[c](m).reverse()}}),Je(["filter","map","takeWhile"],function(c,d){var m=d+1,b=m==w||m==A;Nt.prototype[c]=function(D){var B=this.clone();return B.__iteratees__.push({iteratee:Pt(D,3),type:m}),B.__filtered__=B.__filtered__||b,B}}),Je(["head","last"],function(c,d){var m="take"+(d?"Right":"");Nt.prototype[c]=function(){return this[m](1).value()[0]}}),Je(["initial","tail"],function(c,d){var m="drop"+(d?"":"Right");Nt.prototype[c]=function(){return this.__filtered__?new Nt(this):this[m](1)}}),Nt.prototype.compact=function(){return this.filter(Be)},Nt.prototype.find=function(c){return this.filter(c).head()},Nt.prototype.findLast=function(c){return this.reverse().find(c)},Nt.prototype.invokeMap=Bt(function(c,d){return typeof c=="function"?new Nt(this):this.map(function(m){return ns(m,c,d)})}),Nt.prototype.reject=function(c){return this.filter(Ko(Pt(c)))},Nt.prototype.slice=function(c,d){c=It(c);var m=this;return m.__filtered__&&(c>0||d<0)?new Nt(m):(c<0?m=m.takeRight(-c):c&&(m=m.drop(c)),d!==e&&(d=It(d),m=d<0?m.dropRight(-d):m.take(d-c)),m)},Nt.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},Nt.prototype.toArray=function(){return this.take(M)},wi(Nt.prototype,function(c,d){var m=/^(?:filter|find|map|reject)|While$/.test(d),b=/^(?:head|last)$/.test(d),D=L[b?"take"+(d=="last"?"Right":""):d],B=b||/^find/.test(d);D&&(L.prototype[d]=function(){var H=this.__wrapped__,J=b?[1]:arguments,nt=H instanceof Nt,gt=J[0],mt=nt||Lt(H),vt=function(jt){var Xt=D.apply(L,Qi([jt],J));return b&&wt?Xt[0]:Xt};mt&&m&&typeof gt=="function"&&gt.length!=1&&(nt=mt=!1);var wt=this.__chain__,Et=!!this.__actions__.length,kt=B&&!wt,Rt=nt&&!Et;if(!B&&mt){H=Rt?H:new Nt(this);var At=c.apply(H,J);return At.__actions__.push({func:Ho,args:[vt],thisArg:e}),new ei(At,wt)}return kt&&Rt?c.apply(this,J):(At=this.thru(vt),kt?b?At.value()[0]:At.value():At)})}),Je(["pop","push","shift","sort","splice","unshift"],function(c){var d=vo[c],m=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",b=/^(?:pop|shift)$/.test(c);L.prototype[c]=function(){var D=arguments;if(b&&!this.__chain__){var B=this.value();return d.apply(Lt(B)?B:[],D)}return this[m](function(H){return d.apply(Lt(H)?H:[],D)})}}),wi(Nt.prototype,function(c,d){var m=L[d];if(m){var b=m.name+"";Gt.call(ar,b)||(ar[b]=[]),ar[b].push({name:d,func:m})}}),ar[jo(e,y).name]=[{name:"wrapper",func:e}],Nt.prototype.clone=o_,Nt.prototype.reverse=a_,Nt.prototype.value=l_,L.prototype.at=B1,L.prototype.chain=j1,L.prototype.commit=W1,L.prototype.next=N1,L.prototype.plant=Y1,L.prototype.reverse=z1,L.prototype.toJSON=L.prototype.valueOf=L.prototype.value=U1,L.prototype.first=L.prototype.head,$r&&(L.prototype[$r]=X1),L},Ji=Wy();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(pe._=Ji,define(function(){return Ji})):An?((An.exports=Ji)._=Ji,El._=Ji):pe._=Ji}).call(Vr)});var l0=je(ht=>{var S=S||{version:"5.2.4"};typeof ht<"u"?ht.fabric=S:typeof define=="function"&&define.amd&&define([],function(){return S});typeof document<"u"&&typeof window<"u"?(document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?S.document=document:S.document=document.implementation.createHTMLDocument(""),S.window=window):(a0=Mu(),nf=new a0.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window,S.document=nf.document,S.jsdomImplForWrapper=Fu().implForWrapper,S.nodeCanvas=Lu().Canvas,S.window=nf,DOMParser=S.window.DOMParser);var a0,nf;S.isTouchSupported="ontouchstart"in S.window||"ontouchstart"in S.document||S.window&&S.window.navigator&&S.window.navigator.maxTouchPoints>0;S.isLikelyNode=typeof Buffer<"u"&&typeof window>"u";S.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];S.DPI=96;S.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)";S.commaWsp="(?:\\s+,?\\s*|,\\s*)";S.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig;S.reNonWord=/[ \n\.,;!\?\-]/;S.fontPaths={};S.iMatrix=[1,0,0,1,0,0];S.svgNS="http://www.w3.org/2000/svg";S.perfLimitSizeTotal=2097152;S.maxCacheSideLimit=4096;S.minCacheSideLimit=256;S.charWidthsCache={};S.textureSize=2048;S.disableStyleCopyPaste=!1;S.enableGLFiltering=!0;S.devicePixelRatio=S.window.devicePixelRatio||S.window.webkitDevicePixelRatio||S.window.mozDevicePixelRatio||1;S.browserShadowBlurConstant=1;S.arcToSegmentsCache={};S.boundsOfCurveCache={};S.cachesBoundsOfCurve=!0;S.forceGLPutImageData=!1;S.initFilterBackend=function(){if(S.enableGLFiltering&&S.isWebglSupported&&S.isWebglSupported(S.textureSize))return console.log("max texture size: "+S.maxTextureSize),new S.WebglFilterBackend({tileSize:S.textureSize});if(S.Canvas2dFilterBackend)return new S.Canvas2dFilterBackend};typeof document<"u"&&typeof window<"u"&&(window.fabric=S);(function(){function e(r,a){if(this.__eventListeners[r]){var u=this.__eventListeners[r];a?u[u.indexOf(a)]=!1:S.util.array.fill(u,!1)}}function t(r,a){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var u in r)this.on(u,r[u]);else this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(a);return this}function i(r,a){var u=function(){a.apply(this,arguments),this.off(r,u)}.bind(this);this.on(r,u)}function o(r,a){if(arguments.length===1)for(var u in r)i.call(this,u,r[u]);else i.call(this,r,a);return this}function n(r,a){if(!this.__eventListeners)return this;if(arguments.length===0)for(r in this.__eventListeners)e.call(this,r);else if(arguments.length===1&&typeof arguments[0]=="object")for(var u in r)e.call(this,u,r[u]);else e.call(this,r,a);return this}function s(r,a){if(!this.__eventListeners)return this;var u=this.__eventListeners[r];if(!u)return this;for(var l=0,h=u.length;l<h;l++)u[l]&&u[l].call(this,a||{});return this.__eventListeners[r]=u.filter(function(f){return f!==!1}),this}S.Observable={fire:s,on:t,once:o,off:n}})();S.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var e=0,t=arguments.length;e<t;e++)this._onObjectAdded(arguments[e]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(e,t,i){var o=this._objects;return i?o[t]=e:o.splice(t,0,e),this._onObjectAdded&&this._onObjectAdded(e),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var e=this._objects,t,i=!1,o=0,n=arguments.length;o<n;o++)t=e.indexOf(arguments[o]),t!==-1&&(i=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[o]));return this.renderOnAddRemove&&i&&this.requestRenderAll(),this},forEachObject:function(e,t){for(var i=this.getObjects(),o=0,n=i.length;o<n;o++)e.call(t,i[o],o,i);return this},getObjects:function(e){return typeof e>"u"?this._objects.concat():this._objects.filter(function(t){return t.type===e})},item:function(e){return this._objects[e]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(e,t){return this._objects.indexOf(e)>-1?!0:t?this._objects.some(function(i){return typeof i.contains=="function"&&i.contains(e,!0)}):!1},complexity:function(){return this._objects.reduce(function(e,t){return e+=t.complexity?t.complexity():0,e},0)}};S.CommonMethods={_setOptions:function(e){for(var t in e)this.set(t,e[t])},_initGradient:function(e,t){e&&e.colorStops&&!(e instanceof S.Gradient)&&this.set(t,new S.Gradient(e))},_initPattern:function(e,t,i){e&&e.source&&!(e instanceof S.Pattern)?this.set(t,new S.Pattern(e,i)):i&&i()},_setObject:function(e){for(var t in e)this._set(t,e[t])},set:function(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this},_set:function(e,t){this[e]=t},toggle:function(e){var t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this},get:function(e){return this[e]}};(function(e){var t=Math.sqrt,i=Math.atan2,o=Math.pow,n=Math.PI/180,s=Math.PI/2;S.util={cos:function(r){if(r===0)return 1;r<0&&(r=-r);var a=r/s;switch(a){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},sin:function(r){if(r===0)return 0;var a=r/s,u=1;switch(r<0&&(u=-1),a){case 1:return u;case 2:return 0;case 3:return-u}return Math.sin(r)},removeFromArray:function(r,a){var u=r.indexOf(a);return u!==-1&&r.splice(u,1),r},getRandomInt:function(r,a){return Math.floor(Math.random()*(a-r+1))+r},degreesToRadians:function(r){return r*n},radiansToDegrees:function(r){return r/n},rotatePoint:function(r,a,u){var l=new S.Point(r.x-a.x,r.y-a.y),h=S.util.rotateVector(l,u);return new S.Point(h.x,h.y).addEquals(a)},rotateVector:function(r,a){var u=S.util.sin(a),l=S.util.cos(a),h=r.x*l-r.y*u,f=r.x*u+r.y*l;return{x:h,y:f}},createVector:function(r,a){return new S.Point(a.x-r.x,a.y-r.y)},calcAngleBetweenVectors:function(r,a){return Math.acos((r.x*a.x+r.y*a.y)/(Math.hypot(r.x,r.y)*Math.hypot(a.x,a.y)))},getHatVector:function(r){return new S.Point(r.x,r.y).multiply(1/Math.hypot(r.x,r.y))},getBisector:function(r,a,u){var l=S.util.createVector(r,a),h=S.util.createVector(r,u),f=S.util.calcAngleBetweenVectors(l,h),g=S.util.calcAngleBetweenVectors(S.util.rotateVector(l,f),h),p=f*(g===0?1:-1)/2;return{vector:S.util.getHatVector(S.util.rotateVector(l,p)),angle:f}},projectStrokeOnPoints:function(r,a,u){var l=[],h=a.strokeWidth/2,f=a.strokeUniform?new S.Point(1/a.scaleX,1/a.scaleY):new S.Point(1,1),g=function(p){var v=h/Math.hypot(p.x,p.y);return new S.Point(p.x*v*f.x,p.y*v*f.y)};return r.length<=1||r.forEach(function(p,v){var y=new S.Point(p.x,p.y),_,T;v===0?(T=r[v+1],_=u?g(S.util.createVector(T,y)).addEquals(y):r[r.length-1]):v===r.length-1?(_=r[v-1],T=u?g(S.util.createVector(_,y)).addEquals(y):r[0]):(_=r[v-1],T=r[v+1]);var P=S.util.getBisector(y,_,T),F=P.vector,j=P.angle,Z,Q;if(a.strokeLineJoin==="miter"&&(Z=-h/Math.sin(j/2),Q=new S.Point(F.x*Z*f.x,F.y*Z*f.y),Math.hypot(Q.x,Q.y)/h<=a.strokeMiterLimit)){l.push(y.add(Q)),l.push(y.subtract(Q));return}Z=-h*Math.SQRT2,Q=new S.Point(F.x*Z*f.x,F.y*Z*f.y),l.push(y.add(Q)),l.push(y.subtract(Q))}),l},transformPoint:function(r,a,u){return u?new S.Point(a[0]*r.x+a[2]*r.y,a[1]*r.x+a[3]*r.y):new S.Point(a[0]*r.x+a[2]*r.y+a[4],a[1]*r.x+a[3]*r.y+a[5])},makeBoundingBoxFromPoints:function(r,a){if(a)for(var u=0;u<r.length;u++)r[u]=S.util.transformPoint(r[u],a);var l=[r[0].x,r[1].x,r[2].x,r[3].x],h=S.util.array.min(l),f=S.util.array.max(l),g=f-h,p=[r[0].y,r[1].y,r[2].y,r[3].y],v=S.util.array.min(p),y=S.util.array.max(p),_=y-v;return{left:h,top:v,width:g,height:_}},invertTransform:function(r){var a=1/(r[0]*r[3]-r[1]*r[2]),u=[a*r[3],-a*r[1],-a*r[2],a*r[0]],l=S.util.transformPoint({x:r[4],y:r[5]},u,!0);return u[4]=-l.x,u[5]=-l.y,u},toFixed:function(r,a){return parseFloat(Number(r).toFixed(a))},parseUnit:function(r,a){var u=/\D{0,2}$/.exec(r),l=parseFloat(r);switch(a||(a=S.Text.DEFAULT_SVG_FONT_SIZE),u[0]){case"mm":return l*S.DPI/25.4;case"cm":return l*S.DPI/2.54;case"in":return l*S.DPI;case"pt":return l*S.DPI/72;case"pc":return l*S.DPI/72*12;case"em":return l*a;default:return l}},falseFunction:function(){return!1},getKlass:function(r,a){return r=S.util.string.camelize(r.charAt(0).toUpperCase()+r.slice(1)),S.util.resolveNamespace(a)[r]},getSvgAttributes:function(r){var a=["instantiated_by_use","style","id","class"];switch(r){case"linearGradient":a=a.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":a=a.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":a=a.concat(["offset","stop-color","stop-opacity"]);break}return a},resolveNamespace:function(r){if(!r)return S;var a=r.split("."),u=a.length,l,h=e||S.window;for(l=0;l<u;++l)h=h[a[l]];return h},loadImage:function(r,a,u,l){if(!r){a&&a.call(u,r);return}var h=S.util.createImage(),f=function(){a&&a.call(u,h,!1),h=h.onload=h.onerror=null};h.onload=f,h.onerror=function(){S.log("Error loading "+h.src),a&&a.call(u,null,!0),h=h.onload=h.onerror=null},r.indexOf("data")!==0&&l!==void 0&&l!==null&&(h.crossOrigin=l),r.substring(0,14)==="data:image/svg"&&(h.onload=null,S.util.loadImageInDom(h,f)),h.src=r},loadImageInDom:function(r,a){var u=S.document.createElement("div");u.style.width=u.style.height="1px",u.style.left=u.style.top="-100%",u.style.position="absolute",u.appendChild(r),S.document.querySelector("body").appendChild(u),r.onload=function(){a(),u.parentNode.removeChild(u),u=null}},enlivenObjects:function(r,a,u,l){r=r||[];var h=[],f=0,g=r.length;function p(){++f===g&&a&&a(h.filter(function(v){return v}))}if(!g){a&&a(h);return}r.forEach(function(v,y){if(!v||!v.type){p();return}var _=S.util.getKlass(v.type,u);_.fromObject(v,function(T,P){P||(h[y]=T),l&&l(v,T,P),p()})})},enlivenObjectEnlivables:function(r,a,u){var l=S.Object.ENLIVEN_PROPS.filter(function(h){return!!r[h]});S.util.enlivenObjects(l.map(function(h){return r[h]}),function(h){var f={};l.forEach(function(g,p){f[g]=h[p],a&&(a[g]=h[p])}),u&&u(f)})},enlivenPatterns:function(r,a){r=r||[];function u(){++h===f&&a&&a(l)}var l=[],h=0,f=r.length;if(!f){a&&a(l);return}r.forEach(function(g,p){g&&g.source?new S.Pattern(g,function(v){l[p]=v,u()}):(l[p]=g,u())})},groupSVGElements:function(r,a,u){var l;return r&&r.length===1?(typeof u<"u"&&(r[0].sourcePath=u),r[0]):(a&&(a.width&&a.height?a.centerPoint={x:a.width/2,y:a.height/2}:(delete a.width,delete a.height)),l=new S.Group(r,a),typeof u<"u"&&(l.sourcePath=u),l)},populateWithProperties:function(r,a,u){if(u&&Array.isArray(u))for(var l=0,h=u.length;l<h;l++)u[l]in r&&(a[u[l]]=r[u[l]])},createCanvasElement:function(){return S.document.createElement("canvas")},copyCanvasElement:function(r){var a=S.util.createCanvasElement();return a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),a},toDataURL:function(r,a,u){return r.toDataURL("image/"+a,u)},createImage:function(){return S.document.createElement("img")},multiplyTransformMatrices:function(r,a,u){return[r[0]*a[0]+r[2]*a[1],r[1]*a[0]+r[3]*a[1],r[0]*a[2]+r[2]*a[3],r[1]*a[2]+r[3]*a[3],u?0:r[0]*a[4]+r[2]*a[5]+r[4],u?0:r[1]*a[4]+r[3]*a[5]+r[5]]},qrDecompose:function(r){var a=i(r[1],r[0]),u=o(r[0],2)+o(r[1],2),l=t(u),h=(r[0]*r[3]-r[2]*r[1])/l,f=i(r[0]*r[2]+r[1]*r[3],u);return{angle:a/n,scaleX:l,scaleY:h,skewX:f/n,skewY:0,translateX:r[4],translateY:r[5]}},calcRotateMatrix:function(r){if(!r.angle)return S.iMatrix.concat();var a=S.util.degreesToRadians(r.angle),u=S.util.cos(a),l=S.util.sin(a);return[u,l,-l,u,0,0]},calcDimensionsMatrix:function(r){var a=typeof r.scaleX>"u"?1:r.scaleX,u=typeof r.scaleY>"u"?1:r.scaleY,l=[r.flipX?-a:a,0,0,r.flipY?-u:u,0,0],h=S.util.multiplyTransformMatrices,f=S.util.degreesToRadians;return r.skewX&&(l=h(l,[1,0,Math.tan(f(r.skewX)),1],!0)),r.skewY&&(l=h(l,[1,Math.tan(f(r.skewY)),0,1],!0)),l},composeMatrix:function(r){var a=[1,0,0,1,r.translateX||0,r.translateY||0],u=S.util.multiplyTransformMatrices;return r.angle&&(a=u(a,S.util.calcRotateMatrix(r))),(r.scaleX!==1||r.scaleY!==1||r.skewX||r.skewY||r.flipX||r.flipY)&&(a=u(a,S.util.calcDimensionsMatrix(r))),a},resetObjectTransform:function(r){r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},saveObjectTransform:function(r){return{scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}},isTransparent:function(r,a,u,l){l>0&&(a>l?a-=l:a=0,u>l?u-=l:u=0);var h=!0,f,g,p=r.getImageData(a,u,l*2||1,l*2||1),v=p.data.length;for(f=3;f<v&&(g=p.data[f],h=g<=0,h!==!1);f+=4);return p=null,h},parsePreserveAspectRatioAttribute:function(r){var a="meet",u="Mid",l="Mid",h=r.split(" "),f;return h&&h.length&&(a=h.pop(),a!=="meet"&&a!=="slice"?(f=a,a="meet"):h.length&&(f=h.pop())),u=f!=="none"?f.slice(1,4):"none",l=f!=="none"?f.slice(5,8):"none",{meetOrSlice:a,alignX:u,alignY:l}},clearFabricFontCache:function(r){r=(r||"").toLowerCase(),r?S.charWidthsCache[r]&&delete S.charWidthsCache[r]:S.charWidthsCache={}},limitDimsByArea:function(r,a){var u=Math.sqrt(a*r),l=Math.floor(a/u);return{x:Math.floor(u),y:l}},capValue:function(r,a,u){return Math.max(r,Math.min(a,u))},findScaleToFit:function(r,a){return Math.min(a.width/r.width,a.height/r.height)},findScaleToCover:function(r,a){return Math.max(a.width/r.width,a.height/r.height)},matrixToSVG:function(r){return"matrix("+r.map(function(a){return S.util.toFixed(a,S.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(r,a){var u=S.util.invertTransform(a),l=S.util.multiplyTransformMatrices(u,r.calcOwnMatrix());S.util.applyTransformToObject(r,l)},addTransformToObject:function(r,a){S.util.applyTransformToObject(r,S.util.multiplyTransformMatrices(a,r.calcOwnMatrix()))},applyTransformToObject:function(r,a){var u=S.util.qrDecompose(a),l=new S.Point(u.translateX,u.translateY);r.flipX=!1,r.flipY=!1,r.set("scaleX",u.scaleX),r.set("scaleY",u.scaleY),r.skewX=u.skewX,r.skewY=u.skewY,r.angle=u.angle,r.setPositionByOrigin(l,"center","center")},sizeAfterTransform:function(r,a,u){var l=r/2,h=a/2,f=[{x:-l,y:-h},{x:l,y:-h},{x:-l,y:h},{x:l,y:h}],g=S.util.calcDimensionsMatrix(u),p=S.util.makeBoundingBoxFromPoints(f,g);return{x:p.width,y:p.height}},mergeClipPaths:function(r,a){var u=r,l=a;u.inverted&&!l.inverted&&(u=a,l=r),S.util.applyTransformToObject(l,S.util.multiplyTransformMatrices(S.util.invertTransform(u.calcTransformMatrix()),l.calcTransformMatrix()));var h=u.inverted&&l.inverted;return h&&(u.inverted=l.inverted=!1),new S.Group([u],{clipPath:l,inverted:h})},hasStyleChanged:function(r,a,u){return u=u||!1,r.fill!==a.fill||r.stroke!==a.stroke||r.strokeWidth!==a.strokeWidth||r.fontSize!==a.fontSize||r.fontFamily!==a.fontFamily||r.fontWeight!==a.fontWeight||r.fontStyle!==a.fontStyle||r.deltaY!==a.deltaY||u&&(r.overline!==a.overline||r.underline!==a.underline||r.linethrough!==a.linethrough)},stylesToArray:function(u,a){for(var u=S.util.object.clone(u,!0),l=a.split(`
`),h=-1,f={},g=[],p=0;p<l.length;p++){if(!u[p]){h+=l[p].length;continue}for(var v=0;v<l[p].length;v++){h++;var y=u[p][v];if(y){var _=S.util.hasStyleChanged(f,y,!0);_?g.push({start:h,end:h+1,style:y}):g[g.length-1].end++}f=y||{}}}return g},stylesFromArray:function(r,a){if(!Array.isArray(r))return r;for(var u=a.split(`
`),l=-1,h=0,f={},g=0;g<u.length;g++)for(var p=0;p<u[g].length;p++)l++,r[h]&&r[h].start<=l&&l<r[h].end&&(f[g]=f[g]||{},f[g][p]=Object.assign({},r[h].style),l===r[h].end-1&&h++);return f}}})(ht);(function(){var e=Array.prototype.join,t={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},i={m:"l",M:"L"};function o(w,k,A,E,W,O,x,M,R,z,N){var q=S.util.cos(w),et=S.util.sin(w),ot=S.util.cos(k),X=S.util.sin(k),I=A*W*ot-E*O*X+x,G=E*W*ot+A*O*X+M,V=z+R*(-A*W*et-E*O*q),Y=N+R*(-E*W*et+A*O*q),K=I+R*(A*W*X+E*O*ot),st=G+R*(E*W*X-A*O*ot);return["C",V,Y,K,st,I,G]}function n(w,k,A,E,W,O,x){var M=Math.PI,R=x*M/180,z=S.util.sin(R),N=S.util.cos(R),q=0,et=0;A=Math.abs(A),E=Math.abs(E);var ot=-N*w*.5-z*k*.5,X=-N*k*.5+z*w*.5,I=A*A,G=E*E,V=X*X,Y=ot*ot,K=I*G-I*V-G*Y,st=0;if(K<0){var yt=Math.sqrt(1-K/(I*G));A*=yt,E*=yt}else st=(W===O?-1:1)*Math.sqrt(K/(I*V+G*Y));var dt=st*A*X/E,U=-st*E*ot/A,pt=N*dt-z*U+w*.5,_t=z*dt+N*U+k*.5,St=s(1,0,(ot-dt)/A,(X-U)/E),Ot=s((ot-dt)/A,(X-U)/E,(-ot-dt)/A,(-X-U)/E);O===0&&Ot>0?Ot-=2*M:O===1&&Ot<0&&(Ot+=2*M);for(var Tt=Math.ceil(Math.abs(Ot/M*2)),Wt=[],Ft=Ot/Tt,ae=8/3*Math.sin(Ft/4)*Math.sin(Ft/4)/Math.sin(Ft/2),ze=St+Ft,qt=0;qt<Tt;qt++)Wt[qt]=o(St,ze,N,z,A,E,pt,_t,ae,q,et),q=Wt[qt][5],et=Wt[qt][6],St=ze,ze+=Ft;return Wt}function s(w,k,A,E){var W=Math.atan2(k,w),O=Math.atan2(E,A);return O>=W?O-W:2*Math.PI-(W-O)}function r(w,k,A,E,W,O,x,M){var R;if(S.cachesBoundsOfCurve&&(R=e.call(arguments),S.boundsOfCurveCache[R]))return S.boundsOfCurveCache[R];var z=Math.sqrt,N=Math.min,q=Math.max,et=Math.abs,ot=[],X=[[],[]],I,G,V,Y,K,st,yt,dt;G=6*w-12*A+6*W,I=-3*w+9*A-9*W+3*x,V=3*A-3*w;for(var U=0;U<2;++U){if(U>0&&(G=6*k-12*E+6*O,I=-3*k+9*E-9*O+3*M,V=3*E-3*k),et(I)<1e-12){if(et(G)<1e-12)continue;Y=-V/G,0<Y&&Y<1&&ot.push(Y);continue}yt=G*G-4*V*I,!(yt<0)&&(dt=z(yt),K=(-G+dt)/(2*I),0<K&&K<1&&ot.push(K),st=(-G-dt)/(2*I),0<st&&st<1&&ot.push(st))}for(var pt,_t,St=ot.length,Ot=St,Tt;St--;)Y=ot[St],Tt=1-Y,pt=Tt*Tt*Tt*w+3*Tt*Tt*Y*A+3*Tt*Y*Y*W+Y*Y*Y*x,X[0][St]=pt,_t=Tt*Tt*Tt*k+3*Tt*Tt*Y*E+3*Tt*Y*Y*O+Y*Y*Y*M,X[1][St]=_t;X[0][Ot]=w,X[1][Ot]=k,X[0][Ot+1]=x,X[1][Ot+1]=M;var Wt=[{x:N.apply(null,X[0]),y:N.apply(null,X[1])},{x:q.apply(null,X[0]),y:q.apply(null,X[1])}];return S.cachesBoundsOfCurve&&(S.boundsOfCurveCache[R]=Wt),Wt}function a(w,k,A){for(var E=A[1],W=A[2],O=A[3],x=A[4],M=A[5],R=A[6],z=A[7],N=n(R-w,z-k,E,W,x,M,O),q=0,et=N.length;q<et;q++)N[q][1]+=w,N[q][2]+=k,N[q][3]+=w,N[q][4]+=k,N[q][5]+=w,N[q][6]+=k;return N}function u(w){var k=0,A=0,E=w.length,W=0,O=0,x,M,R,z=[],N,q,et;for(M=0;M<E;++M){switch(R=!1,x=w[M].slice(0),x[0]){case"l":x[0]="L",x[1]+=k,x[2]+=A;case"L":k=x[1],A=x[2];break;case"h":x[1]+=k;case"H":x[0]="L",x[2]=A,k=x[1];break;case"v":x[1]+=A;case"V":x[0]="L",A=x[1],x[1]=k,x[2]=A;break;case"m":x[0]="M",x[1]+=k,x[2]+=A;case"M":k=x[1],A=x[2],W=x[1],O=x[2];break;case"c":x[0]="C",x[1]+=k,x[2]+=A,x[3]+=k,x[4]+=A,x[5]+=k,x[6]+=A;case"C":q=x[3],et=x[4],k=x[5],A=x[6];break;case"s":x[0]="S",x[1]+=k,x[2]+=A,x[3]+=k,x[4]+=A;case"S":N==="C"?(q=2*k-q,et=2*A-et):(q=k,et=A),k=x[3],A=x[4],x[0]="C",x[5]=x[3],x[6]=x[4],x[3]=x[1],x[4]=x[2],x[1]=q,x[2]=et,q=x[3],et=x[4];break;case"q":x[0]="Q",x[1]+=k,x[2]+=A,x[3]+=k,x[4]+=A;case"Q":q=x[1],et=x[2],k=x[3],A=x[4];break;case"t":x[0]="T",x[1]+=k,x[2]+=A;case"T":N==="Q"?(q=2*k-q,et=2*A-et):(q=k,et=A),x[0]="Q",k=x[1],A=x[2],x[1]=q,x[2]=et,x[3]=k,x[4]=A;break;case"a":x[0]="A",x[6]+=k,x[7]+=A;case"A":R=!0,z=z.concat(a(k,A,x)),k=x[6],A=x[7];break;case"z":case"Z":k=W,A=O;break;default:}R||z.push(x),N=x[0]}return z}function l(w,k,A,E){return Math.sqrt((A-w)*(A-w)+(E-k)*(E-k))}function h(w){return w*w*w}function f(w){return 3*w*w*(1-w)}function g(w){return 3*w*(1-w)*(1-w)}function p(w){return(1-w)*(1-w)*(1-w)}function v(w,k,A,E,W,O,x,M){return function(R){var z=h(R),N=f(R),q=g(R),et=p(R);return{x:x*z+W*N+A*q+w*et,y:M*z+O*N+E*q+k*et}}}function y(w,k,A,E,W,O,x,M){return function(R){var z=1-R,N=3*z*z*(A-w)+6*z*R*(W-A)+3*R*R*(x-W),q=3*z*z*(E-k)+6*z*R*(O-E)+3*R*R*(M-O);return Math.atan2(q,N)}}function _(w){return w*w}function T(w){return 2*w*(1-w)}function P(w){return(1-w)*(1-w)}function F(w,k,A,E,W,O){return function(x){var M=_(x),R=T(x),z=P(x);return{x:W*M+A*R+w*z,y:O*M+E*R+k*z}}}function j(w,k,A,E,W,O){return function(x){var M=1-x,R=2*M*(A-w)+2*x*(W-A),z=2*M*(E-k)+2*x*(O-E);return Math.atan2(z,R)}}function Z(w,k,A){var E={x:k,y:A},W,O=0,x;for(x=1;x<=100;x+=1)W=w(x/100),O+=l(E.x,E.y,W.x,W.y),E=W;return O}function Q(w,k){for(var A=0,E=0,W=w.iterator,O={x:w.x,y:w.y},x,M,R=.01,z=w.angleFinder,N;E<k&&R>1e-4;)x=W(A),N=A,M=l(O.x,O.y,x.x,x.y),M+E>k?(A-=R,R/=2):(O=x,A+=R,E+=M);return x.angle=z(N),x}function $(w){for(var k=0,A=w.length,E,W=0,O=0,x=0,M=0,R=[],z,N,q,et=0;et<A;et++){switch(E=w[et],N={x:W,y:O,command:E[0]},E[0]){case"M":N.length=0,x=W=E[1],M=O=E[2];break;case"L":N.length=l(W,O,E[1],E[2]),W=E[1],O=E[2];break;case"C":z=v(W,O,E[1],E[2],E[3],E[4],E[5],E[6]),q=y(W,O,E[1],E[2],E[3],E[4],E[5],E[6]),N.iterator=z,N.angleFinder=q,N.length=Z(z,W,O),W=E[5],O=E[6];break;case"Q":z=F(W,O,E[1],E[2],E[3],E[4]),q=j(W,O,E[1],E[2],E[3],E[4]),N.iterator=z,N.angleFinder=q,N.length=Z(z,W,O),W=E[3],O=E[4];break;case"Z":case"z":N.destX=x,N.destY=M,N.length=l(W,O,x,M),W=x,O=M;break}k+=N.length,R.push(N)}return R.push({length:k,x:W,y:O}),R}function tt(w,k,A){A||(A=$(w));for(var E=0;k-A[E].length>0&&E<A.length-2;)k-=A[E].length,E++;var W=A[E],O=k/W.length,x=W.command,M=w[E],R;switch(x){case"M":return{x:W.x,y:W.y,angle:0};case"Z":case"z":return R=new S.Point(W.x,W.y).lerp(new S.Point(W.destX,W.destY),O),R.angle=Math.atan2(W.destY-W.y,W.destX-W.x),R;case"L":return R=new S.Point(W.x,W.y).lerp(new S.Point(M[1],M[2]),O),R.angle=Math.atan2(M[2]-W.y,M[1]-W.x),R;case"C":return Q(W,k);case"Q":return Q(W,k)}}function rt(w){var k=[],A=[],E,W,O=S.rePathCommand,x="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",M="("+x+")"+S.commaWsp,R="([01])"+S.commaWsp+"?",z=M+"?"+M+"?"+M+R+R+M+"?("+x+")",N=new RegExp(z,"g"),q,et,ot;if(!w||!w.match)return k;ot=w.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var X=0,I,G=ot.length;X<G;X++){E=ot[X],et=E.slice(1).trim(),A.length=0;var V=E.charAt(0);if(I=[V],V.toLowerCase()==="a")for(var Y;Y=N.exec(et);)for(var K=1;K<Y.length;K++)A.push(Y[K]);else for(;q=O.exec(et);)A.push(q[0]);for(var K=0,st=A.length;K<st;K++)W=parseFloat(A[K]),isNaN(W)||I.push(W);var yt=t[V.toLowerCase()],dt=i[V]||V;if(I.length-1>yt)for(var U=1,pt=I.length;U<pt;U+=yt)k.push([V].concat(I.slice(U,U+yt))),V=dt;else k.push(I)}return k}function ct(w,k){var A=[],E,W=new S.Point(w[0].x,w[0].y),O=new S.Point(w[1].x,w[1].y),x=w.length,M=1,R=0,z=x>2;for(k=k||0,z&&(M=w[2].x<O.x?-1:w[2].x===O.x?0:1,R=w[2].y<O.y?-1:w[2].y===O.y?0:1),A.push(["M",W.x-M*k,W.y-R*k]),E=1;E<x;E++){if(!W.eq(O)){var N=W.midPointFrom(O);A.push(["Q",W.x,W.y,N.x,N.y])}W=w[E],E+1<w.length&&(O=w[E+1])}return z&&(M=W.x>w[E-2].x?1:W.x===w[E-2].x?0:-1,R=W.y>w[E-2].y?1:W.y===w[E-2].y?0:-1),A.push(["L",W.x+M*k,W.y+R*k]),A}function lt(w,k,A){return A&&(k=S.util.multiplyTransformMatrices(k,[1,0,0,1,-A.x,-A.y])),w.map(function(E){for(var W=E.slice(0),O={},x=1;x<E.length-1;x+=2)O.x=E[x],O.y=E[x+1],O=S.util.transformPoint(O,k),W[x]=O.x,W[x+1]=O.y;return W})}S.util.joinPath=function(w){return w.map(function(k){return k.join(" ")}).join(" ")},S.util.parsePath=rt,S.util.makePathSimpler=u,S.util.getSmoothPathFromPoints=ct,S.util.getPathSegmentsInfo=$,S.util.getBoundsOfCurve=r,S.util.getPointOnPath=tt,S.util.transformPath=lt})();(function(){var e=Array.prototype.slice;function t(r,a){for(var u=e.call(arguments,2),l=[],h=0,f=r.length;h<f;h++)l[h]=u.length?r[h][a].apply(r[h],u):r[h][a].call(r[h]);return l}function i(r,a){return s(r,a,function(u,l){return u>=l})}function o(r,a){return s(r,a,function(u,l){return u<l})}function n(r,a){for(var u=r.length;u--;)r[u]=a;return r}function s(r,a,u){if(!(!r||r.length===0)){var l=r.length-1,h=a?r[l][a]:r[l];if(a)for(;l--;)u(r[l][a],h)&&(h=r[l][a]);else for(;l--;)u(r[l],h)&&(h=r[l]);return h}}S.util.array={fill:n,invoke:t,min:o,max:i}})();(function(){function e(i,o,n){if(n)if(!S.isLikelyNode&&o instanceof Element)i=o;else if(o instanceof Array){i=[];for(var s=0,r=o.length;s<r;s++)i[s]=e({},o[s],n)}else if(o&&typeof o=="object")for(var a in o)a==="canvas"||a==="group"?i[a]=null:o.hasOwnProperty(a)&&(i[a]=e({},o[a],n));else i=o;else for(var a in o)i[a]=o[a];return i}function t(i,o){return e({},i,o)}S.util.object={extend:e,clone:t},S.util.object.extend(S.util,S.Observable)})();(function(){function e(s){return s.replace(/-+(.)?/g,function(r,a){return a?a.toUpperCase():""})}function t(s,r){return s.charAt(0).toUpperCase()+(r?s.slice(1):s.slice(1).toLowerCase())}function i(s){return s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function o(s){var r=0,a,u=[];for(r=0,a;r<s.length;r++)(a=n(s,r))!==!1&&u.push(a);return u}function n(s,r){var a=s.charCodeAt(r);if(isNaN(a))return"";if(a<55296||a>57343)return s.charAt(r);if(55296<=a&&a<=56319){if(s.length<=r+1)throw"High surrogate without following low surrogate";var u=s.charCodeAt(r+1);if(56320>u||u>57343)throw"High surrogate without following low surrogate";return s.charAt(r)+s.charAt(r+1)}if(r===0)throw"Low surrogate without preceding high surrogate";var l=s.charCodeAt(r-1);if(55296>l||l>56319)throw"Low surrogate without preceding high surrogate";return!1}S.util.string={camelize:e,capitalize:t,escapeXml:i,graphemeSplit:o}})();(function(){var e=Array.prototype.slice,t=function(){},i=function(){for(var a in{toString:1})if(a==="toString")return!1;return!0}(),o=function(a,u,l){for(var h in u)h in a.prototype&&typeof a.prototype[h]=="function"&&(u[h]+"").indexOf("callSuper")>-1?a.prototype[h]=function(f){return function(){var g=this.constructor.superclass;this.constructor.superclass=l;var p=u[f].apply(this,arguments);if(this.constructor.superclass=g,f!=="initialize")return p}}(h):a.prototype[h]=u[h],i&&(u.toString!==Object.prototype.toString&&(a.prototype.toString=u.toString),u.valueOf!==Object.prototype.valueOf&&(a.prototype.valueOf=u.valueOf))};function n(){}function s(a){for(var u=null,l=this;l.constructor.superclass;){var h=l.constructor.superclass.prototype[a];if(l[a]!==h){u=h;break}l=l.constructor.superclass.prototype}return u?arguments.length>1?u.apply(this,e.call(arguments,1)):u.call(this):console.log("tried to callSuper "+a+", method not found in prototype chain",this)}function r(){var a=null,u=e.call(arguments,0);typeof u[0]=="function"&&(a=u.shift());function l(){this.initialize.apply(this,arguments)}l.superclass=a,l.subclasses=[],a&&(n.prototype=a.prototype,l.prototype=new n,a.subclasses.push(l));for(var h=0,f=u.length;h<f;h++)o(l,u[h],a);return l.prototype.initialize||(l.prototype.initialize=t),l.prototype.constructor=l,l.prototype.callSuper=s,l}S.util.createClass=r})();(function(){var e=!!S.document.createElement("div").attachEvent,t=["touchstart","touchmove","touchend"];S.util.addListener=function(o,n,s,r){o&&o.addEventListener(n,s,e?!1:r)},S.util.removeListener=function(o,n,s,r){o&&o.removeEventListener(n,s,e?!1:r)};function i(o){var n=o.changedTouches;return n&&n[0]?n[0]:o}S.util.getPointer=function(o){var n=o.target,s=S.util.getScrollLeftTop(n),r=i(o);return{x:r.clientX+s.left,y:r.clientY+s.top}},S.util.isTouchEvent=function(o){return t.indexOf(o.type)>-1||o.pointerType==="touch"}})();(function(){function e(r,a){var u=r.style;if(!u)return r;if(typeof a=="string")return r.style.cssText+=";"+a,a.indexOf("opacity")>-1?s(r,a.match(/opacity:\s*(\d?\.?\d*)/)[1]):r;for(var l in a)if(l==="opacity")s(r,a[l]);else{var h=l==="float"||l==="cssFloat"?typeof u.styleFloat>"u"?"cssFloat":"styleFloat":l;u.setProperty(h,a[l])}return r}var t=S.document.createElement("div"),i=typeof t.style.opacity=="string",o=typeof t.style.filter=="string",n=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,s=function(r){return r};i?s=function(r,a){return r.style.opacity=a,r}:o&&(s=function(r,a){var u=r.style;return r.currentStyle&&!r.currentStyle.hasLayout&&(u.zoom=1),n.test(u.filter)?(a=a>=.9999?"":"alpha(opacity="+a*100+")",u.filter=u.filter.replace(n,a)):u.filter+=" alpha(opacity="+a*100+")",r}),S.util.setStyle=e})();(function(){var e=Array.prototype.slice;function t(p){return typeof p=="string"?S.document.getElementById(p):p}var i,o=function(p){return e.call(p,0)};try{i=o(S.document.childNodes)instanceof Array}catch{}i||(o=function(p){for(var v=new Array(p.length),y=p.length;y--;)v[y]=p[y];return v});function n(p,v){var y=S.document.createElement(p);for(var _ in v)_==="class"?y.className=v[_]:_==="for"?y.htmlFor=v[_]:y.setAttribute(_,v[_]);return y}function s(p,v){p&&(" "+p.className+" ").indexOf(" "+v+" ")===-1&&(p.className+=(p.className?" ":"")+v)}function r(p,v,y){return typeof v=="string"&&(v=n(v,y)),p.parentNode&&p.parentNode.replaceChild(v,p),v.appendChild(p),v}function a(p){for(var v=0,y=0,_=S.document.documentElement,T=S.document.body||{scrollLeft:0,scrollTop:0};p&&(p.parentNode||p.host)&&(p=p.parentNode||p.host,p===S.document?(v=T.scrollLeft||_.scrollLeft||0,y=T.scrollTop||_.scrollTop||0):(v+=p.scrollLeft||0,y+=p.scrollTop||0),!(p.nodeType===1&&p.style.position==="fixed")););return{left:v,top:y}}function u(p){var v,y=p&&p.ownerDocument,_={left:0,top:0},T={left:0,top:0},P,F={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!y)return T;for(var j in F)T[F[j]]+=parseInt(l(p,j),10)||0;return v=y.documentElement,typeof p.getBoundingClientRect<"u"&&(_=p.getBoundingClientRect()),P=a(p),{left:_.left+P.left-(v.clientLeft||0)+T.left,top:_.top+P.top-(v.clientTop||0)+T.top}}var l;S.document.defaultView&&S.document.defaultView.getComputedStyle?l=function(p,v){var y=S.document.defaultView.getComputedStyle(p,null);return y?y[v]:void 0}:l=function(p,v){var y=p.style[v];return!y&&p.currentStyle&&(y=p.currentStyle[v]),y},function(){var p=S.document.documentElement.style,v="userSelect"in p?"userSelect":"MozUserSelect"in p?"MozUserSelect":"WebkitUserSelect"in p?"WebkitUserSelect":"KhtmlUserSelect"in p?"KhtmlUserSelect":"";function y(T){return typeof T.onselectstart<"u"&&(T.onselectstart=S.util.falseFunction),v?T.style[v]="none":typeof T.unselectable=="string"&&(T.unselectable="on"),T}function _(T){return typeof T.onselectstart<"u"&&(T.onselectstart=null),v?T.style[v]="":typeof T.unselectable=="string"&&(T.unselectable=""),T}S.util.makeElementUnselectable=y,S.util.makeElementSelectable=_}();function h(p){var v=S.jsdomImplForWrapper(p);return v._canvas||v._image}function f(p){if(S.isLikelyNode){var v=S.jsdomImplForWrapper(p);v&&(v._image=null,v._canvas=null,v._currentSrc=null,v._attributes=null,v._classList=null)}}function g(p,v){p.imageSmoothingEnabled=p.imageSmoothingEnabled||p.webkitImageSmoothingEnabled||p.mozImageSmoothingEnabled||p.msImageSmoothingEnabled||p.oImageSmoothingEnabled,p.imageSmoothingEnabled=v}S.util.setImageSmoothing=g,S.util.getById=t,S.util.toArray=o,S.util.addClass=s,S.util.makeElement=n,S.util.wrapElement=r,S.util.getScrollLeftTop=a,S.util.getElementOffset=u,S.util.getNodeCanvas=h,S.util.cleanUpJsdomNode=f})();(function(){function e(o,n){return o+(/\?/.test(o)?"&":"?")+n}function t(){}function i(o,n){n||(n={});var s=n.method?n.method.toUpperCase():"GET",r=n.onComplete||function(){},a=new S.window.XMLHttpRequest,u=n.body||n.parameters;return a.onreadystatechange=function(){a.readyState===4&&(r(a),a.onreadystatechange=t)},s==="GET"&&(u=null,typeof n.parameters=="string"&&(o=e(o,n.parameters))),a.open(s,o,!0),(s==="POST"||s==="PUT")&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(u),a}S.util.request=i})();S.log=console.log;S.warn=console.warn;(function(){var e=S.util.object.extend,t=S.util.object.clone,i=[];S.util.object.extend(i,{cancelAll:function(){var h=this.splice(0);return h.forEach(function(f){f.cancel()}),h},cancelByCanvas:function(h){if(!h)return[];var f=this.filter(function(g){return typeof g.target=="object"&&g.target.canvas===h});return f.forEach(function(g){g.cancel()}),f},cancelByTarget:function(h){var f=this.findAnimationsByTarget(h);return f.forEach(function(g){g.cancel()}),f},findAnimationIndex:function(h){return this.indexOf(this.findAnimation(h))},findAnimation:function(h){return this.find(function(f){return f.cancel===h})},findAnimationsByTarget:function(h){return h?this.filter(function(f){return f.target===h}):[]}});function o(){return!1}function n(h,f,g,p){return-g*Math.cos(h/p*(Math.PI/2))+g+f}function s(h){h||(h={});var f=!1,g,p=function(){var v=S.runningAnimations.indexOf(g);return v>-1&&S.runningAnimations.splice(v,1)[0]};return g=e(t(h),{cancel:function(){return f=!0,p()},currentValue:"startValue"in h?h.startValue:0,completionRate:0,durationRate:0}),S.runningAnimations.push(g),u(function(v){var y=v||+new Date,_=h.duration||500,T=y+_,P,F=h.onChange||o,j=h.abort||o,Z=h.onComplete||o,Q=h.easing||n,$="startValue"in h?h.startValue.length>0:!1,tt="startValue"in h?h.startValue:0,rt="endValue"in h?h.endValue:100,ct=h.byValue||($?tt.map(function(lt,w){return rt[w]-tt[w]}):rt-tt);h.onStart&&h.onStart(),function lt(w){P=w||+new Date;var k=P>T?_:P-y,A=k/_,E=$?tt.map(function(O,x){return Q(k,tt[x],ct[x],_)}):Q(k,tt,ct,_),W=Math.abs($?(E[0]-tt[0])/ct[0]:(E-tt)/ct);if(g.currentValue=$?E.slice():E,g.completionRate=W,g.durationRate=A,!f){if(j(E,W,A)){p();return}if(P>T){g.currentValue=$?rt.slice():rt,g.completionRate=1,g.durationRate=1,F($?rt.slice():rt,1,1),Z(rt,1,1),p();return}else F(E,W,A),u(lt)}}(y)}),g.cancel}var r=S.window.requestAnimationFrame||S.window.webkitRequestAnimationFrame||S.window.mozRequestAnimationFrame||S.window.oRequestAnimationFrame||S.window.msRequestAnimationFrame||function(h){return S.window.setTimeout(h,1e3/60)},a=S.window.cancelAnimationFrame||S.window.clearTimeout;function u(){return r.apply(S.window,arguments)}function l(){return a.apply(S.window,arguments)}S.util.animate=s,S.util.requestAnimFrame=u,S.util.cancelAnimFrame=l,S.runningAnimations=i})();(function(){function e(i,o,n){var s="rgba("+parseInt(i[0]+n*(o[0]-i[0]),10)+","+parseInt(i[1]+n*(o[1]-i[1]),10)+","+parseInt(i[2]+n*(o[2]-i[2]),10);return s+=","+(i&&o?parseFloat(i[3]+n*(o[3]-i[3])):1),s+=")",s}function t(i,o,n,s){var r=new S.Color(i).getSource(),a=new S.Color(o).getSource(),u=s.onComplete,l=s.onChange;return s=s||{},S.util.animate(S.util.object.extend(s,{duration:n||500,startValue:r,endValue:a,byValue:a,easing:function(h,f,g,p){var v=s.colorEasing?s.colorEasing(h,p):1-Math.cos(h/p*(Math.PI/2));return e(f,g,v)},onComplete:function(h,f,g){if(u)return u(e(a,a,0),f,g)},onChange:function(h,f,g){if(l){if(Array.isArray(h))return l(e(h,h,0),f,g);l(h,f,g)}}}))}S.util.animateColor=t})();(function(){function e(w,k,A,E){return w<Math.abs(k)?(w=k,E=A/4):k===0&&w===0?E=A/(2*Math.PI)*Math.asin(1):E=A/(2*Math.PI)*Math.asin(k/w),{a:w,c:k,p:A,s:E}}function t(w,k,A){return w.a*Math.pow(2,10*(k-=1))*Math.sin((k*A-w.s)*(2*Math.PI)/w.p)}function i(w,k,A,E){return A*((w=w/E-1)*w*w+1)+k}function o(w,k,A,E){return w/=E/2,w<1?A/2*w*w*w+k:A/2*((w-=2)*w*w+2)+k}function n(w,k,A,E){return A*(w/=E)*w*w*w+k}function s(w,k,A,E){return-A*((w=w/E-1)*w*w*w-1)+k}function r(w,k,A,E){return w/=E/2,w<1?A/2*w*w*w*w+k:-A/2*((w-=2)*w*w*w-2)+k}function a(w,k,A,E){return A*(w/=E)*w*w*w*w+k}function u(w,k,A,E){return A*((w=w/E-1)*w*w*w*w+1)+k}function l(w,k,A,E){return w/=E/2,w<1?A/2*w*w*w*w*w+k:A/2*((w-=2)*w*w*w*w+2)+k}function h(w,k,A,E){return-A*Math.cos(w/E*(Math.PI/2))+A+k}function f(w,k,A,E){return A*Math.sin(w/E*(Math.PI/2))+k}function g(w,k,A,E){return-A/2*(Math.cos(Math.PI*w/E)-1)+k}function p(w,k,A,E){return w===0?k:A*Math.pow(2,10*(w/E-1))+k}function v(w,k,A,E){return w===E?k+A:A*(-Math.pow(2,-10*w/E)+1)+k}function y(w,k,A,E){return w===0?k:w===E?k+A:(w/=E/2,w<1?A/2*Math.pow(2,10*(w-1))+k:A/2*(-Math.pow(2,-10*--w)+2)+k)}function _(w,k,A,E){return-A*(Math.sqrt(1-(w/=E)*w)-1)+k}function T(w,k,A,E){return A*Math.sqrt(1-(w=w/E-1)*w)+k}function P(w,k,A,E){return w/=E/2,w<1?-A/2*(Math.sqrt(1-w*w)-1)+k:A/2*(Math.sqrt(1-(w-=2)*w)+1)+k}function F(w,k,A,E){var W=1.70158,O=0,x=A;if(w===0)return k;if(w/=E,w===1)return k+A;O||(O=E*.3);var M=e(x,A,O,W);return-t(M,w,E)+k}function j(w,k,A,E){var W=1.70158,O=0,x=A;if(w===0)return k;if(w/=E,w===1)return k+A;O||(O=E*.3);var M=e(x,A,O,W);return M.a*Math.pow(2,-10*w)*Math.sin((w*E-M.s)*(2*Math.PI)/M.p)+M.c+k}function Z(w,k,A,E){var W=1.70158,O=0,x=A;if(w===0)return k;if(w/=E/2,w===2)return k+A;O||(O=E*(.3*1.5));var M=e(x,A,O,W);return w<1?-.5*t(M,w,E)+k:M.a*Math.pow(2,-10*(w-=1))*Math.sin((w*E-M.s)*(2*Math.PI)/M.p)*.5+M.c+k}function Q(w,k,A,E,W){return W===void 0&&(W=1.70158),A*(w/=E)*w*((W+1)*w-W)+k}function $(w,k,A,E,W){return W===void 0&&(W=1.70158),A*((w=w/E-1)*w*((W+1)*w+W)+1)+k}function tt(w,k,A,E,W){return W===void 0&&(W=1.70158),w/=E/2,w<1?A/2*(w*w*(((W*=1.525)+1)*w-W))+k:A/2*((w-=2)*w*(((W*=1.525)+1)*w+W)+2)+k}function rt(w,k,A,E){return A-ct(E-w,0,A,E)+k}function ct(w,k,A,E){return(w/=E)<1/2.75?A*(7.5625*w*w)+k:w<2/2.75?A*(7.5625*(w-=1.5/2.75)*w+.75)+k:w<2.5/2.75?A*(7.5625*(w-=2.25/2.75)*w+.9375)+k:A*(7.5625*(w-=2.625/2.75)*w+.984375)+k}function lt(w,k,A,E){return w<E/2?rt(w*2,0,A,E)*.5+k:ct(w*2-E,0,A,E)*.5+A*.5+k}S.util.ease={easeInQuad:function(w,k,A,E){return A*(w/=E)*w+k},easeOutQuad:function(w,k,A,E){return-A*(w/=E)*(w-2)+k},easeInOutQuad:function(w,k,A,E){return w/=E/2,w<1?A/2*w*w+k:-A/2*(--w*(w-2)-1)+k},easeInCubic:function(w,k,A,E){return A*(w/=E)*w*w+k},easeOutCubic:i,easeInOutCubic:o,easeInQuart:n,easeOutQuart:s,easeInOutQuart:r,easeInQuint:a,easeOutQuint:u,easeInOutQuint:l,easeInSine:h,easeOutSine:f,easeInOutSine:g,easeInExpo:p,easeOutExpo:v,easeInOutExpo:y,easeInCirc:_,easeOutCirc:T,easeInOutCirc:P,easeInElastic:F,easeOutElastic:j,easeInOutElastic:Z,easeInBack:Q,easeOutBack:$,easeInOutBack:tt,easeInBounce:rt,easeOutBounce:ct,easeInOutBounce:lt}})();(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.object.clone,n=t.util.toFixed,s=t.util.parseUnit,r=t.util.multiplyTransformMatrices,a=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],u=["symbol","image","marker","pattern","view","svg"],l=["pattern","defs","symbol","metadata","clipPath","mask","desc"],h=["symbol","g","a","svg","clipPath","defs"],f={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},g={stroke:"strokeOpacity",fill:"fillOpacity"},p="font-size",v="clip-path";t.svgValidTagNamesRegEx=T(a),t.svgViewBoxElementsRegEx=T(u),t.svgInvalidAncestorsRegEx=T(l),t.svgValidParentsRegEx=T(h),t.cssRules={},t.gradientDefs={},t.clipPaths={};function y(O){return O in f?f[O]:O}function _(O,x,M,R){var z=Array.isArray(x),N;if((O==="fill"||O==="stroke")&&x==="none")x="";else{if(O==="strokeUniform")return x==="non-scaling-stroke";if(O==="strokeDashArray")x==="none"?x=null:x=x.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(O==="transformMatrix")M&&M.transformMatrix?x=r(M.transformMatrix,t.parseTransformAttribute(x)):x=t.parseTransformAttribute(x);else if(O==="visible")x=x!=="none"&&x!=="hidden",M&&M.visible===!1&&(x=!1);else if(O==="opacity")x=parseFloat(x),M&&typeof M.opacity<"u"&&(x*=M.opacity);else if(O==="textAnchor")x=x==="start"?"left":x==="end"?"right":"center";else if(O==="charSpacing")N=s(x,R)/R*1e3;else if(O==="paintFirst"){var q=x.indexOf("fill"),et=x.indexOf("stroke"),x="fill";(q>-1&&et>-1&&et<q||q===-1&&et>-1)&&(x="stroke")}else{if(O==="href"||O==="xlink:href"||O==="font")return x;if(O==="imageSmoothing")return x==="optimizeQuality";N=z?x.map(s):s(x,R)}}return!z&&isNaN(N)?x:N}function T(O){return new RegExp("^("+O.join("|")+")\\b","i")}function P(O){for(var x in g)if(!(typeof O[g[x]]>"u"||O[x]==="")){if(typeof O[x]>"u"){if(!t.Object.prototype[x])continue;O[x]=t.Object.prototype[x]}if(O[x].indexOf("url(")!==0){var M=new t.Color(O[x]);O[x]=M.setAlpha(n(M.getAlpha()*O[g[x]],2)).toRgba()}}return O}function F(O,x){var M,R=[],z,N,q;for(N=0,q=x.length;N<q;N++)M=x[N],z=O.getElementsByTagName(M),R=R.concat(Array.prototype.slice.call(z));return R}t.parseTransformAttribute=function(){function O(U,pt){var _t=t.util.cos(pt[0]),St=t.util.sin(pt[0]),Ot=0,Tt=0;pt.length===3&&(Ot=pt[1],Tt=pt[2]),U[0]=_t,U[1]=St,U[2]=-St,U[3]=_t,U[4]=Ot-(_t*Ot-St*Tt),U[5]=Tt-(St*Ot+_t*Tt)}function x(U,pt){var _t=pt[0],St=pt.length===2?pt[1]:pt[0];U[0]=_t,U[3]=St}function M(U,pt,_t){U[_t]=Math.tan(t.util.degreesToRadians(pt[0]))}function R(U,pt){U[4]=pt[0],pt.length===2&&(U[5]=pt[1])}var z=t.iMatrix,N=t.reNum,q=t.commaWsp,et="(?:(skewX)\\s*\\(\\s*("+N+")\\s*\\))",ot="(?:(skewY)\\s*\\(\\s*("+N+")\\s*\\))",X="(?:(rotate)\\s*\\(\\s*("+N+")(?:"+q+"("+N+")"+q+"("+N+"))?\\s*\\))",I="(?:(scale)\\s*\\(\\s*("+N+")(?:"+q+"("+N+"))?\\s*\\))",G="(?:(translate)\\s*\\(\\s*("+N+")(?:"+q+"("+N+"))?\\s*\\))",V="(?:(matrix)\\s*\\(\\s*("+N+")"+q+"("+N+")"+q+"("+N+")"+q+"("+N+")"+q+"("+N+")"+q+"("+N+")\\s*\\))",Y="(?:"+V+"|"+G+"|"+I+"|"+X+"|"+et+"|"+ot+")",K="(?:"+Y+"(?:"+q+"*"+Y+")*)",st="^\\s*(?:"+K+"?)\\s*$",yt=new RegExp(st),dt=new RegExp(Y,"g");return function(U){var pt=z.concat(),_t=[];if(!U||U&&!yt.test(U))return pt;U.replace(dt,function(Ot){var Tt=new RegExp(Y).exec(Ot).filter(function(ae){return!!ae}),Wt=Tt[1],Ft=Tt.slice(2).map(parseFloat);switch(Wt){case"translate":R(pt,Ft);break;case"rotate":Ft[0]=t.util.degreesToRadians(Ft[0]),O(pt,Ft);break;case"scale":x(pt,Ft);break;case"skewX":M(pt,Ft,2);break;case"skewY":M(pt,Ft,1);break;case"matrix":pt=Ft;break}_t.push(pt.concat()),pt=z.concat()});for(var St=_t[0];_t.length>1;)_t.shift(),St=t.util.multiplyTransformMatrices(St,_t[0]);return St}}();function j(O,x){var M,R;O.replace(/;\s*$/,"").split(";").forEach(function(z){var N=z.split(":");M=N[0].trim().toLowerCase(),R=N[1].trim(),x[M]=R})}function Z(O,x){var M,R;for(var z in O)typeof O[z]>"u"||(M=z.toLowerCase(),R=O[z],x[M]=R)}function Q(O,x){var M={};for(var R in t.cssRules[x])if($(O,R.split(" ")))for(var z in t.cssRules[x][R])M[z]=t.cssRules[x][R][z];return M}function $(O,x){var M,R=!0;return M=rt(O,x.pop()),M&&x.length&&(R=tt(O,x)),M&&R&&x.length===0}function tt(O,x){for(var M,R=!0;O.parentNode&&O.parentNode.nodeType===1&&x.length;)R&&(M=x.pop()),O=O.parentNode,R=rt(O,M);return x.length===0}function rt(O,x){var M=O.nodeName,R=O.getAttribute("class"),z=O.getAttribute("id"),N,q;if(N=new RegExp("^"+M,"i"),x=x.replace(N,""),z&&x.length&&(N=new RegExp("#"+z+"(?![a-zA-Z\\-]+)","i"),x=x.replace(N,"")),R&&x.length)for(R=R.split(" "),q=R.length;q--;)N=new RegExp("\\."+R[q]+"(?![a-zA-Z\\-]+)","i"),x=x.replace(N,"");return x.length===0}function ct(O,x){var M;if(O.getElementById&&(M=O.getElementById(x)),M)return M;var R,z,N,q=O.getElementsByTagName("*");for(z=0,N=q.length;z<N;z++)if(R=q[z],x===R.getAttribute("id"))return R}function lt(O){for(var x=F(O,["use","svg:use"]),M=0;x.length&&M<x.length;){var R=x[M],z=R.getAttribute("xlink:href")||R.getAttribute("href");if(z===null)return;var N=z.slice(1),q=R.getAttribute("x")||0,et=R.getAttribute("y")||0,ot=ct(O,N).cloneNode(!0),X=(ot.getAttribute("transform")||"")+" translate("+q+", "+et+")",I,G=x.length,V,Y,K,st,yt=t.svgNS;if(k(ot),/^svg$/i.test(ot.nodeName)){var dt=ot.ownerDocument.createElementNS(yt,"g");for(Y=0,K=ot.attributes,st=K.length;Y<st;Y++)V=K.item(Y),dt.setAttributeNS(yt,V.nodeName,V.nodeValue);for(;ot.firstChild;)dt.appendChild(ot.firstChild);ot=dt}for(Y=0,K=R.attributes,st=K.length;Y<st;Y++)V=K.item(Y),!(V.nodeName==="x"||V.nodeName==="y"||V.nodeName==="xlink:href"||V.nodeName==="href")&&(V.nodeName==="transform"?X=V.nodeValue+" "+X:ot.setAttribute(V.nodeName,V.nodeValue));ot.setAttribute("transform",X),ot.setAttribute("instantiated_by_use","1"),ot.removeAttribute("id"),I=R.parentNode,I.replaceChild(ot,R),x.length===G&&M++}}var w=new RegExp("^\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*$");function k(O){if(!t.svgViewBoxElementsRegEx.test(O.nodeName))return{};var x=O.getAttribute("viewBox"),M=1,R=1,z=0,N=0,q,et,ot,X,I=O.getAttribute("width"),G=O.getAttribute("height"),V=O.getAttribute("x")||0,Y=O.getAttribute("y")||0,K=O.getAttribute("preserveAspectRatio")||"",st=!x||!(x=x.match(w)),yt=!I||!G||I==="100%"||G==="100%",dt=st&&yt,U={},pt="",_t=0,St=0;if(U.width=0,U.height=0,U.toBeParsed=dt,st&&(V||Y)&&O.parentNode&&O.parentNode.nodeName!=="#document"&&(pt=" translate("+s(V)+" "+s(Y)+") ",ot=(O.getAttribute("transform")||"")+pt,O.setAttribute("transform",ot),O.removeAttribute("x"),O.removeAttribute("y")),dt)return U;if(st)return U.width=s(I),U.height=s(G),U;if(z=-parseFloat(x[1]),N=-parseFloat(x[2]),q=parseFloat(x[3]),et=parseFloat(x[4]),U.minX=z,U.minY=N,U.viewBoxWidth=q,U.viewBoxHeight=et,yt?(U.width=q,U.height=et):(U.width=s(I),U.height=s(G),M=U.width/q,R=U.height/et),K=t.util.parsePreserveAspectRatioAttribute(K),K.alignX!=="none"&&(K.meetOrSlice==="meet"&&(R=M=M>R?R:M),K.meetOrSlice==="slice"&&(R=M=M>R?M:R),_t=U.width-q*M,St=U.height-et*M,K.alignX==="Mid"&&(_t/=2),K.alignY==="Mid"&&(St/=2),K.alignX==="Min"&&(_t=0),K.alignY==="Min"&&(St=0)),M===1&&R===1&&z===0&&N===0&&V===0&&Y===0)return U;if((V||Y)&&O.parentNode.nodeName!=="#document"&&(pt=" translate("+s(V)+" "+s(Y)+") "),ot=pt+" matrix("+M+" 0 0 "+R+" "+(z*M+_t)+" "+(N*R+St)+") ",O.nodeName==="svg"){for(X=O.ownerDocument.createElementNS(t.svgNS,"g");O.firstChild;)X.appendChild(O.firstChild);O.appendChild(X)}else X=O,X.removeAttribute("x"),X.removeAttribute("y"),ot=X.getAttribute("transform")+ot;return X.setAttribute("transform",ot),U}function A(O,x){for(;O&&(O=O.parentNode);)if(O.nodeName&&x.test(O.nodeName.replace("svg:",""))&&!O.getAttribute("instantiated_by_use"))return!0;return!1}t.parseSVGDocument=function(O,x,M,R){if(O){lt(O);var z=t.Object.__uid++,N,q,et=k(O),ot=t.util.toArray(O.getElementsByTagName("*"));if(et.crossOrigin=R&&R.crossOrigin,et.svgUid=z,ot.length===0&&t.isLikelyNode){ot=O.selectNodes('//*[name(.)!="svg"]');var X=[];for(N=0,q=ot.length;N<q;N++)X[N]=ot[N];ot=X}var I=ot.filter(function(V){return k(V),t.svgValidTagNamesRegEx.test(V.nodeName.replace("svg:",""))&&!A(V,t.svgInvalidAncestorsRegEx)});if(!I||I&&!I.length){x&&x([],{});return}var G={};ot.filter(function(V){return V.nodeName.replace("svg:","")==="clipPath"}).forEach(function(V){var Y=V.getAttribute("id");G[Y]=t.util.toArray(V.getElementsByTagName("*")).filter(function(K){return t.svgValidTagNamesRegEx.test(K.nodeName.replace("svg:",""))})}),t.gradientDefs[z]=t.getGradientDefs(O),t.cssRules[z]=t.getCSSRules(O),t.clipPaths[z]=G,t.parseElements(I,function(V,Y){x&&(x(V,et,Y,ot),delete t.gradientDefs[z],delete t.cssRules[z],delete t.clipPaths[z])},o(et),M,R)}};function E(O,x){var M=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],R="xlink:href",z=x.getAttribute(R).slice(1),N=ct(O,z);if(N&&N.getAttribute(R)&&E(O,N),M.forEach(function(et){N&&!x.hasAttribute(et)&&N.hasAttribute(et)&&x.setAttribute(et,N.getAttribute(et))}),!x.children.length)for(var q=N.cloneNode(!0);q.firstChild;)x.appendChild(q.firstChild);x.removeAttribute(R)}var W=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+t.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+t.reNum+"))?\\s+(.*)");i(t,{parseFontDeclaration:function(O,x){var M=O.match(W);if(M){var R=M[1],z=M[3],N=M[4],q=M[5],et=M[6];R&&(x.fontStyle=R),z&&(x.fontWeight=isNaN(parseFloat(z))?z:parseFloat(z)),N&&(x.fontSize=s(N)),et&&(x.fontFamily=et),q&&(x.lineHeight=q==="normal"?1:q)}},getGradientDefs:function(O){var x=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],M=F(O,x),R,z=0,N={};for(z=M.length;z--;)R=M[z],R.getAttribute("xlink:href")&&E(O,R),N[R.getAttribute("id")]=R;return N},parseAttributes:function(O,x,M){if(O){var R,z={},N,q;typeof M>"u"&&(M=O.getAttribute("svgUid")),O.parentNode&&t.svgValidParentsRegEx.test(O.parentNode.nodeName)&&(z=t.parseAttributes(O.parentNode,x,M));var et=x.reduce(function(K,st){return R=O.getAttribute(st),R&&(K[st]=R),K},{}),ot=i(Q(O,M),t.parseStyleAttribute(O));et=i(et,ot),ot[v]&&O.setAttribute(v,ot[v]),N=q=z.fontSize||t.Text.DEFAULT_SVG_FONT_SIZE,et[p]&&(et[p]=N=s(et[p],q));var X,I,G={};for(var V in et)X=y(V),I=_(X,et[V],z,N),G[X]=I;G&&G.font&&t.parseFontDeclaration(G.font,G);var Y=i(z,G);return t.svgValidParentsRegEx.test(O.nodeName)?Y:P(Y)}},parseElements:function(O,x,M,R,z){new t.ElementsParser(O,x,M,R,z).parse()},parseStyleAttribute:function(O){var x={},M=O.getAttribute("style");return M&&(typeof M=="string"?j(M,x):Z(M,x)),x},parsePointsAttribute:function(O){if(!O)return null;O=O.replace(/,/g," ").trim(),O=O.split(/\s+/);var x=[],M,R;for(M=0,R=O.length;M<R;M+=2)x.push({x:parseFloat(O[M]),y:parseFloat(O[M+1])});return x},getCSSRules:function(O){var x=O.getElementsByTagName("style"),M,R,z={},N;for(M=0,R=x.length;M<R;M++){var q=x[M].textContent;q=q.replace(/\/\*[\s\S]*?\*\//g,""),q.trim()!==""&&(N=q.split("}"),N=N.filter(function(et){return et.trim()}),N.forEach(function(et){var ot=et.split("{"),X={},I=ot[1].trim(),G=I.split(";").filter(function(st){return st.trim()});for(M=0,R=G.length;M<R;M++){var V=G[M].split(":"),Y=V[0].trim(),K=V[1].trim();X[Y]=K}et=ot[0].trim(),et.split(",").forEach(function(st){st=st.replace(/^svg/i,"").trim(),st!==""&&(z[st]?t.util.object.extend(z[st],X):z[st]=t.util.object.clone(X))})}))}return z},loadSVGFromURL:function(O,x,M,R){O=O.replace(/^\n\s*/,"").trim(),new t.util.request(O,{method:"get",onComplete:z});function z(N){var q=N.responseXML;if(!q||!q.documentElement)return x&&x(null),!1;t.parseSVGDocument(q.documentElement,function(et,ot,X,I){x&&x(et,ot,X,I)},M,R)}},loadSVGFromString:function(O,x,M,R){var z=new t.window.DOMParser,N=z.parseFromString(O.trim(),"text/xml");t.parseSVGDocument(N.documentElement,function(q,et,ot,X){x(q,et,ot,X)},M,R)}})})(ht);S.ElementsParser=function(e,t,i,o,n,s){this.elements=e,this.callback=t,this.options=i,this.reviver=o,this.svgUid=i&&i.svgUid||0,this.parsingOptions=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=s};(function(e){e.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},e.createObjects=function(){var t=this;this.elements.forEach(function(i,o){i.setAttribute("svgUid",t.svgUid),t.createObject(i,o)})},e.findTag=function(t){return S[S.util.string.capitalize(t.tagName.replace("svg:",""))]},e.createObject=function(t,i){var o=this.findTag(t);if(o&&o.fromElement)try{o.fromElement(t,this.createCallback(i,t),this.options)}catch(n){S.log(n)}else this.checkIfDone()},e.createCallback=function(t,i){var o=this;return function(n){var s;o.resolveGradient(n,i,"fill"),o.resolveGradient(n,i,"stroke"),n instanceof S.Image&&n._originalElement&&(s=n.parsePreserveAspectRatioAttribute(i)),n._removeTransformMatrix(s),o.resolveClipPath(n,i),o.reviver&&o.reviver(i,n),o.instances[t]=n,o.checkIfDone()}},e.extractPropertyDefinition=function(t,i,o){var n=t[i],s=this.regexUrl;if(s.test(n)){s.lastIndex=0;var r=s.exec(n)[1];return s.lastIndex=0,S[o][this.svgUid][r]}},e.resolveGradient=function(t,i,o){var n=this.extractPropertyDefinition(t,o,"gradientDefs");if(n){var s=i.getAttribute(o+"-opacity"),r=S.Gradient.fromElement(n,t,s,this.options);t.set(o,r)}},e.createClipPathCallback=function(t,i){return function(o){o._removeTransformMatrix(),o.fillRule=o.clipRule,i.push(o)}},e.resolveClipPath=function(t,i){var o=this.extractPropertyDefinition(t,"clipPath","clipPaths"),n,s,r,a,u,l;if(o){a=[],r=S.util.invertTransform(t.calcTransformMatrix());for(var h=o[0].parentNode,f=i;f.parentNode&&f.getAttribute("clip-path")!==t.clipPath;)f=f.parentNode;f.parentNode.appendChild(h);for(var g=0;g<o.length;g++)n=o[g],s=this.findTag(n),s.fromElement(n,this.createClipPathCallback(t,a),this.options);a.length===1?o=a[0]:o=new S.Group(a),u=S.util.multiplyTransformMatrices(r,o.calcTransformMatrix()),o.clipPath&&this.resolveClipPath(o,f);var l=S.util.qrDecompose(u);o.flipX=!1,o.flipY=!1,o.set("scaleX",l.scaleX),o.set("scaleY",l.scaleY),o.angle=l.angle,o.skewX=l.skewX,o.skewY=0,o.setPositionByOrigin({x:l.translateX,y:l.translateY},"center","center"),t.clipPath=o}else delete t.clipPath},e.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(t){return t!=null}),this.callback(this.instances,this.elements))}})(S.ElementsParser.prototype);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Point){t.warn("fabric.Point is already defined");return}t.Point=i;function i(o,n){this.x=o,this.y=n}i.prototype={type:"point",constructor:i,add:function(o){return new i(this.x+o.x,this.y+o.y)},addEquals:function(o){return this.x+=o.x,this.y+=o.y,this},scalarAdd:function(o){return new i(this.x+o,this.y+o)},scalarAddEquals:function(o){return this.x+=o,this.y+=o,this},subtract:function(o){return new i(this.x-o.x,this.y-o.y)},subtractEquals:function(o){return this.x-=o.x,this.y-=o.y,this},scalarSubtract:function(o){return new i(this.x-o,this.y-o)},scalarSubtractEquals:function(o){return this.x-=o,this.y-=o,this},multiply:function(o){return new i(this.x*o,this.y*o)},multiplyEquals:function(o){return this.x*=o,this.y*=o,this},divide:function(o){return new i(this.x/o,this.y/o)},divideEquals:function(o){return this.x/=o,this.y/=o,this},eq:function(o){return this.x===o.x&&this.y===o.y},lt:function(o){return this.x<o.x&&this.y<o.y},lte:function(o){return this.x<=o.x&&this.y<=o.y},gt:function(o){return this.x>o.x&&this.y>o.y},gte:function(o){return this.x>=o.x&&this.y>=o.y},lerp:function(o,n){return typeof n>"u"&&(n=.5),n=Math.max(Math.min(1,n),0),new i(this.x+(o.x-this.x)*n,this.y+(o.y-this.y)*n)},distanceFrom:function(o){var n=this.x-o.x,s=this.y-o.y;return Math.sqrt(n*n+s*s)},midPointFrom:function(o){return this.lerp(o)},min:function(o){return new i(Math.min(this.x,o.x),Math.min(this.y,o.y))},max:function(o){return new i(Math.max(this.x,o.x),Math.max(this.y,o.y))},toString:function(){return this.x+","+this.y},setXY:function(o,n){return this.x=o,this.y=n,this},setX:function(o){return this.x=o,this},setY:function(o){return this.y=o,this},setFromPoint:function(o){return this.x=o.x,this.y=o.y,this},swap:function(o){var n=this.x,s=this.y;this.x=o.x,this.y=o.y,o.x=n,o.y=s},clone:function(){return new i(this.x,this.y)}}})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Intersection){t.warn("fabric.Intersection is already defined");return}function i(o){this.status=o,this.points=[]}t.Intersection=i,t.Intersection.prototype={constructor:i,appendPoint:function(o){return this.points.push(o),this},appendPoints:function(o){return this.points=this.points.concat(o),this}},t.Intersection.intersectLineLine=function(o,n,s,r){var a,u=(r.x-s.x)*(o.y-s.y)-(r.y-s.y)*(o.x-s.x),l=(n.x-o.x)*(o.y-s.y)-(n.y-o.y)*(o.x-s.x),h=(r.y-s.y)*(n.x-o.x)-(r.x-s.x)*(n.y-o.y);if(h!==0){var f=u/h,g=l/h;0<=f&&f<=1&&0<=g&&g<=1?(a=new i("Intersection"),a.appendPoint(new t.Point(o.x+f*(n.x-o.x),o.y+f*(n.y-o.y)))):a=new i}else u===0||l===0?a=new i("Coincident"):a=new i("Parallel");return a},t.Intersection.intersectLinePolygon=function(o,n,s){var r=new i,a=s.length,u,l,h,f;for(f=0;f<a;f++)u=s[f],l=s[(f+1)%a],h=i.intersectLineLine(o,n,u,l),r.appendPoints(h.points);return r.points.length>0&&(r.status="Intersection"),r},t.Intersection.intersectPolygonPolygon=function(o,n){var s=new i,r=o.length,a;for(a=0;a<r;a++){var u=o[a],l=o[(a+1)%r],h=i.intersectLinePolygon(u,l,n);s.appendPoints(h.points)}return s.points.length>0&&(s.status="Intersection"),s},t.Intersection.intersectPolygonRectangle=function(o,n,s){var r=n.min(s),a=n.max(s),u=new t.Point(a.x,r.y),l=new t.Point(r.x,a.y),h=i.intersectLinePolygon(r,u,o),f=i.intersectLinePolygon(u,a,o),g=i.intersectLinePolygon(a,l,o),p=i.intersectLinePolygon(l,r,o),v=new i;return v.appendPoints(h.points),v.appendPoints(f.points),v.appendPoints(g.points),v.appendPoints(p.points),v.points.length>0&&(v.status="Intersection"),v}})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Color){t.warn("fabric.Color is already defined.");return}function i(n){n?this._tryParsingColor(n):this.setSource([0,0,0,1])}t.Color=i,t.Color.prototype={_tryParsingColor:function(n){var s;n in i.colorNameMap&&(n=i.colorNameMap[n]),n==="transparent"&&(s=[255,255,255,0]),s||(s=i.sourceFromHex(n)),s||(s=i.sourceFromRgb(n)),s||(s=i.sourceFromHsl(n)),s||(s=[0,0,0,1]),s&&this.setSource(s)},_rgbToHsl:function(n,s,r){n/=255,s/=255,r/=255;var a,u,l,h=t.util.array.max([n,s,r]),f=t.util.array.min([n,s,r]);if(l=(h+f)/2,h===f)a=u=0;else{var g=h-f;switch(u=l>.5?g/(2-h-f):g/(h+f),h){case n:a=(s-r)/g+(s<r?6:0);break;case s:a=(r-n)/g+2;break;case r:a=(n-s)/g+4;break}a/=6}return[Math.round(a*360),Math.round(u*100),Math.round(l*100)]},getSource:function(){return this._source},setSource:function(n){this._source=n},toRgb:function(){var n=this.getSource();return"rgb("+n[0]+","+n[1]+","+n[2]+")"},toRgba:function(){var n=this.getSource();return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},toHsl:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsl("+s[0]+","+s[1]+"%,"+s[2]+"%)"},toHsla:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsla("+s[0]+","+s[1]+"%,"+s[2]+"%,"+n[3]+")"},toHex:function(){var n=this.getSource(),s,r,a;return s=n[0].toString(16),s=s.length===1?"0"+s:s,r=n[1].toString(16),r=r.length===1?"0"+r:r,a=n[2].toString(16),a=a.length===1?"0"+a:a,s.toUpperCase()+r.toUpperCase()+a.toUpperCase()},toHexa:function(){var n=this.getSource(),s;return s=Math.round(n[3]*255),s=s.toString(16),s=s.length===1?"0"+s:s,this.toHex()+s.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(n){var s=this.getSource();return s[3]=n,this.setSource(s),this},toGrayscale:function(){var n=this.getSource(),s=parseInt((n[0]*.3+n[1]*.59+n[2]*.11).toFixed(0),10),r=n[3];return this.setSource([s,s,s,r]),this},toBlackWhite:function(n){var s=this.getSource(),r=(s[0]*.3+s[1]*.59+s[2]*.11).toFixed(0),a=s[3];return n=n||127,r=Number(r)<Number(n)?0:255,this.setSource([r,r,r,a]),this},overlayWith:function(n){n instanceof i||(n=new i(n));var s=[],r=this.getAlpha(),a=.5,u=this.getSource(),l=n.getSource(),h;for(h=0;h<3;h++)s.push(Math.round(u[h]*(1-a)+l[h]*a));return s[3]=r,this.setSource(s),this}},t.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,t.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,t.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,t.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function o(n,s,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?n+(s-n)*6*r:r<1/2?s:r<2/3?n+(s-n)*(2/3-r)*6:n}t.Color.fromRgb=function(n){return i.fromSource(i.sourceFromRgb(n))},t.Color.sourceFromRgb=function(n){var s=n.match(i.reRGBa);if(s){var r=parseInt(s[1],10)/(/%$/.test(s[1])?100:1)*(/%$/.test(s[1])?255:1),a=parseInt(s[2],10)/(/%$/.test(s[2])?100:1)*(/%$/.test(s[2])?255:1),u=parseInt(s[3],10)/(/%$/.test(s[3])?100:1)*(/%$/.test(s[3])?255:1);return[parseInt(r,10),parseInt(a,10),parseInt(u,10),s[4]?parseFloat(s[4]):1]}},t.Color.fromRgba=i.fromRgb,t.Color.fromHsl=function(n){return i.fromSource(i.sourceFromHsl(n))},t.Color.sourceFromHsl=function(n){var s=n.match(i.reHSLa);if(s){var r=(parseFloat(s[1])%360+360)%360/360,a=parseFloat(s[2])/(/%$/.test(s[2])?100:1),u=parseFloat(s[3])/(/%$/.test(s[3])?100:1),l,h,f;if(a===0)l=h=f=u;else{var g=u<=.5?u*(a+1):u+a-u*a,p=u*2-g;l=o(p,g,r+1/3),h=o(p,g,r),f=o(p,g,r-1/3)}return[Math.round(l*255),Math.round(h*255),Math.round(f*255),s[4]?parseFloat(s[4]):1]}},t.Color.fromHsla=i.fromHsl,t.Color.fromHex=function(n){return i.fromSource(i.sourceFromHex(n))},t.Color.sourceFromHex=function(n){if(n.match(i.reHex)){var s=n.slice(n.indexOf("#")+1),r=s.length===3||s.length===4,a=s.length===8||s.length===4,u=r?s.charAt(0)+s.charAt(0):s.substring(0,2),l=r?s.charAt(1)+s.charAt(1):s.substring(2,4),h=r?s.charAt(2)+s.charAt(2):s.substring(4,6),f=a?r?s.charAt(3)+s.charAt(3):s.substring(6,8):"FF";return[parseInt(u,16),parseInt(l,16),parseInt(h,16),parseFloat((parseInt(f,16)/255).toFixed(2))]}},t.Color.fromSource=function(n){var s=new i;return s.setSource(n),s}})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=["e","se","s","sw","w","nw","n","ne","e"],o=["ns","nesw","ew","nwse"],n={},s="left",r="top",a="right",u="bottom",l="center",h={top:u,bottom:r,left:a,right:s,center:l},f=t.util.radiansToDegrees,g=Math.sign||function(X){return(X>0)-(X<0)||+X};function p(X,I){var G=X.angle+f(Math.atan2(I.y,I.x))+360;return Math.round(G%360/45)}function v(X,I){var G=I.transform.target,V=G.canvas,Y=t.util.object.clone(I);Y.target=G,V&&V.fire("object:"+X,Y),G.fire(X,I)}function y(X,I){var G=I.canvas,V=G.uniScaleKey,Y=X[V];return G.uniformScaling&&!Y||!G.uniformScaling&&Y}function _(X){return X.originX===l&&X.originY===l}function T(X,I,G){var V=X.lockScalingX,Y=X.lockScalingY;return!!(V&&Y||!I&&(V||Y)&&G||V&&I==="x"||Y&&I==="y")}function P(X,I,G){var V="not-allowed",Y=y(X,G),K="";if(I.x!==0&&I.y===0?K="x":I.x===0&&I.y!==0&&(K="y"),T(G,K,Y))return V;var st=p(G,I);return i[st]+"-resize"}function F(X,I,G){var V="not-allowed";if(I.x!==0&&G.lockSkewingY||I.y!==0&&G.lockSkewingX)return V;var Y=p(G,I)%4;return o[Y]+"-resize"}function j(X,I,G){return X[G.canvas.altActionKey]?n.skewCursorStyleHandler(X,I,G):n.scaleCursorStyleHandler(X,I,G)}function Z(X,I,G){var V=X[G.canvas.altActionKey];if(I.x===0)return V?"skewX":"scaleY";if(I.y===0)return V?"skewY":"scaleX"}function Q(X,I,G){return G.lockRotation?"not-allowed":I.cursorStyle}function $(X,I,G,V){return{e:X,transform:I,pointer:{x:G,y:V}}}function tt(X){return function(I,G,V,Y){var K=G.target,st=K.getCenterPoint(),yt=K.translateToOriginPoint(st,G.originX,G.originY),dt=X(I,G,V,Y);return K.setPositionByOrigin(yt,G.originX,G.originY),dt}}function rt(X,I){return function(G,V,Y,K){var st=I(G,V,Y,K);return st&&v(X,$(G,V,Y,K)),st}}function ct(X,I,G,V,Y){var K=X.target,st=K.controls[X.corner],yt=K.canvas.getZoom(),dt=K.padding/yt,U=K.toLocalPoint(new t.Point(V,Y),I,G);return U.x>=dt&&(U.x-=dt),U.x<=-dt&&(U.x+=dt),U.y>=dt&&(U.y-=dt),U.y<=dt&&(U.y+=dt),U.x-=st.offsetX,U.y-=st.offsetY,U}function lt(X){return X.flipX!==X.flipY}function w(X,I,G,V,Y){if(X[I]!==0){var K=X._getTransformedDimensions()[V],st=Y/K*X[G];X.set(G,st)}}function k(X,I,G,V){var Y=I.target,K=Y._getTransformedDimensions(0,Y.skewY),st=ct(I,I.originX,I.originY,G,V),yt=Math.abs(st.x*2)-K.x,dt=Y.skewX,U;yt<2?U=0:(U=f(Math.atan2(yt/Y.scaleX,K.y/Y.scaleY)),I.originX===s&&I.originY===u&&(U=-U),I.originX===a&&I.originY===r&&(U=-U),lt(Y)&&(U=-U));var pt=dt!==U;if(pt){var _t=Y._getTransformedDimensions().y;Y.set("skewX",U),w(Y,"skewY","scaleY","y",_t)}return pt}function A(X,I,G,V){var Y=I.target,K=Y._getTransformedDimensions(Y.skewX,0),st=ct(I,I.originX,I.originY,G,V),yt=Math.abs(st.y*2)-K.y,dt=Y.skewY,U;yt<2?U=0:(U=f(Math.atan2(yt/Y.scaleY,K.x/Y.scaleX)),I.originX===s&&I.originY===u&&(U=-U),I.originX===a&&I.originY===r&&(U=-U),lt(Y)&&(U=-U));var pt=dt!==U;if(pt){var _t=Y._getTransformedDimensions().x;Y.set("skewY",U),w(Y,"skewX","scaleX","x",_t)}return pt}function E(X,I,G,V){var Y=I.target,K=Y.skewX,st,yt=I.originY;if(Y.lockSkewingX)return!1;if(K===0){var dt=ct(I,l,l,G,V);dt.x>0?st=s:st=a}else K>0&&(st=yt===r?s:a),K<0&&(st=yt===r?a:s),lt(Y)&&(st=st===s?a:s);I.originX=st;var U=rt("skewing",tt(k));return U(X,I,G,V)}function W(X,I,G,V){var Y=I.target,K=Y.skewY,st,yt=I.originX;if(Y.lockSkewingY)return!1;if(K===0){var dt=ct(I,l,l,G,V);dt.y>0?st=r:st=u}else K>0&&(st=yt===s?r:u),K<0&&(st=yt===s?u:r),lt(Y)&&(st=st===r?u:r);I.originY=st;var U=rt("skewing",tt(A));return U(X,I,G,V)}function O(X,I,G,V){var Y=I,K=Y.target,st=K.translateToOriginPoint(K.getCenterPoint(),Y.originX,Y.originY);if(K.lockRotation)return!1;var yt=Math.atan2(Y.ey-st.y,Y.ex-st.x),dt=Math.atan2(V-st.y,G-st.x),U=f(dt-yt+Y.theta),pt=!0;if(K.snapAngle>0){var _t=K.snapAngle,St=K.snapThreshold||_t,Ot=Math.ceil(U/_t)*_t,Tt=Math.floor(U/_t)*_t;Math.abs(U-Tt)<St?U=Tt:Math.abs(U-Ot)<St&&(U=Ot)}return U<0&&(U=360+U),U%=360,pt=K.angle!==U,K.angle=U,pt}function x(X,I,G,V,Y){Y=Y||{};var K=I.target,st=K.lockScalingX,yt=K.lockScalingY,dt=Y.by,U,pt,_t,St,Ot=y(X,K),Tt=T(K,dt,Ot),Wt,Ft,ae=I.gestureScale;if(Tt)return!1;if(ae)pt=I.scaleX*ae,_t=I.scaleY*ae;else{if(U=ct(I,I.originX,I.originY,G,V),Wt=dt!=="y"?g(U.x):1,Ft=dt!=="x"?g(U.y):1,I.signX||(I.signX=Wt),I.signY||(I.signY=Ft),K.lockScalingFlip&&(I.signX!==Wt||I.signY!==Ft))return!1;if(St=K._getTransformedDimensions(),Ot&&!dt){var ze=Math.abs(U.x)+Math.abs(U.y),qt=I.original,Si=Math.abs(St.x*qt.scaleX/K.scaleX)+Math.abs(St.y*qt.scaleY/K.scaleY),Fi=ze/Si;pt=qt.scaleX*Fi,_t=qt.scaleY*Fi}else pt=Math.abs(U.x*K.scaleX/St.x),_t=Math.abs(U.y*K.scaleY/St.y);_(I)&&(pt*=2,_t*=2),I.signX!==Wt&&dt!=="y"&&(I.originX=h[I.originX],pt*=-1,I.signX=Wt),I.signY!==Ft&&dt!=="x"&&(I.originY=h[I.originY],_t*=-1,I.signY=Ft)}var Pn=K.scaleX,kn=K.scaleY;return dt?(dt==="x"&&K.set("scaleX",pt),dt==="y"&&K.set("scaleY",_t)):(!st&&K.set("scaleX",pt),!yt&&K.set("scaleY",_t)),Pn!==K.scaleX||kn!==K.scaleY}function M(X,I,G,V){return x(X,I,G,V)}function R(X,I,G,V){return x(X,I,G,V,{by:"x"})}function z(X,I,G,V){return x(X,I,G,V,{by:"y"})}function N(X,I,G,V){return X[I.target.canvas.altActionKey]?n.skewHandlerX(X,I,G,V):n.scalingY(X,I,G,V)}function q(X,I,G,V){return X[I.target.canvas.altActionKey]?n.skewHandlerY(X,I,G,V):n.scalingX(X,I,G,V)}function et(X,I,G,V){var Y=I.target,K=ct(I,I.originX,I.originY,G,V),st=Y.strokeWidth/(Y.strokeUniform?Y.scaleX:1),yt=_(I)?2:1,dt=Y.width,U=Math.abs(K.x*yt/Y.scaleX)-st;return Y.set("width",Math.max(U,0)),dt!==U}function ot(X,I,G,V){var Y=I.target,K=G-I.offsetX,st=V-I.offsetY,yt=!Y.get("lockMovementX")&&Y.left!==K,dt=!Y.get("lockMovementY")&&Y.top!==st;return yt&&Y.set("left",K),dt&&Y.set("top",st),(yt||dt)&&v("moving",$(X,I,G,V)),yt||dt}n.scaleCursorStyleHandler=P,n.skewCursorStyleHandler=F,n.scaleSkewCursorStyleHandler=j,n.rotationWithSnapping=rt("rotating",tt(O)),n.scalingEqually=rt("scaling",tt(M)),n.scalingX=rt("scaling",tt(R)),n.scalingY=rt("scaling",tt(z)),n.scalingYOrSkewingX=N,n.scalingXOrSkewingY=q,n.changeWidth=rt("resizing",tt(et)),n.skewHandlerX=E,n.skewHandlerY=W,n.dragHandler=ot,n.scaleOrSkewActionName=Z,n.rotationStyleHandler=Q,n.fireEvent=v,n.wrapWithFixedAnchor=tt,n.wrapWithFireEvent=rt,n.getLocalPoint=ct,t.controlsUtils=n})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.degreesToRadians,o=t.controlsUtils;function n(r,a,u,l,h){l=l||{};var f=this.sizeX||l.cornerSize||h.cornerSize,g=this.sizeY||l.cornerSize||h.cornerSize,p=typeof l.transparentCorners<"u"?l.transparentCorners:h.transparentCorners,v=p?"stroke":"fill",y=!p&&(l.cornerStrokeColor||h.cornerStrokeColor),_=a,T=u,P;r.save(),r.fillStyle=l.cornerColor||h.cornerColor,r.strokeStyle=l.cornerStrokeColor||h.cornerStrokeColor,f>g?(P=f,r.scale(1,g/f),T=u*f/g):g>f?(P=g,r.scale(f/g,1),_=a*g/f):P=f,r.lineWidth=1,r.beginPath(),r.arc(_,T,P/2,0,2*Math.PI,!1),r[v](),y&&r.stroke(),r.restore()}function s(r,a,u,l,h){l=l||{};var f=this.sizeX||l.cornerSize||h.cornerSize,g=this.sizeY||l.cornerSize||h.cornerSize,p=typeof l.transparentCorners<"u"?l.transparentCorners:h.transparentCorners,v=p?"stroke":"fill",y=!p&&(l.cornerStrokeColor||h.cornerStrokeColor),_=f/2,T=g/2;r.save(),r.fillStyle=l.cornerColor||h.cornerColor,r.strokeStyle=l.cornerStrokeColor||h.cornerStrokeColor,r.lineWidth=1,r.translate(a,u),r.rotate(i(h.angle)),r[v+"Rect"](-_,-T,f,g),y&&r.strokeRect(-_,-T,f,g),r.restore()}o.renderCircleControl=n,o.renderSquareControl=s})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={});function i(o){for(var n in o)this[n]=o[n]}t.Control=i,t.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(o,n){return n.cursorStyle},getActionName:function(o,n){return n.actionName},getVisibility:function(o,n){var s=o._controlsVisibility;return s&&typeof s[n]<"u"?s[n]:this.visible},setVisibility:function(o){this.visible=o},positionHandler:function(o,n){var s=t.util.transformPoint({x:this.x*o.x+this.offsetX,y:this.y*o.y+this.offsetY},n);return s},calcCornerCoords:function(o,n,s,r,a){var u,l,h,f,g=a?this.touchSizeX:this.sizeX,p=a?this.touchSizeY:this.sizeY;if(g&&p&&g!==p){var v=Math.atan2(p,g),y=Math.sqrt(g*g+p*p)/2,_=v-t.util.degreesToRadians(o),T=Math.PI/2-v-t.util.degreesToRadians(o);u=y*t.util.cos(_),l=y*t.util.sin(_),h=y*t.util.cos(T),f=y*t.util.sin(T)}else{var P=g&&p?g:n;y=P*.7071067812;var _=t.util.degreesToRadians(45-o);u=h=y*t.util.cos(_),l=f=y*t.util.sin(_)}return{tl:{x:s-f,y:r-h},tr:{x:s+u,y:r-l},bl:{x:s-u,y:r+l},br:{x:s+f,y:r+h}}},render:function(o,n,s,r,a){switch(r=r||{},r.cornerStyle||a.cornerStyle){case"circle":t.controlsUtils.renderCircleControl.call(this,o,n,s,r,a);break;default:t.controlsUtils.renderSquareControl.call(this,o,n,s,r,a)}}}})(ht);(function(){function e(s,r){var a=s.getAttribute("style"),u=s.getAttribute("offset")||0,l,h,f,g;if(u=parseFloat(u)/(/%$/.test(u)?100:1),u=u<0?0:u>1?1:u,a){var p=a.split(/\s*;\s*/);for(p[p.length-1]===""&&p.pop(),g=p.length;g--;){var v=p[g].split(/\s*:\s*/),y=v[0].trim(),_=v[1].trim();y==="stop-color"?l=_:y==="stop-opacity"&&(f=_)}}return l||(l=s.getAttribute("stop-color")||"rgb(0,0,0)"),f||(f=s.getAttribute("stop-opacity")),l=new S.Color(l),h=l.getAlpha(),f=isNaN(parseFloat(f))?1:parseFloat(f),f*=h*r,{offset:u,color:l.toRgb(),opacity:f}}function t(s){return{x1:s.getAttribute("x1")||0,y1:s.getAttribute("y1")||0,x2:s.getAttribute("x2")||"100%",y2:s.getAttribute("y2")||0}}function i(s){return{x1:s.getAttribute("fx")||s.getAttribute("cx")||"50%",y1:s.getAttribute("fy")||s.getAttribute("cy")||"50%",r1:0,x2:s.getAttribute("cx")||"50%",y2:s.getAttribute("cy")||"50%",r2:s.getAttribute("r")||"50%"}}var o=S.util.object.clone;S.Gradient=S.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(s){s||(s={}),s.coords||(s.coords={});var r,a=this;Object.keys(s).forEach(function(u){a[u]=s[u]}),this.id?this.id+="_"+S.Object.__uid++:this.id=S.Object.__uid++,r={x1:s.coords.x1||0,y1:s.coords.y1||0,x2:s.coords.x2||0,y2:s.coords.y2||0},this.type==="radial"&&(r.r1=s.coords.r1||0,r.r2=s.coords.r2||0),this.coords=r,this.colorStops=s.colorStops.slice()},addColorStop:function(s){for(var r in s){var a=new S.Color(s[r]);this.colorStops.push({offset:parseFloat(r),color:a.toRgb(),opacity:a.getAlpha()})}return this},toObject:function(s){var r={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return S.util.populateWithProperties(this,r,s),r},toSVG:function(s,h){var a=o(this.coords,!0),u,l,h=h||{},f,g,p=o(this.colorStops,!0),v=a.r1>a.r2,y=this.gradientTransform?this.gradientTransform.concat():S.iMatrix.concat(),_=-this.offsetX,T=-this.offsetY,P=!!h.additionalTransform,F=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(p.sort(function(tt,rt){return tt.offset-rt.offset}),F==="objectBoundingBox"?(_/=s.width,T/=s.height):(_+=s.width/2,T+=s.height/2),s.type==="path"&&this.gradientUnits!=="percentage"&&(_-=s.pathOffset.x,T-=s.pathOffset.y),y[4]-=_,y[5]-=T,g='id="SVGID_'+this.id+'" gradientUnits="'+F+'"',g+=' gradientTransform="'+(P?h.additionalTransform+" ":"")+S.util.matrixToSVG(y)+'" ',this.type==="linear"?f=["<linearGradient ",g,' x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,`">
`]:this.type==="radial"&&(f=["<radialGradient ",g,' cx="',v?a.x1:a.x2,'" cy="',v?a.y1:a.y2,'" r="',v?a.r1:a.r2,'" fx="',v?a.x2:a.x1,'" fy="',v?a.y2:a.y1,`">
`]),this.type==="radial"){if(v)for(p=p.concat(),p.reverse(),u=0,l=p.length;u<l;u++)p[u].offset=1-p[u].offset;var j=Math.min(a.r1,a.r2);if(j>0){var Z=Math.max(a.r1,a.r2),Q=j/Z;for(u=0,l=p.length;u<l;u++)p[u].offset+=Q*(1-p[u].offset)}}for(u=0,l=p.length;u<l;u++){var $=p[u];f.push("<stop ",'offset="',$.offset*100+"%",'" style="stop-color:',$.color,typeof $.opacity<"u"?";stop-opacity: "+$.opacity:";",`"/>
`)}return f.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),f.join("")},toLive:function(s){var r,a=S.util.object.clone(this.coords),u,l;if(this.type){for(this.type==="linear"?r=s.createLinearGradient(a.x1,a.y1,a.x2,a.y2):this.type==="radial"&&(r=s.createRadialGradient(a.x1,a.y1,a.r1,a.x2,a.y2,a.r2)),u=0,l=this.colorStops.length;u<l;u++){var h=this.colorStops[u].color,f=this.colorStops[u].opacity,g=this.colorStops[u].offset;typeof f<"u"&&(h=new S.Color(h).setAlpha(f).toRgba()),r.addColorStop(g,h)}return r}}}),S.util.object.extend(S.Gradient,{fromElement:function(s,r,a,u){var l=parseFloat(a)/(/%$/.test(a)?100:1);l=l<0?0:l>1?1:l,isNaN(l)&&(l=1);var h=s.getElementsByTagName("stop"),f,g=s.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",p=s.getAttribute("gradientTransform")||"",v=[],y,_,T=0,P=0,F;for(s.nodeName==="linearGradient"||s.nodeName==="LINEARGRADIENT"?(f="linear",y=t(s)):(f="radial",y=i(s)),_=h.length;_--;)v.push(e(h[_],l));F=S.parseTransformAttribute(p),n(r,y,u,g),g==="pixels"&&(T=-r.left,P=-r.top);var j=new S.Gradient({id:s.getAttribute("id"),type:f,coords:y,colorStops:v,gradientUnits:g,gradientTransform:F,offsetX:T,offsetY:P});return j}});function n(s,r,a,u){var l,h;Object.keys(r).forEach(function(f){l=r[f],l==="Infinity"?h=1:l==="-Infinity"?h=0:(h=parseFloat(r[f],10),typeof l=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(l)&&(h*=.01,u==="pixels"&&((f==="x1"||f==="x2"||f==="r2")&&(h*=a.viewBoxWidth||a.width),(f==="y1"||f==="y2")&&(h*=a.viewBoxHeight||a.height)))),r[f]=h})}})();(function(){"use strict";var e=S.util.toFixed;S.Pattern=S.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(t,i){if(t||(t={}),this.id=S.Object.__uid++,this.setOptions(t),!t.source||t.source&&typeof t.source!="string"){i&&i(this);return}else{var o=this;this.source=S.util.createImage(),S.util.loadImage(t.source,function(n,s){o.source=n,i&&i(o,s)},null,this.crossOrigin)}},toObject:function(t){var i=S.Object.NUM_FRACTION_DIGITS,o,n;return typeof this.source.src=="string"?o=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(o=this.source.toDataURL()),n={type:"pattern",source:o,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:e(this.offsetX,i),offsetY:e(this.offsetY,i),patternTransform:this.patternTransform?this.patternTransform.concat():null},S.util.populateWithProperties(this,n,t),n},toSVG:function(t){var i=typeof this.source=="function"?this.source():this.source,o=i.width/t.width,n=i.height/t.height,s=this.offsetX/t.width,r=this.offsetY/t.height,a="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(n=1,r&&(n+=Math.abs(r))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(o=1,s&&(o+=Math.abs(s))),i.src?a=i.src:i.toDataURL&&(a=i.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+s+'" y="'+r+'" width="'+o+'" height="'+n+`">
<image x="0" y="0" width="`+i.width+'" height="'+i.height+'" xlink:href="'+a+`"></image>
</pattern>
`},setOptions:function(t){for(var i in t)this[i]=t[i]},toLive:function(t){var i=this.source;return!i||typeof i.src<"u"&&(!i.complete||i.naturalWidth===0||i.naturalHeight===0)?"":t.createPattern(i,this.repeat)}})})();(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.toFixed;if(t.Shadow){t.warn("fabric.Shadow is already defined.");return}t.Shadow=t.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(o){typeof o=="string"&&(o=this._parseShadow(o));for(var n in o)this[n]=o[n];this.id=t.Object.__uid++},_parseShadow:function(o){var n=o.trim(),s=t.Shadow.reOffsetsAndBlur.exec(n)||[],r=n.replace(t.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:r.trim(),offsetX:parseFloat(s[1],10)||0,offsetY:parseFloat(s[2],10)||0,blur:parseFloat(s[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(o){var n=40,s=40,r=t.Object.NUM_FRACTION_DIGITS,a=t.util.rotateVector({x:this.offsetX,y:this.offsetY},t.util.degreesToRadians(-o.angle)),u=20,l=new t.Color(this.color);return o.width&&o.height&&(n=i((Math.abs(a.x)+this.blur)/o.width,r)*100+u,s=i((Math.abs(a.y)+this.blur)/o.height,r)*100+u),o.flipX&&(a.x*=-1),o.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+n+'%" width="'+(100+2*n)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+i(this.blur?this.blur/2:0,r)+`"></feGaussianBlur>
	<feOffset dx="`+i(a.x,r)+'" dy="'+i(a.y,r)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+l.toRgb()+'" flood-opacity="'+l.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var o={},n=t.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(s){this[s]!==n[s]&&(o[s]=this[s])},this),o}}),t.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/})(ht);(function(){"use strict";if(S.StaticCanvas){S.warn("fabric.StaticCanvas is already defined.");return}var e=S.util.object.extend,t=S.util.getElementOffset,i=S.util.removeFromArray,o=S.util.toFixed,n=S.util.transformPoint,s=S.util.invertTransform,r=S.util.getNodeCanvas,a=S.util.createCanvasElement,u=new Error("Could not initialize `canvas` element");S.StaticCanvas=S.util.createClass(S.CommonMethods,{initialize:function(l,h){h||(h={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(l,h)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:S.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(l,h){var f=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(l),this._initOptions(h),this.interactive||this._initRetinaScaling(),h.overlayImage&&this.setOverlayImage(h.overlayImage,f),h.backgroundImage&&this.setBackgroundImage(h.backgroundImage,f),h.backgroundColor&&this.setBackgroundColor(h.backgroundColor,f),h.overlayColor&&this.setOverlayColor(h.overlayColor,f),this.calcOffset()},_isRetinaScaling:function(){return S.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,S.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var l=S.devicePixelRatio;this.__initRetinaScaling(l,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(l,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(l,h,f){h.setAttribute("width",this.width*l),h.setAttribute("height",this.height*l),f.scale(l,l)},calcOffset:function(){return this._offset=t(this.lowerCanvasEl),this},setOverlayImage:function(l,h,f){return this.__setBgOverlayImage("overlayImage",l,h,f)},setBackgroundImage:function(l,h,f){return this.__setBgOverlayImage("backgroundImage",l,h,f)},setOverlayColor:function(l,h){return this.__setBgOverlayColor("overlayColor",l,h)},setBackgroundColor:function(l,h){return this.__setBgOverlayColor("backgroundColor",l,h)},__setBgOverlayImage:function(l,h,f,g){return typeof h=="string"?S.util.loadImage(h,function(p,v){if(p){var y=new S.Image(p,g);this[l]=y,y.canvas=this}f&&f(p,v)},this,g&&g.crossOrigin):(g&&h.setOptions(g),this[l]=h,h&&(h.canvas=this),f&&f(h,!1)),this},__setBgOverlayColor:function(l,h,f){return this[l]=h,this._initGradient(h,l),this._initPattern(h,l,f),this},_createCanvasElement:function(){var l=a();if(!l||(l.style||(l.style={}),typeof l.getContext>"u"))throw u;return l},_initOptions:function(l){var h=this.lowerCanvasEl;this._setOptions(l),this.width=this.width||parseInt(h.width,10)||0,this.height=this.height||parseInt(h.height,10)||0,this.lowerCanvasEl.style&&(h.width=this.width,h.height=this.height,h.style.width=this.width+"px",h.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(l){l&&l.getContext?this.lowerCanvasEl=l:this.lowerCanvasEl=S.util.getById(l)||this._createCanvasElement(),S.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(l,h){return this.setDimensions({width:l},h)},setHeight:function(l,h){return this.setDimensions({height:l},h)},setDimensions:function(l,h){var f;h=h||{};for(var g in l)f=l[g],h.cssOnly||(this._setBackstoreDimension(g,l[g]),f+="px",this.hasLostContext=!0),h.backstoreOnly||this._setCssDimension(g,f);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),h.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(l,h){return this.lowerCanvasEl[l]=h,this.upperCanvasEl&&(this.upperCanvasEl[l]=h),this.cacheCanvasEl&&(this.cacheCanvasEl[l]=h),this[l]=h,this},_setCssDimension:function(l,h){return this.lowerCanvasEl.style[l]=h,this.upperCanvasEl&&(this.upperCanvasEl.style[l]=h),this.wrapperEl&&(this.wrapperEl.style[l]=h),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(l){var h=this._activeObject,f=this.backgroundImage,g=this.overlayImage,p,v,y;for(this.viewportTransform=l,v=0,y=this._objects.length;v<y;v++)p=this._objects[v],p.group||p.setCoords(!0);return h&&h.setCoords(),f&&f.setCoords(!0),g&&g.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(l,h){var f=l,g=this.viewportTransform.slice(0);l=n(l,s(this.viewportTransform)),g[0]=h,g[3]=h;var p=n(l,g);return g[4]+=f.x-p.x,g[5]+=f.y-p.y,this.setViewportTransform(g)},setZoom:function(l){return this.zoomToPoint(new S.Point(0,0),l),this},absolutePan:function(l){var h=this.viewportTransform.slice(0);return h[4]=-l.x,h[5]=-l.y,this.setViewportTransform(h)},relativePan:function(l){return this.absolutePan(new S.Point(-l.x-this.viewportTransform[4],-l.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(l){this.stateful&&l.setupState(),l._set("canvas",this),l.setCoords(),this.fire("object:added",{target:l}),l.fire("added")},_onObjectRemoved:function(l){this.fire("object:removed",{target:l}),l.fire("removed"),delete l.canvas},clearContext:function(l){return l.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var l=this.contextContainer;return this.renderCanvas(l,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=S.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var l={},h=this.width,f=this.height,g=s(this.viewportTransform);return l.tl=n({x:0,y:0},g),l.br=n({x:h,y:f},g),l.tr=new S.Point(l.br.x,l.tl.y),l.bl=new S.Point(l.tl.x,l.br.y),this.vptCoords=l,l},cancelRequestedRender:function(){this.isRendering&&(S.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(l,h){var f=this.viewportTransform,g=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(l),S.util.setImageSmoothing(l,this.imageSmoothingEnabled),this.fire("before:render",{ctx:l}),this._renderBackground(l),l.save(),l.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._renderObjects(l,h),l.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(l),g&&(g.canvas=this,g.shouldCache(),g._transformDone=!0,g.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(l)),this._renderOverlay(l),this.controlsAboveOverlay&&this.interactive&&this.drawControls(l),this.fire("after:render",{ctx:l})},drawClipPathOnCanvas:function(l){var h=this.viewportTransform,f=this.clipPath;l.save(),l.transform(h[0],h[1],h[2],h[3],h[4],h[5]),l.globalCompositeOperation="destination-in",f.transform(l),l.scale(1/f.zoomX,1/f.zoomY),l.drawImage(f._cacheCanvas,-f.cacheTranslationX,-f.cacheTranslationY),l.restore()},_renderObjects:function(l,h){var f,g;for(f=0,g=h.length;f<g;++f)h[f]&&h[f].render(l)},_renderBackgroundOrOverlay:function(l,h){var f=this[h+"Color"],g=this[h+"Image"],p=this.viewportTransform,v=this[h+"Vpt"];if(!(!f&&!g)){if(f){l.save(),l.beginPath(),l.moveTo(0,0),l.lineTo(this.width,0),l.lineTo(this.width,this.height),l.lineTo(0,this.height),l.closePath(),l.fillStyle=f.toLive?f.toLive(l,this):f,v&&l.transform(p[0],p[1],p[2],p[3],p[4],p[5]),l.transform(1,0,0,1,f.offsetX||0,f.offsetY||0);var y=f.gradientTransform||f.patternTransform;y&&l.transform(y[0],y[1],y[2],y[3],y[4],y[5]),l.fill(),l.restore()}g&&(l.save(),v&&l.transform(p[0],p[1],p[2],p[3],p[4],p[5]),g.render(l),l.restore())}},_renderBackground:function(l){this._renderBackgroundOrOverlay(l,"background")},_renderOverlay:function(l){this._renderBackgroundOrOverlay(l,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new S.Point(this.width/2,this.height/2)},centerObjectH:function(l){return this._centerObject(l,new S.Point(this.getCenterPoint().x,l.getCenterPoint().y))},centerObjectV:function(l){return this._centerObject(l,new S.Point(l.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(l){var h=this.getCenterPoint();return this._centerObject(l,h)},viewportCenterObject:function(l){var h=this.getVpCenter();return this._centerObject(l,h)},viewportCenterObjectH:function(l){var h=this.getVpCenter();return this._centerObject(l,new S.Point(h.x,l.getCenterPoint().y)),this},viewportCenterObjectV:function(l){var h=this.getVpCenter();return this._centerObject(l,new S.Point(l.getCenterPoint().x,h.y))},getVpCenter:function(){var l=this.getCenterPoint(),h=s(this.viewportTransform);return n(l,h)},_centerObject:function(l,h){return l.setPositionByOrigin(h,"center","center"),l.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(l){return this.toDatalessObject(l)},toObject:function(l){return this._toObjectMethod("toObject",l)},toDatalessObject:function(l){return this._toObjectMethod("toDatalessObject",l)},_toObjectMethod:function(l,h){var f=this.clipPath,g={version:S.version,objects:this._toObjects(l,h)};return f&&!f.excludeFromExport&&(g.clipPath=this._toObject(this.clipPath,l,h)),e(g,this.__serializeBgOverlay(l,h)),S.util.populateWithProperties(this,g,h),g},_toObjects:function(l,h){return this._objects.filter(function(f){return!f.excludeFromExport}).map(function(f){return this._toObject(f,l,h)},this)},_toObject:function(l,h,f){var g;this.includeDefaultValues||(g=l.includeDefaultValues,l.includeDefaultValues=!1);var p=l[h](f);return this.includeDefaultValues||(l.includeDefaultValues=g),p},__serializeBgOverlay:function(l,h){var f={},g=this.backgroundImage,p=this.overlayImage,v=this.backgroundColor,y=this.overlayColor;return v&&v.toObject?v.excludeFromExport||(f.background=v.toObject(h)):v&&(f.background=v),y&&y.toObject?y.excludeFromExport||(f.overlay=y.toObject(h)):y&&(f.overlay=y),g&&!g.excludeFromExport&&(f.backgroundImage=this._toObject(g,l,h)),p&&!p.excludeFromExport&&(f.overlayImage=this._toObject(p,l,h)),f},svgViewportTransformation:!0,toSVG:function(l,h){l||(l={}),l.reviver=h;var f=[];return this._setSVGPreamble(f,l),this._setSVGHeader(f,l),this.clipPath&&f.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(f,"background"),this._setSVGBgOverlayImage(f,"backgroundImage",h),this._setSVGObjects(f,h),this.clipPath&&f.push(`</g>
`),this._setSVGBgOverlayColor(f,"overlay"),this._setSVGBgOverlayImage(f,"overlayImage",h),f.push("</svg>"),f.join("")},_setSVGPreamble:function(l,h){h.suppressPreamble||l.push('<?xml version="1.0" encoding="',h.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(l,h){var f=h.width||this.width,g=h.height||this.height,p,v='viewBox="0 0 '+this.width+" "+this.height+'" ',y=S.Object.NUM_FRACTION_DIGITS;h.viewBox?v='viewBox="'+h.viewBox.x+" "+h.viewBox.y+" "+h.viewBox.width+" "+h.viewBox.height+'" ':this.svgViewportTransformation&&(p=this.viewportTransform,v='viewBox="'+o(-p[4]/p[0],y)+" "+o(-p[5]/p[3],y)+" "+o(this.width/p[0],y)+" "+o(this.height/p[3],y)+'" '),l.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',f,'" ','height="',g,'" ',v,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",S.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(h),`</defs>
`)},createSVGClipPathMarkup:function(l){var h=this.clipPath;return h?(h.clipPathId="CLIPPATH_"+S.Object.__uid++,'<clipPath id="'+h.clipPathId+`" >
`+this.clipPath.toClipPathSVG(l.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var l=this,h=["background","overlay"].map(function(f){var g=l[f+"Color"];if(g&&g.toLive){var p=l[f+"Vpt"],v=l.viewportTransform,y={width:l.width/(p?v[0]:1),height:l.height/(p?v[3]:1)};return g.toSVG(y,{additionalTransform:p?S.util.matrixToSVG(v):""})}});return h.join("")},createSVGFontFacesMarkup:function(){var l="",h={},f,g,p,v,y,_,T,P,F,j=S.fontPaths,Z=[];for(this._objects.forEach(function $(tt){Z.push(tt),tt._objects&&tt._objects.forEach($)}),P=0,F=Z.length;P<F;P++)if(f=Z[P],g=f.fontFamily,!(f.type.indexOf("text")===-1||h[g]||!j[g])&&(h[g]=!0,!!f.styles)){p=f.styles;for(y in p){v=p[y];for(T in v)_=v[T],g=_.fontFamily,!h[g]&&j[g]&&(h[g]=!0)}}for(var Q in h)l+=[`		@font-face {
`,"			font-family: '",Q,`';
`,"			src: url('",j[Q],`');
`,`		}
`].join("");return l&&(l=['	<style type="text/css">',`<![CDATA[
`,l,"]]>",`</style>
`].join("")),l},_setSVGObjects:function(l,h){var f,g,p,v=this._objects;for(g=0,p=v.length;g<p;g++)f=v[g],!f.excludeFromExport&&this._setSVGObject(l,f,h)},_setSVGObject:function(l,h,f){l.push(h.toSVG(f))},_setSVGBgOverlayImage:function(l,h,f){this[h]&&!this[h].excludeFromExport&&this[h].toSVG&&l.push(this[h].toSVG(f))},_setSVGBgOverlayColor:function(l,h){var f=this[h+"Color"],g=this.viewportTransform,p=this.width,v=this.height;if(f)if(f.toLive){var y=f.repeat,_=S.util.invertTransform(g),T=this[h+"Vpt"],P=T?S.util.matrixToSVG(_):"";l.push('<rect transform="'+P+" translate(",p/2,",",v/2,')"',' x="',f.offsetX-p/2,'" y="',f.offsetY-v/2,'" ','width="',y==="repeat-y"||y==="no-repeat"?f.source.width:p,'" height="',y==="repeat-x"||y==="no-repeat"?f.source.height:v,'" fill="url(#SVGID_'+f.id+')"',`></rect>
`)}else l.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',f,'"',`></rect>
`)},sendToBack:function(l){if(!l)return this;var h=this._activeObject,f,g,p;if(l===h&&l.type==="activeSelection")for(p=h._objects,f=p.length;f--;)g=p[f],i(this._objects,g),this._objects.unshift(g);else i(this._objects,l),this._objects.unshift(l);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(l){if(!l)return this;var h=this._activeObject,f,g,p;if(l===h&&l.type==="activeSelection")for(p=h._objects,f=0;f<p.length;f++)g=p[f],i(this._objects,g),this._objects.push(g);else i(this._objects,l),this._objects.push(l);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(l,h){if(!l)return this;var f=this._activeObject,g,p,v,y,_,T=0;if(l===f&&l.type==="activeSelection")for(_=f._objects,g=0;g<_.length;g++)p=_[g],v=this._objects.indexOf(p),v>0+T&&(y=v-1,i(this._objects,p),this._objects.splice(y,0,p)),T++;else v=this._objects.indexOf(l),v!==0&&(y=this._findNewLowerIndex(l,v,h),i(this._objects,l),this._objects.splice(y,0,l));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(l,h,f){var g,p;if(f)for(g=h,p=h-1;p>=0;--p){var v=l.intersectsWithObject(this._objects[p])||l.isContainedWithinObject(this._objects[p])||this._objects[p].isContainedWithinObject(l);if(v){g=p;break}}else g=h-1;return g},bringForward:function(l,h){if(!l)return this;var f=this._activeObject,g,p,v,y,_,T=0;if(l===f&&l.type==="activeSelection")for(_=f._objects,g=_.length;g--;)p=_[g],v=this._objects.indexOf(p),v<this._objects.length-1-T&&(y=v+1,i(this._objects,p),this._objects.splice(y,0,p)),T++;else v=this._objects.indexOf(l),v!==this._objects.length-1&&(y=this._findNewUpperIndex(l,v,h),i(this._objects,l),this._objects.splice(y,0,l));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(l,h,f){var g,p,v;if(f)for(g=h,p=h+1,v=this._objects.length;p<v;++p){var y=l.intersectsWithObject(this._objects[p])||l.isContainedWithinObject(this._objects[p])||this._objects[p].isContainedWithinObject(l);if(y){g=p;break}}else g=h+1;return g},moveTo:function(l,h){return i(this._objects,l),this._objects.splice(h,0,l),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(S.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(l){l.dispose&&l.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),S.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),S.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),e(S.StaticCanvas.prototype,S.Observable),e(S.StaticCanvas.prototype,S.Collection),e(S.StaticCanvas.prototype,S.DataURLExporter),e(S.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(l){var h=a();if(!h||!h.getContext)return null;var f=h.getContext("2d");if(!f)return null;switch(l){case"setLineDash":return typeof f.setLineDash<"u";default:return null}}}),S.StaticCanvas.prototype.toJSON=S.StaticCanvas.prototype.toObject,S.isLikelyNode&&(S.StaticCanvas.prototype.createPNGStream=function(){var l=r(this.lowerCanvasEl);return l&&l.createPNGStream()},S.StaticCanvas.prototype.createJPEGStream=function(l){var h=r(this.lowerCanvasEl);return h&&h.createJPEGStream(l)})})();S.BaseBrush=S.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(e){e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.miterLimit=this.strokeMiterLimit,e.lineJoin=this.strokeLineJoin,e.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(e){var t=this.canvas.viewportTransform;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5])},_setShadow:function(){if(this.shadow){var e=this.canvas,t=this.shadow,i=e.contextTop,o=e.getZoom();e&&e._isRetinaScaling()&&(o*=S.devicePixelRatio),i.shadowColor=t.color,i.shadowBlur=t.blur*o,i.shadowOffsetX=t.offsetX*o,i.shadowOffsetY=t.offsetY*o}},needsFullRender:function(){var e=new S.Color(this.color);return e.getAlpha()<1||!!this.shadow},_resetShadow:function(){var e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0},_isOutSideCanvas:function(e){return e.x<0||e.x>this.canvas.getWidth()||e.y<0||e.y>this.canvas.getHeight()}});(function(){S.PencilBrush=S.util.createClass(S.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(e){this.canvas=e,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(e,t,i){var o=t.midPointFrom(i);return e.quadraticCurveTo(t.x,t.y,o.x,o.y),o},onMouseDown:function(e,t){this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],this._prepareForDrawing(e),this._captureDrawingPath(e),this._render())},onMouseMove:function(e,t){if(this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e))&&this._captureDrawingPath(e)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var i=this._points,o=i.length,n=this.canvas.contextTop;this._saveAndTransform(n),this.oldEnd&&(n.beginPath(),n.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(n,i[o-2],i[o-1],!0),n.stroke(),n.restore()}},onMouseUp:function(e){return this.canvas._isMainEvent(e.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(e){var t=new S.Point(e.x,e.y);this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)},_addPoint:function(e){return this._points.length>1&&e.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(e),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(e){var t=new S.Point(e.x,e.y);return this._addPoint(t)},_render:function(e){var t,i,o=this._points[0],n=this._points[1];if(e=e||this.canvas.contextTop,this._saveAndTransform(e),e.beginPath(),this._points.length===2&&o.x===n.x&&o.y===n.y){var s=this.width/1e3;o=new S.Point(o.x,o.y),n=new S.Point(n.x,n.y),o.x-=s,n.x+=s}for(e.moveTo(o.x,o.y),t=1,i=this._points.length;t<i;t++)this._drawSegment(e,o,n),o=this._points[t],n=this._points[t+1];e.lineTo(o.x,o.y),e.stroke(),e.restore()},convertPointsToSVGPath:function(e){var t=this.width/1e3;return S.util.getSmoothPathFromPoints(e,t)},_isEmptySVGPath:function(e){var t=S.util.joinPath(e);return t==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(e){var t=new S.Path(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.shadow=new S.Shadow(this.shadow)),t},decimatePoints:function(e,t){if(e.length<=2)return e;var i=this.canvas.getZoom(),o=Math.pow(t/i,2),n,s=e.length-1,r=e[0],a=[r],u;for(n=1;n<s-1;n++)u=Math.pow(r.x-e[n].x,2)+Math.pow(r.y-e[n].y,2),u>=o&&(r=e[n],a.push(r));return a.push(e[s]),a},_finalizeAndAddPath:function(){var e=this.canvas.contextTop;e.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var t=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(t)){this.canvas.requestRenderAll();return}var i=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:i}),this.canvas.add(i),this.canvas.requestRenderAll(),i.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:i})}})})();S.CircleBrush=S.util.createClass(S.BaseBrush,{width:10,initialize:function(e){this.canvas=e,this.points=[]},drawDot:function(e){var t=this.addPoint(e),i=this.canvas.contextTop;this._saveAndTransform(i),this.dot(i,t),i.restore()},dot:function(e,t){e.fillStyle=t.fill,e.beginPath(),e.arc(t.x,t.y,t.radius,0,Math.PI*2,!1),e.closePath(),e.fill()},onMouseDown:function(e){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(e)},_render:function(){var e=this.canvas.contextTop,t,i,o=this.points;for(this._saveAndTransform(e),t=0,i=o.length;t<i;t++)this.dot(e,o[t]);e.restore()},onMouseMove:function(e){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(e),this._render()):this.drawDot(e))},onMouseUp:function(){var e=this.canvas.renderOnAddRemove,t,i;this.canvas.renderOnAddRemove=!1;var o=[];for(t=0,i=this.points.length;t<i;t++){var n=this.points[t],s=new S.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&(s.shadow=new S.Shadow(this.shadow)),o.push(s)}var r=new S.Group(o);r.canvas=this.canvas,this.canvas.fire("before:path:created",{path:r}),this.canvas.add(r),this.canvas.fire("path:created",{path:r}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()},addPoint:function(e){var t=new S.Point(e.x,e.y),i=S.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,o=new S.Color(this.color).setAlpha(S.util.getRandomInt(0,100)/100).toRgba();return t.radius=i,t.fill=o,this.points.push(t),t}});S.SprayBrush=S.util.createClass(S.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(e){this.canvas=e,this.sprayChunks=[]},onMouseDown:function(e){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(e),this.render(this.sprayChunkPoints)},onMouseMove:function(e){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e)||(this.addSprayChunk(e),this.render(this.sprayChunkPoints))},onMouseUp:function(){var e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var t=[],i=0,o=this.sprayChunks.length;i<o;i++)for(var n=this.sprayChunks[i],s=0,r=n.length;s<r;s++){var a=new S.Rect({width:n[s].width,height:n[s].width,left:n[s].x+1,top:n[s].y+1,originX:"center",originY:"center",fill:this.color});t.push(a)}this.optimizeOverlapping&&(t=this._getOptimizedRects(t));var u=new S.Group(t);this.shadow&&u.set("shadow",new S.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:u}),this.canvas.add(u),this.canvas.fire("path:created",{path:u}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()},_getOptimizedRects:function(e){var t={},i,o,n;for(o=0,n=e.length;o<n;o++)i=e[o].left+""+e[o].top,t[i]||(t[i]=e[o]);var s=[];for(i in t)s.push(t[i]);return s},render:function(e){var t=this.canvas.contextTop,i,o;for(t.fillStyle=this.color,this._saveAndTransform(t),i=0,o=e.length;i<o;i++){var n=e[i];typeof n.opacity<"u"&&(t.globalAlpha=n.opacity),t.fillRect(n.x,n.y,n.width,n.width)}t.restore()},_render:function(){var e=this.canvas.contextTop,t,i;for(e.fillStyle=this.color,this._saveAndTransform(e),t=0,i=this.sprayChunks.length;t<i;t++)this.render(this.sprayChunks[t]);e.restore()},addSprayChunk:function(e){this.sprayChunkPoints=[];var t,i,o,n=this.width/2,s;for(s=0;s<this.density;s++){t=S.util.getRandomInt(e.x-n,e.x+n),i=S.util.getRandomInt(e.y-n,e.y+n),this.dotWidthVariance?o=S.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):o=this.dotWidth;var r=new S.Point(t,i);r.width=o,this.randomOpacity&&(r.opacity=S.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(r)}this.sprayChunks.push(this.sprayChunkPoints)}});S.PatternBrush=S.util.createClass(S.PencilBrush,{getPatternSrc:function(){var e=20,t=5,i=S.util.createCanvasElement(),o=i.getContext("2d");return i.width=i.height=e+t,o.fillStyle=this.color,o.beginPath(),o.arc(e/2,e/2,e/2,0,Math.PI*2,!1),o.closePath(),o.fill(),i},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(e){return e.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(e){this.callSuper("_setBrushStyles",e),e.strokeStyle=this.getPattern(e)},createPath:function(e){var t=this.callSuper("createPath",e),i=t._getLeftTopCoords().scalarAdd(t.strokeWidth/2);return t.stroke=new S.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-i.x,offsetY:-i.y}),t}});(function(){var e=S.util.getPointer,t=S.util.degreesToRadians,i=S.util.isTouchEvent;S.Canvas=S.util.createClass(S.StaticCanvas,{initialize:function(n,s){s||(s={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(n,s),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=S.PencilBrush&&new S.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var n=this.getActiveObjects(),s,r,a;if(n.length>0&&!this.preserveObjectStacking){r=[],a=[];for(var u=0,l=this._objects.length;u<l;u++)s=this._objects[u],n.indexOf(s)===-1?r.push(s):a.push(s);n.length>1&&(this._activeObject._objects=a),r.push.apply(r,a)}else r=this._objects;return r},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var n=this.contextContainer;return this.renderCanvas(n,this._chooseObjectsToRender()),this},renderTopLayer:function(n){n.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(n),this.contextTopDirty=!0),n.restore()},renderTop:function(){var n=this.contextTop;return this.clearContext(n),this.renderTopLayer(n),this.fire("after:render"),this},_normalizePointer:function(n,s){var r=n.calcTransformMatrix(),a=S.util.invertTransform(r),u=this.restorePointerVpt(s);return S.util.transformPoint(u,a)},isTargetTransparent:function(n,s,r){if(n.shouldCache()&&n._cacheCanvas&&n!==this._activeObject){var a=this._normalizePointer(n,{x:s,y:r}),u=Math.max(n.cacheTranslationX+a.x*n.zoomX,0),l=Math.max(n.cacheTranslationY+a.y*n.zoomY,0),p=S.util.isTransparent(n._cacheContext,Math.round(u),Math.round(l),this.targetFindTolerance);return p}var h=this.contextCache,f=n.selectionBackgroundColor,g=this.viewportTransform;n.selectionBackgroundColor="",this.clearContext(h),h.save(),h.transform(g[0],g[1],g[2],g[3],g[4],g[5]),n.render(h),h.restore(),n.selectionBackgroundColor=f;var p=S.util.isTransparent(h,s,r,this.targetFindTolerance);return p},_isSelectionKeyPressed:function(n){var s=!1;return Array.isArray(this.selectionKey)?s=!!this.selectionKey.find(function(r){return n[r]===!0}):s=n[this.selectionKey],s},_shouldClearSelection:function(n,s){var r=this.getActiveObjects(),a=this._activeObject;return!s||s&&a&&r.length>1&&r.indexOf(s)===-1&&a!==s&&!this._isSelectionKeyPressed(n)||s&&!s.evented||s&&!s.selectable&&a&&a!==s},_shouldCenterTransform:function(n,s,r){if(n){var a;return s==="scale"||s==="scaleX"||s==="scaleY"||s==="resizing"?a=this.centeredScaling||n.centeredScaling:s==="rotate"&&(a=this.centeredRotation||n.centeredRotation),a?!r:r}},_getOriginFromCorner:function(n,s){var r={x:n.originX,y:n.originY};return s==="ml"||s==="tl"||s==="bl"?r.x="right":(s==="mr"||s==="tr"||s==="br")&&(r.x="left"),s==="tl"||s==="mt"||s==="tr"?r.y="bottom":(s==="bl"||s==="mb"||s==="br")&&(r.y="top"),r},_getActionFromCorner:function(n,s,r,a){if(!s||!n)return"drag";var u=a.controls[s];return u.getActionName(r,u,a)},_setupCurrentTransform:function(n,s,r){if(s){var a=this.getPointer(n),u=s.__corner,l=s.controls[u],h=r&&u?l.getActionHandler(n,s,l):S.controlsUtils.dragHandler,f=this._getActionFromCorner(r,u,n,s),g=this._getOriginFromCorner(s,u),p=n[this.centeredKey],v={target:s,action:f,actionHandler:h,corner:u,scaleX:s.scaleX,scaleY:s.scaleY,skewX:s.skewX,skewY:s.skewY,offsetX:a.x-s.left,offsetY:a.y-s.top,originX:g.x,originY:g.y,ex:a.x,ey:a.y,lastX:a.x,lastY:a.y,theta:t(s.angle),width:s.width*s.scaleX,shiftKey:n.shiftKey,altKey:p,original:S.util.saveObjectTransform(s)};this._shouldCenterTransform(s,f,p)&&(v.originX="center",v.originY="center"),v.original.originX=g.x,v.original.originY=g.y,this._currentTransform=v,this._beforeTransform(n)}},setCursor:function(n){this.upperCanvasEl.style.cursor=n},_drawSelection:function(n){var s=this._groupSelector,r=new S.Point(s.ex,s.ey),a=S.util.transformPoint(r,this.viewportTransform),u=new S.Point(s.ex+s.left,s.ey+s.top),l=S.util.transformPoint(u,this.viewportTransform),h=Math.min(a.x,l.x),f=Math.min(a.y,l.y),g=Math.max(a.x,l.x),p=Math.max(a.y,l.y),v=this.selectionLineWidth/2;this.selectionColor&&(n.fillStyle=this.selectionColor,n.fillRect(h,f,g-h,p-f)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(n.lineWidth=this.selectionLineWidth,n.strokeStyle=this.selectionBorderColor,h+=v,f+=v,g-=v,p-=v,S.Object.prototype._setLineDash.call(this,n,this.selectionDashArray),n.strokeRect(h,f,g-h,p-f))},findTarget:function(n,s){if(!this.skipTargetFind){var r=!0,a=this.getPointer(n,r),u=this._activeObject,l=this.getActiveObjects(),h,f,g=i(n),p=l.length>1&&!s||l.length===1;if(this.targets=[],p&&u._findTargetCorner(a,g)||l.length>1&&!s&&u===this._searchPossibleTargets([u],a))return u;if(l.length===1&&u===this._searchPossibleTargets([u],a))if(this.preserveObjectStacking)h=u,f=this.targets,this.targets=[];else return u;var v=this._searchPossibleTargets(this._objects,a);return n[this.altSelectionKey]&&v&&h&&v!==h&&(v=h,this.targets=f),v}},_checkTarget:function(n,s,r){if(s&&s.visible&&s.evented&&s.containsPoint(n))if((this.perPixelTargetFind||s.perPixelTargetFind)&&!s.isEditing){var a=this.isTargetTransparent(s,r.x,r.y);if(!a)return!0}else return!0},_searchPossibleTargets:function(n,s){for(var r,a=n.length,u;a--;){var l=n[a],h=l.group?this._normalizePointer(l.group,s):s;if(this._checkTarget(h,l,s)){r=n[a],r.subTargetCheck&&r instanceof S.Group&&(u=this._searchPossibleTargets(r._objects,s),u&&this.targets.push(u));break}}return r},restorePointerVpt:function(n){return S.util.transformPoint(n,S.util.invertTransform(this.viewportTransform))},getPointer:function(n,s){if(this._absolutePointer&&!s)return this._absolutePointer;if(this._pointer&&s)return this._pointer;var r=e(n),a=this.upperCanvasEl,u=a.getBoundingClientRect(),l=u.width||0,h=u.height||0,f;(!l||!h)&&("top"in u&&"bottom"in u&&(h=Math.abs(u.top-u.bottom)),"right"in u&&"left"in u&&(l=Math.abs(u.right-u.left))),this.calcOffset(),r.x=r.x-this._offset.left,r.y=r.y-this._offset.top,s||(r=this.restorePointerVpt(r));var g=this.getRetinaScaling();return g!==1&&(r.x/=g,r.y/=g),l===0||h===0?f={width:1,height:1}:f={width:a.width/l,height:a.height/h},{x:r.x*f.width,y:r.y*f.height}},_createUpperCanvas:function(){var n=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),s=this.lowerCanvasEl,r=this.upperCanvasEl;r?r.className="":(r=this._createCanvasElement(),this.upperCanvasEl=r),S.util.addClass(r,"upper-canvas "+n),this.wrapperEl.appendChild(r),this._copyCanvasStyle(s,r),this._applyCanvasStyle(r),this.contextTop=r.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=S.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),S.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),S.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(n){var s=this.width||n.width,r=this.height||n.height;S.util.setStyle(n,{position:"absolute",width:s+"px",height:r+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),n.width=s,n.height=r,S.util.makeElementUnselectable(n)},_copyCanvasStyle:function(n,s){s.style.cssText=n.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var n=this._activeObject;return n?n.type==="activeSelection"&&n._objects?n._objects.slice(0):[n]:[]},_onObjectRemoved:function(n){n===this._activeObject&&(this.fire("before:selection:cleared",{target:n}),this._discardActiveObject(),this.fire("selection:cleared",{target:n}),n.fire("deselected")),n===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",n)},_fireSelectionEvents:function(n,s){var r=!1,a=this.getActiveObjects(),u=[],l=[];n.forEach(function(h){a.indexOf(h)===-1&&(r=!0,h.fire("deselected",{e:s,target:h}),l.push(h))}),a.forEach(function(h){n.indexOf(h)===-1&&(r=!0,h.fire("selected",{e:s,target:h}),u.push(h))}),n.length>0&&a.length>0?r&&this.fire("selection:updated",{e:s,selected:u,deselected:l}):a.length>0?this.fire("selection:created",{e:s,selected:u}):n.length>0&&this.fire("selection:cleared",{e:s,deselected:l})},setActiveObject:function(n,s){var r=this.getActiveObjects();return this._setActiveObject(n,s),this._fireSelectionEvents(r,s),this},_setActiveObject:function(n,s){return this._activeObject===n||!this._discardActiveObject(s,n)||n.onSelect({e:s})?!1:(this._activeObject=n,!0)},_discardActiveObject:function(n,s){var r=this._activeObject;if(r){if(r.onDeselect({e:n,object:s}))return!1;this._activeObject=null}return!0},discardActiveObject:function(n){var s=this.getActiveObjects(),r=this.getActiveObject();return s.length&&this.fire("before:selection:cleared",{target:r,e:n}),this._discardActiveObject(n),this._fireSelectionEvents(s,n),this},dispose:function(){var n=this.wrapperEl;return this.removeListeners(),n.removeChild(this.upperCanvasEl),n.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(s){S.util.cleanUpJsdomNode(this[s]),this[s]=void 0}.bind(this)),n.parentNode&&n.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,S.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(n){var s=this._activeObject;s&&s._renderControls(n)},_toObject:function(n,s,r){var a=this._realizeGroupTransformOnObject(n),u=this.callSuper("_toObject",n,s,r);return this._unwindGroupTransformOnObject(n,a),u},_realizeGroupTransformOnObject:function(n){if(n.group&&n.group.type==="activeSelection"&&this._activeObject===n.group){var s=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],r={};return s.forEach(function(a){r[a]=n[a]}),S.util.addTransformToObject(n,this._activeObject.calcOwnMatrix()),r}else return null},_unwindGroupTransformOnObject:function(n,s){s&&n.set(s)},_setSVGObject:function(n,s,r){var a=this._realizeGroupTransformOnObject(s);this.callSuper("_setSVGObject",n,s,r),this._unwindGroupTransformOnObject(s,a)},setViewportTransform:function(n){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),S.StaticCanvas.prototype.setViewportTransform.call(this,n)}});for(var o in S.StaticCanvas)o!=="prototype"&&(S.Canvas[o]=S.StaticCanvas[o])})();(function(){var e=S.util.addListener,t=S.util.removeListener,i=3,o=2,n=1,s={passive:!1};function r(a,u){return a.button&&a.button===u-1}S.util.object.extend(S.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(e,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(a,u){var l=this.upperCanvasEl,h=this._getEventPrefix();a(S.window,"resize",this._onResize),a(l,h+"down",this._onMouseDown),a(l,h+"move",this._onMouseMove,s),a(l,h+"out",this._onMouseOut),a(l,h+"enter",this._onMouseEnter),a(l,"wheel",this._onMouseWheel),a(l,"contextmenu",this._onContextMenu),a(l,"dblclick",this._onDoubleClick),a(l,"dragover",this._onDragOver),a(l,"dragenter",this._onDragEnter),a(l,"dragleave",this._onDragLeave),a(l,"drop",this._onDrop),this.enablePointerEvents||a(l,"touchstart",this._onTouchStart,s),typeof eventjs<"u"&&u in eventjs&&(eventjs[u](l,"gesture",this._onGesture),eventjs[u](l,"drag",this._onDrag),eventjs[u](l,"orientation",this._onOrientationChange),eventjs[u](l,"shake",this._onShake),eventjs[u](l,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(t,"remove");var a=this._getEventPrefix();t(S.document,a+"up",this._onMouseUp),t(S.document,"touchend",this._onTouchEnd,s),t(S.document,a+"move",this._onMouseMove,s),t(S.document,"touchmove",this._onMouseMove,s)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(a,u){this.__onTransformGesture&&this.__onTransformGesture(a,u)},_onDrag:function(a,u){this.__onDrag&&this.__onDrag(a,u)},_onMouseWheel:function(a){this.__onMouseWheel(a)},_onMouseOut:function(a){var u=this._hoveredTarget;this.fire("mouse:out",{target:u,e:a}),this._hoveredTarget=null,u&&u.fire("mouseout",{e:a});var l=this;this._hoveredTargets.forEach(function(h){l.fire("mouse:out",{target:u,e:a}),h&&u.fire("mouseout",{e:a})}),this._hoveredTargets=[]},_onMouseEnter:function(a){!this._currentTransform&&!this.findTarget(a)&&(this.fire("mouse:over",{target:null,e:a}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(a,u){this.__onOrientationChange&&this.__onOrientationChange(a,u)},_onShake:function(a,u){this.__onShake&&this.__onShake(a,u)},_onLongPress:function(a,u){this.__onLongPress&&this.__onLongPress(a,u)},_onDragOver:function(a){a.preventDefault();var u=this._simpleEventHandler("dragover",a);this._fireEnterLeaveEvents(u,a)},_onDrop:function(a){return this._simpleEventHandler("drop:before",a),this._simpleEventHandler("drop",a)},_onContextMenu:function(a){return this.stopContextMenu&&(a.stopPropagation(),a.preventDefault()),!1},_onDoubleClick:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"dblclick"),this._resetTransformEventData(a)},getPointerId:function(a){var u=a.changedTouches;return u?u[0]&&u[0].identifier:this.enablePointerEvents?a.pointerId:-1},_isMainEvent:function(a){return a.isPrimary===!0?!0:a.isPrimary===!1?!1:a.type==="touchend"&&a.touches.length===0?!0:a.changedTouches?a.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(a){a.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(a)),this.__onMouseDown(a),this._resetTransformEventData();var u=this.upperCanvasEl,l=this._getEventPrefix();e(S.document,"touchend",this._onTouchEnd,s),e(S.document,"touchmove",this._onMouseMove,s),t(u,l+"down",this._onMouseDown)},_onMouseDown:function(a){this.__onMouseDown(a),this._resetTransformEventData();var u=this.upperCanvasEl,l=this._getEventPrefix();t(u,l+"move",this._onMouseMove,s),e(S.document,l+"up",this._onMouseUp),e(S.document,l+"move",this._onMouseMove,s)},_onTouchEnd:function(a){if(!(a.touches.length>0)){this.__onMouseUp(a),this._resetTransformEventData(),this.mainTouchId=null;var u=this._getEventPrefix();t(S.document,"touchend",this._onTouchEnd,s),t(S.document,"touchmove",this._onMouseMove,s);var l=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){e(l.upperCanvasEl,u+"down",l._onMouseDown),l._willAddMouseDown=0},400)}},_onMouseUp:function(a){this.__onMouseUp(a),this._resetTransformEventData();var u=this.upperCanvasEl,l=this._getEventPrefix();this._isMainEvent(a)&&(t(S.document,l+"up",this._onMouseUp),t(S.document,l+"move",this._onMouseMove,s),e(u,l+"move",this._onMouseMove,s))},_onMouseMove:function(a){!this.allowTouchScrolling&&a.preventDefault&&a.preventDefault(),this.__onMouseMove(a)},_onResize:function(){this.calcOffset()},_shouldRender:function(a){var u=this._activeObject;return!!u!=!!a||u&&a&&u!==a?!0:(u&&u.isEditing,!1)},__onMouseUp:function(a){var u,l=this._currentTransform,h=this._groupSelector,f=!1,g=!h||h.left===0&&h.top===0;if(this._cacheTransformEventData(a),u=this._target,this._handleEvent(a,"up:before"),r(a,i)){this.fireRightClick&&this._handleEvent(a,"up",i,g);return}if(r(a,o)){this.fireMiddleClick&&this._handleEvent(a,"up",o,g),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(a);return}if(this._isMainEvent(a)){if(l&&(this._finalizeCurrentTransform(a),f=l.actionPerformed),!g){var p=u===this._activeObject;this._maybeGroupObjects(a),f||(f=this._shouldRender(u)||!p&&u===this._activeObject)}var v,y;if(u){if(v=u._findTargetCorner(this.getPointer(a,!0),S.util.isTouchEvent(a)),u.selectable&&u!==this._activeObject&&u.activeOn==="up")this.setActiveObject(u,a),f=!0;else{var _=u.controls[v],T=_&&_.getMouseUpHandler(a,u,_);T&&(y=this.getPointer(a),T(a,l,y.x,y.y))}u.isMoving=!1}if(l&&(l.target!==u||l.corner!==v)){var P=l.target&&l.target.controls[l.corner],F=P&&P.getMouseUpHandler(a,u,_);y=y||this.getPointer(a),F&&F(a,l,y.x,y.y)}this._setCursorFromEvent(a,u),this._handleEvent(a,"up",n,g),this._groupSelector=null,this._currentTransform=null,u&&(u.__corner=0),f?this.requestRenderAll():g||this.renderTop()}},_simpleEventHandler:function(a,u){var l=this.findTarget(u),h=this.targets,f={e:u,target:l,subTargets:h};if(this.fire(a,f),l&&l.fire(a,f),!h)return l;for(var g=0;g<h.length;g++)h[g].fire(a,f);return l},_handleEvent:function(a,u,l,h){var f=this._target,g=this.targets||[],p={e:a,target:f,subTargets:g,button:l||n,isClick:h||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};u==="up"&&(p.currentTarget=this.findTarget(a),p.currentSubTargets=this.targets),this.fire("mouse:"+u,p),f&&f.fire("mouse"+u,p);for(var v=0;v<g.length;v++)g[v].fire("mouse"+u,p)},_finalizeCurrentTransform:function(a){var u=this._currentTransform,l=u.target,h={e:a,target:l,transform:u,action:u.action};l._scaling&&(l._scaling=!1),l.setCoords(),(u.actionPerformed||this.stateful&&l.hasStateChanged())&&this._fire("modified",h)},_onMouseDownInDrawingMode:function(a){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(a).requestRenderAll();var u=this.getPointer(a);this.freeDrawingBrush.onMouseDown(u,{e:a,pointer:u}),this._handleEvent(a,"down")},_onMouseMoveInDrawingMode:function(a){if(this._isCurrentlyDrawing){var u=this.getPointer(a);this.freeDrawingBrush.onMouseMove(u,{e:a,pointer:u})}this.setCursor(this.freeDrawingCursor),this._handleEvent(a,"move")},_onMouseUpInDrawingMode:function(a){var u=this.getPointer(a);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:a,pointer:u}),this._handleEvent(a,"up")},__onMouseDown:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"down:before");var u=this._target;if(r(a,i)){this.fireRightClick&&this._handleEvent(a,"down",i);return}if(r(a,o)){this.fireMiddleClick&&this._handleEvent(a,"down",o);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(a);return}if(this._isMainEvent(a)&&!this._currentTransform){var l=this._pointer;this._previousPointer=l;var h=this._shouldRender(u),f=this._shouldGroup(a,u);if(this._shouldClearSelection(a,u)?this.discardActiveObject(a):f&&(this._handleGrouping(a,u),u=this._activeObject),this.selection&&(!u||!u.selectable&&!u.isEditing&&u!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),u){var g=u===this._activeObject;u.selectable&&u.activeOn==="down"&&this.setActiveObject(u,a);var p=u._findTargetCorner(this.getPointer(a,!0),S.util.isTouchEvent(a));if(u.__corner=p,u===this._activeObject&&(p||!f)){this._setupCurrentTransform(a,u,g);var v=u.controls[p],l=this.getPointer(a),y=v&&v.getMouseDownHandler(a,u,v);y&&y(a,this._currentTransform,l.x,l.y)}}this._handleEvent(a,"down"),(h||f)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(a){this._resetTransformEventData(),this._pointer=this.getPointer(a,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(a)||null},_beforeTransform:function(a){var u=this._currentTransform;this.stateful&&u.target.saveState(),this.fire("before:transform",{e:a,transform:u})},__onMouseMove:function(a){this._handleEvent(a,"move:before"),this._cacheTransformEventData(a);var u,l;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(a);return}if(this._isMainEvent(a)){var h=this._groupSelector;h?(l=this._absolutePointer,h.left=l.x-h.ex,h.top=l.y-h.ey,this.renderTop()):this._currentTransform?this._transformObject(a):(u=this.findTarget(a)||null,this._setCursorFromEvent(a,u),this._fireOverOutEvents(u,a)),this._handleEvent(a,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(a,u){var l=this._hoveredTarget,h=this._hoveredTargets,f=this.targets,g=Math.max(h.length,f.length);this.fireSyntheticInOutEvents(a,u,{oldTarget:l,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var p=0;p<g;p++)this.fireSyntheticInOutEvents(f[p],u,{oldTarget:h[p],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=a,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(a,u){var l=this._draggedoverTarget,h=this._hoveredTargets,f=this.targets,g=Math.max(h.length,f.length);this.fireSyntheticInOutEvents(a,u,{oldTarget:l,evtOut:"dragleave",evtIn:"dragenter"});for(var p=0;p<g;p++)this.fireSyntheticInOutEvents(f[p],u,{oldTarget:h[p],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=a},fireSyntheticInOutEvents:function(a,u,l){var h,f,g=l.oldTarget,p,v,y=g!==a,_=l.canvasEvtIn,T=l.canvasEvtOut;y&&(h={e:u,target:a,previousTarget:g},f={e:u,target:g,nextTarget:a}),v=a&&y,p=g&&y,p&&(T&&this.fire(T,f),g.fire(l.evtOut,f)),v&&(_&&this.fire(_,h),a.fire(l.evtIn,h))},__onMouseWheel:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"wheel"),this._resetTransformEventData()},_transformObject:function(a){var u=this.getPointer(a),l=this._currentTransform;l.reset=!1,l.shiftKey=a.shiftKey,l.altKey=a[this.centeredKey],this._performTransformAction(a,l,u),l.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(a,u,l){var h=l.x,f=l.y,g=u.action,p=!1,v=u.actionHandler;v&&(p=v(a,u,h,f)),g==="drag"&&p&&(u.target.isMoving=!0,this.setCursor(u.target.moveCursor||this.moveCursor)),u.actionPerformed=u.actionPerformed||p},_fire:S.controlsUtils.fireEvent,_setCursorFromEvent:function(a,u){if(!u)return this.setCursor(this.defaultCursor),!1;var l=u.hoverCursor||this.hoverCursor,h=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,f=(!h||!h.contains(u))&&u._findTargetCorner(this.getPointer(a,!0));f?this.setCursor(this.getCornerCursor(f,u,a)):(u.subTargetCheck&&this.targets.concat().reverse().map(function(g){l=g.hoverCursor||l}),this.setCursor(l))},getCornerCursor:function(a,u,l){var h=u.controls[a];return h.cursorStyleHandler(l,h,u)}})})();(function(){var e=Math.min,t=Math.max;S.util.object.extend(S.Canvas.prototype,{_shouldGroup:function(i,o){var n=this._activeObject;return n&&this._isSelectionKeyPressed(i)&&o&&o.selectable&&this.selection&&(n!==o||n.type==="activeSelection")&&!o.onSelect({e:i})},_handleGrouping:function(i,o){var n=this._activeObject;n.__corner||o===n&&(o=this.findTarget(i,!0),!o||!o.selectable)||(n&&n.type==="activeSelection"?this._updateActiveSelection(o,i):this._createActiveSelection(o,i))},_updateActiveSelection:function(i,o){var n=this._activeObject,s=n._objects.slice(0);n.contains(i)?(n.removeWithUpdate(i),this._hoveredTarget=i,this._hoveredTargets=this.targets.concat(),n.size()===1&&this._setActiveObject(n.item(0),o)):(n.addWithUpdate(i),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(s,o)},_createActiveSelection:function(i,o){var n=this.getActiveObjects(),s=this._createGroup(i);this._hoveredTarget=s,this._setActiveObject(s,o),this._fireSelectionEvents(n,o)},_createGroup:function(i){var o=this._objects,n=o.indexOf(this._activeObject)<o.indexOf(i),s=n?[this._activeObject,i]:[i,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new S.ActiveSelection(s,{canvas:this})},_groupSelectedObjects:function(i){var o=this._collectObjects(i),n;o.length===1?this.setActiveObject(o[0],i):o.length>1&&(n=new S.ActiveSelection(o.reverse(),{canvas:this}),this.setActiveObject(n,i))},_collectObjects:function(i){for(var o=[],n,s=this._groupSelector.ex,r=this._groupSelector.ey,a=s+this._groupSelector.left,u=r+this._groupSelector.top,l=new S.Point(e(s,a),e(r,u)),h=new S.Point(t(s,a),t(r,u)),f=!this.selectionFullyContained,g=s===a&&r===u,p=this._objects.length;p--&&(n=this._objects[p],!(!(!n||!n.selectable||!n.visible)&&(f&&n.intersectsWithRect(l,h,!0)||n.isContainedWithinRect(l,h,!0)||f&&n.containsPoint(l,null,!0)||f&&n.containsPoint(h,null,!0))&&(o.push(n),g))););return o.length>1&&(o=o.filter(function(v){return!v.onSelect({e:i})})),o},_maybeGroupObjects:function(i){this.selection&&this._groupSelector&&this._groupSelectedObjects(i),this.setCursor(this.defaultCursor),this._groupSelector=null}})})();(function(){S.util.object.extend(S.StaticCanvas.prototype,{toDataURL:function(e){e||(e={});var t=e.format||"png",i=e.quality||1,o=(e.multiplier||1)*(e.enableRetinaScaling?this.getRetinaScaling():1),n=this.toCanvasElement(o,e);return S.util.toDataURL(n,t,i)},toCanvasElement:function(e,t){e=e||1,t=t||{};var i=(t.width||this.width)*e,o=(t.height||this.height)*e,n=this.getZoom(),s=this.width,r=this.height,a=n*e,u=this.viewportTransform,l=(u[4]-(t.left||0))*e,h=(u[5]-(t.top||0))*e,f=this.interactive,g=[a,0,0,a,l,h],p=this.enableRetinaScaling,v=S.util.createCanvasElement(),y=this.contextTop;return v.width=i,v.height=o,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=g,this.width=i,this.height=o,this.calcViewportBoundaries(),this.renderCanvas(v.getContext("2d"),this._objects),this.viewportTransform=u,this.width=s,this.height=r,this.calcViewportBoundaries(),this.interactive=f,this.enableRetinaScaling=p,this.contextTop=y,v}})})();S.util.object.extend(S.StaticCanvas.prototype,{loadFromJSON:function(e,t,i){if(e){var o=typeof e=="string"?JSON.parse(e):S.util.object.clone(e),n=this,s=o.clipPath,r=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete o.clipPath,this._enlivenObjects(o.objects,function(a){n.clear(),n._setBgOverlay(o,function(){s?n._enlivenObjects([s],function(u){n.clipPath=u[0],n.__setupCanvas.call(n,o,a,r,t)}):n.__setupCanvas.call(n,o,a,r,t)})},i),this}},__setupCanvas:function(e,t,i,o){var n=this;t.forEach(function(s,r){n.insertAt(s,r)}),this.renderOnAddRemove=i,delete e.objects,delete e.backgroundImage,delete e.overlayImage,delete e.background,delete e.overlay,this._setOptions(e),this.renderAll(),o&&o()},_setBgOverlay:function(e,t){var i={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!e.backgroundImage&&!e.overlayImage&&!e.background&&!e.overlay){t&&t();return}var o=function(){i.backgroundImage&&i.overlayImage&&i.backgroundColor&&i.overlayColor&&t&&t()};this.__setBgOverlay("backgroundImage",e.backgroundImage,i,o),this.__setBgOverlay("overlayImage",e.overlayImage,i,o),this.__setBgOverlay("backgroundColor",e.background,i,o),this.__setBgOverlay("overlayColor",e.overlay,i,o)},__setBgOverlay:function(e,t,i,o){var n=this;if(!t){i[e]=!0,o&&o();return}e==="backgroundImage"||e==="overlayImage"?S.util.enlivenObjects([t],function(s){n[e]=s[0],i[e]=!0,o&&o()}):this["set"+S.util.string.capitalize(e,!0)](t,function(){i[e]=!0,o&&o()})},_enlivenObjects:function(e,t,i){if(!e||e.length===0){t&&t([]);return}S.util.enlivenObjects(e,function(o){t&&t(o)},null,i)},_toDataURL:function(e,t){this.clone(function(i){t(i.toDataURL(e))})},_toDataURLWithMultiplier:function(e,t,i){this.clone(function(o){i(o.toDataURLWithMultiplier(e,t))})},clone:function(e,t){var i=JSON.stringify(this.toJSON(t));this.cloneWithoutData(function(o){o.loadFromJSON(i,function(){e&&e(o)})})},cloneWithoutData:function(e){var t=S.util.createCanvasElement();t.width=this.width,t.height=this.height;var i=new S.Canvas(t);this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,function(){i.renderAll(),e&&e(i)}),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):e&&e(i)}});(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.object.clone,n=t.util.toFixed,s=t.util.string.capitalize,r=t.util.degreesToRadians,a=!t.isLikelyNode,u=2;t.Object||(t.Object=t.util.createClass(t.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:a,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(l){l&&this.setOptions(l)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=t.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(l){var h=t.perfLimitSizeTotal,f=l.width,g=l.height,p=t.maxCacheSideLimit,v=t.minCacheSideLimit;if(f<=p&&g<=p&&f*g<=h)return f<v&&(l.width=v),g<v&&(l.height=v),l;var y=f/g,_=t.util.limitDimsByArea(y,h),T=t.util.capValue,P=T(v,_.x,p),F=T(v,_.y,p);return f>P&&(l.zoomX/=f/P,l.width=P,l.capped=!0),g>F&&(l.zoomY/=g/F,l.height=F,l.capped=!0),l},_getCacheCanvasDimensions:function(){var l=this.getTotalObjectScaling(),h=this._getTransformedDimensions(0,0),f=h.x*l.scaleX/this.scaleX,g=h.y*l.scaleY/this.scaleY;return{width:f+u,height:g+u,zoomX:l.scaleX,zoomY:l.scaleY,x:f,y:g}},_updateCacheCanvas:function(){var l=this.canvas;if(this.noScaleCache&&l&&l._currentTransform){var h=l._currentTransform.target,f=l._currentTransform.action;if(this===h&&f.slice&&f.slice(0,5)==="scale")return!1}var g=this._cacheCanvas,p=this._limitCacheSize(this._getCacheCanvasDimensions()),v=t.minCacheSideLimit,y=p.width,_=p.height,T,P,F=p.zoomX,j=p.zoomY,Z=y!==this.cacheWidth||_!==this.cacheHeight,Q=this.zoomX!==F||this.zoomY!==j,$=Z||Q,tt=0,rt=0,ct=!1;if(Z){var lt=this._cacheCanvas.width,w=this._cacheCanvas.height,k=y>lt||_>w,A=(y<lt*.9||_<w*.9)&&lt>v&&w>v;ct=k||A,k&&!p.capped&&(y>v||_>v)&&(tt=y*.1,rt=_*.1)}return this instanceof t.Text&&this.path&&($=!0,ct=!0,tt+=this.getHeightOfLine(0)*this.zoomX,rt+=this.getHeightOfLine(0)*this.zoomY),$?(ct?(g.width=Math.ceil(y+tt),g.height=Math.ceil(_+rt)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,g.width,g.height)),T=p.x/2,P=p.y/2,this.cacheTranslationX=Math.round(g.width/2-T)+T,this.cacheTranslationY=Math.round(g.height/2-P)+P,this.cacheWidth=y,this.cacheHeight=_,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(F,j),this.zoomX=F,this.zoomY=j,!0):!1},setOptions:function(l){this._setOptions(l),this._initGradient(l.fill,"fill"),this._initGradient(l.stroke,"stroke"),this._initPattern(l.fill,"fill"),this._initPattern(l.stroke,"stroke")},transform:function(l){var h=this.group&&!this.group._transformDone||this.group&&this.canvas&&l===this.canvas.contextTop,f=this.calcTransformMatrix(!h);l.transform(f[0],f[1],f[2],f[3],f[4],f[5])},toObject:function(l){var h=t.Object.NUM_FRACTION_DIGITS,f={type:this.type,version:t.version,originX:this.originX,originY:this.originY,left:n(this.left,h),top:n(this.top,h),width:n(this.width,h),height:n(this.height,h),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,h),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:n(this.strokeMiterLimit,h),scaleX:n(this.scaleX,h),scaleY:n(this.scaleY,h),angle:n(this.angle,h),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,h),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:n(this.skewX,h),skewY:n(this.skewY,h)};return this.clipPath&&!this.clipPath.excludeFromExport&&(f.clipPath=this.clipPath.toObject(l),f.clipPath.inverted=this.clipPath.inverted,f.clipPath.absolutePositioned=this.clipPath.absolutePositioned),t.util.populateWithProperties(this,f,l),this.includeDefaultValues||(f=this._removeDefaultValues(f)),f},toDatalessObject:function(l){return this.toObject(l)},_removeDefaultValues:function(l){var h=t.util.getKlass(l.type).prototype,f=h.stateProperties;return f.forEach(function(g){g==="left"||g==="top"||(l[g]===h[g]&&delete l[g],Array.isArray(l[g])&&Array.isArray(h[g])&&l[g].length===0&&h[g].length===0&&delete l[g])}),l},toString:function(){return"#<fabric."+s(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var l=t.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(l.scaleX),scaleY:Math.abs(l.scaleY)}},getTotalObjectScaling:function(){var l=this.getObjectScaling(),h=l.scaleX,f=l.scaleY;if(this.canvas){var g=this.canvas.getZoom(),p=this.canvas.getRetinaScaling();h*=g*p,f*=g*p}return{scaleX:h,scaleY:f}},getObjectOpacity:function(){var l=this.opacity;return this.group&&(l*=this.group.getObjectOpacity()),l},_set:function(l,h){var f=l==="scaleX"||l==="scaleY",g=this[l]!==h,p=!1;return f&&(h=this._constrainScale(h)),l==="scaleX"&&h<0?(this.flipX=!this.flipX,h*=-1):l==="scaleY"&&h<0?(this.flipY=!this.flipY,h*=-1):l==="shadow"&&h&&!(h instanceof t.Shadow)?h=new t.Shadow(h):l==="dirty"&&this.group&&this.group.set("dirty",h),this[l]=h,g&&(p=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(l)>-1?(this.dirty=!0,p&&this.group.set("dirty",!0)):p&&this.stateProperties.indexOf(l)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:t.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(l){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(l.save(),this._setupCompositeOperation(l),this.drawSelectionBackground(l),this.transform(l),this._setOpacity(l),this._setShadow(l,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(l)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(l),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),l.restore())},renderCache:function(l){l=l||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,l.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(l,h){if(l.save(),h.inverted?l.globalCompositeOperation="destination-out":l.globalCompositeOperation="destination-in",h.absolutePositioned){var f=t.util.invertTransform(this.calcTransformMatrix());l.transform(f[0],f[1],f[2],f[3],f[4],f[5])}h.transform(l),l.scale(1/h.zoomX,1/h.zoomY),l.drawImage(h._cacheCanvas,-h.cacheTranslationX,-h.cacheTranslationY),l.restore()},drawObject:function(l,h){var f=this.fill,g=this.stroke;h?(this.fill="black",this.stroke="",this._setClippingProperties(l)):this._renderBackground(l),this._render(l),this._drawClipPath(l,this.clipPath),this.fill=f,this.stroke=g},_drawClipPath:function(l,h){h&&(h.canvas=this.canvas,h.shouldCache(),h._transformDone=!0,h.renderCache({forClipping:!0}),this.drawClipPathOnCache(l,h))},drawCacheOnCanvas:function(l){l.scale(1/this.zoomX,1/this.zoomY),l.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(l){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!l&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!l){var h=this.cacheWidth/this.zoomX,f=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-h/2,-f/2,h,f)}return!0}return!1},_renderBackground:function(l){if(this.backgroundColor){var h=this._getNonTransformedDimensions();l.fillStyle=this.backgroundColor,l.fillRect(-h.x/2,-h.y/2,h.x,h.y),this._removeShadow(l)}},_setOpacity:function(l){this.group&&!this.group._transformDone?l.globalAlpha=this.getObjectOpacity():l.globalAlpha*=this.opacity},_setStrokeStyles:function(l,h){var f=h.stroke;f&&(l.lineWidth=h.strokeWidth,l.lineCap=h.strokeLineCap,l.lineDashOffset=h.strokeDashOffset,l.lineJoin=h.strokeLineJoin,l.miterLimit=h.strokeMiterLimit,f.toLive?f.gradientUnits==="percentage"||f.gradientTransform||f.patternTransform?this._applyPatternForTransformedGradient(l,f):(l.strokeStyle=f.toLive(l,this),this._applyPatternGradientTransform(l,f)):l.strokeStyle=h.stroke)},_setFillStyles:function(l,h){var f=h.fill;f&&(f.toLive?(l.fillStyle=f.toLive(l,this),this._applyPatternGradientTransform(l,h.fill)):l.fillStyle=f)},_setClippingProperties:function(l){l.globalAlpha=1,l.strokeStyle="transparent",l.fillStyle="#000000"},_setLineDash:function(l,h){!h||h.length===0||(1&h.length&&h.push.apply(h,h),l.setLineDash(h))},_renderControls:function(l,h){var f=this.getViewportTransform(),g=this.calcTransformMatrix(),p,v,y;h=h||{},v=typeof h.hasBorders<"u"?h.hasBorders:this.hasBorders,y=typeof h.hasControls<"u"?h.hasControls:this.hasControls,g=t.util.multiplyTransformMatrices(f,g),p=t.util.qrDecompose(g),l.save(),l.translate(p.translateX,p.translateY),l.lineWidth=1*this.borderScaleFactor,this.group||(l.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(p.angle-=180),l.rotate(r(this.group?p.angle:this.angle)),h.forActiveSelection||this.group?v&&this.drawBordersInGroup(l,p,h):v&&this.drawBorders(l,h),y&&this.drawControls(l,h),l.restore()},_setShadow:function(l){if(this.shadow){var h=this.shadow,f=this.canvas,g,p=f&&f.viewportTransform[0]||1,v=f&&f.viewportTransform[3]||1;h.nonScaling?g={scaleX:1,scaleY:1}:g=this.getObjectScaling(),f&&f._isRetinaScaling()&&(p*=t.devicePixelRatio,v*=t.devicePixelRatio),l.shadowColor=h.color,l.shadowBlur=h.blur*t.browserShadowBlurConstant*(p+v)*(g.scaleX+g.scaleY)/4,l.shadowOffsetX=h.offsetX*p*g.scaleX,l.shadowOffsetY=h.offsetY*v*g.scaleY}},_removeShadow:function(l){this.shadow&&(l.shadowColor="",l.shadowBlur=l.shadowOffsetX=l.shadowOffsetY=0)},_applyPatternGradientTransform:function(l,h){if(!h||!h.toLive)return{offsetX:0,offsetY:0};var f=h.gradientTransform||h.patternTransform,g=-this.width/2+h.offsetX||0,p=-this.height/2+h.offsetY||0;return h.gradientUnits==="percentage"?l.transform(this.width,0,0,this.height,g,p):l.transform(1,0,0,1,g,p),f&&l.transform(f[0],f[1],f[2],f[3],f[4],f[5]),{offsetX:g,offsetY:p}},_renderPaintInOrder:function(l){this.paintFirst==="stroke"?(this._renderStroke(l),this._renderFill(l)):(this._renderFill(l),this._renderStroke(l))},_render:function(){},_renderFill:function(l){this.fill&&(l.save(),this._setFillStyles(l,this),this.fillRule==="evenodd"?l.fill("evenodd"):l.fill(),l.restore())},_renderStroke:function(l){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(l),l.save(),this.strokeUniform&&this.group){var h=this.getObjectScaling();l.scale(1/h.scaleX,1/h.scaleY)}else this.strokeUniform&&l.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(l,this.strokeDashArray),this._setStrokeStyles(l,this),l.stroke(),l.restore()}},_applyPatternForTransformedGradient:function(l,h){var f=this._limitCacheSize(this._getCacheCanvasDimensions()),g=t.util.createCanvasElement(),p,v=this.canvas.getRetinaScaling(),y=f.x/this.scaleX/v,_=f.y/this.scaleY/v;g.width=y,g.height=_,p=g.getContext("2d"),p.beginPath(),p.moveTo(0,0),p.lineTo(y,0),p.lineTo(y,_),p.lineTo(0,_),p.closePath(),p.translate(y/2,_/2),p.scale(f.zoomX/this.scaleX/v,f.zoomY/this.scaleY/v),this._applyPatternGradientTransform(p,h),p.fillStyle=h.toLive(l),p.fill(),l.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),l.scale(v*this.scaleX/f.zoomX,v*this.scaleY/f.zoomY),l.strokeStyle=p.createPattern(g,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var l=t.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",l.scaleX),this.set("scaleY",l.scaleY),this.angle=l.angle,this.skewX=l.skewX,this.skewY=0}},_removeTransformMatrix:function(l){var h=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),h=t.util.transformPoint(h,this.transformMatrix)),this.transformMatrix=null,l&&(this.scaleX*=l.scaleX,this.scaleY*=l.scaleY,this.cropX=l.cropX,this.cropY=l.cropY,h.x+=l.offsetLeft,h.y+=l.offsetTop,this.width=l.width,this.height=l.height),this.setPositionByOrigin(h,"center","center")},clone:function(l,h){var f=this.toObject(h);this.constructor.fromObject?this.constructor.fromObject(f,l):t.Object._fromObject("Object",f,l)},cloneAsImage:function(l,h){var f=this.toCanvasElement(h);return l&&l(new t.Image(f)),this},toCanvasElement:function(l){l||(l={});var h=t.util,f=h.saveObjectTransform(this),g=this.group,p=this.shadow,v=Math.abs,y=(l.multiplier||1)*(l.enableRetinaScaling?t.devicePixelRatio:1);delete this.group,l.withoutTransform&&h.resetObjectTransform(this),l.withoutShadow&&(this.shadow=null);var _=t.util.createCanvasElement(),T=this.getBoundingRect(!0,!0),P=this.shadow,F,j={x:0,y:0},Z,Q,$;P&&(Z=P.blur,P.nonScaling?F={scaleX:1,scaleY:1}:F=this.getObjectScaling(),j.x=2*Math.round(v(P.offsetX)+Z)*v(F.scaleX),j.y=2*Math.round(v(P.offsetY)+Z)*v(F.scaleY)),Q=T.width+j.x,$=T.height+j.y,_.width=Math.ceil(Q),_.height=Math.ceil($);var tt=new t.StaticCanvas(_,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});l.format==="jpeg"&&(tt.backgroundColor="#fff"),this.setPositionByOrigin(new t.Point(tt.width/2,tt.height/2),"center","center");var rt=this.canvas;tt.add(this);var ct=tt.toCanvasElement(y||1,l);return this.shadow=p,this.set("canvas",rt),g&&(this.group=g),this.set(f).setCoords(),tt._objects=[],tt.dispose(),tt=null,ct},toDataURL:function(l){return l||(l={}),t.util.toDataURL(this.toCanvasElement(l),l.format||"png",l.quality||1)},isType:function(l){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===l},complexity:function(){return 1},toJSON:function(l){return this.toObject(l)},rotate:function(l){var h=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return h&&this._setOriginToCenter(),this.set("angle",l),h&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(l,h){h=h||this.canvas.getPointer(l);var f=new t.Point(h.x,h.y),g=this._getLeftTopCoords();return this.angle&&(f=t.util.rotatePoint(f,g,r(-this.angle))),{x:f.x-g.x,y:f.y-g.y}},_setupCompositeOperation:function(l){this.globalCompositeOperation&&(l.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){t.runningAnimations&&t.runningAnimations.cancelByTarget(this)}}),t.util.createAccessors&&t.util.createAccessors(t.Object),i(t.Object.prototype,t.Observable),t.Object.NUM_FRACTION_DIGITS=2,t.Object.ENLIVEN_PROPS=["clipPath"],t.Object._fromObject=function(l,h,f,g){var p=t[l];h=o(h,!0),t.util.enlivenPatterns([h.fill,h.stroke],function(v){typeof v[0]<"u"&&(h.fill=v[0]),typeof v[1]<"u"&&(h.stroke=v[1]),t.util.enlivenObjectEnlivables(h,h,function(){var y=g?new p(h[g],h):new p(h);f&&f(y)})})},t.Object.__uid=0)})(ht);(function(){var e=S.util.degreesToRadians,t={left:-.5,center:0,right:.5},i={top:-.5,center:0,bottom:.5};S.util.object.extend(S.Object.prototype,{translateToGivenOrigin:function(o,n,s,r,a){var u=o.x,l=o.y,h,f,g;return typeof n=="string"?n=t[n]:n-=.5,typeof r=="string"?r=t[r]:r-=.5,h=r-n,typeof s=="string"?s=i[s]:s-=.5,typeof a=="string"?a=i[a]:a-=.5,f=a-s,(h||f)&&(g=this._getTransformedDimensions(),u=o.x+h*g.x,l=o.y+f*g.y),new S.Point(u,l)},translateToCenterPoint:function(o,n,s){var r=this.translateToGivenOrigin(o,n,s,"center","center");return this.angle?S.util.rotatePoint(r,o,e(this.angle)):r},translateToOriginPoint:function(o,n,s){var r=this.translateToGivenOrigin(o,"center","center",n,s);return this.angle?S.util.rotatePoint(r,o,e(this.angle)):r},getCenterPoint:function(){var o=new S.Point(this.left,this.top);return this.translateToCenterPoint(o,this.originX,this.originY)},getPointByOrigin:function(o,n){var s=this.getCenterPoint();return this.translateToOriginPoint(s,o,n)},toLocalPoint:function(o,n,s){var r=this.getCenterPoint(),a,u;return typeof n<"u"&&typeof s<"u"?a=this.translateToGivenOrigin(r,"center","center",n,s):a=new S.Point(this.left,this.top),u=new S.Point(o.x,o.y),this.angle&&(u=S.util.rotatePoint(u,r,-e(this.angle))),u.subtractEquals(a)},setPositionByOrigin:function(o,n,s){var r=this.translateToCenterPoint(o,n,s),a=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",a.x),this.set("top",a.y)},adjustPosition:function(o){var n=e(this.angle),s=this.getScaledWidth(),r=S.util.cos(n)*s,a=S.util.sin(n)*s,u,l;typeof this.originX=="string"?u=t[this.originX]:u=this.originX-.5,typeof o=="string"?l=t[o]:l=o-.5,this.left+=r*(l-u),this.top+=a*(l-u),this.setCoords(),this.originX=o},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var o=this.getCenterPoint();this.originX="center",this.originY="center",this.left=o.x,this.top=o.y},_resetOrigin:function(){var o=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=o.x,this.top=o.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})})();(function(){function e(s){return[new S.Point(s.tl.x,s.tl.y),new S.Point(s.tr.x,s.tr.y),new S.Point(s.br.x,s.br.y),new S.Point(s.bl.x,s.bl.y)]}var t=S.util,i=t.degreesToRadians,o=t.multiplyTransformMatrices,n=t.transformPoint;t.object.extend(S.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(s,r){return r?s?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),s?this.aCoords:this.lineCoords)},getCoords:function(s,r){return e(this._getCoords(s,r))},intersectsWithRect:function(s,r,a,u){var l=this.getCoords(a,u),h=S.Intersection.intersectPolygonRectangle(l,s,r);return h.status==="Intersection"},intersectsWithObject:function(s,r,a){var u=S.Intersection.intersectPolygonPolygon(this.getCoords(r,a),s.getCoords(r,a));return u.status==="Intersection"||s.isContainedWithinObject(this,r,a)||this.isContainedWithinObject(s,r,a)},isContainedWithinObject:function(s,r,a){for(var u=this.getCoords(r,a),l=r?s.aCoords:s.lineCoords,h=0,f=s._getImageLines(l);h<4;h++)if(!s.containsPoint(u[h],f))return!1;return!0},isContainedWithinRect:function(s,r,a,u){var l=this.getBoundingRect(a,u);return l.left>=s.x&&l.left+l.width<=r.x&&l.top>=s.y&&l.top+l.height<=r.y},containsPoint:function(s,h,a,u){var l=this._getCoords(a,u),h=h||this._getImageLines(l),f=this._findCrossPoints(s,h);return f!==0&&f%2===1},isOnScreen:function(s){if(!this.canvas)return!1;var r=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br,u=this.getCoords(!0,s);return u.some(function(l){return l.x<=a.x&&l.x>=r.x&&l.y<=a.y&&l.y>=r.y})||this.intersectsWithRect(r,a,!0,s)?!0:this._containsCenterOfCanvas(r,a,s)},_containsCenterOfCanvas:function(s,r,a){var u={x:(s.x+r.x)/2,y:(s.y+r.y)/2};return!!this.containsPoint(u,null,!0,a)},isPartiallyOnScreen:function(s){if(!this.canvas)return!1;var r=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br;if(this.intersectsWithRect(r,a,!0,s))return!0;var u=this.getCoords(!0,s).every(function(l){return(l.x>=a.x||l.x<=r.x)&&(l.y>=a.y||l.y<=r.y)});return u&&this._containsCenterOfCanvas(r,a,s)},_getImageLines:function(s){var r={topline:{o:s.tl,d:s.tr},rightline:{o:s.tr,d:s.br},bottomline:{o:s.br,d:s.bl},leftline:{o:s.bl,d:s.tl}};return r},_findCrossPoints:function(s,r){var a,u,l,h,f,g=0,p;for(var v in r)if(p=r[v],!(p.o.y<s.y&&p.d.y<s.y)&&!(p.o.y>=s.y&&p.d.y>=s.y)&&(p.o.x===p.d.x&&p.o.x>=s.x?f=p.o.x:(a=0,u=(p.d.y-p.o.y)/(p.d.x-p.o.x),l=s.y-a*s.x,h=p.o.y-u*p.o.x,f=-(l-h)/(a-u)),f>=s.x&&(g+=1),g===2))break;return g},getBoundingRect:function(s,r){var a=this.getCoords(s,r);return t.makeBoundingBoxFromPoints(a)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(s){return Math.abs(s)<this.minScaleLimit?s<0?-this.minScaleLimit:this.minScaleLimit:s===0?1e-4:s},scale:function(s){return this._set("scaleX",s),this._set("scaleY",s),this.setCoords()},scaleToWidth:function(s,r){var a=this.getBoundingRect(r).width/this.getScaledWidth();return this.scale(s/this.width/a)},scaleToHeight:function(s,r){var a=this.getBoundingRect(r).height/this.getScaledHeight();return this.scale(s/this.height/a)},calcLineCoords:function(){var s=this.getViewportTransform(),r=this.padding,a=i(this.angle),u=t.cos(a),l=t.sin(a),h=u*r,f=l*r,g=h+f,p=h-f,v=this.calcACoords(),y={tl:n(v.tl,s),tr:n(v.tr,s),bl:n(v.bl,s),br:n(v.br,s)};return r&&(y.tl.x-=p,y.tl.y-=g,y.tr.x+=g,y.tr.y-=p,y.bl.x-=g,y.bl.y+=p,y.br.x+=p,y.br.y+=g),y},calcOCoords:function(){var s=this._calcRotateMatrix(),r=this._calcTranslateMatrix(),a=this.getViewportTransform(),u=o(a,r),l=o(u,s),l=o(l,[1/a[0],0,0,1/a[3],0,0]),h=this._calculateCurrentDimensions(),f={};return this.forEachControl(function(g,p,v){f[p]=g.positionHandler(h,l,v)}),f},calcACoords:function(){var s=this._calcRotateMatrix(),r=this._calcTranslateMatrix(),a=o(r,s),u=this._getTransformedDimensions(),l=u.x/2,h=u.y/2;return{tl:n({x:-l,y:-h},a),tr:n({x:l,y:-h},a),bl:n({x:-l,y:h},a),br:n({x:l,y:h},a)}},setCoords:function(s){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),s?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return t.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var s=this.getCenterPoint();return[1,0,0,1,s.x,s.y]},transformMatrixKey:function(s){var r="_",a="";return!s&&this.group&&(a=this.group.transformMatrixKey(s)+r),a+this.top+r+this.left+r+this.scaleX+r+this.scaleY+r+this.skewX+r+this.skewY+r+this.angle+r+this.originX+r+this.originY+r+this.width+r+this.height+r+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(s){var r=this.calcOwnMatrix();if(s||!this.group)return r;var a=this.transformMatrixKey(s),u=this.matrixCache||(this.matrixCache={});return u.key===a?u.value:(this.group&&(r=o(this.group.calcTransformMatrix(!1),r)),u.key=a,u.value=r,r)},calcOwnMatrix:function(){var s=this.transformMatrixKey(!0),r=this.ownMatrixCache||(this.ownMatrixCache={});if(r.key===s)return r.value;var a=this._calcTranslateMatrix(),u={angle:this.angle,translateX:a[4],translateY:a[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return r.key=s,r.value=t.composeMatrix(u),r.value},_getNonTransformedDimensions:function(){var s=this.strokeWidth,r=this.width+s,a=this.height+s;return{x:r,y:a}},_getTransformedDimensions:function(s,r){typeof s>"u"&&(s=this.skewX),typeof r>"u"&&(r=this.skewY);var a,u,l,h=s===0&&r===0;if(this.strokeUniform?(u=this.width,l=this.height):(a=this._getNonTransformedDimensions(),u=a.x,l=a.y),h)return this._finalizeDimensions(u*this.scaleX,l*this.scaleY);var f=t.sizeAfterTransform(u,l,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:s,skewY:r});return this._finalizeDimensions(f.x,f.y)},_finalizeDimensions:function(s,r){return this.strokeUniform?{x:s+this.strokeWidth,y:r+this.strokeWidth}:{x:s,y:r}},_calculateCurrentDimensions:function(){var s=this.getViewportTransform(),r=this._getTransformedDimensions(),a=n(r,s,!0);return a.scalarAdd(2*this.padding)}})})();S.util.object.extend(S.Object.prototype,{sendToBack:function(){return this.group?S.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?S.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(e){return this.group?S.StaticCanvas.prototype.sendBackwards.call(this.group,this,e):this.canvas&&this.canvas.sendBackwards(this,e),this},bringForward:function(e){return this.group?S.StaticCanvas.prototype.bringForward.call(this.group,this,e):this.canvas&&this.canvas.bringForward(this,e),this},moveTo:function(e){return this.group&&this.group.type!=="activeSelection"?S.StaticCanvas.prototype.moveTo.call(this.group,this,e):this.canvas&&this.canvas.moveTo(this,e),this}});(function(){function e(i,o){if(o){if(o.toLive)return i+": url(#SVGID_"+o.id+"); ";var n=new S.Color(o),s=i+": "+n.toRgb()+"; ",r=n.getAlpha();return r!==1&&(s+=i+"-opacity: "+r.toString()+"; "),s}else return i+": none; "}var t=S.util.toFixed;S.util.object.extend(S.Object.prototype,{getSvgStyles:function(i){var o=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"none",r=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",u=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",h=typeof this.opacity<"u"?this.opacity:"1",f=this.visible?"":" visibility: hidden;",g=i?"":this.getSvgFilter(),p=e("fill",this.fill),v=e("stroke",this.stroke);return[v,"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",r,"; ","stroke-linejoin: ",u,"; ","stroke-miterlimit: ",l,"; ",p,"fill-rule: ",o,"; ","opacity: ",h,";",g,f].join("")},getSvgSpanStyles:function(i,o){var n="; ",r=i.fontFamily?"font-family: "+(i.fontFamily.indexOf("'")===-1&&i.fontFamily.indexOf('"')===-1?"'"+i.fontFamily+"'":i.fontFamily)+n:"",s=i.strokeWidth?"stroke-width: "+i.strokeWidth+n:"",r=r,a=i.fontSize?"font-size: "+i.fontSize+"px"+n:"",u=i.fontStyle?"font-style: "+i.fontStyle+n:"",l=i.fontWeight?"font-weight: "+i.fontWeight+n:"",h=i.fill?e("fill",i.fill):"",f=i.stroke?e("stroke",i.stroke):"",g=this.getSvgTextDecoration(i),p=i.deltaY?"baseline-shift: "+-i.deltaY+"; ":"";return g&&(g="text-decoration: "+g+n),[f,s,r,a,u,l,g,h,p,o?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(i){return["overline","underline","line-through"].filter(function(o){return i[o.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(i,o){var n=i?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'+S.util.matrixToSVG(n);return s+(o||"")+'" '},_setSVGBg:function(i){if(this.backgroundColor){var o=S.Object.NUM_FRACTION_DIGITS;i.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',t(-this.width/2,o),'" y="',t(-this.height/2,o),'" width="',t(this.width,o),'" height="',t(this.height,o),`"></rect>
`)}},toSVG:function(i){return this._createBaseSVGMarkup(this._toSVG(i),{reviver:i})},toClipPathSVG:function(i){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(i),{reviver:i})},_createBaseClipPathSVGMarkup:function(i,o){o=o||{};var n=o.reviver,s=o.additionalTransform||"",r=[this.getSvgTransform(!0,s),this.getSvgCommons()].join(""),a=i.indexOf("COMMON_PARTS");return i[a]=r,n?n(i.join("")):i.join("")},_createBaseSVGMarkup:function(i,o){o=o||{};var n=o.noStyle,s=o.reviver,r=n?"":'style="'+this.getSvgStyles()+'" ',a=o.withShadow?'style="'+this.getSvgFilter()+'" ':"",u=this.clipPath,l=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",h=u&&u.absolutePositioned,f=this.stroke,g=this.fill,p=this.shadow,v,y=[],_,T=i.indexOf("COMMON_PARTS"),P=o.additionalTransform;return u&&(u.clipPathId="CLIPPATH_"+S.Object.__uid++,_='<clipPath id="'+u.clipPathId+`" >
`+u.toClipPathSVG(s)+`</clipPath>
`),h&&y.push("<g ",a,this.getSvgCommons(),` >
`),y.push("<g ",this.getSvgTransform(!1),h?"":a+this.getSvgCommons(),` >
`),v=[r,l,n?"":this.addPaintOrder()," ",P?'transform="'+P+'" ':""].join(""),i[T]=v,g&&g.toLive&&y.push(g.toSVG(this)),f&&f.toLive&&y.push(f.toSVG(this)),p&&y.push(p.toSVG(this)),u&&y.push(_),y.push(i.join("")),y.push(`</g>
`),h&&y.push(`</g>
`),s?s(y.join("")):y.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})})();(function(){var e=S.util.object.extend,t="stateProperties";function i(n,s,r){var a={},u=!0;r.forEach(function(l){a[l]=n[l]}),e(n[s],a,u)}function o(n,s,r){if(n===s)return!0;if(Array.isArray(n)){if(!Array.isArray(s)||n.length!==s.length)return!1;for(var a=0,u=n.length;a<u;a++)if(!o(n[a],s[a]))return!1;return!0}else if(n&&typeof n=="object"){var l=Object.keys(n),h;if(!s||typeof s!="object"||!r&&l.length!==Object.keys(s).length)return!1;for(var a=0,u=l.length;a<u;a++)if(h=l[a],!(h==="canvas"||h==="group")&&!o(n[h],s[h]))return!1;return!0}}S.util.object.extend(S.Object.prototype,{hasStateChanged:function(n){n=n||t;var s="_"+n;return Object.keys(this[s]).length<this[n].length?!0:!o(this[s],this,!0)},saveState:function(n){var s=n&&n.propertySet||t,r="_"+s;return this[r]?(i(this,r,this[s]),n&&n.stateProperties&&i(this,r,n.stateProperties),this):this.setupState(n)},setupState:function(n){n=n||{};var s=n.propertySet||t;return n.propertySet=s,this["_"+s]={},this.saveState(n),this}})})();(function(){var e=S.util.degreesToRadians;S.util.object.extend(S.Object.prototype,{_findTargetCorner:function(t,i){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var o=t.x,n=t.y,s,r,a=Object.keys(this.oCoords),u=a.length-1,l;for(this.__corner=0;u>=0;u--)if(l=a[u],!!this.isControlVisible(l)&&(r=this._getImageLines(i?this.oCoords[l].touchCorner:this.oCoords[l].corner),s=this._findCrossPoints({x:o,y:n},r),s!==0&&s%2===1))return this.__corner=l,l;return!1},forEachControl:function(t){for(var i in this.controls)t(this.controls[i],i,this)},_setCornerCoords:function(){var t=this.oCoords;for(var i in t){var o=this.controls[i];t[i].corner=o.calcCornerCoords(this.angle,this.cornerSize,t[i].x,t[i].y,!1),t[i].touchCorner=o.calcCornerCoords(this.angle,this.touchCornerSize,t[i].x,t[i].y,!0)}},drawSelectionBackground:function(t){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;t.save();var i=this.getCenterPoint(),o=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return t.translate(i.x,i.y),t.scale(1/n[0],1/n[3]),t.rotate(e(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-o.x/2,-o.y/2,o.x,o.y),t.restore(),this},drawBorders:function(t,i){i=i||{};var o=this._calculateCurrentDimensions(),n=this.borderScaleFactor,s=o.x+n,r=o.y+n,a=typeof i.hasControls<"u"?i.hasControls:this.hasControls,u=!1;return t.save(),t.strokeStyle=i.borderColor||this.borderColor,this._setLineDash(t,i.borderDashArray||this.borderDashArray),t.strokeRect(-s/2,-r/2,s,r),a&&(t.beginPath(),this.forEachControl(function(l,h,f){l.withConnection&&l.getVisibility(f,h)&&(u=!0,t.moveTo(l.x*s,l.y*r),t.lineTo(l.x*s+l.offsetX,l.y*r+l.offsetY))}),u&&t.stroke()),t.restore(),this},drawBordersInGroup:function(t,i,o){o=o||{};var n=S.util.sizeAfterTransform(this.width,this.height,i),s=this.strokeWidth,r=this.strokeUniform,a=this.borderScaleFactor,u=n.x+s*(r?this.canvas.getZoom():i.scaleX)+a,l=n.y+s*(r?this.canvas.getZoom():i.scaleY)+a;return t.save(),this._setLineDash(t,o.borderDashArray||this.borderDashArray),t.strokeStyle=o.borderColor||this.borderColor,t.strokeRect(-u/2,-l/2,u,l),t.restore(),this},drawControls:function(t,i){i=i||{},t.save();var o=this.canvas.getRetinaScaling(),n,s;return t.setTransform(o,0,0,o,0,0),t.strokeStyle=t.fillStyle=i.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=i.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,i.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(n=this.group.calcTransformMatrix()),this.forEachControl(function(r,a,u){s=u.oCoords[a],r.getVisibility(u,a)&&(n&&(s=S.util.transformPoint(s,n)),r.render(t,s.x,s.y,i,u))}),t.restore(),this},isControlVisible:function(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)},setControlVisible:function(t,i){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=i,this},setControlsVisibility:function(t){t||(t={});for(var i in t)this.setControlVisible(i,t[i]);return this},onDeselect:function(){},onSelect:function(){}})})();S.util.object.extend(S.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(e,t){t=t||{};var i=function(){},o=t.onComplete||i,n=t.onChange||i,s=this;return S.util.animate({target:this,startValue:e.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(r){e.set("left",r),s.requestRenderAll(),n()},onComplete:function(){e.setCoords(),o()}})},fxCenterObjectV:function(e,t){t=t||{};var i=function(){},o=t.onComplete||i,n=t.onChange||i,s=this;return S.util.animate({target:this,startValue:e.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(r){e.set("top",r),s.requestRenderAll(),n()},onComplete:function(){e.setCoords(),o()}})},fxRemove:function(e,t){t=t||{};var i=function(){},o=t.onComplete||i,n=t.onChange||i,s=this;return S.util.animate({target:this,startValue:e.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(r){e.set("opacity",r),s.requestRenderAll(),n()},onComplete:function(){s.remove(e),o()}})}});S.util.object.extend(S.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var e=[],t,i,o=[];for(t in arguments[0])e.push(t);for(var n=0,s=e.length;n<s;n++)t=e[n],i=n!==s-1,o.push(this._animate(t,arguments[0][t],arguments[1],i));return o}else return this._animate.apply(this,arguments)},_animate:function(e,t,i,o){var n=this,s;t=t.toString(),i?i=S.util.object.clone(i):i={},~e.indexOf(".")&&(s=e.split("."));var r=n.colorProperties.indexOf(e)>-1||s&&n.colorProperties.indexOf(s[1])>-1,a=s?this.get(s[0])[s[1]]:this.get(e);"from"in i||(i.from=a),r||(~t.indexOf("=")?t=a+parseFloat(t.replace("=","")):t=parseFloat(t));var u={target:this,startValue:i.from,endValue:t,byValue:i.by,easing:i.easing,duration:i.duration,abort:i.abort&&function(l,h,f){return i.abort.call(n,l,h,f)},onChange:function(l,h,f){s?n[s[0]][s[1]]=l:n.set(e,l),!o&&i.onChange&&i.onChange(l,h,f)},onComplete:function(l,h,f){o||(n.setCoords(),i.onComplete&&i.onComplete(l,h,f))}};return r?S.util.animateColor(u.startValue,u.endValue,u.duration,u):S.util.animate(u)}});(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.object.clone,n={x1:1,x2:1,y1:1,y2:1};if(t.Line){t.warn("fabric.Line is already defined");return}t.Line=t.util.createClass(t.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:t.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(r,a){r||(r=[0,0,0,0]),this.callSuper("initialize",a),this.set("x1",r[0]),this.set("y1",r[1]),this.set("x2",r[2]),this.set("y2",r[3]),this._setWidthHeight(a)},_setWidthHeight:function(r){r||(r={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in r?r.left:this._getLeftToOriginX(),this.top="top"in r?r.top:this._getTopToOriginY()},_set:function(r,a){return this.callSuper("_set",r,a),typeof n[r]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:s({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:s({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(r){r.beginPath();var a=this.calcLinePoints();r.moveTo(a.x1,a.y1),r.lineTo(a.x2,a.y2),r.lineWidth=this.strokeWidth;var u=r.strokeStyle;r.strokeStyle=this.stroke||r.fillStyle,this.stroke&&this._renderStroke(r),r.strokeStyle=u},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(r){return i(this.callSuper("toObject",r),this.calcLinePoints())},_getNonTransformedDimensions:function(){var r=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(r.y-=this.strokeWidth),this.height===0&&(r.x-=this.strokeWidth)),r},calcLinePoints:function(){var r=this.x1<=this.x2?-1:1,a=this.y1<=this.y2?-1:1,u=r*this.width*.5,l=a*this.height*.5,h=r*this.width*-.5,f=a*this.height*-.5;return{x1:u,x2:h,y1:l,y2:f}},_toSVG:function(){var r=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',r.x1,'" y1="',r.y1,'" x2="',r.x2,'" y2="',r.y2,`" />
`]}}),t.Line.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),t.Line.fromElement=function(r,a,u){u=u||{};var l=t.parseAttributes(r,t.Line.ATTRIBUTE_NAMES),h=[l.x1||0,l.y1||0,l.x2||0,l.y2||0];a(new t.Line(h,i(l,u)))},t.Line.fromObject=function(r,a){function u(h){delete h.points,a&&a(h)}var l=o(r,!0);l.points=[r.x1,r.y1,r.x2,r.y2],t.Object._fromObject("Line",l,u,"points")};function s(r,a){var u=r.origin,l=r.axis1,h=r.axis2,f=r.dimension,g=a.nearest,p=a.center,v=a.farthest;return function(){switch(this.get(u)){case g:return Math.min(this.get(l),this.get(h));case p:return Math.min(this.get(l),this.get(h))+.5*this.get(f);case v:return Math.max(this.get(l),this.get(h))}}}})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.degreesToRadians;if(t.Circle){t.warn("fabric.Circle is already defined.");return}t.Circle=t.util.createClass(t.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:t.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(n,s){return this.callSuper("_set",n,s),n==="radius"&&this.setRadius(s),this},toObject:function(n){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(n))},_toSVG:function(){var n,s=0,r=0,a=(this.endAngle-this.startAngle)%360;if(a===0)n=["<circle ","COMMON_PARTS",'cx="'+s+'" cy="'+r+'" ','r="',this.radius,`" />
`];else{var u=i(this.startAngle),l=i(this.endAngle),h=this.radius,f=t.util.cos(u)*h,g=t.util.sin(u)*h,p=t.util.cos(l)*h,v=t.util.sin(l)*h,y=a>180?"1":"0";n=['<path d="M '+f+" "+g," A "+h+" "+h," 0 ",+y+" 1"," "+p+" "+v,'" ',"COMMON_PARTS",` />
`]}return n},_render:function(n){n.beginPath(),n.arc(0,0,this.radius,i(this.startAngle),i(this.endAngle),!1),this._renderPaintInOrder(n)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(n){return this.radius=n,this.set("width",n*2).set("height",n*2)}}),t.Circle.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),t.Circle.fromElement=function(n,s){var r=t.parseAttributes(n,t.Circle.ATTRIBUTE_NAMES);if(!o(r))throw new Error("value of `r` attribute is required and can not be negative");r.left=(r.left||0)-r.radius,r.top=(r.top||0)-r.radius,s(new t.Circle(r))};function o(n){return"radius"in n&&n.radius>=0}t.Circle.fromObject=function(n,s){t.Object._fromObject("Circle",n,s)}})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Triangle){t.warn("fabric.Triangle is already defined");return}t.Triangle=t.util.createClass(t.Object,{type:"triangle",width:100,height:100,_render:function(i){var o=this.width/2,n=this.height/2;i.beginPath(),i.moveTo(-o,n),i.lineTo(0,-n),i.lineTo(o,n),i.closePath(),this._renderPaintInOrder(i)},_toSVG:function(){var i=this.width/2,o=this.height/2,n=[-i+" "+o,"0 "+-o,i+" "+o].join(",");return["<polygon ","COMMON_PARTS",'points="',n,'" />']}}),t.Triangle.fromObject=function(i,o){return t.Object._fromObject("Triangle",i,o)}})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=Math.PI*2;if(t.Ellipse){t.warn("fabric.Ellipse is already defined.");return}t.Ellipse=t.util.createClass(t.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this.set("rx",o&&o.rx||0),this.set("ry",o&&o.ry||0)},_set:function(o,n){switch(this.callSuper("_set",o,n),o){case"rx":this.rx=n,this.set("width",n*2);break;case"ry":this.ry=n,this.set("height",n*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(o){o.beginPath(),o.save(),o.transform(1,0,0,this.ry/this.rx,0,0),o.arc(0,0,this.rx,0,i,!1),o.restore(),this._renderPaintInOrder(o)}}),t.Ellipse.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),t.Ellipse.fromElement=function(o,n){var s=t.parseAttributes(o,t.Ellipse.ATTRIBUTE_NAMES);s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,n(new t.Ellipse(s))},t.Ellipse.fromObject=function(o,n){t.Object._fromObject("Ellipse",o,n)}})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend;if(t.Rect){t.warn("fabric.Rect is already defined");return}t.Rect=t.util.createClass(t.Object,{stateProperties:t.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(o){var n=this.rx?Math.min(this.rx,this.width/2):0,s=this.ry?Math.min(this.ry,this.height/2):0,r=this.width,a=this.height,u=-this.width/2,l=-this.height/2,h=n!==0||s!==0,f=1-.5522847498;o.beginPath(),o.moveTo(u+n,l),o.lineTo(u+r-n,l),h&&o.bezierCurveTo(u+r-f*n,l,u+r,l+f*s,u+r,l+s),o.lineTo(u+r,l+a-s),h&&o.bezierCurveTo(u+r,l+a-f*s,u+r-f*n,l+a,u+r-n,l+a),o.lineTo(u+n,l+a),h&&o.bezierCurveTo(u+f*n,l+a,u,l+a-f*s,u,l+a-s),o.lineTo(u,l+s),h&&o.bezierCurveTo(u,l+f*s,u+f*n,l,u+n,l),o.closePath(),this._renderPaintInOrder(o)},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){var o=-this.width/2,n=-this.height/2;return["<rect ","COMMON_PARTS",'x="',o,'" y="',n,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),t.Rect.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),t.Rect.fromElement=function(o,n,s){if(!o)return n(null);s=s||{};var r=t.parseAttributes(o,t.Rect.ATTRIBUTE_NAMES);r.left=r.left||0,r.top=r.top||0,r.height=r.height||0,r.width=r.width||0;var a=new t.Rect(i(s?t.util.object.clone(s):{},r));a.visible=a.visible&&a.width>0&&a.height>0,n(a)},t.Rect.fromObject=function(o,n){return t.Object._fromObject("Rect",o,n)}})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.array.min,n=t.util.array.max,s=t.util.toFixed,r=t.util.projectStrokeOnPoints;if(t.Polyline){t.warn("fabric.Polyline is already defined");return}t.Polyline=t.util.createClass(t.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:t.Object.prototype.cacheProperties.concat("points"),initialize:function(a,u){u=u||{},this.points=a||[],this.callSuper("initialize",u),this._setPositionDimensions(u)},_projectStrokeOnPoints:function(){return r(this.points,this,!0)},_setPositionDimensions:function(a){var u=this._calcDimensions(a),l,h=this.exactBoundingBox?this.strokeWidth:0;this.width=u.width-h,this.height=u.height-h,a.fromSVG||(l=this.translateToGivenOrigin({x:u.left-this.strokeWidth/2+h/2,y:u.top-this.strokeWidth/2+h/2},"left","top",this.originX,this.originY)),typeof a.left>"u"&&(this.left=a.fromSVG?u.left:l.x),typeof a.top>"u"&&(this.top=a.fromSVG?u.top:l.y),this.pathOffset={x:u.left+this.width/2+h/2,y:u.top+this.height/2+h/2}},_calcDimensions:function(){var a=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,u=o(a,"x")||0,l=o(a,"y")||0,h=n(a,"x")||0,f=n(a,"y")||0,g=h-u,p=f-l;return{left:u,top:l,width:g,height:p}},toObject:function(a){return i(this.callSuper("toObject",a),{points:this.points.concat()})},_toSVG:function(){for(var a=[],u=this.pathOffset.x,l=this.pathOffset.y,h=t.Object.NUM_FRACTION_DIGITS,f=0,g=this.points.length;f<g;f++)a.push(s(this.points[f].x-u,h),",",s(this.points[f].y-l,h)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',a.join(""),`" />
`]},commonRender:function(a){var u,l=this.points.length,h=this.pathOffset.x,f=this.pathOffset.y;if(!l||isNaN(this.points[l-1].y))return!1;a.beginPath(),a.moveTo(this.points[0].x-h,this.points[0].y-f);for(var g=0;g<l;g++)u=this.points[g],a.lineTo(u.x-h,u.y-f);return!0},_render:function(a){this.commonRender(a)&&this._renderPaintInOrder(a)},complexity:function(){return this.get("points").length}}),t.Polyline.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polyline.fromElementGenerator=function(a){return function(u,l,h){if(!u)return l(null);h||(h={});var f=t.parsePointsAttribute(u.getAttribute("points")),g=t.parseAttributes(u,t[a].ATTRIBUTE_NAMES);g.fromSVG=!0,l(new t[a](f,i(g,h)))}},t.Polyline.fromElement=t.Polyline.fromElementGenerator("Polyline"),t.Polyline.fromObject=function(a,u){return t.Object._fromObject("Polyline",a,u,"points")}})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.projectStrokeOnPoints;if(t.Polygon){t.warn("fabric.Polygon is already defined");return}t.Polygon=t.util.createClass(t.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return i(this.points,this)},_render:function(o){this.commonRender(o)&&(o.closePath(),this._renderPaintInOrder(o))}}),t.Polygon.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polygon.fromElement=t.Polyline.fromElementGenerator("Polygon"),t.Polygon.fromObject=function(o,n){t.Object._fromObject("Polygon",o,n,"points")}})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.array.min,o=t.util.array.max,n=t.util.object.extend,s=t.util.object.clone,r=t.util.toFixed;if(t.Path){t.warn("fabric.Path is already defined");return}t.Path=t.util.createClass(t.Object,{type:"path",path:null,cacheProperties:t.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:t.Object.prototype.stateProperties.concat("path"),initialize:function(a,u){u=s(u||{}),delete u.path,this.callSuper("initialize",u),this._setPath(a||[],u)},_setPath:function(a,u){this.path=t.util.makePathSimpler(Array.isArray(a)?a:t.util.parsePath(a)),t.Polyline.prototype._setPositionDimensions.call(this,u||{})},_renderPathCommands:function(a){var u,l=0,h=0,f=0,g=0,p=0,v=0,y=-this.pathOffset.x,_=-this.pathOffset.y;a.beginPath();for(var T=0,P=this.path.length;T<P;++T)switch(u=this.path[T],u[0]){case"L":f=u[1],g=u[2],a.lineTo(f+y,g+_);break;case"M":f=u[1],g=u[2],l=f,h=g,a.moveTo(f+y,g+_);break;case"C":f=u[5],g=u[6],p=u[3],v=u[4],a.bezierCurveTo(u[1]+y,u[2]+_,p+y,v+_,f+y,g+_);break;case"Q":a.quadraticCurveTo(u[1]+y,u[2]+_,u[3]+y,u[4]+_),f=u[3],g=u[4],p=u[1],v=u[2];break;case"z":case"Z":f=l,g=h,a.closePath();break}},_render:function(a){this._renderPathCommands(a),this._renderPaintInOrder(a)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){return n(this.callSuper("toObject",a),{path:this.path.map(function(u){return u.slice()})})},toDatalessObject:function(a){var u=this.toObject(["sourcePath"].concat(a));return u.sourcePath&&delete u.path,u},_toSVG:function(){var a=t.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',a,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var a=t.Object.NUM_FRACTION_DIGITS;return" translate("+r(-this.pathOffset.x,a)+", "+r(-this.pathOffset.y,a)+")"},toClipPathSVG:function(a){var u=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:u})},toSVG:function(a){var u=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:u})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var a=[],u=[],l,h=0,f=0,g=0,p=0,v,y=0,_=this.path.length;y<_;++y){switch(l=this.path[y],l[0]){case"L":g=l[1],p=l[2],v=[];break;case"M":g=l[1],p=l[2],h=g,f=p,v=[];break;case"C":v=t.util.getBoundsOfCurve(g,p,l[1],l[2],l[3],l[4],l[5],l[6]),g=l[5],p=l[6];break;case"Q":v=t.util.getBoundsOfCurve(g,p,l[1],l[2],l[1],l[2],l[3],l[4]),g=l[3],p=l[4];break;case"z":case"Z":g=h,p=f;break}v.forEach(function($){a.push($.x),u.push($.y)}),a.push(g),u.push(p)}var T=i(a)||0,P=i(u)||0,F=o(a)||0,j=o(u)||0,Z=F-T,Q=j-P;return{left:T,top:P,width:Z,height:Q}}}),t.Path.fromObject=function(a,u){if(typeof a.sourcePath=="string"){var l=a.sourcePath;t.loadSVGFromURL(l,function(h){var f=h[0];f.setOptions(a),a.clipPath?t.util.enlivenObjects([a.clipPath],function(g){f.clipPath=g[0],u&&u(f)}):u&&u(f)})}else t.Object._fromObject("Path",a,u,"path")},t.Path.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(["d"]),t.Path.fromElement=function(a,u,l){var h=t.parseAttributes(a,t.Path.ATTRIBUTE_NAMES);h.fromSVG=!0,u(new t.Path(h.d,n(h,l)))}})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.array.min,o=t.util.array.max;t.Group||(t.Group=t.util.createClass(t.Object,t.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(n,s,r){s=s||{},this._objects=[],r&&this.callSuper("initialize",s),this._objects=n||[];for(var a=this._objects.length;a--;)this._objects[a].group=this;if(r)this._updateObjectsACoords();else{var u=s&&s.centerPoint;s.originX!==void 0&&(this.originX=s.originX),s.originY!==void 0&&(this.originY=s.originY),u||this._calcBounds(),this._updateObjectsCoords(u),delete s.centerPoint,this.callSuper("initialize",s)}this.setCoords()},_updateObjectsACoords:function(){for(var n=!0,s=this._objects.length;s--;)this._objects[s].setCoords(n)},_updateObjectsCoords:function(s){for(var s=s||this.getCenterPoint(),r=this._objects.length;r--;)this._updateObjectCoords(this._objects[r],s)},_updateObjectCoords:function(n,s){var r=n.left,a=n.top,u=!0;n.set({left:r-s.x,top:a-s.y}),n.group=this,n.setCoords(u)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(n){var s=!!this.group;return this._restoreObjectsState(),t.util.resetObjectTransform(this),n&&(s&&t.util.removeTransformFromObject(n,this.group.calcTransformMatrix()),this._objects.push(n),n.group=this,n._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,s?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(n){return this._restoreObjectsState(),t.util.resetObjectTransform(this),this.remove(n),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(n){this.dirty=!0,n.group=this,n._set("canvas",this.canvas)},_onObjectRemoved:function(n){this.dirty=!0,delete n.group},_set:function(n,s){var r=this._objects.length;if(this.useSetOnGroup)for(;r--;)this._objects[r].setOnGroup(n,s);if(n==="canvas")for(;r--;)this._objects[r]._set(n,s);t.Object.prototype._set.call(this,n,s)},toObject:function(n){var s=this.includeDefaultValues,r=this._objects.filter(function(u){return!u.excludeFromExport}).map(function(u){var l=u.includeDefaultValues;u.includeDefaultValues=s;var h=u.toObject(n);return u.includeDefaultValues=l,h}),a=t.Object.prototype.toObject.call(this,n);return a.objects=r,a},toDatalessObject:function(n){var s,r=this.sourcePath;if(r)s=r;else{var a=this.includeDefaultValues;s=this._objects.map(function(l){var h=l.includeDefaultValues;l.includeDefaultValues=a;var f=l.toDatalessObject(n);return l.includeDefaultValues=h,f})}var u=t.Object.prototype.toDatalessObject.call(this,n);return u.objects=s,u},render:function(n){this._transformDone=!0,this.callSuper("render",n),this._transformDone=!1},shouldCache:function(){var n=t.Object.prototype.shouldCache.call(this);if(n){for(var s=0,r=this._objects.length;s<r;s++)if(this._objects[s].willDrawShadow())return this.ownCaching=!1,!1}return n},willDrawShadow:function(){if(t.Object.prototype.willDrawShadow.call(this))return!0;for(var n=0,s=this._objects.length;n<s;n++)if(this._objects[n].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(n){for(var s=0,r=this._objects.length;s<r;s++)this._objects[s].render(n);this._drawClipPath(n,this.clipPath)},isCacheDirty:function(n){if(this.callSuper("isCacheDirty",n))return!0;if(!this.statefullCache)return!1;for(var s=0,r=this._objects.length;s<r;s++)if(this._objects[s].isCacheDirty(!0)){if(this._cacheCanvas){var a=this.cacheWidth/this.zoomX,u=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-a/2,-u/2,a,u)}return!0}return!1},_restoreObjectsState:function(){var n=this.calcOwnMatrix();return this._objects.forEach(function(s){t.util.addTransformToObject(s,n),delete s.group,s.setCoords()}),this},destroy:function(){return this._objects.forEach(function(n){n.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(n){n.dispose&&n.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var n=this._objects,s=this.canvas;this._objects=[];var r=this.toObject();delete r.objects;var a=new t.ActiveSelection([]);return a.set(r),a.type="activeSelection",s.remove(this),n.forEach(function(u){u.group=a,u.dirty=!0,s.add(u)}),a.canvas=s,a._objects=n,s._activeObject=a,a.setCoords(),a}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var n=!0;return this.forEachObject(function(s){s.setCoords(n)}),this},_calcBounds:function(n){for(var s=[],r=[],a,u,l,h=["tr","br","bl","tl"],f=0,g=this._objects.length,p,v=h.length;f<g;++f){for(a=this._objects[f],l=a.calcACoords(),p=0;p<v;p++)u=h[p],s.push(l[u].x),r.push(l[u].y);a.aCoords=l}this._getBounds(s,r,n)},_getBounds:function(n,s,r){var a=new t.Point(i(n),i(s)),u=new t.Point(o(n),o(s)),l=a.y||0,h=a.x||0,f=u.x-a.x||0,g=u.y-a.y||0;this.width=f,this.height=g,r||this.setPositionByOrigin({x:h,y:l},"left","top")},_toSVG:function(n){for(var s=["<g ","COMMON_PARTS",` >
`],r=0,a=this._objects.length;r<a;r++)s.push("		",this._objects[r].toSVG(n));return s.push(`</g>
`),s},getSvgStyles:function(){var n=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",s=this.visible?"":" visibility: hidden;";return[n,this.getSvgFilter(),s].join("")},toClipPathSVG:function(n){for(var s=[],r=0,a=this._objects.length;r<a;r++)s.push("	",this._objects[r].toClipPathSVG(n));return this._createBaseClipPathSVGMarkup(s,{reviver:n})}}),t.Group.fromObject=function(n,s){var r=n.objects,a=t.util.object.clone(n,!0);if(delete a.objects,typeof r=="string"){t.loadSVGFromURL(r,function(u){var l=t.util.groupSVGElements(u,n,r),h=a.clipPath;delete a.clipPath,l.set(a),h?t.util.enlivenObjects([h],function(f){l.clipPath=f[0],s&&s(l)}):s&&s(l)});return}t.util.enlivenObjects(r,function(u){t.util.enlivenObjectEnlivables(n,a,function(){s&&s(new t.Group(u,a,!0))})})})})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={});t.ActiveSelection||(t.ActiveSelection=t.util.createClass(t.Group,{type:"activeSelection",initialize:function(i,o){o=o||{},this._objects=i||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;o.originX&&(this.originX=o.originX),o.originY&&(this.originY=o.originY),this._calcBounds(),this._updateObjectsCoords(),t.Object.prototype.initialize.call(this,o),this.setCoords()},toGroup:function(){var i=this._objects.concat();this._objects=[];var o=t.Object.prototype.toObject.call(this),n=new t.Group([]);if(delete o.type,n.set(o),i.forEach(function(r){r.canvas.remove(r),r.group=n}),n._objects=i,!this.canvas)return n;var s=this.canvas;return s.add(n),s._activeObject=n,n.setCoords(),n},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(i,o,n){i.save(),i.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",i,o),n=n||{},typeof n.hasControls>"u"&&(n.hasControls=!1),n.forActiveSelection=!0;for(var s=0,r=this._objects.length;s<r;s++)this._objects[s]._renderControls(i,n);i.restore()}}),t.ActiveSelection.fromObject=function(i,o){t.util.enlivenObjects(i.objects,function(n){delete i.objects,o&&o(new t.ActiveSelection(n,i,!0))})})})(ht);(function(e){"use strict";var t=S.util.object.extend;if(e.fabric||(e.fabric={}),e.fabric.Image){S.warn("fabric.Image is already defined.");return}S.Image=S.util.createClass(S.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:S.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:S.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(i,o){o||(o={}),this.filters=[],this.cacheKey="texture"+S.Object.__uid++,this.callSuper("initialize",o),this._initElement(i,o)},getElement:function(){return this._element||{}},setElement:function(i,o){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=i,this._originalElement=i,this._initConfig(o),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(i){var o=S.filterBackend;o&&o.evictCachesForKey&&o.evictCachesForKey(i)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(i){S.util.cleanUpJsdomNode(this[i]),this[i]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var i=this.getElement();return{width:i.naturalWidth||i.width,height:i.naturalHeight||i.height}},_stroke:function(i){if(!(!this.stroke||this.strokeWidth===0)){var o=this.width/2,n=this.height/2;i.beginPath(),i.moveTo(-o,-n),i.lineTo(o,-n),i.lineTo(o,n),i.lineTo(-o,n),i.lineTo(-o,-n),i.closePath()}},toObject:function(i){var o=[];this.filters.forEach(function(s){s&&o.push(s.toObject())});var n=t(this.callSuper("toObject",["cropX","cropY"].concat(i)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:o});return this.resizeFilter&&(n.resizeFilter=this.resizeFilter.toObject()),n},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var i=[],o=[],n,s=this._element,r=-this.width/2,a=-this.height/2,u="",l="";if(!s)return[];if(this.hasCrop()){var h=S.Object.__uid++;i.push('<clipPath id="imageCrop_'+h+`">
`,'	<rect x="'+r+'" y="'+a+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),u=' clip-path="url(#imageCrop_'+h+')" '}if(this.imageSmoothing||(l='" image-rendering="optimizeSpeed'),o.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',r-this.cropX,'" y="',a-this.cropY,'" width="',s.width||s.naturalWidth,'" height="',s.height||s.height,l,'"',u,`></image>
`),this.stroke||this.strokeDashArray){var f=this.fill;this.fill=null,n=["	<rect ",'x="',r,'" y="',a,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=f}return this.paintFirst!=="fill"?i=i.concat(n,o):i=i.concat(o,n),i},getSrc:function(i){var o=i?this._element:this._originalElement;return o?o.toDataURL?o.toDataURL():this.srcFromAttribute?o.getAttribute("src"):o.src:this.src||""},setSrc:function(i,o,n){return S.util.loadImage(i,function(s,r){this.setElement(s,n),this._setWidthHeight(),o&&o(this,r)},this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var i=this.resizeFilter,o=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.scaleX,r=n.scaleY,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!i||s>o&&r>o){this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,this._lastScaleY=r;return}S.filterBackend||(S.filterBackend=S.initFilterBackend());var u=S.util.createCanvasElement(),l=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,h=a.width,f=a.height;u.width=h,u.height=f,this._element=u,this._lastScaleX=i.scaleX=s,this._lastScaleY=i.scaleY=r,S.filterBackend.applyFilters([i],a,h,f,this._element,l),this._filterScalingX=u.width/this._originalElement.width,this._filterScalingY=u.height/this._originalElement.height},applyFilters:function(i){if(i=i||this.filters||[],i=i.filter(function(a){return a&&!a.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),i.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var o=this._originalElement,n=o.naturalWidth||o.width,s=o.naturalHeight||o.height;if(this._element===this._originalElement){var r=S.util.createCanvasElement();r.width=n,r.height=s,this._element=r,this._filteredEl=r}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1;return S.filterBackend||(S.filterBackend=S.initFilterBackend()),S.filterBackend.applyFilters(i,this._originalElement,n,s,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(i){S.util.setImageSmoothing(i,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(i),this._renderPaintInOrder(i)},drawCacheOnCanvas:function(i){S.util.setImageSmoothing(i,this.imageSmoothing),S.Object.prototype.drawCacheOnCanvas.call(this,i)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(i){var o=this._element;if(o){var n=this._filterScalingX,s=this._filterScalingY,r=this.width,a=this.height,u=Math.min,l=Math.max,h=l(this.cropX,0),f=l(this.cropY,0),g=o.naturalWidth||o.width,p=o.naturalHeight||o.height,v=h*n,y=f*s,_=u(r*n,g-v),T=u(a*s,p-y),P=-r/2,F=-a/2,j=u(r,g/n-h),Z=u(a,p/s-f);o&&i.drawImage(o,v,y,_,T,P,F,j,Z)}},_needsResize:function(){var i=this.getTotalObjectScaling();return i.scaleX!==this._lastScaleX||i.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(i,o){this.setElement(S.util.getById(i),o),S.util.addClass(this.getElement(),S.Image.CSS_CANVAS)},_initConfig:function(i){i||(i={}),this.setOptions(i),this._setWidthHeight(i)},_initFilters:function(i,o){i&&i.length?S.util.enlivenObjects(i,function(n){o&&o(n)},"fabric.Image.filters"):o&&o()},_setWidthHeight:function(i){i||(i={});var o=this.getElement();this.width=i.width||o.naturalWidth||o.width||0,this.height=i.height||o.naturalHeight||o.height||0},parsePreserveAspectRatioAttribute:function(){var i=S.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),o=this._element.width,n=this._element.height,s=1,r=1,a=0,u=0,l=0,h=0,f,g=this.width,p=this.height,v={width:g,height:p};return i&&(i.alignX!=="none"||i.alignY!=="none")?(i.meetOrSlice==="meet"&&(s=r=S.util.findScaleToFit(this._element,v),f=(g-o*s)/2,i.alignX==="Min"&&(a=-f),i.alignX==="Max"&&(a=f),f=(p-n*r)/2,i.alignY==="Min"&&(u=-f),i.alignY==="Max"&&(u=f)),i.meetOrSlice==="slice"&&(s=r=S.util.findScaleToCover(this._element,v),f=o-g/s,i.alignX==="Mid"&&(l=f/2),i.alignX==="Max"&&(l=f),f=n-p/r,i.alignY==="Mid"&&(h=f/2),i.alignY==="Max"&&(h=f),o=g/s,n=p/r)):(s=g/o,r=p/n),{width:o,height:n,scaleX:s,scaleY:r,offsetLeft:a,offsetTop:u,cropX:l,cropY:h}}}),S.Image.CSS_CANVAS="canvas-img",S.Image.prototype.getSvgSrc=S.Image.prototype.getSrc,S.Image.fromObject=function(i,o){var n=S.util.object.clone(i);S.util.loadImage(n.src,function(s,r){if(r){o&&o(null,!0);return}S.Image.prototype._initFilters.call(n,n.filters,function(a){n.filters=a||[],S.Image.prototype._initFilters.call(n,[n.resizeFilter],function(u){n.resizeFilter=u[0],S.util.enlivenObjectEnlivables(n,n,function(){var l=new S.Image(s,n);o(l,!1)})})})},null,n.crossOrigin)},S.Image.fromURL=function(i,o,n){S.util.loadImage(i,function(s,r){o&&o(new S.Image(s,n),r)},null,n&&n.crossOrigin)},S.Image.ATTRIBUTE_NAMES=S.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),S.Image.fromElement=function(i,o,n){var s=S.parseAttributes(i,S.Image.ATTRIBUTE_NAMES);S.Image.fromURL(s["xlink:href"],o,t(n?S.util.object.clone(n):{},s))}})(ht);S.util.object.extend(S.Object.prototype,{_getAngleValueForStraighten:function(){var e=this.angle%360;return e>0?Math.round((e-1)/90)*90:Math.round(e/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(e){e=e||{};var t=function(){},i=e.onComplete||t,o=e.onChange||t,n=this;return S.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(s){n.rotate(s),o()},onComplete:function(){n.setCoords(),i()}})}});S.util.object.extend(S.StaticCanvas.prototype,{straightenObject:function(e){return e.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(e){return e.fxStraighten({onChange:this.requestRenderAllBound})}});(function(){"use strict";function e(i,o){var n="precision "+o+` float;
void main(){}`,s=i.createShader(i.FRAGMENT_SHADER);return i.shaderSource(s,n),i.compileShader(s),!!i.getShaderParameter(s,i.COMPILE_STATUS)}S.isWebglSupported=function(i){if(S.isLikelyNode)return!1;i=i||S.WebglFilterBackend.prototype.tileSize;var o=document.createElement("canvas"),n=o.getContext("webgl")||o.getContext("experimental-webgl"),s=!1;if(n){S.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),s=S.maxTextureSize>=i;for(var r=["highp","mediump","lowp"],a=0;a<3;a++)if(e(n,r[a])){S.webGlPrecision=r[a];break}}return this.isSupported=s,s},S.WebglFilterBackend=t;function t(i){i&&i.tileSize&&(this.tileSize=i.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}t.prototype={tileSize:2048,resources:{},setupGLContext:function(i,o){this.dispose(),this.createWebGLCanvas(i,o),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(i,o)},chooseFastestCopyGLTo2DMethod:function(i,o){var n=typeof window.performance<"u",s;try{new ImageData(1,1),s=!0}catch{s=!1}var r=typeof ArrayBuffer<"u",a=typeof Uint8ClampedArray<"u";if(n&&s&&r&&a){var u=S.util.createCanvasElement(),l=new ArrayBuffer(i*o*4);if(S.forceGLPutImageData){this.imageBuffer=l,this.copyGLTo2D=sf;return}var h={imageBuffer:l,destinationWidth:i,destinationHeight:o,targetCanvas:u},f,g,p;u.width=i,u.height=o,f=window.performance.now(),rf.call(h,this.gl,h),g=window.performance.now()-f,f=window.performance.now(),sf.call(h,this.gl,h),p=window.performance.now()-f,g>p?(this.imageBuffer=l,this.copyGLTo2D=sf):this.copyGLTo2D=rf}},createWebGLCanvas:function(i,o){var n=S.util.createCanvasElement();n.width=i,n.height=o;var s={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},r=n.getContext("webgl",s);r||(r=n.getContext("experimental-webgl",s)),r&&(r.clearColor(0,0,0,0),this.canvas=n,this.gl=r)},applyFilters:function(i,o,n,s,r,a){var u=this.gl,l;a&&(l=this.getCachedTexture(a,o));var h={originalWidth:o.width||o.originalWidth,originalHeight:o.height||o.originalHeight,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:u,sourceTexture:this.createTexture(u,n,s,!l&&o),targetTexture:this.createTexture(u,n,s),originalTexture:l||this.createTexture(u,n,s,!l&&o),passes:i.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:r},f=u.createFramebuffer();return u.bindFramebuffer(u.FRAMEBUFFER,f),i.forEach(function(g){g&&g.applyTo(h)}),s2(h),this.copyGLTo2D(u,h),u.bindTexture(u.TEXTURE_2D,null),u.deleteTexture(h.sourceTexture),u.deleteTexture(h.targetTexture),u.deleteFramebuffer(f),r.getContext("2d").setTransform(1,0,0,1,0,0),h},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(i,o,n,s){var r=i.createTexture();return i.bindTexture(i.TEXTURE_2D,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),s?i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,s):i.texImage2D(i.TEXTURE_2D,0,i.RGBA,o,n,0,i.RGBA,i.UNSIGNED_BYTE,null),r},getCachedTexture:function(i,o){if(this.textureCache[i])return this.textureCache[i];var n=this.createTexture(this.gl,o.width,o.height,o);return this.textureCache[i]=n,n},evictCachesForKey:function(i){this.textureCache[i]&&(this.gl.deleteTexture(this.textureCache[i]),delete this.textureCache[i])},copyGLTo2D:rf,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var i=this.gl,o={renderer:"",vendor:""};if(!i)return o;var n=i.getExtension("WEBGL_debug_renderer_info");if(n){var s=i.getParameter(n.UNMASKED_RENDERER_WEBGL),r=i.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(o.renderer=s.toLowerCase()),r&&(o.vendor=r.toLowerCase())}return this.gpuInfo=o,o}}})();function s2(e){var t=e.targetCanvas,i=t.width,o=t.height,n=e.destinationWidth,s=e.destinationHeight;(i!==n||o!==s)&&(t.width=n,t.height=s)}function rf(e,t){var i=e.canvas,o=t.targetCanvas,n=o.getContext("2d");n.translate(0,o.height),n.scale(1,-1);var s=i.height-o.height;n.drawImage(i,0,s,o.width,o.height,0,0,o.width,o.height)}function sf(e,t){var i=t.targetCanvas,o=i.getContext("2d"),n=t.destinationWidth,s=t.destinationHeight,r=n*s*4,a=new Uint8Array(this.imageBuffer,0,r),u=new Uint8ClampedArray(this.imageBuffer,0,r);e.readPixels(0,0,n,s,e.RGBA,e.UNSIGNED_BYTE,a);var l=new ImageData(u,n,s);o.putImageData(l,0,0)}(function(){"use strict";var e=function(){};S.Canvas2dFilterBackend=t;function t(){}t.prototype={evictCachesForKey:e,dispose:e,clearWebGLCaches:e,resources:{},applyFilters:function(i,o,n,s,r){var a=r.getContext("2d");a.drawImage(o,0,0,n,s);var u=a.getImageData(0,0,n,s),l=a.getImageData(0,0,n,s),h={sourceWidth:n,sourceHeight:s,imageData:u,originalEl:o,originalImageData:l,canvasEl:r,ctx:a,filterBackend:this};return i.forEach(function(f){f.applyTo(h)}),(h.imageData.width!==n||h.imageData.height!==s)&&(r.width=h.imageData.width,r.height=h.imageData.height),a.putImageData(h.imageData,0,0),h}}})();S.Image=S.Image||{};S.Image.filters=S.Image.filters||{};S.Image.filters.BaseFilter=S.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(e){e&&this.setOptions(e)},setOptions:function(e){for(var t in e)this[t]=e[t]},createProgram:function(e,t,i){t=t||this.fragmentSource,i=i||this.vertexSource,S.webGlPrecision!=="highp"&&(t=t.replace(/precision highp float/g,"precision "+S.webGlPrecision+" float"));var o=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(o,i),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+e.getShaderInfoLog(o));var n=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+e.getShaderInfoLog(n));var s=e.createProgram();if(e.attachShader(s,o),e.attachShader(s,n),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+e.getProgramInfoLog(s));var r=this.getAttributeLocations(e,s),a=this.getUniformLocations(e,s)||{};return a.uStepW=e.getUniformLocation(s,"uStepW"),a.uStepH=e.getUniformLocation(s,"uStepH"),{program:s,attributeLocations:r,uniformLocations:a}},getAttributeLocations:function(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(e,t,i){var o=t.aPosition,n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW)},_setupFrameBuffer:function(e){var t=e.context,i,o;e.passes>1?(i=e.destinationWidth,o=e.destinationHeight,(e.sourceWidth!==i||e.sourceHeight!==o)&&(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,i,o)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)):(t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish())},_swapTextures:function(e){e.passes--,e.pass++;var t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t},isNeutralState:function(){var e=this.mainParameter,t=S.Image.filters[this.type].prototype;if(e)if(Array.isArray(t[e])){for(var i=t[e].length;i--;)if(this[e][i]!==t[e][i])return!1;return!0}else return t[e]===this[e];else return!1},applyTo:function(e){e.webgl?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)},retrieveShader:function(e){return e.programCache.hasOwnProperty(this.type)||(e.programCache[this.type]=this.createProgram(e.context)),e.programCache[this.type]},applyToWebGL:function(e){var t=e.context,i=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(i.program),this.sendAttributeData(t,i.attributeLocations,e.aPosition),t.uniform1f(i.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(i.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,i.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(e,t,i){e.activeTexture(i),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)},unbindAdditionalTexture:function(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(e){this[this.mainParameter]=e},sendUniformData:function(){},createHelpLayer:function(e){if(!e.helpLayer){var t=document.createElement("canvas");t.width=e.sourceWidth,t.height=e.sourceHeight,e.helpLayer=t}},toObject:function(){var e={type:this.type},t=this.mainParameter;return t&&(e[t]=this[t]),e},toJSON:function(){return this.toObject()}});S.Image.filters.BaseFilter.fromObject=function(e,t){var i=new S.Image.filters[e.type](e);return t&&t(i),i};(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.ColorMatrix=o(i.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(n){this.callSuper("initialize",n),this.matrix=this.matrix.slice(0)},applyTo2d:function(n){var s=n.imageData,r=s.data,a=r.length,u=this.matrix,l,h,f,g,p,v=this.colorsOnly;for(p=0;p<a;p+=4)l=r[p],h=r[p+1],f=r[p+2],v?(r[p]=l*u[0]+h*u[1]+f*u[2]+u[4]*255,r[p+1]=l*u[5]+h*u[6]+f*u[7]+u[9]*255,r[p+2]=l*u[10]+h*u[11]+f*u[12]+u[14]*255):(g=r[p+3],r[p]=l*u[0]+h*u[1]+f*u[2]+g*u[3]+u[4]*255,r[p+1]=l*u[5]+h*u[6]+f*u[7]+g*u[8]+u[9]*255,r[p+2]=l*u[10]+h*u[11]+f*u[12]+g*u[13]+u[14]*255,r[p+3]=l*u[15]+h*u[16]+f*u[17]+g*u[18]+u[19]*255)},getUniformLocations:function(n,s){return{uColorMatrix:n.getUniformLocation(s,"uColorMatrix"),uConstants:n.getUniformLocation(s,"uConstants")}},sendUniformData:function(n,s){var r=this.matrix,a=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],u=[r[4],r[9],r[14],r[19]];n.uniformMatrix4fv(s.uColorMatrix,!1,a),n.uniform4fv(s.uConstants,u)}}),t.Image.filters.ColorMatrix.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Brightness=o(i.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(n){if(this.brightness!==0){var s=n.imageData,r=s.data,a,u=r.length,l=Math.round(this.brightness*255);for(a=0;a<u;a+=4)r[a]=r[a]+l,r[a+1]=r[a+1]+l,r[a+2]=r[a+2]+l}},getUniformLocations:function(n,s){return{uBrightness:n.getUniformLocation(s,"uBrightness")}},sendUniformData:function(n,s){n.uniform1f(s.uBrightness,this.brightness)}}),t.Image.filters.Brightness.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.Image.filters,n=t.util.createClass;o.Convolute=n(o.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(s){var r=Math.sqrt(this.matrix.length),a=this.type+"_"+r+"_"+(this.opaque?1:0),u=this.fragmentSource[a];return s.programCache.hasOwnProperty(a)||(s.programCache[a]=this.createProgram(s.context,u)),s.programCache[a]},applyTo2d:function(s){var r=s.imageData,a=r.data,u=this.matrix,l=Math.round(Math.sqrt(u.length)),h=Math.floor(l/2),f=r.width,g=r.height,p=s.ctx.createImageData(f,g),v=p.data,y=this.opaque?1:0,_,T,P,F,j,Z,Q,$,tt,rt,ct,lt,w;for(ct=0;ct<g;ct++)for(rt=0;rt<f;rt++){for(j=(ct*f+rt)*4,_=0,T=0,P=0,F=0,w=0;w<l;w++)for(lt=0;lt<l;lt++)Q=ct+w-h,Z=rt+lt-h,!(Q<0||Q>=g||Z<0||Z>=f)&&($=(Q*f+Z)*4,tt=u[w*l+lt],_+=a[$]*tt,T+=a[$+1]*tt,P+=a[$+2]*tt,y||(F+=a[$+3]*tt));v[j]=_,v[j+1]=T,v[j+2]=P,y?v[j+3]=a[j+3]:v[j+3]=F}s.imageData=p},getUniformLocations:function(s,r){return{uMatrix:s.getUniformLocation(r,"uMatrix"),uOpaque:s.getUniformLocation(r,"uOpaque"),uHalfSize:s.getUniformLocation(r,"uHalfSize"),uSize:s.getUniformLocation(r,"uSize")}},sendUniformData:function(s,r){s.uniform1fv(r.uMatrix,this.matrix)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),t.Image.filters.Convolute.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Grayscale=o(i.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(n){var s=n.imageData,r=s.data,a,u=r.length,l,h=this.mode;for(a=0;a<u;a+=4)h==="average"?l=(r[a]+r[a+1]+r[a+2])/3:h==="lightness"?l=(Math.min(r[a],r[a+1],r[a+2])+Math.max(r[a],r[a+1],r[a+2]))/2:h==="luminosity"&&(l=.21*r[a]+.72*r[a+1]+.07*r[a+2]),r[a]=l,r[a+1]=l,r[a+2]=l},retrieveShader:function(n){var s=this.type+"_"+this.mode;if(!n.programCache.hasOwnProperty(s)){var r=this.fragmentSource[this.mode];n.programCache[s]=this.createProgram(n.context,r)}return n.programCache[s]},getUniformLocations:function(n,s){return{uMode:n.getUniformLocation(s,"uMode")}},sendUniformData:function(n,s){var r=1;n.uniform1i(s.uMode,r)},isNeutralState:function(){return!1}}),t.Image.filters.Grayscale.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Invert=o(i.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(n){var s=n.imageData,r=s.data,a,u=r.length;for(a=0;a<u;a+=4)r[a]=255-r[a],r[a+1]=255-r[a+1],r[a+2]=255-r[a+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(n,s){return{uInvert:n.getUniformLocation(s,"uInvert")}},sendUniformData:function(n,s){n.uniform1i(s.uInvert,this.invert)}}),t.Image.filters.Invert.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.Image.filters,n=t.util.createClass;o.Noise=n(o.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(s){if(this.noise!==0){var r=s.imageData,a=r.data,u,l=a.length,h=this.noise,f;for(u=0,l=a.length;u<l;u+=4)f=(.5-Math.random())*h,a[u]+=f,a[u+1]+=f,a[u+2]+=f}},getUniformLocations:function(s,r){return{uNoise:s.getUniformLocation(r,"uNoise"),uSeed:s.getUniformLocation(r,"uSeed")}},sendUniformData:function(s,r){s.uniform1f(r.uNoise,this.noise/255),s.uniform1f(r.uSeed,Math.random())},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),t.Image.filters.Noise.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Pixelate=o(i.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(n){var s=n.imageData,r=s.data,a=s.height,u=s.width,l,h,f,g,p,v,y,_,T,P,F;for(h=0;h<a;h+=this.blocksize)for(f=0;f<u;f+=this.blocksize)for(l=h*4*u+f*4,g=r[l],p=r[l+1],v=r[l+2],y=r[l+3],P=Math.min(h+this.blocksize,a),F=Math.min(f+this.blocksize,u),_=h;_<P;_++)for(T=f;T<F;T++)l=_*4*u+T*4,r[l]=g,r[l+1]=p,r[l+2]=v,r[l+3]=y},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(n,s){return{uBlocksize:n.getUniformLocation(s,"uBlocksize"),uStepW:n.getUniformLocation(s,"uStepW"),uStepH:n.getUniformLocation(s,"uStepH")}},sendUniformData:function(n,s){n.uniform1f(s.uBlocksize,this.blocksize)}}),t.Image.filters.Pixelate.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.Image.filters,n=t.util.createClass;o.RemoveColor=n(o.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(s){var r=s.imageData,a=r.data,u,l=this.distance*255,h,f,g,p=new t.Color(this.color).getSource(),v=[p[0]-l,p[1]-l,p[2]-l],y=[p[0]+l,p[1]+l,p[2]+l];for(u=0;u<a.length;u+=4)h=a[u],f=a[u+1],g=a[u+2],h>v[0]&&f>v[1]&&g>v[2]&&h<y[0]&&f<y[1]&&g<y[2]&&(a[u+3]=0)},getUniformLocations:function(s,r){return{uLow:s.getUniformLocation(r,"uLow"),uHigh:s.getUniformLocation(r,"uHigh")}},sendUniformData:function(s,r){var a=new t.Color(this.color).getSource(),u=parseFloat(this.distance),l=[0+a[0]/255-u,0+a[1]/255-u,0+a[2]/255-u,1],h=[a[0]/255+u,a[1]/255+u,a[2]/255+u,1];s.uniform4fv(r.uLow,l),s.uniform4fv(r.uHigh,h)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),t.Image.filters.RemoveColor.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var s in n)i[s]=o(i.ColorMatrix,{type:s,matrix:n[s],mainParameter:!1,colorsOnly:!0}),t.Image.filters[s].fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric,i=t.Image.filters,o=t.util.createClass;i.BlendColor=o(i.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(n){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[n]+`}
}`},retrieveShader:function(n){var s=this.type+"_"+this.mode,r;return n.programCache.hasOwnProperty(s)||(r=this.buildSource(this.mode),n.programCache[s]=this.createProgram(n.context,r)),n.programCache[s]},applyTo2d:function(n){var s=n.imageData,r=s.data,a=r.length,u,l,h,f,g,p,v,y=1-this.alpha;v=new t.Color(this.color).getSource(),u=v[0]*this.alpha,l=v[1]*this.alpha,h=v[2]*this.alpha;for(var _=0;_<a;_+=4)switch(f=r[_],g=r[_+1],p=r[_+2],this.mode){case"multiply":r[_]=f*u/255,r[_+1]=g*l/255,r[_+2]=p*h/255;break;case"screen":r[_]=255-(255-f)*(255-u)/255,r[_+1]=255-(255-g)*(255-l)/255,r[_+2]=255-(255-p)*(255-h)/255;break;case"add":r[_]=f+u,r[_+1]=g+l,r[_+2]=p+h;break;case"diff":case"difference":r[_]=Math.abs(f-u),r[_+1]=Math.abs(g-l),r[_+2]=Math.abs(p-h);break;case"subtract":r[_]=f-u,r[_+1]=g-l,r[_+2]=p-h;break;case"darken":r[_]=Math.min(f,u),r[_+1]=Math.min(g,l),r[_+2]=Math.min(p,h);break;case"lighten":r[_]=Math.max(f,u),r[_+1]=Math.max(g,l),r[_+2]=Math.max(p,h);break;case"overlay":r[_]=u<128?2*f*u/255:255-2*(255-f)*(255-u)/255,r[_+1]=l<128?2*g*l/255:255-2*(255-g)*(255-l)/255,r[_+2]=h<128?2*p*h/255:255-2*(255-p)*(255-h)/255;break;case"exclusion":r[_]=u+f-2*u*f/255,r[_+1]=l+g-2*l*g/255,r[_+2]=h+p-2*h*p/255;break;case"tint":r[_]=u+f*y,r[_+1]=l+g*y,r[_+2]=h+p*y}},getUniformLocations:function(n,s){return{uColor:n.getUniformLocation(s,"uColor")}},sendUniformData:function(n,s){var r=new t.Color(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,n.uniform4fv(s.uColor,r)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendColor.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric,i=t.Image.filters,o=t.util.createClass;i.BlendImage=o(i.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(n){var s=this.type+"_"+this.mode,r=this.fragmentSource[this.mode];return n.programCache.hasOwnProperty(s)||(n.programCache[s]=this.createProgram(n.context,r)),n.programCache[s]},applyToWebGL:function(n){var s=n.context,r=this.createTexture(n.filterBackend,this.image);this.bindAdditionalTexture(s,r,s.TEXTURE1),this.callSuper("applyToWebGL",n),this.unbindAdditionalTexture(s,s.TEXTURE1)},createTexture:function(n,s){return n.getCachedTexture(s.cacheKey,s._element)},calculateMatrix:function(){var n=this.image,s=n._element.width,r=n._element.height;return[1/n.scaleX,0,0,0,1/n.scaleY,0,-n.left/s,-n.top/r,1]},applyTo2d:function(n){var s=n.imageData,r=n.filterBackend.resources,a=s.data,u=a.length,l=s.width,h=s.height,f,g,p,v,y,_,T,P,F,j,Z=this.image,Q;r.blendImage||(r.blendImage=t.util.createCanvasElement()),F=r.blendImage,j=F.getContext("2d"),F.width!==l||F.height!==h?(F.width=l,F.height=h):j.clearRect(0,0,l,h),j.setTransform(Z.scaleX,0,0,Z.scaleY,Z.left,Z.top),j.drawImage(Z._element,0,0,l,h),Q=j.getImageData(0,0,l,h).data;for(var $=0;$<u;$+=4)switch(y=a[$],_=a[$+1],T=a[$+2],P=a[$+3],f=Q[$],g=Q[$+1],p=Q[$+2],v=Q[$+3],this.mode){case"multiply":a[$]=y*f/255,a[$+1]=_*g/255,a[$+2]=T*p/255,a[$+3]=P*v/255;break;case"mask":a[$+3]=v;break}},getUniformLocations:function(n,s){return{uTransformMatrix:n.getUniformLocation(s,"uTransformMatrix"),uImage:n.getUniformLocation(s,"uImage")}},sendUniformData:function(n,s){var r=this.calculateMatrix();n.uniform1i(s.uImage,1),n.uniformMatrix3fv(s.uTransformMatrix,!1,r)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendImage.fromObject=function(n,s){t.Image.fromObject(n.image,function(r){var a=t.util.object.clone(n);a.image=r,s(new t.Image.filters.BlendImage(a))})}})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=Math.pow,o=Math.floor,n=Math.sqrt,s=Math.abs,r=Math.round,a=Math.sin,u=Math.ceil,l=t.Image.filters,h=t.util.createClass;l.Resize=h(l.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(f,g){return{uDelta:f.getUniformLocation(g,"uDelta"),uTaps:f.getUniformLocation(g,"uTaps")}},sendUniformData:function(f,g){f.uniform2fv(g.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),f.uniform1fv(g.uTaps,this.taps)},retrieveShader:function(f){var g=this.getFilterWindow(),p=this.type+"_"+g;if(!f.programCache.hasOwnProperty(p)){var v=this.generateShader(g);f.programCache[p]=this.createProgram(f.context,v)}return f.programCache[p]},getFilterWindow:function(){var f=this.tempScale;return Math.ceil(this.lanczosLobes/f)},getTaps:function(){for(var f=this.lanczosCreate(this.lanczosLobes),g=this.tempScale,p=this.getFilterWindow(),v=new Array(p),y=1;y<=p;y++)v[y-1]=f(y*g);return v},generateShader:function(v){for(var g=new Array(v),p=this.fragmentSourceTOP,v,y=1;y<=v;y++)g[y-1]=y+".0 * uDelta";return p+="uniform float uTaps["+v+`];
`,p+=`void main() {
`,p+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,p+=`  float sum = 1.0;
`,g.forEach(function(_,T){p+="  color += texture2D(uTexture, vTexCoord + "+_+") * uTaps["+T+`];
`,p+="  color += texture2D(uTexture, vTexCoord - "+_+") * uTaps["+T+`];
`,p+="  sum += 2.0 * uTaps["+T+`];
`}),p+=`  gl_FragColor = color / sum;
`,p+="}",p},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(f){f.webgl?(f.passes++,this.width=f.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=f.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),f.destinationWidth=this.dW,this._setupFrameBuffer(f),this.applyToWebGL(f),this._swapTextures(f),f.sourceWidth=f.destinationWidth,this.height=f.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),f.destinationHeight=this.dH,this._setupFrameBuffer(f),this.applyToWebGL(f),this._swapTextures(f),f.sourceHeight=f.destinationHeight):this.applyTo2d(f)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(f){return function(g){if(g>=f||g<=-f)return 0;if(g<11920929e-14&&g>-11920929e-14)return 1;g*=Math.PI;var p=g/f;return a(g)/g*a(p)/p}},applyTo2d:function(f){var g=f.imageData,p=this.scaleX,v=this.scaleY;this.rcpScaleX=1/p,this.rcpScaleY=1/v;var y=g.width,_=g.height,T=r(y*p),P=r(_*v),F;this.resizeType==="sliceHack"?F=this.sliceByTwo(f,y,_,T,P):this.resizeType==="hermite"?F=this.hermiteFastResize(f,y,_,T,P):this.resizeType==="bilinear"?F=this.bilinearFiltering(f,y,_,T,P):this.resizeType==="lanczos"&&(F=this.lanczosResize(f,y,_,T,P)),f.imageData=F},sliceByTwo:function(f,g,p,v,y){var _=f.imageData,T=.5,P=!1,F=!1,j=g*T,Z=p*T,Q=t.filterBackend.resources,$,tt,rt=0,ct=0,lt=g,w=0;for(Q.sliceByTwo||(Q.sliceByTwo=document.createElement("canvas")),$=Q.sliceByTwo,($.width<g*1.5||$.height<p)&&($.width=g*1.5,$.height=p),tt=$.getContext("2d"),tt.clearRect(0,0,g*1.5,p),tt.putImageData(_,0,0),v=o(v),y=o(y);!P||!F;)g=j,p=Z,v<o(j*T)?j=o(j*T):(j=v,P=!0),y<o(Z*T)?Z=o(Z*T):(Z=y,F=!0),tt.drawImage($,rt,ct,g,p,lt,w,j,Z),rt=lt,ct=w,w+=Z;return tt.getImageData(rt,ct,v,y)},lanczosResize:function(f,g,p,v,y){function _(A){var E,W,O,x,M,R,z,N,q,et,ot;for(w.x=(A+.5)*Z,k.x=o(w.x),E=0;E<y;E++){for(w.y=(E+.5)*Q,k.y=o(w.y),M=0,R=0,z=0,N=0,q=0,W=k.x-rt;W<=k.x+rt;W++)if(!(W<0||W>=g)){et=o(1e3*s(W-w.x)),lt[et]||(lt[et]={});for(var X=k.y-ct;X<=k.y+ct;X++)X<0||X>=p||(ot=o(1e3*s(X-w.y)),lt[et][ot]||(lt[et][ot]=j(n(i(et*$,2)+i(ot*tt,2))/1e3)),O=lt[et][ot],O>0&&(x=(X*g+W)*4,M+=O,R+=O*T[x],z+=O*T[x+1],N+=O*T[x+2],q+=O*T[x+3]))}x=(E*v+A)*4,F[x]=R/M,F[x+1]=z/M,F[x+2]=N/M,F[x+3]=q/M}return++A<v?_(A):P}var T=f.imageData.data,P=f.ctx.createImageData(v,y),F=P.data,j=this.lanczosCreate(this.lanczosLobes),Z=this.rcpScaleX,Q=this.rcpScaleY,$=2/this.rcpScaleX,tt=2/this.rcpScaleY,rt=u(Z*this.lanczosLobes/2),ct=u(Q*this.lanczosLobes/2),lt={},w={},k={};return _(0)},bilinearFiltering:function(f,g,p,v,y){var _,T,P,F,j,Z,Q,$,tt,rt,ct,lt,w=0,k,A=this.rcpScaleX,E=this.rcpScaleY,W=4*(g-1),O=f.imageData,x=O.data,M=f.ctx.createImageData(v,y),R=M.data;for(Q=0;Q<y;Q++)for($=0;$<v;$++)for(j=o(A*$),Z=o(E*Q),tt=A*$-j,rt=E*Q-Z,k=4*(Z*g+j),ct=0;ct<4;ct++)_=x[k+ct],T=x[k+4+ct],P=x[k+W+ct],F=x[k+W+4+ct],lt=_*(1-tt)*(1-rt)+T*tt*(1-rt)+P*rt*(1-tt)+F*tt*rt,R[w++]=lt;return M},hermiteFastResize:function(f,g,p,v,y){for(var _=this.rcpScaleX,T=this.rcpScaleY,P=u(_/2),F=u(T/2),j=f.imageData,Z=j.data,Q=f.ctx.createImageData(v,y),$=Q.data,tt=0;tt<y;tt++)for(var rt=0;rt<v;rt++){for(var ct=(rt+tt*v)*4,lt=0,w=0,k=0,A=0,E=0,W=0,O=0,x=(tt+.5)*T,M=o(tt*T);M<(tt+1)*T;M++)for(var R=s(x-(M+.5))/F,z=(rt+.5)*_,N=R*R,q=o(rt*_);q<(rt+1)*_;q++){var et=s(z-(q+.5))/P,ot=n(N+et*et);ot>1&&ot<-1||(lt=2*ot*ot*ot-3*ot*ot+1,lt>0&&(et=4*(q+M*g),O+=lt*Z[et+3],k+=lt,Z[et+3]<255&&(lt=lt*Z[et+3]/250),A+=lt*Z[et],E+=lt*Z[et+1],W+=lt*Z[et+2],w+=lt))}$[ct]=A/w,$[ct+1]=E/w,$[ct+2]=W/w,$[ct+3]=O/k}return Q},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),t.Image.filters.Resize.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Contrast=o(i.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(n){if(this.contrast!==0){var s=n.imageData,r,u,a=s.data,u=a.length,l=Math.floor(this.contrast*255),h=259*(l+255)/(255*(259-l));for(r=0;r<u;r+=4)a[r]=h*(a[r]-128)+128,a[r+1]=h*(a[r+1]-128)+128,a[r+2]=h*(a[r+2]-128)+128}},getUniformLocations:function(n,s){return{uContrast:n.getUniformLocation(s,"uContrast")}},sendUniformData:function(n,s){n.uniform1f(s.uContrast,this.contrast)}}),t.Image.filters.Contrast.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Saturation=o(i.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(n){if(this.saturation!==0){var s=n.imageData,r=s.data,a=r.length,u=-this.saturation,l,h;for(l=0;l<a;l+=4)h=Math.max(r[l],r[l+1],r[l+2]),r[l]+=h!==r[l]?(h-r[l])*u:0,r[l+1]+=h!==r[l+1]?(h-r[l+1])*u:0,r[l+2]+=h!==r[l+2]?(h-r[l+2])*u:0}},getUniformLocations:function(n,s){return{uSaturation:n.getUniformLocation(s,"uSaturation")}},sendUniformData:function(n,s){n.uniform1f(s.uSaturation,-this.saturation)}}),t.Image.filters.Saturation.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Vibrance=o(i.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(n){if(this.vibrance!==0){var s=n.imageData,r=s.data,a=r.length,u=-this.vibrance,l,h,f,g;for(l=0;l<a;l+=4)h=Math.max(r[l],r[l+1],r[l+2]),f=(r[l]+r[l+1]+r[l+2])/3,g=Math.abs(h-f)*2/255*u,r[l]+=h!==r[l]?(h-r[l])*g:0,r[l+1]+=h!==r[l+1]?(h-r[l+1])*g:0,r[l+2]+=h!==r[l+2]?(h-r[l+2])*g:0}},getUniformLocations:function(n,s){return{uVibrance:n.getUniformLocation(s,"uVibrance")}},sendUniformData:function(n,s){n.uniform1f(s.uVibrance,-this.vibrance)}}),t.Image.filters.Vibrance.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Blur=o(i.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(n){n.webgl?(this.aspectRatio=n.sourceWidth/n.sourceHeight,n.passes++,this._setupFrameBuffer(n),this.horizontal=!0,this.applyToWebGL(n),this._swapTextures(n),this._setupFrameBuffer(n),this.horizontal=!1,this.applyToWebGL(n),this._swapTextures(n)):this.applyTo2d(n)},applyTo2d:function(n){n.imageData=this.simpleBlur(n)},simpleBlur:function(n){var s=n.filterBackend.resources,r,a,u=n.imageData.width,l=n.imageData.height;s.blurLayer1||(s.blurLayer1=t.util.createCanvasElement(),s.blurLayer2=t.util.createCanvasElement()),r=s.blurLayer1,a=s.blurLayer2,(r.width!==u||r.height!==l)&&(a.width=r.width=u,a.height=r.height=l);var h=r.getContext("2d"),f=a.getContext("2d"),g=15,p,v,y,_,T=this.blur*.06*.5;for(h.putImageData(n.imageData,0,0),f.clearRect(0,0,u,l),_=-g;_<=g;_++)p=(Math.random()-.5)/4,v=_/g,y=T*v*u+p,f.globalAlpha=1-Math.abs(v),f.drawImage(r,y,p),h.drawImage(a,0,0),f.globalAlpha=1,f.clearRect(0,0,a.width,a.height);for(_=-g;_<=g;_++)p=(Math.random()-.5)/4,v=_/g,y=T*v*l+p,f.globalAlpha=1-Math.abs(v),f.drawImage(r,p,y),h.drawImage(a,0,0),f.globalAlpha=1,f.clearRect(0,0,a.width,a.height);n.ctx.drawImage(r,0,0);var P=n.ctx.getImageData(0,0,r.width,r.height);return h.globalAlpha=1,h.clearRect(0,0,r.width,r.height),P},getUniformLocations:function(n,s){return{delta:n.getUniformLocation(s,"uDelta")}},sendUniformData:function(n,s){var r=this.chooseRightDelta();n.uniform2fv(s.delta,r)},chooseRightDelta:function(){var n=1,s=[0,0],r;return this.horizontal?this.aspectRatio>1&&(n=1/this.aspectRatio):this.aspectRatio<1&&(n=this.aspectRatio),r=n*this.blur*.12,this.horizontal?s[0]=r:s[1]=r,s}}),i.Blur.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Gamma=o(i.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(n){this.gamma=[1,1,1],i.BaseFilter.prototype.initialize.call(this,n)},applyTo2d:function(n){var s=n.imageData,r=s.data,a=this.gamma,u=r.length,l=1/a[0],h=1/a[1],f=1/a[2],g;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),g=0,u=256;g<u;g++)this.rVals[g]=Math.pow(g/255,l)*255,this.gVals[g]=Math.pow(g/255,h)*255,this.bVals[g]=Math.pow(g/255,f)*255;for(g=0,u=r.length;g<u;g+=4)r[g]=this.rVals[r[g]],r[g+1]=this.gVals[r[g+1]],r[g+2]=this.bVals[r[g+2]]},getUniformLocations:function(n,s){return{uGamma:n.getUniformLocation(s,"uGamma")}},sendUniformData:function(n,s){n.uniform3fv(s.uGamma,this.gamma)}}),t.Image.filters.Gamma.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Composed=o(i.BaseFilter,{type:"Composed",subFilters:[],initialize:function(n){this.callSuper("initialize",n),this.subFilters=this.subFilters.slice(0)},applyTo:function(n){n.passes+=this.subFilters.length-1,this.subFilters.forEach(function(s){s.applyTo(n)})},toObject:function(){return t.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(n){return n.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(n){return!n.isNeutralState()})}}),t.Image.filters.Composed.fromObject=function(n,s){var r=n.subFilters||[],a=r.map(function(l){return new t.Image.filters[l.type](l)}),u=new t.Image.filters.Composed({subFilters:a});return s&&s(u),u}})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.HueRotation=o(i.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var n=this.rotation*Math.PI,s=t.util.cos(n),r=t.util.sin(n),a=1/3,u=Math.sqrt(a)*r,l=1-s;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=s+l/3,this.matrix[1]=a*l-u,this.matrix[2]=a*l+u,this.matrix[5]=a*l+u,this.matrix[6]=s+a*l,this.matrix[7]=a*l-u,this.matrix[10]=a*l-u,this.matrix[11]=a*l+u,this.matrix[12]=s+a*l},isNeutralState:function(n){return this.calculateMatrix(),i.BaseFilter.prototype.isNeutralState.call(this,n)},applyTo:function(n){this.calculateMatrix(),i.BaseFilter.prototype.applyTo.call(this,n)}}),t.Image.filters.HueRotation.fromObject=t.Image.filters.BaseFilter.fromObject})(ht);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.clone;if(t.Text){t.warn("fabric.Text is already defined");return}var o="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");t.Text=t.util.createClass(t.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:t.Object.prototype.stateProperties.concat(o),cacheProperties:t.Object.prototype.cacheProperties.concat(o),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(n,s){this.styles=s?s.styles||{}:{},this.text=n,this.__skipDimension=!0,this.callSuper("initialize",s),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var n=this.path;n&&(n.segmentsInfo=t.util.getPathSegmentsInfo(n.path))},getMeasuringContext:function(){return t._measuringContext||(t._measuringContext=this.canvas&&this.canvas.contextCache||t.util.createCanvasElement().getContext("2d")),t._measuringContext},_splitText:function(){var n=this._splitTextIntoLines(this.text);return this.textLines=n.lines,this._textLines=n.graphemeLines,this._unwrappedTextLines=n._unwrappedLines,this._text=n.graphemeText,n},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var n,s,r,a,u,l,h,f=0,g=this._textLines.length;f<g;f++)if(!(this.textAlign!=="justify"&&(f===g-1||this.isEndOfWrapping(f)))&&(a=0,u=this._textLines[f],s=this.getLineWidth(f),s<this.width&&(h=this.textLines[f].match(this._reSpacesAndTabs)))){r=h.length,n=(this.width-s)/r;for(var p=0,v=u.length;p<=v;p++)l=this.__charBounds[f][p],this._reSpaceAndTab.test(u[p])?(l.width+=n,l.kernedWidth+=n,l.left+=a,a+=n):l.left+=a}},isEndOfWrapping:function(n){return n===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var n=this.callSuper("_getCacheCanvasDimensions"),s=this.fontSize;return n.width+=s*n.zoomX,n.height+=s*n.zoomY,n},_render:function(n){var s=this.path;s&&!s.isNotVisible()&&s._render(n),this._setTextStyles(n),this._renderTextLinesBackground(n),this._renderTextDecoration(n,"underline"),this._renderText(n),this._renderTextDecoration(n,"overline"),this._renderTextDecoration(n,"linethrough")},_renderText:function(n){this.paintFirst==="stroke"?(this._renderTextStroke(n),this._renderTextFill(n)):(this._renderTextFill(n),this._renderTextStroke(n))},_setTextStyles:function(n,s,r){if(n.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":n.textBaseline="middle";break;case"ascender":n.textBaseline="top";break;case"descender":n.textBaseline="bottom";break}n.font=this._getFontDeclaration(s,r)},calcTextWidth:function(){for(var n=this.getLineWidth(0),s=1,r=this._textLines.length;s<r;s++){var a=this.getLineWidth(s);a>n&&(n=a)}return n},_renderTextLine:function(n,s,r,a,u,l){this._renderChars(n,s,r,a,u,l)},_renderTextLinesBackground:function(n){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var s,r,a=n.fillStyle,u,l,h=this._getLeftOffset(),f=this._getTopOffset(),g=0,p=0,v,y,_=this.path,T,P=0,F=this._textLines.length;P<F;P++){if(s=this.getHeightOfLine(P),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",P)){f+=s;continue}u=this._textLines[P],r=this._getLineLeftOffset(P),p=0,g=0,l=this.getValueOfPropertyAt(P,0,"textBackgroundColor");for(var j=0,Z=u.length;j<Z;j++)v=this.__charBounds[P][j],y=this.getValueOfPropertyAt(P,j,"textBackgroundColor"),_?(n.save(),n.translate(v.renderLeft,v.renderTop),n.rotate(v.angle),n.fillStyle=y,y&&n.fillRect(-v.width/2,-s/this.lineHeight*(1-this._fontSizeFraction),v.width,s/this.lineHeight),n.restore()):y!==l?(T=h+r+g,this.direction==="rtl"&&(T=this.width-T-p),n.fillStyle=l,l&&n.fillRect(T,f,p,s/this.lineHeight),g=v.left,p=v.width,l=y):p+=v.kernedWidth;y&&!_&&(T=h+r+g,this.direction==="rtl"&&(T=this.width-T-p),n.fillStyle=y,n.fillRect(T,f,p,s/this.lineHeight)),f+=s}n.fillStyle=a,this._removeShadow(n)}},getFontCache:function(n){var s=n.fontFamily.toLowerCase();t.charWidthsCache[s]||(t.charWidthsCache[s]={});var r=t.charWidthsCache[s],a=n.fontStyle.toLowerCase()+"_"+(n.fontWeight+"").toLowerCase();return r[a]||(r[a]={}),r[a]},_measureChar:function(n,s,r,a){var u=this.getFontCache(s),l=this._getFontDeclaration(s),h=this._getFontDeclaration(a),f=r+n,g=l===h,p,v,y,_=s.fontSize/this.CACHE_FONT_SIZE,T;if(r&&u[r]!==void 0&&(y=u[r]),u[n]!==void 0&&(T=p=u[n]),g&&u[f]!==void 0&&(v=u[f],T=v-y),p===void 0||y===void 0||v===void 0){var P=this.getMeasuringContext();this._setTextStyles(P,s,!0)}return p===void 0&&(T=p=P.measureText(n).width,u[n]=p),y===void 0&&g&&r&&(y=P.measureText(r).width,u[r]=y),g&&v===void 0&&(v=P.measureText(f).width,u[f]=v,T=v-y),{width:p*_,kernedWidth:T*_}},getHeightOfChar:function(n,s){return this.getValueOfPropertyAt(n,s,"fontSize")},measureLine:function(n){var s=this._measureLine(n);return this.charSpacing!==0&&(s.width-=this._getWidthOfCharSpacing()),s.width<0&&(s.width=0),s},_measureLine:function(n){var s=0,r,a,u=this._textLines[n],l,h,f=0,g=new Array(u.length),p=0,v,y,_=this.path,T=this.pathSide==="right";for(this.__charBounds[n]=g,r=0;r<u.length;r++)a=u[r],h=this._getGraphemeBox(a,n,r,l),g[r]=h,s+=h.kernedWidth,l=a;if(g[r]={left:h?h.left+h.width:0,width:0,kernedWidth:0,height:this.fontSize},_){switch(y=_.segmentsInfo[_.segmentsInfo.length-1].length,v=t.util.getPointOnPath(_.path,0,_.segmentsInfo),v.x+=_.pathOffset.x,v.y+=_.pathOffset.y,this.textAlign){case"left":p=T?y-s:0;break;case"center":p=(y-s)/2;break;case"right":p=T?0:y-s;break}for(p+=this.pathStartOffset*(T?-1:1),r=T?u.length-1:0;T?r>=0:r<u.length;T?r--:r++)h=g[r],p>y?p%=y:p<0&&(p+=y),this._setGraphemeOnPath(p,h,v),p+=h.kernedWidth}return{width:s,numOfSpaces:f}},_setGraphemeOnPath:function(n,s,r){var a=n+s.kernedWidth/2,u=this.path,l=t.util.getPointOnPath(u.path,a,u.segmentsInfo);s.renderLeft=l.x-r.x,s.renderTop=l.y-r.y,s.angle=l.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(n,s,r,a,u){var l=this.getCompleteStyleDeclaration(s,r),h=a?this.getCompleteStyleDeclaration(s,r-1):{},f=this._measureChar(n,l,a,h),g=f.kernedWidth,p=f.width,v;this.charSpacing!==0&&(v=this._getWidthOfCharSpacing(),p+=v,g+=v);var y={width:p,left:0,height:l.fontSize,kernedWidth:g,deltaY:l.deltaY};if(r>0&&!u){var _=this.__charBounds[s][r-1];y.left=_.left+_.width+f.kernedWidth-f.width}return y},getHeightOfLine:function(n){if(this.__lineHeights[n])return this.__lineHeights[n];for(var s=this._textLines[n],r=this.getHeightOfChar(n,0),a=1,u=s.length;a<u;a++)r=Math.max(this.getHeightOfChar(n,a),r);return this.__lineHeights[n]=r*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var n,s=0,r=0,a=this._textLines.length;r<a;r++)n=this.getHeightOfLine(r),s+=r===a-1?n/this.lineHeight:n;return s},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(n,s){n.save();for(var r=0,a=this._getLeftOffset(),u=this._getTopOffset(),l=0,h=this._textLines.length;l<h;l++){var f=this.getHeightOfLine(l),g=f/this.lineHeight,p=this._getLineLeftOffset(l);this._renderTextLine(s,n,this._textLines[l],a+p,u+r+g,l),r+=f}n.restore()},_renderTextFill:function(n){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(n,"fillText")},_renderTextStroke:function(n){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(n),n.save(),this._setLineDash(n,this.strokeDashArray),n.beginPath(),this._renderTextCommon(n,"strokeText"),n.closePath(),n.restore())},_renderChars:function(n,s,r,a,u,l){var h=this.getHeightOfLine(l),f=this.textAlign.indexOf("justify")!==-1,g,p,v="",y,_=0,T,P=this.path,F=!f&&this.charSpacing===0&&this.isEmptyStyles(l)&&!P,j=this.direction==="ltr",Z=this.direction==="ltr"?1:-1,Q,$=s.canvas.getAttribute("dir");if(s.save(),$!==this.direction&&(s.canvas.setAttribute("dir",j?"ltr":"rtl"),s.direction=j?"ltr":"rtl",s.textAlign=j?"left":"right"),u-=h*this._fontSizeFraction/this.lineHeight,F){this._renderChar(n,s,l,0,r.join(""),a,u,h),s.restore();return}for(var tt=0,rt=r.length-1;tt<=rt;tt++)T=tt===rt||this.charSpacing||P,v+=r[tt],y=this.__charBounds[l][tt],_===0?(a+=Z*(y.kernedWidth-y.width),_+=y.width):_+=y.kernedWidth,f&&!T&&this._reSpaceAndTab.test(r[tt])&&(T=!0),T||(g=g||this.getCompleteStyleDeclaration(l,tt),p=this.getCompleteStyleDeclaration(l,tt+1),T=t.util.hasStyleChanged(g,p,!1)),T&&(P?(s.save(),s.translate(y.renderLeft,y.renderTop),s.rotate(y.angle),this._renderChar(n,s,l,tt,v,-_/2,0,h),s.restore()):(Q=a,this._renderChar(n,s,l,tt,v,Q,u,h)),v="",g=p,a+=Z*_,_=0);s.restore()},_applyPatternGradientTransformText:function(n){var s=t.util.createCanvasElement(),r,a=this.width+this.strokeWidth,u=this.height+this.strokeWidth;return s.width=a,s.height=u,r=s.getContext("2d"),r.beginPath(),r.moveTo(0,0),r.lineTo(a,0),r.lineTo(a,u),r.lineTo(0,u),r.closePath(),r.translate(a/2,u/2),r.fillStyle=n.toLive(r),this._applyPatternGradientTransform(r,n),r.fill(),r.createPattern(s,"no-repeat")},handleFiller:function(n,s,r){var a,u;return r.toLive?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?(a=-this.width/2,u=-this.height/2,n.translate(a,u),n[s]=this._applyPatternGradientTransformText(r),{offsetX:a,offsetY:u}):(n[s]=r.toLive(n,this),this._applyPatternGradientTransform(n,r)):(n[s]=r,{offsetX:0,offsetY:0})},_setStrokeStyles:function(n,s){return n.lineWidth=s.strokeWidth,n.lineCap=this.strokeLineCap,n.lineDashOffset=this.strokeDashOffset,n.lineJoin=this.strokeLineJoin,n.miterLimit=this.strokeMiterLimit,this.handleFiller(n,"strokeStyle",s.stroke)},_setFillStyles:function(n,s){return this.handleFiller(n,"fillStyle",s.fill)},_renderChar:function(n,s,r,a,u,l,h){var f=this._getStyleDeclaration(r,a),g=this.getCompleteStyleDeclaration(r,a),p=n==="fillText"&&g.fill,v=n==="strokeText"&&g.stroke&&g.strokeWidth,y,_;!v&&!p||(s.save(),p&&(y=this._setFillStyles(s,g)),v&&(_=this._setStrokeStyles(s,g)),s.font=this._getFontDeclaration(g),f&&f.textBackgroundColor&&this._removeShadow(s),f&&f.deltaY&&(h+=f.deltaY),p&&s.fillText(u,l-y.offsetX,h-y.offsetY),v&&s.strokeText(u,l-_.offsetX,h-_.offsetY),s.restore())},setSuperscript:function(n,s){return this._setScript(n,s,this.superscript)},setSubscript:function(n,s){return this._setScript(n,s,this.subscript)},_setScript:function(n,s,r){var a=this.get2DCursorLocation(n,!0),u=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"fontSize"),l=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"deltaY"),h={fontSize:u*r.size,deltaY:l+u*r.baseline};return this.setSelectionStyles(h,n,s),this},_getLineLeftOffset:function(n){var s=this.getLineWidth(n),r=this.width-s,a=this.textAlign,u=this.direction,h,l=0,h=this.isEndOfWrapping(n);return a==="justify"||a==="justify-center"&&!h||a==="justify-right"&&!h||a==="justify-left"&&!h?0:(a==="center"&&(l=r/2),a==="right"&&(l=r),a==="justify-center"&&(l=r/2),a==="justify-right"&&(l=r),u==="rtl"&&(l-=r),l)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var n=this._forceClearCache;return n||(n=this.hasStateChanged("_dimensionAffectingProps")),n&&(this.dirty=!0,this._forceClearCache=!1),n},getLineWidth:function(n){if(this.__lineWidths[n]!==void 0)return this.__lineWidths[n];var s=this.measureLine(n),r=s.width;return this.__lineWidths[n]=r,r},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(n,s,r){var a=this._getStyleDeclaration(n,s);return a&&typeof a[r]<"u"?a[r]:this[r]},_renderTextDecoration:function(n,s){if(!(!this[s]&&!this.styleHas(s))){for(var r,a,u,l,h,f,g,p,v=this._getLeftOffset(),y=this._getTopOffset(),_,T,P,F,j,Z,Q,$,tt=this.path,rt=this._getWidthOfCharSpacing(),ct=this.offsets[s],lt=0,w=this._textLines.length;lt<w;lt++){if(r=this.getHeightOfLine(lt),!this[s]&&!this.styleHas(s,lt)){y+=r;continue}g=this._textLines[lt],Z=r/this.lineHeight,l=this._getLineLeftOffset(lt),T=0,P=0,p=this.getValueOfPropertyAt(lt,0,s),$=this.getValueOfPropertyAt(lt,0,"fill"),_=y+Z*(1-this._fontSizeFraction),a=this.getHeightOfChar(lt,0),h=this.getValueOfPropertyAt(lt,0,"deltaY");for(var k=0,A=g.length;k<A;k++)if(F=this.__charBounds[lt][k],j=this.getValueOfPropertyAt(lt,k,s),Q=this.getValueOfPropertyAt(lt,k,"fill"),u=this.getHeightOfChar(lt,k),f=this.getValueOfPropertyAt(lt,k,"deltaY"),tt&&j&&Q)n.save(),n.fillStyle=$,n.translate(F.renderLeft,F.renderTop),n.rotate(F.angle),n.fillRect(-F.kernedWidth/2,ct*u+f,F.kernedWidth,this.fontSize/15),n.restore();else if((j!==p||Q!==$||u!==a||f!==h)&&P>0){var E=v+l+T;this.direction==="rtl"&&(E=this.width-E-P),p&&$&&(n.fillStyle=$,n.fillRect(E,_+ct*a+h,P,this.fontSize/15)),T=F.left,P=F.width,p=j,$=Q,a=u,h=f}else P+=F.kernedWidth;var E=v+l+T;this.direction==="rtl"&&(E=this.width-E-P),n.fillStyle=Q,j&&Q&&n.fillRect(E,_+ct*a+h,P-rt,this.fontSize/15),y+=r}this._removeShadow(n)}},_getFontDeclaration:function(n,s){var r=n||this,a=this.fontFamily,u=t.Text.genericFonts.indexOf(a.toLowerCase())>-1,l=a===void 0||a.indexOf("'")>-1||a.indexOf(",")>-1||a.indexOf('"')>-1||u?r.fontFamily:'"'+r.fontFamily+'"';return[t.isLikelyNode?r.fontWeight:r.fontStyle,t.isLikelyNode?r.fontStyle:r.fontWeight,s?this.CACHE_FONT_SIZE+"px":r.fontSize+"px",l].join(" ")},render:function(n){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",n)))},_splitTextIntoLines:function(n){for(var s=n.split(this._reNewline),r=new Array(s.length),a=[`
`],u=[],l=0;l<s.length;l++)r[l]=t.util.string.graphemeSplit(s[l]),u=u.concat(r[l],a);return u.pop(),{_unwrappedLines:r,lines:s,graphemeText:u,graphemeLines:r}},toObject:function(n){var s=o.concat(n),r=this.callSuper("toObject",s);return r.styles=t.util.stylesToArray(this.styles,this.text),r.path&&(r.path=this.path.toObject()),r},set:function(n,s){this.callSuper("set",n,s);var r=!1,a=!1;if(typeof n=="object")for(var u in n)u==="path"&&this.setPathInfo(),r=r||this._dimensionAffectingProps.indexOf(u)!==-1,a=a||u==="path";else r=this._dimensionAffectingProps.indexOf(n)!==-1,a=n==="path";return a&&this.setPathInfo(),r&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),t.Text.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),t.Text.DEFAULT_SVG_FONT_SIZE=16,t.Text.fromElement=function(n,s,r){if(!n)return s(null);var a=t.parseAttributes(n,t.Text.ATTRIBUTE_NAMES),u=a.textAnchor||"left";if(r=t.util.object.extend(r?i(r):{},a),r.top=r.top||0,r.left=r.left||0,a.textDecoration){var l=a.textDecoration;l.indexOf("underline")!==-1&&(r.underline=!0),l.indexOf("overline")!==-1&&(r.overline=!0),l.indexOf("line-through")!==-1&&(r.linethrough=!0),delete r.textDecoration}"dx"in a&&(r.left+=a.dx),"dy"in a&&(r.top+=a.dy),"fontSize"in r||(r.fontSize=t.Text.DEFAULT_SVG_FONT_SIZE);var h="";"textContent"in n?h=n.textContent:"firstChild"in n&&n.firstChild!==null&&"data"in n.firstChild&&n.firstChild.data!==null&&(h=n.firstChild.data),h=h.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var f=r.strokeWidth;r.strokeWidth=0;var g=new t.Text(h,r),p=g.getScaledHeight()/g.height,v=(g.height+g.strokeWidth)*g.lineHeight-g.height,y=v*p,_=g.getScaledHeight()+y,T=0;u==="center"&&(T=g.getScaledWidth()/2),u==="right"&&(T=g.getScaledWidth()),g.set({left:g.left-T,top:g.top-(_-g.fontSize*(.07+g._fontSizeFraction))/g.lineHeight,strokeWidth:typeof f<"u"?f:1}),s(g)},t.Text.fromObject=function(n,s){var r=i(n),a=n.path;return delete r.path,t.Object._fromObject("Text",r,function(u){u.styles=t.util.stylesFromArray(n.styles,n.text),a?t.Object._fromObject("Path",a,function(l){u.set("path",l),s(u)},"path"):s(u)},"text")},t.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],t.util.createAccessors&&t.util.createAccessors(t.Text)})(ht);(function(){S.util.object.extend(S.Text.prototype,{isEmptyStyles:function(e){if(!this.styles||typeof e<"u"&&!this.styles[e])return!0;var t=typeof e>"u"?this.styles:{line:this.styles[e]};for(var i in t)for(var o in t[i])for(var n in t[i][o])return!1;return!0},styleHas:function(e,t){if(!this.styles||!e||e===""||typeof t<"u"&&!this.styles[t])return!1;var i=typeof t>"u"?this.styles:{0:this.styles[t]};for(var o in i)for(var n in i[o])if(typeof i[o][n][e]<"u")return!0;return!1},cleanStyle:function(e){if(!this.styles||!e||e==="")return!1;var t=this.styles,i=0,o,n,s=!0,r=0,a;for(var u in t){o=0;for(var l in t[u]){var a=t[u][l],h=a.hasOwnProperty(e);i++,h?(n?a[e]!==n&&(s=!1):n=a[e],a[e]===this[e]&&delete a[e]):s=!1,Object.keys(a).length!==0?o++:delete t[u][l]}o===0&&delete t[u]}for(var f=0;f<this._textLines.length;f++)r+=this._textLines[f].length;s&&i===r&&(this[e]=n,this.removeStyle(e))},removeStyle:function(e){if(!(!this.styles||!e||e==="")){var t=this.styles,i,o,n;for(o in t){i=t[o];for(n in i)delete i[n][e],Object.keys(i[n]).length===0&&delete i[n];Object.keys(i).length===0&&delete t[o]}}},_extendStyles:function(e,t){var i=this.get2DCursorLocation(e);this._getLineStyle(i.lineIndex)||this._setLineStyle(i.lineIndex),this._getStyleDeclaration(i.lineIndex,i.charIndex)||this._setStyleDeclaration(i.lineIndex,i.charIndex,{}),S.util.object.extend(this._getStyleDeclaration(i.lineIndex,i.charIndex),t)},get2DCursorLocation:function(e,t){typeof e>"u"&&(e=this.selectionStart);for(var i=t?this._unwrappedTextLines:this._textLines,o=i.length,n=0;n<o;n++){if(e<=i[n].length)return{lineIndex:n,charIndex:e};e-=i[n].length+this.missingNewlineOffset(n)}return{lineIndex:n-1,charIndex:i[n-1].length<e?i[n-1].length:e}},getSelectionStyles:function(e,t,i){typeof e>"u"&&(e=this.selectionStart||0),typeof t>"u"&&(t=this.selectionEnd||e);for(var o=[],n=e;n<t;n++)o.push(this.getStyleAtPosition(n,i));return o},getStyleAtPosition:function(e,t){var i=this.get2DCursorLocation(e),o=t?this.getCompleteStyleDeclaration(i.lineIndex,i.charIndex):this._getStyleDeclaration(i.lineIndex,i.charIndex);return o||{}},setSelectionStyles:function(e,t,i){typeof t>"u"&&(t=this.selectionStart||0),typeof i>"u"&&(i=this.selectionEnd||t);for(var o=t;o<i;o++)this._extendStyles(o,e);return this._forceClearCache=!0,this},_getStyleDeclaration:function(e,t){var i=this.styles&&this.styles[e];return i?i[t]:null},getCompleteStyleDeclaration:function(e,t){for(var i=this._getStyleDeclaration(e,t)||{},o={},n,s=0;s<this._styleProperties.length;s++)n=this._styleProperties[s],o[n]=typeof i[n]>"u"?this[n]:i[n];return o},_setStyleDeclaration:function(e,t,i){this.styles[e][t]=i},_deleteStyleDeclaration:function(e,t){delete this.styles[e][t]},_getLineStyle:function(e){return!!this.styles[e]},_setLineStyle:function(e){this.styles[e]={}},_deleteLineStyle:function(e){delete this.styles[e]}})})();(function(){function e(t){t.textDecoration&&(t.textDecoration.indexOf("underline")>-1&&(t.underline=!0),t.textDecoration.indexOf("line-through")>-1&&(t.linethrough=!0),t.textDecoration.indexOf("overline")>-1&&(t.overline=!0),delete t.textDecoration)}S.IText=S.util.createClass(S.Text,S.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,i){this.callSuper("initialize",t,i),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,i){this[t]!==i&&(this._fireSelectionChanged(),this[t]=i),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var i=this.canvas.contextTop,o=this.canvas.viewportTransform;i.save(),i.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this.transform(i),this._clearTextArea(i),t||i.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var t=this._getCursorBoundaries(),i=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(t,i):this.renderSelection(t,i),i.restore()}},_clearTextArea:function(t){var i=this.width+4,o=this.height+4;t.clearRect(-i/2,-o/2,i,o)},_getCursorBoundaries:function(t){typeof t>"u"&&(t=this.selectionStart);var i=this._getLeftOffset(),o=this._getTopOffset(),n=this._getCursorBoundariesOffsets(t);return{left:i,top:o,leftOffset:n.left,topOffset:n.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var i,o,n,s=0,r=0,a,u=this.get2DCursorLocation(t);n=u.charIndex,o=u.lineIndex;for(var l=0;l<o;l++)s+=this.getHeightOfLine(l);i=this._getLineLeftOffset(o);var h=this.__charBounds[o][n];return h&&(r=h.left),this.charSpacing!==0&&n===this._textLines[o].length&&(r-=this._getWidthOfCharSpacing()),a={top:s,left:i+(r>0?r:0)},this.direction==="rtl"&&(a.left*=-1),this.cursorOffsetCache=a,this.cursorOffsetCache},renderCursor:function(t,i){var o=this.get2DCursorLocation(),n=o.lineIndex,s=o.charIndex>0?o.charIndex-1:0,r=this.getValueOfPropertyAt(n,s,"fontSize"),a=this.scaleX*this.canvas.getZoom(),u=this.cursorWidth/a,l=t.topOffset,h=this.getValueOfPropertyAt(n,s,"deltaY");l+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-r*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,i),i.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,s,"fill"),i.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,i.fillRect(t.left+t.leftOffset-u/2,l+t.top+h,u,r)},renderSelection:function(t,i){for(var o=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,n=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,s=this.textAlign.indexOf("justify")!==-1,r=this.get2DCursorLocation(o),a=this.get2DCursorLocation(n),u=r.lineIndex,l=a.lineIndex,h=r.charIndex<0?0:r.charIndex,f=a.charIndex<0?0:a.charIndex,g=u;g<=l;g++){var p=this._getLineLeftOffset(g)||0,v=this.getHeightOfLine(g),y=0,_=0,T=0;if(g===u&&(_=this.__charBounds[u][h].left),g>=u&&g<l)T=s&&!this.isEndOfWrapping(g)?this.width:this.getLineWidth(g)||5;else if(g===l)if(f===0)T=this.__charBounds[l][f].left;else{var P=this._getWidthOfCharSpacing();T=this.__charBounds[l][f-1].left+this.__charBounds[l][f-1].width-P}y=v,(this.lineHeight<1||g===l&&this.lineHeight>1)&&(v/=this.lineHeight);var F=t.left+p+_,j=T-_,Z=v,Q=0;this.inCompositionMode?(i.fillStyle=this.compositionColor||"black",Z=1,Q=v):i.fillStyle=this.selectionColor,this.direction==="rtl"&&(F=this.width-F-j),i.fillRect(F,t.top+t.topOffset+Q,j,Z),t.topOffset+=y}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),i=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:i}}}),S.IText.fromObject=function(t,i){var o=S.util.stylesFromArray(t.styles,t.text),n=Object.assign({},t,{styles:o});if(e(n),n.styles)for(var s in n.styles)for(var r in n.styles[s])e(n.styles[s][r]);S.Object._fromObject("IText",n,i,"text")}})();(function(){var e=S.util.object.clone;S.util.object.extend(S.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var t=this;this.on("added",function(){var i=t.canvas;i&&(i._hasITextHandlers||(i._hasITextHandlers=!0,t._initCanvasHandlers(i)),i._iTextInstances=i._iTextInstances||[],i._iTextInstances.push(t))})},initRemovedHandler:function(){var t=this;this.on("removed",function(){var i=t.canvas;i&&(i._iTextInstances=i._iTextInstances||[],S.util.removeFromArray(i._iTextInstances,t),i._iTextInstances.length===0&&(i._hasITextHandlers=!1,t._removeCanvasHandlers(i)))})},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach(function(i){i.__isMousedown=!1})},t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,i,o,n){var s;return s={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",i,{duration:o,onComplete:function(){s.isAborted||t[n]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return s.isAborted}}),s},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(t){var i=this,o=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){i._tick()},o)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,i=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&i&&i.clearContext(i.contextTop||i.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var i=0,o=t-1;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)i++,o--;for(;/\S/.test(this._text[o])&&o>-1;)i++,o--;return t-i},findWordBoundaryRight:function(t){var i=0,o=t;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)i++,o++;for(;/\S/.test(this._text[o])&&o<this._text.length;)i++,o++;return t+i},findLineBoundaryLeft:function(t){for(var i=0,o=t-1;!/\n/.test(this._text[o])&&o>-1;)i++,o--;return t-i},findLineBoundaryRight:function(t){for(var i=0,o=t;!/\n/.test(this._text[o])&&o<this._text.length;)i++,o++;return t+i},searchWordBoundary:function(t,i){for(var o=this._text,n=this._reSpace.test(o[t])?t-1:t,s=o[n],r=S.reNonWord;!r.test(s)&&n>0&&n<o.length;)n+=i,s=o[n];return r.test(s)&&(n+=i===1?0:1),n},selectWord:function(t){t=t||this.selectionStart;var i=this.searchWordBoundary(t,-1),o=this.searchWordBoundary(t,1);this.selectionStart=i,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var i=this.findLineBoundaryLeft(t),o=this.findLineBoundaryRight(t);return this.selectionStart=i,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach(function(i){i.selected=!1,i.isEditing&&i.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var i=this.getSelectionStartFromPointer(t.e),o=this.selectionStart,n=this.selectionEnd;(i!==this.__selectionStartOnMouseDown||o===n)&&(o===i||n===i)||(i>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=i):(this.selectionStart=i,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==o||this.selectionEnd!==n)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,i,o){var n=o.slice(0,t),s=S.util.string.graphemeSplit(n).length;if(t===i)return{selectionStart:s,selectionEnd:s};var r=o.slice(t,i),a=S.util.string.graphemeSplit(r).length;return{selectionStart:s,selectionEnd:s+a}},fromGraphemeToStringSelection:function(t,i,o){var n=o.slice(0,t),s=n.join("").length;if(t===i)return{selectionStart:s,selectionEnd:s};var r=o.slice(t,i),a=r.join("").length;return{selectionStart:s,selectionEnd:s+a}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,i=this._getCursorBoundaries(t),o=this.get2DCursorLocation(t),n=o.lineIndex,s=o.charIndex,r=this.getValueOfPropertyAt(n,s,"fontSize")*this.lineHeight,a=i.leftOffset,u=this.calcTransformMatrix(),l={x:i.left+a,y:i.top+i.topOffset+r},h=this.canvas.getRetinaScaling(),f=this.canvas.upperCanvasEl,g=f.width/h,p=f.height/h,v=g-r,y=p-r,_=f.clientWidth/g,T=f.clientHeight/p;return l=S.util.transformPoint(l,u),l=S.util.transformPoint(l,this.canvas.viewportTransform),l.x*=_,l.y*=T,l.x<0&&(l.x=0),l.x>v&&(l.x=v),l.y<0&&(l.y=0),l.y>y&&(l.y=y),l.x+=this.canvas._offset.left,l.y+=this.canvas._offset.top,{left:l.x+"px",top:l.y+"px",fontSize:r+"px",charHeight:r}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text,i=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,i&&(i.blur&&i.blur(),i.parentNode&&i.parentNode.removeChild(i)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,i){var o=this.get2DCursorLocation(t,!0),n=this.get2DCursorLocation(i,!0),s=o.lineIndex,r=o.charIndex,a=n.lineIndex,u=n.charIndex,l,h;if(s!==a){if(this.styles[s])for(l=r;l<this._unwrappedTextLines[s].length;l++)delete this.styles[s][l];if(this.styles[a])for(l=u;l<this._unwrappedTextLines[a].length;l++)h=this.styles[a][l],h&&(this.styles[s]||(this.styles[s]={}),this.styles[s][r+l-u]=h);for(l=s+1;l<=a;l++)delete this.styles[l];this.shiftLineStyles(a,s-a)}else if(this.styles[s]){h=this.styles[s];var f=u-r,g,p;for(l=r;l<u;l++)delete h[l];for(p in this.styles[s])g=parseInt(p,10),g>=u&&(h[g-f]=h[p],delete h[p])}},shiftLineStyles:function(t,i){var o=e(this.styles);for(var n in this.styles){var s=parseInt(n,10);s>t&&(this.styles[s+i]=o[s],o[s-i]||delete this.styles[s])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(t,i,o,n){var s,r={},a=!1,u=this._unwrappedTextLines[t].length===i;o||(o=1),this.shiftLineStyles(t,o),this.styles[t]&&(s=this.styles[t][i===0?i:i-1]);for(var l in this.styles[t]){var h=parseInt(l,10);h>=i&&(a=!0,r[h-i]=this.styles[t][l],u&&i===0||delete this.styles[t][l])}var f=!1;for(a&&!u&&(this.styles[t+o]=r,f=!0),f&&o--;o>0;)n&&n[o-1]?this.styles[t+o]={0:e(n[o-1])}:s?this.styles[t+o]={0:e(s)}:delete this.styles[t+o],o--;this._forceClearCache=!0},insertCharStyleObject:function(t,i,o,n){this.styles||(this.styles={});var s=this.styles[t],r=s?e(s):{};o||(o=1);for(var a in r){var u=parseInt(a,10);u>=i&&(s[u+o]=r[u],r[u-o]||delete s[u])}if(this._forceClearCache=!0,n){for(;o--;)Object.keys(n[o]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][i+o]=e(n[o]));return}if(s)for(var l=s[i?i-1:1];l&&o--;)this.styles[t][i+o]=e(l)},insertNewStyleBlock:function(t,i,o){for(var n=this.get2DCursorLocation(i,!0),s=[0],r=0,a=0;a<t.length;a++)t[a]===`
`?(r++,s[r]=0):s[r]++;s[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,s[0],o),o=o&&o.slice(s[0]+1)),r&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+s[0],r);for(var a=1;a<r;a++)s[a]>0?this.insertCharStyleObject(n.lineIndex+a,0,s[a],o):o&&this.styles[n.lineIndex+a]&&o[0]&&(this.styles[n.lineIndex+a][0]=o[0]),o=o&&o.slice(s[a]+1);s[a]>0&&this.insertCharStyleObject(n.lineIndex+a,0,s[a],o)},setSelectionStartEndWithShift:function(t,i,o){o<=t?(i===t?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=o):o>t&&o<i?this._selectionDirection==="right"?this.selectionEnd=o:this.selectionStart=o:(i===t?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=i),this.selectionEnd=o)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}})})();S.util.object.extend(S.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(e){if(this.canvas){this.__newClickTime=+new Date;var t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),this._stopEvent(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y},_stopEvent:function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))},tripleClickHandler:function(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(e){!this.canvas||!this.editable||e.e.button&&e.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(e.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(e){!this.canvas||!this.editable||e.e.button&&e.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(e){if(this.__isMousedown=!1,!(!this.editable||this.group||e.transform&&e.transform.actionPerformed||e.e.button&&e.e.button!==1)){if(this.canvas){var t=this.canvas._activeObject;if(t&&t!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(e.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(e){var t=this.getSelectionStartFromPointer(e),i=this.selectionStart,o=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(i,o,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(e){for(var t=this.getLocalPointer(e),i=0,o=0,n=0,s=0,r=0,a,u,l=0,h=this._textLines.length;l<h&&n<=t.y;l++)n+=this.getHeightOfLine(l)*this.scaleY,r=l,l>0&&(s+=this._textLines[l-1].length+this.missingNewlineOffset(l-1));a=this._getLineLeftOffset(r),o=a*this.scaleX,u=this._textLines[r],this.direction==="rtl"&&(t.x=this.width*this.scaleX-t.x+o);for(var f=0,g=u.length;f<g&&(i=o,o+=this.__charBounds[r][f].kernedWidth*this.scaleX,o<=t.x);f++)s++;return this._getNewSelectionStartFromOffset(t,i,o,s,g)},_getNewSelectionStartFromOffset:function(e,t,i,o,n){var s=e.x-t,r=i-e.x,a=r>s||r<0?0:1,u=o+a;return this.flipX&&(u=n-u),u>this._text.length&&(u=this._text.length),u}});S.util.object.extend(S.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=S.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var e=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+e.top+"; left: "+e.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+e.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):S.document.body.appendChild(this.hiddenTextarea),S.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),S.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),S.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),S.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),S.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),S.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),S.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),S.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),S.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(S.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(e){if(this.isEditing){var t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else if(e.keyCode in this.ctrlKeysMapDown&&(e.ctrlKey||e.metaKey))this[this.ctrlKeysMapDown[e.keyCode]](e);else return;e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(e){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey))this[this.ctrlKeysMapUp[e.keyCode]](e);else return;e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(e){var t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!!this.isEditing){var i=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,n=i.length,s,r,a=n-o,u=this.selectionStart,l=this.selectionEnd,h=u!==l,f,g,p;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var v=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),y=u>v.selectionStart;h?(s=this._text.slice(u,l),a+=l-u):n<o&&(y?s=this._text.slice(l+a,l):s=this._text.slice(u,u-a)),r=i.slice(v.selectionEnd-a,v.selectionEnd),s&&s.length&&(r.length&&(f=this.getSelectionStyles(u,u+1,!1),f=r.map(function(){return f[0]})),h?(g=u,p=l):y?(g=l-s.length,p=l):(g=l,p=l+s.length),this.removeStyleFromTo(g,p)),r.length&&(t&&r.join("")===S.copiedText&&!S.disableStyleCopyPaste&&(f=S.copiedTextStyle),this.insertNewStyleBlock(r,u,f)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(e){this.compositionStart=e.target.selectionStart,this.compositionEnd=e.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(S.copiedText=this.getSelectedText(),S.disableStyleCopyPaste?S.copiedTextStyle=null:S.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(e){return e&&e.clipboardData||S.window.clipboardData},_getWidthBeforeCursor:function(e,t){var i=this._getLineLeftOffset(e),o;return t>0&&(o=this.__charBounds[e][t-1],i+=o.left+o.width),i},getDownCursorOffset:function(e,t){var i=this._getSelectionForOffset(e,t),o=this.get2DCursorLocation(i),n=o.lineIndex;if(n===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-i;var s=o.charIndex,r=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n+1,r),u=this._textLines[n].slice(s);return u.length+a+1+this.missingNewlineOffset(n)},_getSelectionForOffset:function(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(e,t){var i=this._getSelectionForOffset(e,t),o=this.get2DCursorLocation(i),n=o.lineIndex;if(n===0||e.metaKey||e.keyCode===33)return-i;var s=o.charIndex,r=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n-1,r),u=this._textLines[n].slice(0,s),l=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+a-u.length+(1-l)},_getIndexOnLine:function(e,t){for(var i=this._textLines[e],o=this._getLineLeftOffset(e),n=o,s=0,r,a,u=0,l=i.length;u<l;u++)if(r=this.__charBounds[e][u].width,n+=r,n>t){a=!0;var h=n-r,f=n,g=Math.abs(h-t),p=Math.abs(f-t);s=p<g?u:u-1;break}return a||(s=i.length-1),s},moveCursorDown:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)},moveCursorUp:function(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)},_moveCursorUpOrDown:function(e,t){var i="get"+e+"CursorOffset",o=this[i](t,this._selectionDirection==="right");t.shiftKey?this.moveCursorWithShift(o):this.moveCursorWithoutShift(o),o!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(e){var t=this._selectionDirection==="left"?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0},moveCursorWithoutShift:function(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0},moveCursorLeft:function(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)},_move:function(e,t,i){var o;if(e.altKey)o=this["findWordBoundary"+i](this[t]);else if(e.metaKey||e.keyCode===35||e.keyCode===36)o=this["findLineBoundary"+i](this[t]);else return this[t]+=i==="Left"?-1:1,!0;if(typeof o<"u"&&this[t]!==o)return this[t]=o,!0},_moveLeft:function(e,t){return this._move(e,t,"Left")},_moveRight:function(e,t){return this._move(e,t,"Right")},moveCursorLeftWithoutShift:function(e){var t=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t},moveCursorLeftWithShift:function(e){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(e,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(e,"selectionStart")},moveCursorRight:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)},_moveCursorLeftOrRight:function(e,t){var i="moveCursor"+e+"With";this._currentCursorOpacity=1,t.shiftKey?i+="Shift":i+="outShift",this[i](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(e){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(e,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(e,"selectionEnd")},moveCursorRightWithoutShift:function(e){var t=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t},removeChars:function(e,t){typeof t>"u"&&(t=e+1),this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(e,t,i,o){typeof o>"u"&&(o=i),o>i&&this.removeStyleFromTo(i,o);var n=S.util.string.graphemeSplit(e);this.insertNewStyleBlock(n,i,t),this._text=[].concat(this._text.slice(0,i),n,this._text.slice(o)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}});(function(){var e=S.util.toFixed,t=/  +/g;S.util.object.extend(S.Text.prototype,{_toSVG:function(){var i=this._getSVGLeftTopOffsets(),o=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(o)},toSVG:function(i){return this._createBaseSVGMarkup(this._toSVG(),{reviver:i,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(i){var o=!0,n=this.getSvgTextDecoration(this);return[i.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",n?'text-decoration="'+n+'" ':"",'style="',this.getSvgStyles(o),'"',this.addPaintOrder()," >",i.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(i,o){var n=[],s=[],r=i,a;this._setSVGBg(s);for(var u=0,l=this._textLines.length;u<l;u++)a=this._getLineLeftOffset(u),(this.textBackgroundColor||this.styleHas("textBackgroundColor",u))&&this._setSVGTextLineBg(s,u,o+a,r),this._setSVGTextLineText(n,u,o+a,r),r+=this.getHeightOfLine(u);return{textSpans:n,textBgRects:s}},_createTextCharSpan:function(i,o,n,s){var r=i!==i.trim()||i.match(t),a=this.getSvgSpanStyles(o,r),u=a?'style="'+a+'"':"",l=o.deltaY,h="",f=S.Object.NUM_FRACTION_DIGITS;return l&&(h=' dy="'+e(l,f)+'" '),['<tspan x="',e(n,f),'" y="',e(s,f),'" ',h,u,">",S.util.string.escapeXml(i),"</tspan>"].join("")},_setSVGTextLineText:function(i,o,n,s){var r=this.getHeightOfLine(o),a=this.textAlign.indexOf("justify")!==-1,u,l,h="",f,g,p=0,v=this._textLines[o],y;s+=r*(1-this._fontSizeFraction)/this.lineHeight;for(var _=0,T=v.length-1;_<=T;_++)y=_===T||this.charSpacing,h+=v[_],f=this.__charBounds[o][_],p===0?(n+=f.kernedWidth-f.width,p+=f.width):p+=f.kernedWidth,a&&!y&&this._reSpaceAndTab.test(v[_])&&(y=!0),y||(u=u||this.getCompleteStyleDeclaration(o,_),l=this.getCompleteStyleDeclaration(o,_+1),y=S.util.hasStyleChanged(u,l,!0)),y&&(g=this._getStyleDeclaration(o,_)||{},i.push(this._createTextCharSpan(h,g,n,s)),h="",u=l,n+=p,p=0)},_pushTextBgRect:function(i,o,n,s,r,a){var u=S.Object.NUM_FRACTION_DIGITS;i.push("		<rect ",this._getFillAttributes(o),' x="',e(n,u),'" y="',e(s,u),'" width="',e(r,u),'" height="',e(a,u),`"></rect>
`)},_setSVGTextLineBg:function(i,o,n,s){for(var r=this._textLines[o],a=this.getHeightOfLine(o)/this.lineHeight,u=0,l=0,h,f,g=this.getValueOfPropertyAt(o,0,"textBackgroundColor"),p=0,v=r.length;p<v;p++)h=this.__charBounds[o][p],f=this.getValueOfPropertyAt(o,p,"textBackgroundColor"),f!==g?(g&&this._pushTextBgRect(i,g,n+l,s,u,a),l=h.left,u=h.width,g=f):u+=h.kernedWidth;f&&this._pushTextBgRect(i,f,n+l,s,u,a)},_getFillAttributes:function(i){var o=i&&typeof i=="string"?new S.Color(i):"";return!o||!o.getSource()||o.getAlpha()===1?'fill="'+i+'"':'opacity="'+o.getAlpha()+'" fill="'+o.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(i){for(var o=0,n=0,s=0;s<i;s++)o+=this.getHeightOfLine(s);return n=this.getHeightOfLine(s),{lineTop:o,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(i){var o=S.Object.prototype.getSvgStyles.call(this,i);return o+" white-space: pre;"}})})();(function(e){"use strict";var t=e.fabric||(e.fabric={});t.Textbox=t.util.createClass(t.IText,t.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:t.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(i){for(var o=0,n=0,s=0,r={},a=0;a<i.graphemeLines.length;a++)i.graphemeText[s]===`
`&&a>0?(n=0,s++,o++):!this.splitByGrapheme&&this._reSpaceAndTab.test(i.graphemeText[s])&&a>0&&(n++,s++),r[a]={line:o,offset:n},s+=i.graphemeLines[a].length,n+=i.graphemeLines[a].length;return r},styleHas:function(i,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[o];n&&(o=n.line)}return t.Text.prototype.styleHas.call(this,i,o)},isEmptyStyles:function(i){if(!this.styles)return!0;var o=0,n=i+1,s,r,a=!1,u=this._styleMap[i],l=this._styleMap[i+1];u&&(i=u.line,o=u.offset),l&&(n=l.line,a=n===i,s=l.offset),r=typeof i>"u"?this.styles:{line:this.styles[i]};for(var h in r)for(var f in r[h])if(f>=o&&(!a||f<s))for(var g in r[h][f])return!1;return!0},_getStyleDeclaration:function(i,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[i];if(!n)return null;i=n.line,o=n.offset+o}return this.callSuper("_getStyleDeclaration",i,o)},_setStyleDeclaration:function(i,o,n){var s=this._styleMap[i];i=s.line,o=s.offset+o,this.styles[i][o]=n},_deleteStyleDeclaration:function(i,o){var n=this._styleMap[i];i=n.line,o=n.offset+o,delete this.styles[i][o]},_getLineStyle:function(i){var o=this._styleMap[i];return!!this.styles[o.line]},_setLineStyle:function(i){var o=this._styleMap[i];this.styles[o.line]={}},_wrapText:function(i,o){var n=[],s;for(this.isWrapping=!0,s=0;s<i.length;s++)n=n.concat(this._wrapLine(i[s],s,o));return this.isWrapping=!1,n},_measureWord:function(i,o,n){var s=0,r,a=!0;n=n||0;for(var u=0,l=i.length;u<l;u++){var h=this._getGraphemeBox(i[u],o,u+n,r,a);s+=h.kernedWidth,r=i[u]}return s},_wrapLine:function(i,o,n,F){var r=0,a=this.splitByGrapheme,u=[],l=[],h=a?t.util.string.graphemeSplit(i):i.split(this._wordJoiners),f="",g=0,p=a?"":" ",v=0,y=0,_=0,T=!0,P=this._getWidthOfCharSpacing(),F=F||0;h.length===0&&h.push([]),n-=F;for(var j=0;j<h.length;j++)f=a?h[j]:t.util.string.graphemeSplit(h[j]),v=this._measureWord(f,o,g),g+=f.length,r+=y+v-P,r>n&&!T?(u.push(l),l=[],r=v,T=!0):r+=P,!T&&!a&&l.push(p),l=l.concat(f),y=a?0:this._measureWord([p],o,g),g++,T=!1,v>_&&(_=v);return j&&u.push(l),_+F>this.dynamicMinWidth&&(this.dynamicMinWidth=_-P+F),u},isEndOfWrapping:function(i){return!this._styleMap[i+1]||this._styleMap[i+1].line!==this._styleMap[i].line},missingNewlineOffset:function(i){return this.splitByGrapheme?this.isEndOfWrapping(i)?1:0:1},_splitTextIntoLines:function(i){for(var o=t.Text.prototype._splitTextIntoLines.call(this,i),n=this._wrapText(o.lines,this.width),s=new Array(n.length),r=0;r<n.length;r++)s[r]=n[r].join("");return o.lines=s,o.graphemeLines=n,o},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var i={};for(var o in this._styleMap)this._textLines[o]&&(i[this._styleMap[o].line]=1);for(var o in this.styles)i[o]||delete this.styles[o]},toObject:function(i){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(i))}}),t.Textbox.fromObject=function(i,o){var n=t.util.stylesFromArray(i.styles,i.text),s=Object.assign({},i,{styles:n});return t.Object._fromObject("Textbox",s,o,"text")}})(ht);(function(){var e=S.controlsUtils,t=e.scaleSkewCursorStyleHandler,i=e.scaleCursorStyleHandler,o=e.scalingEqually,n=e.scalingYOrSkewingX,s=e.scalingXOrSkewingY,r=e.scaleOrSkewActionName,a=S.Object.prototype.controls;if(a.ml=new S.Control({x:-.5,y:0,cursorStyleHandler:t,actionHandler:s,getActionName:r}),a.mr=new S.Control({x:.5,y:0,cursorStyleHandler:t,actionHandler:s,getActionName:r}),a.mb=new S.Control({x:0,y:.5,cursorStyleHandler:t,actionHandler:n,getActionName:r}),a.mt=new S.Control({x:0,y:-.5,cursorStyleHandler:t,actionHandler:n,getActionName:r}),a.tl=new S.Control({x:-.5,y:-.5,cursorStyleHandler:i,actionHandler:o}),a.tr=new S.Control({x:.5,y:-.5,cursorStyleHandler:i,actionHandler:o}),a.bl=new S.Control({x:-.5,y:.5,cursorStyleHandler:i,actionHandler:o}),a.br=new S.Control({x:.5,y:.5,cursorStyleHandler:i,actionHandler:o}),a.mtr=new S.Control({x:0,y:-.5,actionHandler:e.rotationWithSnapping,cursorStyleHandler:e.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),S.Textbox){var u=S.Textbox.prototype.controls={};u.mtr=a.mtr,u.tr=a.tr,u.br=a.br,u.tl=a.tl,u.bl=a.bl,u.mt=a.mt,u.mb=a.mb,u.mr=new S.Control({x:.5,y:0,actionHandler:e.changeWidth,cursorStyleHandler:t,actionName:"resizing"}),u.ml=new S.Control({x:-.5,y:0,actionHandler:e.changeWidth,cursorStyleHandler:t,actionName:"resizing"})}})()});var of=je((b2,h0)=>{"use strict";function Mi(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function u0(e,t){for(var i="",o=0,n=-1,s=0,r,a=0;a<=e.length;++a){if(a<e.length)r=e.charCodeAt(a);else{if(r===47)break;r=47}if(r===47){if(!(n===a-1||s===1))if(n!==a-1&&s===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){var u=i.lastIndexOf("/");if(u!==i.length-1){u===-1?(i="",o=0):(i=i.slice(0,u),o=i.length-1-i.lastIndexOf("/")),n=a,s=0;continue}}else if(i.length===2||i.length===1){i="",o=0,n=a,s=0;continue}}t&&(i.length>0?i+="/..":i="..",o=2)}else i.length>0?i+="/"+e.slice(n+1,a):i=e.slice(n+1,a),o=a-n-1;n=a,s=0}else r===46&&s!==-1?++s:s=-1}return i}function o2(e,t){var i=t.dir||t.root,o=t.base||(t.name||"")+(t.ext||"");return i?i===t.root?i+o:i+e+o:o}var qr={resolve:function(){for(var t="",i=!1,o,n=arguments.length-1;n>=-1&&!i;n--){var s;n>=0?s=arguments[n]:(o===void 0&&(o=process.cwd()),s=o),Mi(s),s.length!==0&&(t=s+"/"+t,i=s.charCodeAt(0)===47)}return t=u0(t,!i),i?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(t){if(Mi(t),t.length===0)return".";var i=t.charCodeAt(0)===47,o=t.charCodeAt(t.length-1)===47;return t=u0(t,!i),t.length===0&&!i&&(t="."),t.length>0&&o&&(t+="/"),i?"/"+t:t},isAbsolute:function(t){return Mi(t),t.length>0&&t.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var t,i=0;i<arguments.length;++i){var o=arguments[i];Mi(o),o.length>0&&(t===void 0?t=o:t+="/"+o)}return t===void 0?".":qr.normalize(t)},relative:function(t,i){if(Mi(t),Mi(i),t===i||(t=qr.resolve(t),i=qr.resolve(i),t===i))return"";for(var o=1;o<t.length&&t.charCodeAt(o)===47;++o);for(var n=t.length,s=n-o,r=1;r<i.length&&i.charCodeAt(r)===47;++r);for(var a=i.length,u=a-r,l=s<u?s:u,h=-1,f=0;f<=l;++f){if(f===l){if(u>l){if(i.charCodeAt(r+f)===47)return i.slice(r+f+1);if(f===0)return i.slice(r+f)}else s>l&&(t.charCodeAt(o+f)===47?h=f:f===0&&(h=0));break}var g=t.charCodeAt(o+f),p=i.charCodeAt(r+f);if(g!==p)break;g===47&&(h=f)}var v="";for(f=o+h+1;f<=n;++f)(f===n||t.charCodeAt(f)===47)&&(v.length===0?v+="..":v+="/..");return v.length>0?v+i.slice(r+h):(r+=h,i.charCodeAt(r)===47&&++r,i.slice(r))},_makeLong:function(t){return t},dirname:function(t){if(Mi(t),t.length===0)return".";for(var i=t.charCodeAt(0),o=i===47,n=-1,s=!0,r=t.length-1;r>=1;--r)if(i=t.charCodeAt(r),i===47){if(!s){n=r;break}}else s=!1;return n===-1?o?"/":".":o&&n===1?"//":t.slice(0,n)},basename:function(t,i){if(i!==void 0&&typeof i!="string")throw new TypeError('"ext" argument must be a string');Mi(t);var o=0,n=-1,s=!0,r;if(i!==void 0&&i.length>0&&i.length<=t.length){if(i.length===t.length&&i===t)return"";var a=i.length-1,u=-1;for(r=t.length-1;r>=0;--r){var l=t.charCodeAt(r);if(l===47){if(!s){o=r+1;break}}else u===-1&&(s=!1,u=r+1),a>=0&&(l===i.charCodeAt(a)?--a===-1&&(n=r):(a=-1,n=u))}return o===n?n=u:n===-1&&(n=t.length),t.slice(o,n)}else{for(r=t.length-1;r>=0;--r)if(t.charCodeAt(r)===47){if(!s){o=r+1;break}}else n===-1&&(s=!1,n=r+1);return n===-1?"":t.slice(o,n)}},extname:function(t){Mi(t);for(var i=-1,o=0,n=-1,s=!0,r=0,a=t.length-1;a>=0;--a){var u=t.charCodeAt(a);if(u===47){if(!s){o=a+1;break}continue}n===-1&&(s=!1,n=a+1),u===46?i===-1?i=a:r!==1&&(r=1):i!==-1&&(r=-1)}return i===-1||n===-1||r===0||r===1&&i===n-1&&i===o+1?"":t.slice(i,n)},format:function(t){if(t===null||typeof t!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return o2("/",t)},parse:function(t){Mi(t);var i={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return i;var o=t.charCodeAt(0),n=o===47,s;n?(i.root="/",s=1):s=0;for(var r=-1,a=0,u=-1,l=!0,h=t.length-1,f=0;h>=s;--h){if(o=t.charCodeAt(h),o===47){if(!l){a=h+1;break}continue}u===-1&&(l=!1,u=h+1),o===46?r===-1?r=h:f!==1&&(f=1):r!==-1&&(f=-1)}return r===-1||u===-1||f===0||f===1&&r===u-1&&r===a+1?u!==-1&&(a===0&&n?i.base=i.name=t.slice(1,u):i.base=i.name=t.slice(a,u)):(a===0&&n?(i.name=t.slice(1,r),i.base=t.slice(1,u)):(i.name=t.slice(a,r),i.base=t.slice(a,u)),i.ext=t.slice(r,u)),a>0?i.dir=t.slice(0,a-1):n&&(i.dir="/"),i},sep:"/",delimiter:":",win32:null,posix:null};qr.posix=qr;h0.exports=qr});var lf=Wn(Ng());var Xg=/^(https?:(\/\/)?(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:(\/\/)?(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})$/i,Yg=`<svg height="18px" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" preserveAspectRatio="xMidYMid meet" viewBox="0 0 197.99999 198" id="svg2" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="application-icon.svg" enable-background="new" inkscape:export-filename="/home/tim/development/Anki-Android/docs/marketing/android_market/logo512-512-alpha.png" inkscape:export-xdpi="90" inkscape:export-ydpi="90">
<title id="title4207">Anki Flat Design</title>
<sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="2.8" inkscape:cx="44.732536" inkscape:cy="87.724961" inkscape:document-units="px" inkscape:current-layer="layer5" showgrid="false" units="px" borderlayer="true" inkscape:window-width="1855" inkscape:window-height="1056" inkscape:window-x="65" inkscape:window-y="24" inkscape:window-maximized="1" inkscape:snap-bbox="true" inkscape:snap-bbox-midpoints="true" inkscape:bbox-paths="true" showguides="false" inkscape:snap-bbox-edge-midpoints="true" inkscape:snap-global="true">
  <sodipodi:guide position="0.0,0" orientation="198.0,0" id="guide4139"/>
  <sodipodi:guide position="99.0,0" orientation="198.0,0" id="guide4141"/>
  <sodipodi:guide position="198.0,0" orientation="198.0,0" id="guide4143"/>
  <sodipodi:guide position="0,0.0" orientation="0,198.0" id="guide4145"/>
  <sodipodi:guide position="0,99.0" orientation="0,198.0" id="guide4147"/>
  <sodipodi:guide position="0,198.0" orientation="0,198.0" id="guide4149"/>
</sodipodi:namedview>
<defs id="defs4">
  <linearGradient inkscape:collect="always" id="linearGradient4641">
    <stop style="stop-color:#4d4d4d;stop-opacity:1" offset="0" id="stop4643"/>
    <stop style="stop-color:#666666;stop-opacity:0.46757679" offset="1" id="stop4645"/>
  </linearGradient>
  <linearGradient id="linearGradient4266" inkscape:collect="always">
    <stop id="stop4268" offset="0" style="stop-color:#ffffff;stop-opacity:0.1"/>
    <stop id="stop4270" offset="1" style="stop-color:#ffffff;stop-opacity:0"/>
  </linearGradient>
  <linearGradient id="linearGradient4181" inkscape:collect="always">
    <stop id="stop4183" offset="0" style="stop-color:#0288d1;stop-opacity:1"/>
    <stop id="stop4185" offset="1" style="stop-color:#29b6f6;stop-opacity:1"/>
  </linearGradient>
  <clipPath id="clipPath4168" clipPathUnits="userSpaceOnUse">
    <rect y="794.77325" x="358.60416" height="325.2691" width="263.64981" id="rect4170" style="opacity:1;fill:#fbe9e7;fill-opacity:1;stroke:#000000;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"/>
  </clipPath>
  <filter id="filter4246" inkscape:label="Drop Shadow" style="color-interpolation-filters:sRGB">
    <feFlood id="feFlood4248" result="flood" flood-color="rgb(255,255,255)" flood-opacity="0.2"/>
    <feComposite id="feComposite4250" result="composite1" operator="in" in2="flood" in="SourceGraphic"/>
    <feGaussianBlur id="feGaussianBlur4252" result="blur" stdDeviation="4" in="composite1"/>
    <feOffset id="feOffset4254" result="offset" dy="4" dx="2.77556e-017"/>
    <feComposite id="feComposite4256" result="composite2" operator="atop" in2="offset" in="offset"/>
  </filter>
  <radialGradient gradientUnits="userSpaceOnUse" gradientTransform="matrix(-7.8502812e-7,3.09375,-3.0937492,-1.2165089e-6,2721.5333,854.36325)" r="64" fy="879.68774" fx="-6.4646401e-006" cy="879.68774" cx="-6.4646401e-006" id="radialGradient4272" xlink:href="#linearGradient4266" inkscape:collect="always"/>
  <filter id="filter5200" inkscape:label="Drop Shadow" style="color-interpolation-filters:sRGB">
    <feFlood id="feFlood5202" result="flood" flood-color="rgb(62,62,62)" flood-opacity="0.2"/>
    <feComposite id="feComposite5204" result="composite1" operator="in" in2="SourceGraphic" in="flood"/>
    <feGaussianBlur id="feGaussianBlur5206" result="blur" stdDeviation="4" in="composite1"/>
    <feOffset id="feOffset5208" result="offset" dy="4" dx="2.77556e-017"/>
    <feComposite id="feComposite5210" result="composite2" operator="atop" in2="offset" in="offset"/>
  </filter>
  <filter id="filter5330" inkscape:label="Drop Shadow" style="color-interpolation-filters:sRGB">
    <feFlood id="feFlood5332" result="flood" flood-color="rgb(0,0,0)" flood-opacity="0.2"/>
    <feComposite id="feComposite5334" result="composite1" operator="out" in2="SourceGraphic" in="flood"/>
    <feGaussianBlur id="feGaussianBlur5336" result="blur" stdDeviation="0" in="composite1"/>
    <feOffset id="feOffset5338" result="offset" dy="-1" dx="2.77556e-017"/>
    <feComposite id="feComposite5340" result="composite2" operator="in" in2="SourceGraphic" in="offset"/>
  </filter>
  <filter id="filter5590" inkscape:label="Drop Shadow" style="color-interpolation-filters:sRGB">
    <feFlood id="feFlood5592" result="flood" flood-color="rgb(0,69,111)" flood-opacity="0.2"/>
    <feComposite id="feComposite5594" result="composite1" operator="out" in2="SourceGraphic" in="flood"/>
    <feGaussianBlur id="feGaussianBlur5596" result="blur" stdDeviation="0" in="composite1"/>
    <feOffset id="feOffset5598" result="offset" dy="-1" dx="2.77556e-017"/>
    <feComposite id="feComposite5600" result="composite2" operator="atop" in2="SourceGraphic" in="offset"/>
  </filter>
  <filter id="filter6198" inkscape:label="Drop Shadow" style="color-interpolation-filters:sRGB">
    <feFlood id="feFlood6200" result="flood" flood-color="rgb(255,255,255)" flood-opacity="0.2"/>
    <feComposite id="feComposite6202" result="composite1" operator="out" in2="SourceGraphic" in="flood"/>
    <feGaussianBlur id="feGaussianBlur6204" result="blur" stdDeviation="0" in="composite1"/>
    <feOffset id="feOffset6206" result="offset" dy="1" dx="2.77556e-017"/>
    <feComposite id="feComposite6208" result="fbSourceGraphic" operator="atop" in2="SourceGraphic" in="offset"/>
    <feColorMatrix id="feColorMatrix6222" values="0 0 0 -1 0 0 0 0 -1 0 0 0 0 -1 0 0 0 0 1 0" in="fbSourceGraphic" result="fbSourceGraphicAlpha"/>
    <feFlood in="fbSourceGraphic" result="flood" flood-color="rgb(0,0,0)" flood-opacity="0.2" id="feFlood6224"/>
    <feComposite result="composite1" operator="out" in="flood" in2="fbSourceGraphic" id="feComposite6226"/>
    <feGaussianBlur result="blur" stdDeviation="0" in="composite1" id="feGaussianBlur6228"/>
    <feOffset result="offset" dy="-1" dx="2.77556e-017" id="feOffset6230"/>
    <feComposite result="composite2" operator="atop" in="offset" in2="fbSourceGraphic" id="feComposite6232"/>
  </filter>
  <filter id="filter6378" inkscape:label="Drop Shadow" style="color-interpolation-filters:sRGB">
    <feFlood id="feFlood6380" result="flood" flood-color="rgb(255,255,255)" flood-opacity="0.5"/>
    <feComposite id="feComposite6382" result="composite1" operator="out" in2="SourceGraphic" in="flood"/>
    <feGaussianBlur id="feGaussianBlur6384" result="blur" stdDeviation="0" in="composite1"/>
    <feOffset id="feOffset6386" result="offset" dy="1" dx="2.77556e-017"/>
    <feComposite id="feComposite6388" result="composite2" operator="in" in2="SourceGraphic" in="offset"/>
  </filter>
  <linearGradient y2="1022.263" x2="83.887375" y1="942.79626" x1="94.9618" gradientTransform="matrix(0.97143611,-0.13537864,0.13537864,0.97143611,-132.14655,37.991055)" gradientUnits="userSpaceOnUse" id="linearGradient6395" xlink:href="#linearGradient4181" inkscape:collect="always"/>
  <linearGradient y2="939.29724" x2="134.55711" y1="895.45349" x1="113.67747" gradientTransform="matrix(0.87513004,0.41676225,-0.41676225,0.87513004,393.8871,57.480241)" gradientUnits="userSpaceOnUse" id="linearGradient6397" xlink:href="#linearGradient4181" inkscape:collect="always"/>
  <clipPath clipPathUnits="userSpaceOnUse" id="clipPath4629">
    <rect style="display:inline;opacity:1;fill:#666666;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" id="rect4631" width="128" height="172" x="35.000004" y="13.000023" rx="16"/>
  </clipPath>
  <linearGradient inkscape:collect="always" xlink:href="#linearGradient4641" id="linearGradient4647" x1="99" y1="99.000023" x2="224.2589" y2="161.62946" gradientUnits="userSpaceOnUse"/>
</defs>
<metadata id="metadata7">
  <rdf:RDF>
    <cc:Work rdf:about="">
      <dc:format>
        image/svg+xml
      </dc:format>
      <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>
      <dc:title>
        Anki Flat Design
      </dc:title>
      <cc:license rdf:resource="http://creativecommons.org/licenses/by/3.0/"/>
      <dc:creator>
        <cc:Agent>
          <dc:title>
            not7CD
          </dc:title>
        </cc:Agent>
      </dc:creator>
      <dc:description>
        not7CD.pl
      </dc:description>
    </cc:Work>
    <cc:License rdf:about="http://creativecommons.org/licenses/by/3.0/">
      <cc:permits rdf:resource="http://creativecommons.org/ns#Reproduction"/>
      <cc:permits rdf:resource="http://creativecommons.org/ns#Distribution"/>
      <cc:requires rdf:resource="http://creativecommons.org/ns#Notice"/>
      <cc:requires rdf:resource="http://creativecommons.org/ns#Attribution"/>
      <cc:permits rdf:resource="http://creativecommons.org/ns#DerivativeWorks"/>
    </cc:License>
  </rdf:RDF>
</metadata>
<g style="display:inline" inkscape:label="Card" inkscape:groupmode="layer" id="layer1" transform="translate(0,-854.36216)"/>
<g sodipodi:insensitive="true" style="display:none" inkscape:label="Finish" id="layer4" inkscape:groupmode="layer">
  <rect rx="16" y="867.36218" x="34.999996" height="172" width="128" id="rect4192" style="display:inline;opacity:1;fill:url(#radialGradient4272);fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" transform="translate(7.6293945e-6,-854.36216)"/>
</g>
<g inkscape:groupmode="layer" id="layer6" inkscape:label="LongShadow" style="opacity:1"/>
<g style="display:inline" inkscape:label="Stars" id="layer5" inkscape:groupmode="layer">
  <g id="g3410" transform="translate(-8.7624731,0)">
    <rect style="display:inline;opacity:1;fill:#666666;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" id="rect4162" width="145.52492" height="195.5491" x="34.999996" y="855.81305" rx="18.190615" transform="translate(7.6293945e-6,-854.36216)"/>
    <path transform="matrix(1.1369134,0,0,1.1369134,-4.7919614,-13.328985)" inkscape:connector-curvature="0" clip-path="url(#clipPath4629)" id="path4332" d="m 133.86719,36.148438 c -3.17677,-0.288864 -7.82002,7.359765 -11.05274,7.960937 -3.44823,0.64127 -11.27475,-5.623735 -13.6875,-3.078125 -2.41275,2.54561 4.26233,10.026286 3.80664,13.503906 -0.45568,3.47763 -8.8317,8.985107 -7.15625,12.066406 0.0844,0.155164 0.18792,0.291428 0.3086,0.41211 L 318.21875,279.14648 c 1.7413,1.7413 7.07575,0.068 10.83594,-0.17578 l 10.08984,10.08985 c 0.65625,0.58538 1.33604,0.89427 2.04883,0.76172 3.44823,-0.64127 2.44467,-10.6165 4.85742,-13.16211 2.41275,-2.5456 12.42712,-2.07707 12.88281,-5.55469 0.0948,-0.72364 -0.25525,-1.39002 -0.88281,-2.01758 l -10.55469,-10.55273 c 0,0 0,-0.002 0,-0.002 0.21836,-3.61192 1.18995,-8.15967 -0.38086,-9.73047 L 134.98242,36.669922 c -0.14447,-0.144469 -0.30964,-0.26286 -0.5,-0.353516 -0.19791,-0.09425 -0.40345,-0.148711 -0.61523,-0.167968 z M 84.710938,88.658203 c -0.188085,-0.0077 -0.379919,5.42e-4 -0.572266,0.02734 -6.155121,0.85776 -5.180838,18.594407 -9.65625,22.906257 -4.47541,4.31185 -22.163753,2.67795 -23.25,8.79687 -0.247777,1.39576 0.454834,2.71069 1.71875,3.97461 l 17.675781,17.67578 c -0.445623,6.6333 -3.198221,15.85256 -0.166015,18.88477 L 282.59375,373.05469 c 0.22013,0.22013 0.47166,0.409 0.75586,0.56054 5.48379,2.924 15.12027,-11.99776 21.27539,-12.85546 6.15513,-0.8579 19.50505,10.86062 23.98047,6.54882 4.4754,-4.3119 -6.73664,-18.09005 -5.65039,-24.20898 1.08625,-6.11893 16.35454,-15.19439 13.63672,-20.7832 -0.15931,-0.32761 -0.36772,-0.61382 -0.61719,-0.86329 L 123.84375,109.32031 c -2.82418,-2.82417 -11.09471,-0.92329 -17.54297,-0.51562 L 87.511719,90.015625 c -0.888073,-0.817279 -1.815637,-1.317001 -2.800781,-1.357422 z" style="display:inline;opacity:0.46799999;fill:url(#linearGradient4647);fill-opacity:1;stroke:none;stroke-width:5.5;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"/>
    <g id="g5190" transform="matrix(1.1369134,0,0,1.1369134,-3.5527153,-14.164677)">
      <path inkscape:connector-curvature="0" id="path4164" d="m 83.049581,943.78215 c 6.155121,-0.85778 10.067566,16.46925 15.55135,19.39319 5.483779,2.92393 22.051249,-3.48327 24.769079,2.10553 2.71782,5.58881 -12.55215,14.66411 -13.6384,20.78304 -1.08625,6.11893 10.127,19.89549 5.6516,24.20739 -4.47542,4.3118 -17.825218,-7.4064 -23.980342,-6.5485 -6.155121,0.8577 -15.79242,15.7794 -21.276207,12.8554 -5.483788,-2.924 1.535552,-19.24149 -1.182277,-24.83021 -2.717829,-5.5888 -19.887254,-10.14337 -18.801009,-16.26232 1.086247,-6.11892 18.774248,-4.48553 23.249658,-8.79738 4.475412,-4.31185 3.501427,-22.04838 9.656548,-22.90614 z" inkscape:transform-center-y="-2.8065976" inkscape:transform-center-x="1.6436305" style="display:inline;opacity:1;fill:url(#linearGradient6395);fill-opacity:1;stroke:#ffffff;stroke-width:5.5;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" transform="translate(7.6293945e-6,-854.36216)"/>
      <path inkscape:connector-curvature="0" id="path4164-3" d="m 133.39163,891.41316 c 3.1666,1.50803 -0.37288,10.8875 1.30256,13.9688 1.67543,3.0813 11.47206,5.20934 11.01637,8.68697 -0.45569,3.47762 -10.46986,3.0098 -12.88261,5.5554 -2.41275,2.54561 -1.40932,12.52035 -4.85755,13.16162 -3.44823,0.64125 -6.09784,-9.02735 -9.26445,-10.53538 -3.16659,-1.50801 -12.34306,2.52866 -14.01849,-0.55263 -1.67545,-3.0813 6.70117,-8.589 7.15685,-12.06663 0.45569,-3.47762 -6.21911,-10.95755 -3.80636,-13.50316 2.41275,-2.54561 10.2394,3.71905 13.68763,3.07778 3.44823,-0.64125 8.49945,-9.3008 11.66605,-7.79277 z" inkscape:transform-center-y="0.35457901" inkscape:transform-center-x="-1.3524214" style="display:inline;opacity:1;fill:url(#linearGradient6397);fill-opacity:1;stroke:#ffffff;stroke-width:5.5;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" transform="translate(7.6293945e-6,-854.36216)"/>
    </g>
  </g>
</g>
</svg>`,zg="https://img.shields.io/github/sponsors/debanjandhar12.svg?logo=github&style=flat&height=60&label=Donate&cacheSeconds=28800&color=orange";var Vt=Wn(Hu()),a2=Wn(s0()),c0=Wn(o0()),f0=Wn(l0()),af=Wn(of());if(!window.parent.fabric){let e=window.parent.document.createElement("script");e.innerHTML=f0.default,window.parent.document.body.appendChild(e)}var P2=Vt.default.forwardRef(({imgURL:e,occlusionArr:t},i)=>{let o=Vt.default.useRef(null),n=Vt.default.useRef(null),[s,r]=Vt.default.useState(new window.parent.Image);Vt.default.useEffect(()=>{let g=async()=>{i.current=new window.parent.fabric.Canvas(o.current,{stateful:!0}),i.current.selection=!1,i.current.uniformScaling=!1,s.setAttribute("crossOrigin","anonymous");let v=(await logseq.App.getCurrentGraph()).path;s.src=Xg.test(e)?e:encodeURI(af.default.join(v,af.default.resolve(e))),s.onload=function(){let y=new window.parent.fabric.Image(s),_=Math.min(s.width,window.parent.document.querySelector(".occlusion__editor").clientWidth-160),T=Math.min(s.height,window.parent.document.body.clientHeight-340),P=Number(Math.min(_/s.width,T/s.height).toPrecision(1));i.current.setZoom(P),i.current.setWidth(s.width*P),i.current.setHeight(s.height*P),i.current.setBackgroundImage(y,i.current.renderAll.bind(i.current),{scaleX:1,scaleY:1}),i.current.renderAll(),t.forEach(F=>{let j=dl(F.left,F.top,F.width,F.height,F.angle,F.cId);i.current.add(j)}),i.current.renderAll()}},p=()=>{i.current.dispose()};return g(),()=>{p()}},[]);let[a,u]=Vt.default.useState(null);Vt.default.useEffect(()=>{i.current.on("selection:created",function(){u(i.current.getActiveObject())}),i.current.on("selection:updated",function(){u(i.current.getActiveObject())}),i.current.on("selection:cleared",function(){u(null)})},[i]),Vt.default.useEffect(()=>{a&&(n.current.value=a._objects[1].text)},[a]),Vt.default.useEffect(()=>{let g=p=>{let v=p.target,y=v.top,_=y+v.height*v.scaleY,T=v.left,P=T+v.width*v.scaleX,F=v.height*v.scaleY/2,j=F+s.height,Z=v.width*v.scaleX/2,Q=Z+s.width;v.left=Math.min(Math.max(T,Z),Q-v.width*v.scaleX),v.top=Math.min(Math.max(y,F),j-v.height*v.scaleY)};i.current.on("object:moving",g),i.current.on("object:modified",g)},[i]),Vt.default.useEffect(()=>{let g=p=>{if(p.key==="Escape"&&i.current.getActiveObject()&&(i.current.discardActiveObject(),i.current.renderAll(),p.stopImmediatePropagation()),p.key==="Delete"&&i.current.getActiveObject()&&(h(),p.stopImmediatePropagation()),p.key==="Insert"&&(l(),p.stopImmediatePropagation()),p.key==="ArrowUp"&&i.current.getActiveObject()&&(i.current.getActiveObject().top-=1,i.current.renderAll(),p.stopImmediatePropagation()),p.key==="ArrowDown"&&i.current.getActiveObject()&&(i.current.getActiveObject().top+=1,i.current.renderAll(),p.stopImmediatePropagation()),p.key==="ArrowLeft"&&i.current.getActiveObject()&&(i.current.getActiveObject().left-=1,i.current.renderAll(),p.stopImmediatePropagation()),p.key==="ArrowRight"&&i.current.getActiveObject()&&(i.current.getActiveObject().left+=1,i.current.renderAll(),p.stopImmediatePropagation()),p.key>="1"&&p.key<="9"&&i.current.getActiveObject()){n.current.value=p.key;let v=new Event("change",{bubbles:!0});n.current.dispatchEvent(v),p.stopImmediatePropagation()}};return window.parent.document.addEventListener("keydown",g,{capture:!0}),()=>{window.parent.document.removeEventListener("keydown",g,{capture:!0})}},[i]);let l=()=>{let g={x:Math.floor(Math.random()*(s.width-.22*s.width))+.11*s.width,y:Math.floor(Math.random()*(s.height-.22*s.height))+.11*s.height},p=dl(g.x,g.y,.22*s.width,.22*s.height);i.current.add(p),i.current.setActiveObject(p),i.current.renderAll()},h=()=>{i.current.remove(i.current.getActiveObject()),i.current.renderAll()},f=()=>{a&&(i.current.getActiveObject()._objects[1].set("text",n.current.value),i.current.renderAll())};return Vt.default.createElement("div",null,Vt.default.createElement("div",{className:"flex",style:{justifyContent:"space-between",marginTop:"0.3rem",marginBottom:"0.6rem"}},Vt.default.createElement("div",{className:"flex",style:{alignItems:"center"}},Vt.default.createElement("i",{className:"ti",dangerouslySetInnerHTML:{__html:Yg}}),Vt.default.createElement("h3",{className:"text-lg",style:{marginLeft:"4px"}},"Occlusion Editor")),Vt.default.createElement("a",{href:"https://github.com/sponsors/debanjandhar12"},Vt.default.createElement("img",{alt:"Donate",style:{height:"1.6rem"},src:zg}))),Vt.default.createElement("div",{className:"occlusion-editor-toolbar flex",style:{justifyContent:"end",alignItems:"center",marginBottom:"0.3rem"}},Vt.default.createElement("button",{onClick:l,className:"ui__button bg-indigo-600 hover:bg-indigo-700 focus:border-indigo-700 active:bg-indigo-700 text-center text-sm",style:{margin:"0.125rem 0.25rem 0.125rem 0",padding:".35rem .35rem"}},Vt.default.createElement("i",{className:"ti ti-plus",style:{fontSize:"1.25rem"}})),Vt.default.createElement("button",{onClick:h,className:"ui__button bg-indigo-600 hover:bg-indigo-700 focus:border-indigo-700 active:bg-indigo-700 text-center text-sm",style:{margin:"0.125rem 0.25rem 0.125rem 0",padding:".35rem .35rem"},disabled:a==null},Vt.default.createElement("i",{className:"ti ti-trash",style:{fontSize:"1.25rem"}})),Vt.default.createElement("span",{style:{fontSize:"0.875rem",marginLeft:"1rem"}},"Cloze Id:")," ",Vt.default.createElement("select",{ref:n,onChange:f,className:"form-select is-small",style:{margin:"0",width:"80px",height:"2.2rem"},disabled:a==null},c0.default.range(1,10).map(g=>Vt.default.createElement("option",{key:g,value:g},g)))),Vt.default.createElement("div",{className:"cloze-editor-canvas-container flex",style:{justifyContent:"center"}},Vt.default.createElement("canvas",{ref:o})))});function dl(e=0,t=0,i=80,o=40,n=0,s=1){let r=new window.parent.fabric.Rect({fill:"#FFEBA2",stroke:"#000",strokeWidth:1,strokeUniform:!0,noScaleCache:!1,opacity:.8,width:i,height:o,originX:"center",originY:"center"}),a=new window.parent.fabric.Text(`${s}`,{originX:"center",originY:"center"});return a.scaleToHeight(o),new window.parent.fabric.Group([r,a],{left:e,top:t,width:i,height:o,originX:"center",originY:"center",angle:n})}var d0=Wn(of());window.addEventListener("load",()=>{if(type=="image_occlusion"){let e="-1";for(let s=1;s<=9;s++)document.getElementById(`c${s}`)&&(e=`${s}`);if(console.log(`Current cloze id: ${e}`),e=="-1")return;let t=document.getElementById("localImgBasePath").src;t=t.substring(0,t.lastIndexOf("/"));let i={},o=Array.from(document.getElementsByTagName("img"));for(let s of o){s.style.visibility="hidden";let r=document.createElement("canvas");r.width=s.width,r.height=s.height;let a=new lf.fabric.Canvas(r,{imageSmoothingEnabled:!1}),u=new Image;u.src=s.src,u.onload=function(){let l=new lf.fabric.Image(u),h=a.width/l.width,f=a.height/l.height;a.setViewportTransform([h,0,0,f,0,0]),a.setBackgroundImage(l,a.renderAll.bind(a),{scaleX:1,scaleY:1})},r.style.position="relative",s.replaceWith(r),i[s.src]==null&&(i[s.src]=[]),i[s.src].push(a)}document.getElementById("main-content").style.visibility="visible";let n=JSON.parse(document.getElementById("imgToOcclusionArrHashMap").innerHTML);for(let s in n)n[s].forEach(a=>{a.cId==e&&(i[t+"/"+d0.default.basename(s)]||i[s]||[]).forEach(u=>{let l=dl(a.left,a.top,a.width,a.height,a.angle,a.cId);l._objects[0].set("opacity",1),u.add(l),u.renderAll()})})}});})();
/*! Bundled license information:

fabric/dist/fabric.js:
  (*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) *)

object-assign/index.js:
  (*
  object-assign
  (c) Sindre Sorhus
  @license MIT
  *)

react/cjs/react.production.min.js:
  (** @license React v17.0.2
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.min.js:
  (** @license React v0.20.2
   * scheduler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.min.js:
  (** @license React v17.0.2
   * react-dom.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

fabric/dist/fabric.js:
  (*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) *)
*/
